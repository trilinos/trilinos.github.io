<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tempus: 01_Utilize_Thyra.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tempus<span id="projectnumber">&#160;Version of the Day</span>
   </div>
   <div id="projectbrief">Time Integration</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d28a4824dc47e487b107a5db32ef43c4.html">examples</a></li><li class="navelem"><a class="el" href="dir_9bee09d16e7da7e675a8a8daef682da2.html">01_Utilize_Thyra</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">01_Utilize_Thyra.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;iomanip&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;Teuchos_StandardCatchMacros.hpp&quot;</code><br />
<code>#include &quot;Thyra_VectorStdOps.hpp&quot;</code><br />
<code>#include &quot;Thyra_DefaultSpmdVectorSpace.hpp&quot;</code><br />
<code>#include &quot;Thyra_DetachedVectorView.hpp&quot;</code><br />
</div>
<p><a href="01__Utilize__Thyra_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97" id="r_a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="01__Utilize__Thyra_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="memdesc:a0ddf1224851353fc92bfbff6f499fa97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Description:  <br /></td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0ddf1224851353fc92bfbff6f499fa97" name="a0ddf1224851353fc92bfbff6f499fa97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddf1224851353fc92bfbff6f499fa97">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Description: </p>
<h1><a class="anchor" id="example-01"></a>
Example 1: Utilize Thyra</h1>
<p>This problem takes <a class="el" href="00__Basic__Problem_8cpp.html">Basic Problem</a> and utilizes <a class="el" href="namespaceThyra.html">Thyra</a> vectors, replacing the C++ double arrays, <a class="el" href="01__Utilize__Thyra_8cpp.html">01_Utilize_Thyra.cpp</a>. <a class="el" href="namespaceTempus.html">Tempus</a> uses <a class="el" href="namespaceThyra.html">Thyra</a> for its Abstract Numerical Algorithms (ANAs), which are the mathematical concepts of vectors, vector spaces, and linear operators. All other ANA interfaces and support software are built on these fundamental operator/vector interfaces (including ModelEvaluators).</p>
<p>In the following table, code snippets from the <a class="el" href="00__Basic__Problem_8cpp.html">Basic Problem</a> tutorial are replaced with snippets using <a class="el" href="namespaceThyra.html">Thyra</a> to create <a class="el" href="01__Utilize__Thyra_8cpp.html">01_Utilize_Thyra.cpp</a> for the <a class="el" href="01__Utilize__Thyra_8cpp.html">Utilize Thyra</a> tutorial. This is similar to performing a diff between <a class="el" href="00__Basic__Problem_8cpp.html">00_Basic_Problem.cpp</a> and <a class="el" href="01__Utilize__Thyra_8cpp.html">01_Utilize_Thyra.cpp</a>, but the first column provides comments related to the changes. You may want to to do a diff (e.g., vimdiff or tkdiff) to see these changes within main (e.g., vimdiff <a class="el" href="00__Basic__Problem_8cpp.html">00_Basic_Problem/00_Basic_Problem.cpp</a> <a class="el" href="01__Utilize__Thyra_8cpp.html">01_Utilize_Thyra/01_Utilize_Thyra.cpp</a>).</p>
<table class="doxtable">
<tr>
<th>Comments </th><th>Original "Basic Problem" Code Snippet </th><th>Replacement "Utilize Thyra" Code Snippet </th></tr>
<tr valign="top">
<td><b>Setup <a class="el" href="namespaceThyra.html">Thyra</a> vectors.</b> We first need to replace the C++ double arrays with a vector space to construct the Thyra::Vector. We additionally have introduced the use of <a class="el" href="namespaceTeuchos.html">Teuchos</a> Reference-Counted Pointers (<a class="el" href="namespaceTeuchos.html">Teuchos</a>:RCP), which are Trilinos's smart pointers. Details on RCP can be found at <a href="https://www.osti.gov/servlets/purl/919177">https://www.osti.gov/servlets/purl/919177</a>. </td><td><div class="fragment"><div class="line"><span class="comment">// Solution and its time-derivative.</span></div>
<div class="line"><span class="keywordtype">double</span> x_n[2];      <span class="comment">// at time index n</span></div>
<div class="line"><span class="keywordtype">double</span> xDot_n[2];   <span class="comment">// at time index n</span></div>
</div><!-- fragment --> </td><td><div class="fragment"><div class="line"><span class="comment">// Solution and its time-derivative.</span></div>
<div class="line"><span class="keywordtype">int</span> vectorLength = 2;  <span class="comment">// number state unknowns</span></div>
<div class="line">RCP&lt;const Thyra::VectorSpaceBase&lt;double&gt; &gt;  xSpace =</div>
<div class="line">  Thyra::defaultSpmdVectorSpace&lt;double&gt;(vectorLength);</div>
<div class="line"> </div>
<div class="line">RCP&lt;Thyra::VectorBase&lt;double&gt; &gt; x_n    = Thyra::createMember(xSpace);</div>
<div class="line">RCP&lt;Thyra::VectorBase&lt;double&gt; &gt; xDot_n = Thyra::createMember(xSpace);</div>
</div><!-- fragment --> </td></tr>
<tr valign="top">
<td><b>Initialize <a class="el" href="namespaceThyra.html">Thyra</a> vectors.</b> The initialization can be achieved with the Thyra::DetachedVectorView's. The scoping ensures they are deleted after use. </td><td><div class="fragment"><div class="line"><span class="comment">// Initial Conditions</span></div>
<div class="line"><span class="keywordtype">double</span> time = 0.0;</div>
<div class="line"><span class="keywordtype">double</span> epsilon = 1.0e-1;</div>
<div class="line">x_n   [0] = 2.0;</div>
<div class="line">x_n   [1] = 0.0;</div>
<div class="line">xDot_n[0] = 0.0;</div>
<div class="line">xDot_n[1] = -2.0/epsilon;</div>
</div><!-- fragment --> </td><td><div class="fragment"><div class="line"><span class="comment">// Initial Conditions</span></div>
<div class="line"><span class="keywordtype">double</span> time = 0.0;</div>
<div class="line"><span class="keywordtype">double</span> epsilon = 1.0e-1;</div>
<div class="line">{ <span class="comment">// Scope to delete DetachedVectorViews</span></div>
<div class="line">  Thyra::DetachedVectorView&lt;double&gt; x_n_view(*x_n);</div>
<div class="line">  x_n_view[0] = 2.0;</div>
<div class="line">  x_n_view[1] = 0.0;</div>
<div class="line">  Thyra::DetachedVectorView&lt;double&gt; xDot_n_view(*xDot_n);</div>
<div class="line">  xDot_n_view[0] = 0.0;</div>
<div class="line">  xDot_n_view[1] = -2.0/epsilon;</div>
<div class="line">}</div>
</div><!-- fragment --> </td></tr>
<tr valign="top">
<td><b>Access <a class="el" href="namespaceThyra.html">Thyra</a> vectors.</b> Elements of the Thyra::Vector can be quickly accessed with get_ele. </td><td><div class="fragment"><div class="line">cout &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; x_n[0] &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; x_n[1] &lt;&lt; endl;</div>
</div><!-- fragment --> </td><td><div class="fragment"><div class="line">cout &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; get_ele(*(x_n), 0)</div>
<div class="line">                          &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; get_ele(*(x_n), 1) &lt;&lt; endl;</div>
</div><!-- fragment --> </td></tr>
<tr valign="top">
<td><b>Clone <a class="el" href="namespaceThyra.html">Thyra</a> vectors.</b> To initialize the solution at the next time step, we can simply clone the current timestep. </td><td><div class="fragment"><div class="line"><span class="comment">// Initialize next time step</span></div>
<div class="line"><span class="keywordtype">double</span> x_np1[2];    <span class="comment">// at time index n+1</span></div>
<div class="line">x_np1[0] = x_n[0];</div>
<div class="line">x_np1[1] = x_n[1];</div>
</div><!-- fragment --> </td><td><div class="fragment"><div class="line"><span class="comment">// Initialize next time step</span></div>
<div class="line">RCP&lt;Thyra::VectorBase&lt;double&gt; &gt; x_np1 = x_n-&gt;clone_v(); <span class="comment">// at time index n+1</span></div>
</div><!-- fragment --> </td></tr>
<tr valign="top">
<td><b>Accessing elements of <a class="el" href="namespaceThyra.html">Thyra</a> vectors.</b> The model evaluation is achieved through Thyra::DetachedVectorView. </td><td><div class="fragment"><div class="line"><span class="comment">// Righthand side evaluation and time-derivative at n.</span></div>
<div class="line">xDot_n[0] = x_n[1];</div>
<div class="line">xDot_n[1] = ((1.0 - x_n[0]*x_n[0])*x_n[1] - x_n[0])/epsilon;</div>
</div><!-- fragment --> </td><td><div class="fragment"><div class="line"><span class="comment">// Righthand side evaluation and time-derivative at n.</span></div>
<div class="line">{</div>
<div class="line">  Thyra::ConstDetachedVectorView&lt;double&gt; x_n_view(*x_n);</div>
<div class="line">  Thyra::DetachedVectorView&lt;double&gt; xDot_n_view(*xDot_n);</div>
<div class="line">  xDot_n_view[0] = x_n_view[1];</div>
<div class="line">  xDot_n_view[1] =</div>
<div class="line">    ((1.0-x_n_view[0]*x_n_view[0])*x_n_view[1]-x_n_view[0])/epsilon;</div>
<div class="line">}</div>
</div><!-- fragment --> </td></tr>
<tr valign="top">
<td><b>Compute with <a class="el" href="namespaceThyra.html">Thyra</a> vectors.</b> The Forward Euler time stepping is achieved by using Thyra::V_VpStV, which performs an axpy. </td><td><div class="fragment"><div class="line"><span class="comment">// Take the timestep - Forward Euler</span></div>
<div class="line">x_np1[0] = x_n[0] + dt*xDot_n[0];</div>
<div class="line">x_np1[1] = x_n[1] + dt*xDot_n[1];</div>
</div><!-- fragment --> </td><td><div class="fragment"><div class="line"><span class="comment">// Take the timestep - Forward Euler</span></div>
<div class="line">Thyra::V_VpStV(x_np1.ptr(), *x_n, dt, *xDot_n);</div>
</div><!-- fragment --> </td></tr>
<tr valign="top">
<td><b>Other <a class="el" href="namespaceThyra.html">Thyra</a> vector utilities.</b> We can also take advantage other <a class="el" href="namespaceThyra.html">Thyra</a> features, Thyra::norm, to check if the solution has passed. </td><td><div class="fragment"><div class="line"><span class="comment">// Test if solution has passed.</span></div>
<div class="line"><span class="keywordflow">if</span> ( std::isnan(x_n[0]) || std::isnan(x_n[1]) ) {</div>
</div><!-- fragment --> </td><td><div class="fragment"><div class="line"><span class="comment">// Test if solution has passed.</span></div>
<div class="line"><span class="keywordflow">if</span> ( std::isnan(Thyra::norm(*x_np1) ) {</div>
</div><!-- fragment --> </td></tr>
<tr valign="top">
<td><b>Use <a class="el" href="namespaceThyra.html">Thyra</a> vector assignment.</b> The solution update is achieved via Thyra::V_V. </td><td><div class="fragment"><div class="line"><span class="comment">// Promote to next step (n &lt;- n+1).</span></div>
<div class="line">x_n[0] = x_np1[0];</div>
<div class="line">x_n[1] = x_np1[1];</div>
<div class="line">n++;</div>
</div><!-- fragment --> </td><td><div class="fragment"><div class="line"><span class="comment">// Promote to next step (n &lt;- n+1).</span></div>
<div class="line">Thyra::V_V(x_n.ptr(), *x_np1);</div>
<div class="line">n++;</div>
</div><!-- fragment --> </td></tr>
</table>
<p>The remainder of <a class="el" href="01__Utilize__Thyra_8cpp.html">01_Utilize_Thyra.cpp</a> (e.g., regression testing) has similar changes to those from above.</p>
<h2><a class="anchor" id="example-01_Next"></a>
Links</h2>
<ul>
<li>Back to: <a class="el" href="index.html#tutorials">Tutorials</a></li>
<li>Previous: <a class="el" href="00__Basic__Problem_8cpp.html#example-00">Example 0: Basic Problem</a></li>
<li>Next: <a class="el" href="02__Use__ModelEvaluator_8cpp.html#example-02">Example 2: Use ModelEvaluator</a> </li>
</ul>

<p class="definition">Definition at line <a class="el" href="01__Utilize__Thyra_8cpp_source.html#l00214">214</a> of file <a class="el" href="01__Utilize__Thyra_8cpp_source.html">01_Utilize_Thyra.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 9 2025 20:59:10 for Tempus by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
