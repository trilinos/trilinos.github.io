<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tempus: 00_Basic_Problem.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tempus<span id="projectnumber">&#160;Version of the Day</span>
   </div>
   <div id="projectbrief">Time Integration</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d28a4824dc47e487b107a5db32ef43c4.html">examples</a></li><li class="navelem"><a class="el" href="dir_d6fe60ffa4b7d18452c9c732b0acdd2c.html">00_Basic_Problem</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">00_Basic_Problem.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;iomanip&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;Teuchos_StandardCatchMacros.hpp&quot;</code><br />
</div>
<p><a href="00__Basic__Problem_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97" id="r_a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="00__Basic__Problem_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="memdesc:a0ddf1224851353fc92bfbff6f499fa97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Description:  <br /></td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0ddf1224851353fc92bfbff6f499fa97" name="a0ddf1224851353fc92bfbff6f499fa97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddf1224851353fc92bfbff6f499fa97">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Description: </p>
<h1><a class="anchor" id="example-00"></a>
Example 0: Basic Problem</h1>
<p>This problem is an example of a typical application code before utilizing <a class="el" href="namespaceTempus.html">Tempus</a>, thus it has no <a class="el" href="namespaceTempus.html">Tempus</a> or other Trilinos functionality at this point. It is the starting point to help illustrate the various stages an application can do to take advantage of <a class="el" href="namespaceTempus.html">Tempus</a>'s capabilities (additionally see the other <a class="el" href="namespaceTempus.html">Tempus</a> examples).</p>
<p>We have kept the problem itself fairly simple, Van Der Pol problem, with a simple time stepper, Forward Euler, to allow us to focus on the time integration structure and <a class="el" href="namespaceTempus.html">Tempus</a> features as we add them. With this, the implementation is not the most compact or efficient for this simple problem and stepper, but it does have features one would want in a more capable time integrator.</p>
<h2><a class="anchor" id="vanderpol"></a>
van der Pol Problem</h2>
<p>van der Pol problem is a nonlinear electrical circuit, and is a canonical equation of a nonlinear oscillator (Hairer, Norsett, and Wanner, pp. 111-115, and Hairer and Wanner, pp. 4-5) for an electrical circuit. The explicit ODE form, <picture><source srcset="form_452_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \dot{x} = f(x,t)$" src="form_452.png" width="59" height="14"/></picture>, of the scaled problem is  </p><p class="formulaDsp">
<picture><source srcset="form_453_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{eqnarray*}
  \dot{x}_0(t) &amp; = &amp; f_0 = x_1(t) \\
  \dot{x}_1(t) &amp; = &amp; f_1 = [(1-x_0^2)x_1-x_0]/\epsilon
\end{eqnarray*}" src="form_453.png" width="194" height="33"/></picture>
</p>
<p> where the initial conditions are  </p><p class="formulaDsp">
<picture><source srcset="form_401_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{eqnarray*}
  x_0(t_0=0) &amp; = &amp; 2 \\
  x_1(t_0=0) &amp; = &amp; 0
\end{eqnarray*}" src="form_401.png" width="96" height="33"/></picture>
</p>
<p> and the initial time derivatives are  </p><p class="formulaDsp">
<picture><source srcset="form_402_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{eqnarray*}
  \dot{x}_0(t_0=0) &amp; = &amp; x_1(t_0=0) = 0 \\
  \dot{x}_1(t_0=0) &amp; = &amp; [(1-x_0^2)x_1-x_0]/\epsilon = -2/\epsilon
\end{eqnarray*}" src="form_402.png" width="236" height="33"/></picture>
</p>
<h1><a class="anchor" id="basicCodeStructure"></a>
Basic Code Structure</h1>
<p>We will review this program's code structure, <a class="el" href="00__Basic__Problem_8cpp.html">00_Basic_Problem.cpp</a>, and go over its basic details.</p>
<table class="doxtable">
<tr>
<th>Comments </th><th>"Basic Problem" Code Snippet </th></tr>
<tr valign="top">
<td><b>Solution Declaration.</b> One of the first things an application does is to define the solution. </td><td><div class="fragment"><div class="line"><span class="comment">// Solution and its time-derivative.</span></div>
<div class="line"><span class="keywordtype">double</span> x_n[2];      <span class="comment">// at time index n</span></div>
<div class="line"><span class="keywordtype">double</span> xDot_n[2];   <span class="comment">// at time index n</span></div>
</div><!-- fragment --> </td></tr>
<tr valign="top">
<td><b>Initial Conditions.</b> Here we are using an array of two doubles for the solution and its time derivative, and set their initial values (see <a class="el" href="00__Basic__Problem_8cpp.html#vanderpol">van der Pol Problem</a>). Note that xDot_n is the time derivative, <picture><source srcset="form_454_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \dot{x} $" src="form_454.png" width="8" height="9"/></picture>, but is also the right-hand side evaluation, <picture><source srcset="form_455_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ f(x,t) $" src="form_455.png" width="34" height="14"/></picture>. </td><td><div class="fragment"><div class="line"><span class="comment">// Initial Conditions</span></div>
<div class="line"><span class="keywordtype">int</span> n = 0;</div>
<div class="line"><span class="keywordtype">double</span> time = 0.0;</div>
<div class="line"><span class="keywordtype">bool</span> passed = <span class="keyword">true</span>;   <span class="comment">// ICs are considered passed.</span></div>
<div class="line"><span class="keywordtype">double</span> epsilon = 1.0e-1;</div>
<div class="line">x_n   [0] = 2.0;</div>
<div class="line">x_n   [1] = 0.0;</div>
<div class="line">xDot_n[0] = 0.0;</div>
<div class="line">xDot_n[1] = -2.0/epsilon;</div>
</div><!-- fragment --> </td></tr>
<tr valign="top">
<td><b>Timestep Parameters.</b> The next piece of code sets parameters associated with time-integration, e.g., length of time integration, number of timesteps and the timestep size. </td><td><div class="fragment"><div class="line"><span class="comment">// Timestep size</span></div>
<div class="line"><span class="keywordtype">double</span> finalTime = 2.0;</div>
<div class="line"><span class="keywordtype">int</span> nTimeSteps = 2001;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">double</span> constDT = finalTime/(nTimeSteps-1);</div>
</div><!-- fragment --> </td></tr>
<tr valign="top">
<td><b>Time-Integration Loop.</b> The time-integration loop simply advances the solution until the solution is not "passed", the time has reached the final time, or the number timesteps is reached. </td><td><div class="fragment"><div class="line"><span class="comment">// Advance the solution to the next timestep.</span></div>
<div class="line">cout &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; x_n[0] &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; x_n[1] &lt;&lt; endl;</div>
<div class="line"><span class="keywordflow">while</span> (passed &amp;&amp; time &lt; finalTime &amp;&amp; n &lt; nTimeSteps) {</div>
<div class="line"> </div>
<div class="line">  ...</div>
<div class="line"> </div>
<div class="line">}</div>
</div><!-- fragment --> </td></tr>
<tr valign="top">
<td><b> Initialize the Next Timestep.</b> Within the time loop, we initialize the next timestep, <picture><source srcset="form_456_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ x^{n+1} $" src="form_456.png" width="26" height="11"/></picture>, to the previous timestep, <picture><source srcset="form_457_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ x^n $" src="form_457.png" width="14" height="9"/></picture>. Although this is not needed in this simple case, if one wants to recover from a failed timestep, the previous timestep, <picture><source srcset="form_457_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ x^n $" src="form_457.png" width="14" height="9"/></picture>, needs to be perserved until the next timestep is accepted. </td><td><div class="fragment"><div class="line"><span class="comment">// Initialize next time step</span></div>
<div class="line"><span class="keywordtype">double</span> x_np1[2];    <span class="comment">// at time index n+1</span></div>
<div class="line">x_np1[0] = x_n[0];</div>
<div class="line">x_np1[1] = x_n[1];</div>
</div><!-- fragment --> </td></tr>
<tr valign="top">
<td><b>Set the Timestep and Time.</b> Although this a constant timestep example, for variable timestepping, the timestep size needs to be determined and the related time for the next timestep set. </td><td><div class="fragment"><div class="line"><span class="comment">// Set the timestep and time.</span></div>
<div class="line"><span class="keywordtype">double</span> dt = constDT;</div>
<div class="line">time = (n+1)*dt;</div>
</div><!-- fragment --> </td></tr>
<tr valign="top">
<td><b>Evaluate Righthand Side Function.</b> This is a simple evaluation of the van der Pol problem and setting it to <picture><source srcset="form_454_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \dot{x} $" src="form_454.png" width="8" height="9"/></picture>. </td><td><div class="fragment"><div class="line"><span class="comment">// Righthand side evaluation and time-derivative at n.</span></div>
<div class="line">xDot_n[0] = x_n[1];</div>
<div class="line">xDot_n[1] = ((1.0 - x_n[0]*x_n[0])*x_n[1] - x_n[0])/epsilon;</div>
</div><!-- fragment --> </td></tr>
<tr valign="top">
<td><b>Take the Timestep.</b> For Forward Euler, the timestep is a simple daxpy. </td><td><div class="fragment"><div class="line"><span class="comment">// Take the timestep - Forward Euler</span></div>
<div class="line">x_np1[0] = x_n[0] + dt*xDot_n[0];</div>
<div class="line">x_np1[1] = x_n[1] + dt*xDot_n[1];</div>
</div><!-- fragment --> </td></tr>
<tr valign="top">
<td><b>Test If Solution is Passing.</b> Here we have a simple test if the solution has passed, i.e., the solution does not have a NAN. Otherwise "promote" the solution to the next timestep and increment the timestep index. </td><td><div class="fragment"><div class="line"><span class="comment">// Test if solution has passed.</span></div>
<div class="line"><span class="keywordflow">if</span> ( std::isnan(x_n[0]) || std::isnan(x_n[1]) ) {</div>
<div class="line">  passed = <span class="keyword">false</span>;</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">  <span class="comment">// Promote to next step (n -&gt; n+1).</span></div>
<div class="line">  x_n[0] = x_np1[0];</div>
<div class="line">  x_n[1] = x_np1[1];</div>
<div class="line">  n++;</div>
<div class="line">}</div>
</div><!-- fragment --> </td></tr>
<tr valign="top">
<td><b>Output Solution.</b> Of course, we would like to know that progress of the solution during the simulation. </td><td><div class="fragment"><div class="line"><span class="comment">// Output</span></div>
<div class="line"><span class="keywordflow">if</span> ( n%100 == 0 )</div>
<div class="line">  cout &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; x_n[0] &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; x_n[1] &lt;&lt; endl;</div>
</div><!-- fragment --> </td></tr>
</table>
<p><b>Following the Time-Integration Loop.</b> Following the time loop is some basic regression testing, but serves to show tasks that one may want to complete after completion of time integration.</p>
<h1><a class="anchor" id="example-00-summary"></a>
Example 0: Basic Problem Summary</h1>
<p>So this outlines the basic time integration of the van der Pol problem with a few features. We will use this example and introduce <a class="el" href="namespaceTempus.html">Tempus</a> and Trilinos capabilities in the following examples.</p>
<h2><a class="anchor" id="example-00_Next"></a>
Links</h2>
<ul>
<li>Back to: <a class="el" href="index.html#tutorials">Tutorials</a></li>
<li>Next: <a class="el" href="01__Utilize__Thyra_8cpp.html#example-01">Example 1: Utilize Thyra</a> </li>
</ul>

<p class="definition">Definition at line <a class="el" href="00__Basic__Problem_8cpp_source.html#l00217">217</a> of file <a class="el" href="00__Basic__Problem_8cpp_source.html">00_Basic_Problem.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 9 2025 20:59:10 for Tempus by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
