<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Intrepid2: Intrepid2 basis class</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Intrepid2
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Intrepid2 basis class</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="basis_dof_tag_ord_sec"></a>
Degree of freedom ordinals and tags</h1>
<p>Regardless of the basis type, i.e., FEM or FVD, each DoF is assigned an ordinal number which specifies its numerical position in the DoF set, and a 4-field DoF tag whose first 3 fields establish association between the DoF and a subcell of particular dimension. The last field in the DoF tag is for convenience and stores the total number of DoFs associated with the specified subcell. In summary, the tag contains the following information about a DoF with a given ordinal:</p>
<ul>
<li>field 0: dimension of the subcell associated with the specified DoF ordinal; </li>
<li>field 1: ordinal of the subcell relative to its parent cell; </li>
<li>field 2: ordinal of the DoF relative to the subcell; </li>
<li>field 3: cardinality of the DoF set associated with this subcell.</li>
</ul>
<p>DoF definition, DoF ordinals and DoF tags are basis-dependent and are documemented in the concrete basis implementation. A typical entry in a DoF tag table has the following format: </p><pre class="fragment">|-------------------------------------------------------------------------------------------------|
|         |           degree-of-freedom-tag table                    |                            |
|   DoF   |----------------------------------------------------------|      DoF definition        |
| ordinal |  subc dim    | subc ordinal | subc DoF ord |subc num DoF |                            |
|-------------------------------------------------------------------------------------------------|
|---------|--------------|--------------|--------------|-------------|----------------------------|
|    k    |       1      |       2      |       1      |      3      |   L_k(u) = (definition)    |
|---------|--------------|--------------|--------------|-------------|----------------------------|
|-------------------------------------------------------------------------------------------------|
</pre><p>The tag in this example establishes an association between the DoF with ordinal <em>k</em> and the 3rd edge of the parent cell on which the basis is defined. Furthermore, the tag specifies that relative to that edge, this DoF has ordinal 1, i.e., it is the second DoF on that edge. The last field in the tag indicates that there are a total of 3 DoFs associated with that subcell.</p>
<h1><a class="anchor" id="basis_md_array_sec"></a>
MD array template arguments for basis methods</h1>
<p>FEM and FVD basis evaluation methods in Intrepid2 use <a href="https://github.com/kokkos/">Kokkos</a> dynamic rank views as the default MD arrays to pass the evaluation points (and cell vertices for FVD evaluation) and to return the basis values. The ranks and the dimensions of the MD array arguments for these methods are as follows.</p>
<h2><a class="anchor" id="basis_md_array_out_sec"></a>
Rank and dimensions of the output MD array</h2>
<p>Rank and dimensions of the output array depend on the field rank of the basis functions, which can be 0 (scalar fields), 1 (vector fields), or 2 (tensor fields), the space dimension, and the <em>operatorType</em>. The following table summarizes all admissible combinations: </p><pre class="fragment">|-------------------------------------------------------------------------------------------------|
|            Rank and multi-dimensions of the output MD array in getValues methods                |
|--------------------|-------------------------|-------------------------|------------------------|
|operator/field rank |  rank 0                 |  rank 1 2D/3D           |  rank 2 2D/3D          |
|--------------------|-------------------------|-------------------------|------------------------|
|       VALUE        |  (F,P)                  | (F,P,D)                 | (F,P,D,D)              |
|--------------------|-------------------------|-------------------------|------------------------|
|     GRAD, D1       |  (F,P,D)                | (F,P,D,D)               | (F,P,D,D,D)            |
|--------------------|-------------------------|-------------------------|------------------------|
|        CURL        |  (F,P,D) (undef. in 3D) | (F,P)/(F,P,D)           | (F,P,D)/(F,P,D,D)      |
|--------------------|-------------------------|-------------------------|------------------------|
|        DIV         |  (F,P,D) (only in 1D)   | (F,P)                   | (F,P,D)                |
|--------------------|-------------------------|-------------------------|------------------------|
|    D1,D2,..,D10    |  (F,P,K)                | (F,P,D,K)               | (F,P,D,D,K)            |
|-------------------------------------------------------------------------------------------------|
</pre><dl class="section remark"><dt>Remarks</dt><dd><ul>
<li>The totality of all derivatives whose order equals k (OPERATOR_Dk in Intrepid) forms a multiset; see <a href="http://mathworld.wolfram.com/Multiset.html">http://mathworld.wolfram.com/Multiset.html</a> In Intrepid this multiset is enumerated using the lexicographical order of the partial derivatives; see getDkEnumeration() for details.</li>
</ul>
<ul>
<li>The last dimension of the output array for D1,...,D10 is the cardinality of the Dk multiset (computed by DkCardinality). The array is filled with zeroes whenever the order of the derivative Dk exceeed the polynomial degree.</li>
</ul>
</dd></dl>
<h2><a class="anchor" id="basis_md_array_in_sec"></a>
Rank and dimensions of the input MD arrays</h2>
<p>The FEM evaluation method has one MD array input argument which is used to pass the coordinates of P evaluation points in the reference cell for which the concrete basis is defined. The FVD method has two MD array input arguments. The first one passes the coordinates of P evaluation points in the physical cell for which the concrete basis is defined. The second MD array passes the vertices of the physical cell. Ranks and dimensions of these arrays are summarized in the following table: </p><pre class="fragment">|-------------------------------------------------------------------------------------------------|
|             Rank and multi-dimensions of the input MD arrays in getValues methods               |
|--------------------|------------------------|---------------------------------------------------|
| MD array           | rank | multi-dimension |  Description                                      |
|--------------------|------------------------|---------------------------------------------------|
| evaluation points  |   2  |  (P,D)          |  Coordinates of P points in D-dimensions          |
|--------------------|------------------------|---------------------------------------------------|
| cell vertices      |   2  |  (V,D)          |  Coordinates of V vertices of D-dimensional cell  |
|-------------------------------------------------------------------------------------------------|
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
