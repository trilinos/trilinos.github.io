<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Intrepid2: Cell tools</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Intrepid2
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Cell tools</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>Table of contents </b></p>
<ul>
<li><a class="el" href="cell_tools_page.html#cell_topology_sec">Cell topologies</a></li>
<li><a class="el" href="cell_tools_page.html#cell_topology_ref_cells">Reference cells</a><ul>
<li><a class="el" href="cell_tools_page.html#sec_cell_topology_ref_map">Reference-to-physical cell mapping</a></li>
<li><a class="el" href="cell_tools_page.html#sec_cell_topology_ref_map_DF">Jacobian of the reference-to-physical cell mapping</a></li>
<li><a class="el" href="cell_tools_page.html#sec_cell_topology_subcell_map">Parametrization of physical 1- and 2-subcells</a></li>
<li><a class="el" href="cell_tools_page.html#sec_cell_topology_subcell_wset">Subcell worksets</a></li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="cell_topology_sec"></a>
Cell topologies</h1>
<p>The range of admissible cell shapes in Intrepid is restricted to <em>d</em>-dimensional <b>polytopes</b>, <em>d=1,2,3</em>. A polytope is defined by a set of its vertices <picture><source srcset="form_79_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \{ {\bf v}_0,\ldots {\bf v}_V\} $" src="form_79.png" width="64" height="14"/></picture> and a <b>base topology</b> <em>BT</em> that defines how these verices are connected into <em>k</em>-dimensional, <em>k &lt; d</em> facets (k-subcells) of that polytope. <br  />
</p>
<p>The base topology of any polytope can be extended by augmenting the set of its vertices by an additional set of points <picture><source srcset="form_80_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\{ {\bf p}_0,\ldots {\bf p}_P\} $" src="form_80.png" width="64" height="14"/></picture>. The <b>extended topology</b> <em>ET</em> is defined by specifying the connectivity of the set <picture><source srcset="form_81_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \{ {\bf v}_0,\ldots {\bf v}_V\}\cup \{ {\bf p}_0,\ldots {\bf p}_P\} $" src="form_81.png" width="141" height="14"/></picture> relative to the subcells specified by its base topology <em>BT</em>. The vertices and the extra points are collectively referred to as <b>nodes</b>. Thus, a polytope with <b>extended topology</b> <em>ET</em> is defined by a set of nodes <picture><source srcset="form_82_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\{{\bf q}_0,\ldots,{\bf q}_N\}$" src="form_82.png" width="70" height="14"/></picture>, where <picture><source srcset="form_83_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$N = V + P$" src="form_83.png" width="63" height="11"/></picture>, and a connectivity rule for these nodes.</p>
<p>Intrepid requires any cell to have a valid base topology. The nodes of the cell should always be ordered by listing its vertices <b>first</b>, i.e.,  </p><p class="formulaDsp">
<picture><source srcset="form_84_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[ 
  \{{\bf q}_0,\ldots,{\bf q}_N\} = \{ {\bf v}_0,\ldots {\bf v}_V,{\bf p}_0,\ldots {\bf p}_P\} 
  \]" src="form_84.png" width="208" height="14"/></picture>
</p>
<p> To manage cell topologies Intrepid uses the Shards package <a href="http://trilinos.org/packages/shards">http://trilinos.org/packages/shards</a> . Shards provides definitions for a standard set of base and extended cell topologies plus tools to construct custom, user defined cell topologies, such as arbitrary polyhedral cells. For further details see Shards documentation.</p>
<h1><a class="anchor" id="cell_topology_ref_cells"></a>
Reference cells</h1>
<p>For some cell topologies there exist simple, e.g., polynomial, mappings that allow to obtain any cell having that topology as an image of a single "standard" cell. We refer to such standard cells as <b>reference</b> cells.</p>
<p>Just like in the general case, a reference cell with a base topology <em>BT</em> is defined by a set of vertices, and a reference cell with extended topology <em>ET</em> is defined by a set of nodes that include the original vertices and some additional points.</p>
<p>The actual vertex and node coordinates for the reference cells can be chosen arbitrarily; however, once selected they should not be changed because in many cases, e.g., in finite element reconstructions, all calculations are done on a reference cell and then transformed to physical cells by an appropriate pullback (see Section <a class="el" href="function_space_tools_page.html#sec_pullbacks">Pullbacks</a>).</p>
<p>In Intrepid base and extended reference cell topologies are defined using the following selections of vertex and node coordinates:</p>
<pre class="fragment">|=======================|==============================================================================|
| Topology family       |    reference cell vertices/additional nodes defining extended topology       |
|=======================|==============================================================================|
| Line&lt;2&gt;               |                                                                              |
| Beam&lt;2&gt;               | {(-1,0,0),(1,0,0)}                                                           |
| ShellLine&lt;2&gt;          |                                                                              |
|-----------------------|------------------------------------------------------------------------------|
| Line&lt;3&gt;               |                                                                              |
| Beam&lt;3&gt;               | {(0,0,0)}                                                                    |
| ShellLine&lt;3&gt;          |                                                                              |
|=======================|==============================================================================|
| Triangle&lt;3&gt;           | {(0,0,0),(1,0,0),(0,1,0)}                                                    |
| ShellTriangle&lt;3&gt;      |                                                                              |
|-----------------------|------------------------------------------------------------------------------|
| Triangle&lt;4&gt;           | {(1/3,1/3,0)}                                                                |
|.......................|..............................................................................|
| Triangle&lt;6&gt;           | {(1/2,0,0),(1/2,1/2,0),(0,1/2,0)}                                            |
| ShellTriangle&lt;6&gt;      |                                                                              |
|=======================|==============================================================================|
| Quadrilateral&lt;4&gt;      | {(-1,-1,0),(1,-1,0), (1,1,0),(-1,1,0)}                                       |
| ShellQuadrilateral&lt;4&gt; |                                                                              |
|-----------------------|------------------------------------------------------------------------------|
| Quadrilateral&lt;8&gt;      | {(0,-1,0),(1,0,0),(0,1,0),(-1,0,0)}                                          |
| ShellQuadrilateral&lt;8&gt; |                                                                              |
|.......................|..............................................................................|
| Quadrilateral&lt;9&gt;      | {(0,-1,0),(1,0,0),(0,1,0),(-1,0,0),(0,0,0)}                                  |
| ShellQuadrilateral&lt;9&gt; |                                                                              |
|=======================|==============================================================================|
| Tetrahedron&lt;4&gt;        | {(0,0,0),(1,0,0),(0,1,0),(0,0,1)}                                            |
|-----------------------|------------------------------------------------------------------------------|
| Tetrahedron&lt;8&gt;        | {(1/2,0,0),(1/2,1/2,0),(0,1/2,0),(1/3,1/3,1/3)}                              |
| Tetrahedron&lt;10&gt;       | {(1/2,0,0),(1/2,1/2,0),(0,1/2,0),(0,0,1/2),(1/2,0,1/2),(0,1/2,1/2)}          |
|=======================|==============================================================================|
| Pyramid&lt;5&gt;            | {(-1,-1,0),(1,-1,0),(1,1,0),(-1,1,0),(0,0,1)}                                |
|-----------------------|------------------------------------------------------------------------------|
| Pyramid&lt;13&gt;           | {(0,-1,0),(1,0,0),(0,1,0),(-1,0,0), 1/2((-1,-1,1),(1,-1,1),(1,1,1),(-1,1,1))}|
| Pyramid&lt;14&gt;           | all of the above and (0,0,0)                                                 |
|=======================|==============================================================================|
| Wedge&lt;6&gt;              | {(0,0,-1),(1,0,-1),(0,1,-1),(0,0,1),(1,0,1),(0,1,1)}                         |
|-----------------------|------------------------------------------------------------------------------|
| Wedge&lt;15&gt;             | {(1/2,0,-1),(1/2,1/2,-1),(0,1/2,-1), (0,0,0),(1,0,0),(0,1,0),                |  
|                       |  (1/2,0, 1),(1/2,1/2, 1),(0,1/2, 1)                                          |
|.......................|..............................................................................|
| Wedge&lt;18&gt;             | All of the above plus {(1/2,0,0),(1/2,1/2,0),(0,1/2,0)}                      |
|=======================|==============================================================================|
| Hexahedron&lt;8&gt;         | {(-1,-1,-1),(1,-1,-1),(1,1,-1),(-1,1,-1),(-1,-1,1),(1,-1,1),(1,1,1),(-1,1,1)}|
|-----------------------|------------------------------------------------------------------------------|
| Hexahedron&lt;20&gt;        | {(0,-1,-1),(1,0,-1),(0,1,-1),(-1,0,-1), (0,-1,0),(1,0,0),(0,1,0),(-1,0,0),   |
|                       |  (0,-1, 1),(1,0, 1),(0,1, 1),(-1,0, 1) }                                     |
|.......................|..............................................................................|
| Hexahedron&lt;27&gt;        | All of the above plus center point and face midpoints:                       |
|                       | {(0,0,0), (0,0,-1),(0,0,1), (-1,0,0),(1,0,0), (0,-1,0),(0,1,0)}              |
|=======================|==============================================================================|
</pre><p>Finite element reconstruction methods based on pullbacks (see Section <a class="el" href="function_space_tools_page.html#sec_pullbacks">Pullbacks</a>) are restricted to the above cell topologies. <br  />
</p>
<h2><a class="anchor" id="sec_cell_topology_ref_map"></a>
Reference-to-physical cell mapping</h2>
<p>The mapping that takes a given reference cell to a physical cell with the same topology is defined using a nodal Lagrangian basis corresponding to the nodes of the reference cell. In other words, the mapping is constructed using basis functions that are dual to the nodes of the reference cell. Implementation details are as follows.</p>
<p>Assume that <picture><source srcset="form_85_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \hat{\mathcal{C}} $" src="form_85.png" width="9" height="14"/></picture> is a reference cell with topology <em>T</em> and nodes <picture><source srcset="form_86_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\{\hat{{\bf q}}_0,\ldots,\hat{{\bf q}}_{N}\}$" src="form_86.png" width="70" height="14"/></picture>, and that <picture><source srcset="form_87_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \{\hat{\phi}_i\}_{i=0}^{N} $" src="form_87.png" width="40" height="16"/></picture> is the Lagrangian basis dual to these nodes, i.e., <picture><source srcset="form_88_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \hat{\phi}_i( \hat{{\bf q}}_j)=\delta_{ij} $" src="form_88.png" width="64" height="16"/></picture>. A physical cell <picture><source srcset="form_89_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\mathcal{C}$" src="form_89.png" width="9" height="11"/></picture> with the same topology <em>T</em> as <picture><source srcset="form_90_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\hat{\mathcal{C}}$" src="form_90.png" width="9" height="14"/></picture> is <br  />
 then defined as the image of <picture><source srcset="form_85_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \hat{\mathcal{C}} $" src="form_85.png" width="9" height="14"/></picture> under the mapping  </p><p class="formulaDsp">
<picture><source srcset="form_91_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[               
  F_\mathcal{C}(\hat{\bf x}) = \sum_{m=0}^{N}  {\bf q}_m(\mathcal{C})  \hat{\phi}_m(\hat{\bf x})          
\]" src="form_91.png" width="140" height="38"/></picture>
</p>
<p> where <picture><source srcset="form_92_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\{{\bf q}_0(\mathcal{C}),\ldots,{\bf q}_N(\mathcal{C})\}$" src="form_92.png" width="104" height="14"/></picture> is the set of <b>physical nodes</b> that defines <picture><source srcset="form_89_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\mathcal{C}$" src="form_89.png" width="9" height="11"/></picture>. The number of physical nodes is required to match the number of reference <br  />
 nodes in the specified cell topology <em>T</em>. The <em>i</em>-th coordinate function of the reference-to-physical mapping is given by  </p><p class="formulaDsp">
<picture><source srcset="form_93_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[        
  \big(F_{\mathcal{C}}(\hat{\bf x})\big)_i = 
              \sum_{m=0}^{N}  \big({\bf q}_m(\mathcal{C})\big)_i\hat{\phi}_m(\hat{\bf x})           
\]" src="form_93.png" width="170" height="38"/></picture>
</p>
<p> where <picture><source srcset="form_94_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \big({\bf q}_m(\mathcal{C})\big)_i $" src="form_94.png" width="48" height="16"/></picture> is the <em>i</em>-th spatial coordinate of the <em>m</em>-th node.</p>
<p>For simplicity, unless there's a chance for confusion, the cell symbol will be ommitted from the designations of physical points and reference-to-physical maps, i.e., we shall simply write <picture><source srcset="form_95_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$F(\hat{\bf x})\ \mbox{and}\ {\bf q}_m$" src="form_95.png" width="71" height="14"/></picture>.</p>
<dl class="section user"><dt>Summary</dt><dd></dd></dl>
<ul>
<li><picture><source srcset="form_96_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$F(\hat{\bf x})$" src="form_96.png" width="26" height="14"/></picture>: implemented in <a class="el" href="classIntrepid2_1_1CellTools.html#a4647855c7283cf8bf47c365498121314" title="Computes F, the reference-to-physical frame map.">Intrepid2::CellTools::mapToPhysicalFrame</a> </li>
<li><picture><source srcset="form_97_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$F^{-1}({\bf x})$" src="form_97.png" width="39" height="15"/></picture>: implemented in <a class="el" href="classIntrepid2_1_1CellTools.html#a006dc4e9c5f5ac25be8b513b8f63ca04" title="Computes , the inverse of the reference-to-physical frame map using a default initial guess.">Intrepid2::CellTools::mapToReferenceFrame</a></li>
</ul>
<dl class="section warning"><dt>Warning</dt><dd><a class="el" href="classIntrepid2_1_1CellTools.html" title="A stateless class for operations on cell data. Provides methods for:">Intrepid2::CellTools</a> does not check for non-degeneracy of the physical cell obtained from a given set of physical nodes. As a result, <em>F</em> is not guaranteed to be a diffeomorphism, i.e., it may not have a continuously differentiable inverse. In this case some <a class="el" href="classIntrepid2_1_1CellTools.html" title="A stateless class for operations on cell data. Provides methods for:">Intrepid2::CellTools</a> methods, such as <a class="el" href="classIntrepid2_1_1CellTools.html#a4b3f3c71168e71bf3db25e9255845126" title="Computes the inverse of the Jacobian matrix DF of the reference-to-physical frame map F.">Intrepid2::CellTools::setJacobianInv</a>, and <a class="el" href="classIntrepid2_1_1CellTools.html#a006dc4e9c5f5ac25be8b513b8f63ca04" title="Computes , the inverse of the reference-to-physical frame map using a default initial guess.">Intrepid2::CellTools::mapToReferenceFrame</a> will fail.</dd></dl>
<h2><a class="anchor" id="sec_cell_topology_ref_map_DF"></a>
Jacobian of the reference-to-physical cell mapping</h2>
<p>Intrepid follows the convention that the rows of the Jacobian are the transposed gradients of the coordinate functions of the mapping, i.e.,  </p><p class="formulaDsp">
<picture><source srcset="form_98_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[                    
      DF_{ij}(\hat{{\bf x}}) = \frac{\partial F_i(\hat{{\bf x}})}{\partial\hat{{\bf x}}_j}                    
\]" src="form_98.png" width="100" height="31"/></picture>
</p>
<p> In light of the definition of <em>F</em> in Section <a class="el" href="cell_tools_page.html#sec_cell_topology_ref_map">Reference-to-physical cell mapping</a>, it follows that  </p><p class="formulaDsp">
<picture><source srcset="form_99_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[  
      DF_{ij}(\hat{{\bf x}}) = \sum_{m=0}^{N}
                ({\bf q}_m)_i\frac{\partial\hat{\phi}_m(\hat{{\bf x}})}{\partial\hat{{\bf x}}_j} \,.       
\]" src="form_99.png" width="164" height="38"/></picture>
</p>
<dl class="section user"><dt>Summary</dt><dd></dd></dl>
<ul>
<li><picture><source srcset="form_100_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$DF_{ij}(\hat{{\bf x}}) $" src="form_100.png" width="44" height="14"/></picture>: implemented in <a class="el" href="classIntrepid2_1_1CellTools.html#a9b4e2522850bdc5a0100dd0653154f46" title="Computes the Jacobian matrix DF of the reference-to-physical frame map F.">Intrepid2::CellTools::setJacobian</a> </li>
<li><picture><source srcset="form_101_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$DF_{ij}^{-1}(\hat{{\bf x}}) $" src="form_101.png" width="50" height="18"/></picture>: implemented in <a class="el" href="classIntrepid2_1_1CellTools.html#a4b3f3c71168e71bf3db25e9255845126" title="Computes the inverse of the Jacobian matrix DF of the reference-to-physical frame map F.">Intrepid2::CellTools::setJacobianInv</a> </li>
<li><picture><source srcset="form_102_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\mbox{det} DF_{ij}(\hat{{\bf x}}) $" src="form_102.png" width="63" height="14"/></picture>: implemented in <a class="el" href="classIntrepid2_1_1CellTools.html#a45b9b7c93d79757812c1f00f0062bc37" title="Computes the determinant of the Jacobian matrix DF of the reference-to-physical frame map F.">Intrepid2::CellTools::setJacobianDet</a> <br  />
</li>
</ul>
<h2><a class="anchor" id="sec_cell_topology_subcell_map"></a>
Parametrization of physical 1- and 2-subcells</h2>
<p>Parametrization of a given physical k-subcell <picture><source srcset="form_103_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\mathcal{S}_i$" src="form_103.png" width="13" height="13"/></picture>, k=1,2, is a map from a k-dimensional parametrization domain <em>R</em> to that subcell:  </p><p class="formulaDsp">
<picture><source srcset="form_104_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
    \Phi : R \mapsto \mathcal{S} \,.
\]" src="form_104.png" width="61" height="10"/></picture>
</p>
<p> Parametrization domains play role similar to that of reference cells in the sense that they allow computation of line and surface integrals on 1- and 2-subcells (edges and faces) to be reduced to <br  />
 computation of integrals on <em>R</em> .</p>
<p>Parametrization maps are supported for 1- and 2-subcells (edges and faces) that belong to physical cells with reference cells. The reason is that these maps are defined by the composition of the parametrization maps for reference edges and faces with the mapping <em>F</em> defined in <a class="el" href="cell_tools_page.html#sec_cell_topology_ref_map">Reference-to-physical cell mapping</a>. As a result, parametrization of a given physical k-subcell requires selection of a <b>parent cell</b> that contains the subcell.</p>
<dl class="section remark"><dt>Remarks</dt><dd><br  />
 Because a given k-subcell may belong to more than one physical cell, its parent cell is not unique. For a single k-subcell the choice of a parent cell is not important, however, when dealing with subcell worksets parent cells must all have the same topology (see <a class="el" href="cell_tools_page.html#sec_cell_topology_subcell_wset">Subcell worksets</a> for details about subcell worksets).</dd></dl>
<p>Implementation of subcell parametrization is as follows. Assume that <picture><source srcset="form_103_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\mathcal{S}_i$" src="form_103.png" width="13" height="13"/></picture> is a k-subcell <br  />
 with parent cell <picture><source srcset="form_89_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\mathcal{C}$" src="form_89.png" width="9" height="11"/></picture>; <picture><source srcset="form_105_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\mathcal{\hat{C}}$" src="form_105.png" width="9" height="14"/></picture> is the associated reference cell and <em>i</em> is the local ordinal of the subcell relative to the reference cell. To this physical subcell corresponds a reference subcell <picture><source srcset="form_71_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\hat{\mathcal{S}}_i$" src="form_71.png" width="13" height="15"/></picture> having the same local ordinal. Parametrization of the reference k-subcell is a map from the k-dimensional parametrization domain <em>R</em> to that subcell:  </p><p class="formulaDsp">
<picture><source srcset="form_106_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
    \hat{\Phi} : R \mapsto \hat{\mathcal{S}}_i \,.
\]" src="form_106.png" width="65" height="15"/></picture>
</p>
<p> Parametrization of <picture><source srcset="form_103_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\mathcal{S}_i$" src="form_103.png" width="13" height="13"/></picture> is then defined as  </p><p class="formulaDsp">
<picture><source srcset="form_107_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
    \Phi = F\circ \hat{\Phi} \,,
\]" src="form_107.png" width="61" height="15"/></picture>
</p>
<p> where <em>F</em> is the reference-to-physical mapping between the parent cell and its reference cell.</p>
<p>A 1-subcell (edge) always has <code>Line&lt;N&gt;</code> topology and so, the parametrization domain for edges is the standard 1-cube:  </p><p class="formulaDsp">
<picture><source srcset="form_108_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
      R = [-1,1]\,.
\]" src="form_108.png" width="66" height="14"/></picture>
</p>
<p> On the other hand, faces of reference cells can have <code>Triangle&lt;N&gt;</code> and/or <code>Quadrilateral&lt;N&gt;</code> topologies. Thus, the parametrization domain for a 2-subcell depends on its topology and is either the standard 2-simplex or the standard 2-cube:  </p><p class="formulaDsp">
<picture><source srcset="form_109_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
      R = \left\{\begin{array}{rl} 
          \{(0,0),(1,0),(0,1)\} &amp; \mbox{if the face is Triangle} \\[1ex]
            [-1,1]\times [-1,1] &amp; \mbox{if the face is Quadrilateral}
          \end{array}\right.
\]" src="form_109.png" width="306" height="39"/></picture>
</p>
 <dl class="section user"><dt>Summary</dt><dd></dd></dl>
<ul>
<li><picture><source srcset="form_110_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \Phi : R \mapsto {\mathcal{S}}_i $" src="form_110.png" width="59" height="13"/></picture> requires two steps:<ol type="1">
<li><a class="el" href="classIntrepid2_1_1CellTools.html#a7b4e906b9b8ddf007e9d1602ae211cbb" title="Computes parameterization maps of 1- and 2-subcells of reference cells.">Intrepid2::CellTools::mapToReferenceSubcell</a> to apply <picture><source srcset="form_111_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\hat{\Phi}: R \mapsto \hat{\mathcal{S}}_i$" src="form_111.png" width="59" height="15"/></picture>;</li>
<li><a class="el" href="classIntrepid2_1_1CellTools.html#a4647855c7283cf8bf47c365498121314" title="Computes F, the reference-to-physical frame map.">Intrepid2::CellTools::mapToPhysicalFrame</a> to apply <em>F</em> </li>
</ol>
</li>
</ul>
<h2><a class="anchor" id="sec_cell_topology_subcell_wset"></a>
Subcell worksets</h2>
<p>A subcell workset comprises of 1- or 2-subcells and associated parent cells that satisfy the following conditions</p>
<ul>
<li>all subcells have the same cell topology; </li>
<li>all parent cells have the same cell topology; </li>
<li>The parent cell topology has a reference cell; </li>
<li>relative to that reference cell, all subcells in the workset have the same local ordinal</li>
</ul>
<p>Therefore, a subcell workset is defined by</p>
<ol type="1">
<li>collecting a set of 1- or 2-subcells having the same topology</li>
<li><p class="startli">selecting a parent cell for every subcell in such a way that</p><ol type="a">
<li>all parent cells have the same cell topology</li>
<li>all subcells in the workset have the same local ordinal relative to the parent cell topology</li>
</ol>
<p class="startli">Obviously, a subcell can have multiple parent cells. For example, in a mesh consisiting of Triangle&lt;3&gt; cells, every edge is shared by 2 triangle cells. To define an edge workset we can use either one of the two traingles sharing the cell.</p>
<p class="startli">Suppose now that the mesh comprises of Triangle&lt;3&gt; and Quadrilateral&lt;4&gt; cells and we want to define an edge workset. Let's say the first few edges in our workset happen to be shared by 2 triangles and so we select one of them as the parent cell. Now suppose the next edge is shared by a traingle and a quadrilateral. Because all parent cells in the workset must have the same cell topology we cannot use the quadrilateral as a parent cell and so we choose the triangle. Finally suppose that one of the candidate edges for our workset is shared by 2 quadrilaterals. Because of the requirement that all parent cells have the same topology, we will have to reject this edge because it does not posses a potential parent cell with the same topology as the rest of the edges in our workset.</p>
<p class="startli">A subcell workset is denoted by <picture><source srcset="form_112_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \{\mathcal{S}_{c,i}\}_{c=0}^N $" src="form_112.png" width="49" height="15"/></picture>, where</p>
<ul>
<li><em>c</em> is parent cell ordinal; </li>
<li><em>i</em> is the local subcell ordinal (relative to the topology of the parent cell) shared by all subcells in the workset. </li>
</ul>
</li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
