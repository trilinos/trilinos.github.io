<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TrilinosCouplings: example_GradDiv.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TrilinosCouplings<span id="projectnumber">&#160;Development</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d28a4824dc47e487b107a5db32ef43c4.html">examples</a></li><li class="navelem"><a class="el" href="dir_53e8f797ecf3ce10c23d13890752546e.html">scaling</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">example_GradDiv.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Example solution grad-div diffusion system with div-conforming (face) elements.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;TrilinosCouplings_config.h&quot;</code><br />
<code>#include &quot;TrilinosCouplings_Pamgen_Utils.hpp&quot;</code><br />
<code>#include &quot;Intrepid_FunctionSpaceTools.hpp&quot;</code><br />
<code>#include &quot;Intrepid_FieldContainer.hpp&quot;</code><br />
<code>#include &quot;Intrepid_CellTools.hpp&quot;</code><br />
<code>#include &quot;Intrepid_ArrayTools.hpp&quot;</code><br />
<code>#include &quot;Intrepid_HCURL_HEX_I1_FEM.hpp&quot;</code><br />
<code>#include &quot;Intrepid_HGRAD_HEX_C1_FEM.hpp&quot;</code><br />
<code>#include &quot;Intrepid_HDIV_HEX_I1_FEM.hpp&quot;</code><br />
<code>#include &quot;Intrepid_RealSpaceTools.hpp&quot;</code><br />
<code>#include &quot;Intrepid_DefaultCubatureFactory.hpp&quot;</code><br />
<code>#include &quot;Intrepid_Utils.hpp&quot;</code><br />
<code>#include &quot;Epetra_Time.h&quot;</code><br />
<code>#include &quot;Epetra_Map.h&quot;</code><br />
<code>#include &quot;Epetra_SerialComm.h&quot;</code><br />
<code>#include &quot;Epetra_FECrsMatrix.h&quot;</code><br />
<code>#include &quot;Epetra_FEVector.h&quot;</code><br />
<code>#include &quot;Epetra_Vector.h&quot;</code><br />
<code>#include &quot;Epetra_LinearProblem.h&quot;</code><br />
<code>#include &quot;Epetra_Import.h&quot;</code><br />
<code>#include &quot;Epetra_Export.h&quot;</code><br />
<code>#include &quot;Teuchos_oblackholestream.hpp&quot;</code><br />
<code>#include &quot;Teuchos_RCP.hpp&quot;</code><br />
<code>#include &quot;Teuchos_BLAS.hpp&quot;</code><br />
<code>#include &quot;Teuchos_GlobalMPISession.hpp&quot;</code><br />
<code>#include &quot;Teuchos_ParameterList.hpp&quot;</code><br />
<code>#include &quot;Teuchos_XMLParameterListHelpers.hpp&quot;</code><br />
<code>#include &quot;Shards_CellTopology.hpp&quot;</code><br />
<code>#include &quot;EpetraExt_RowMatrixOut.h&quot;</code><br />
<code>#include &quot;EpetraExt_MultiVectorOut.h&quot;</code><br />
<code>#include &quot;EpetraExt_VectorOut.h&quot;</code><br />
<code>#include &quot;EpetraExt_MatrixMatrix.h&quot;</code><br />
<code>#include &quot;create_inline_mesh.h&quot;</code><br />
<code>#include &quot;pamgen_im_exodusII_l.h&quot;</code><br />
<code>#include &quot;pamgen_im_ne_nemesisI_l.h&quot;</code><br />
<code>#include &quot;pamgen_extras.h&quot;</code><br />
<code>#include &quot;AztecOO.h&quot;</code><br />
<code>#include &quot;ml_epetra_utils.h&quot;</code><br />
<code>#include &quot;ml_GradDiv.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for example_GradDiv.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="example__GradDiv_8cpp__incl.gif" border="0" usemap="#aexample__GradDiv_8cpp" alt=""/></div>
<map name="aexample__GradDiv_8cpp" id="aexample__GradDiv_8cpp">
<area shape="rect" title="Example solution grad&#45;div diffusion system with div&#45;conforming (face) elements." alt="" coords="3470,5,3635,31"/>
<area shape="rect" title=" " alt="" coords="5,86,196,111"/>
<area shape="poly" title=" " alt="" coords="3470,22,2864,22,1919,28,1413,35,934,45,520,61,209,81,171,86,170,81,208,76,520,55,934,40,1413,29,1919,22,2864,16,3470,16"/>
<area shape="rect" title=" " alt="" coords="221,86,455,111"/>
<area shape="poly" title=" " alt="" coords="3470,22,2905,25,2036,34,1133,51,753,65,468,81,419,87,419,81,467,76,753,59,1133,46,2036,28,2905,20,3470,17"/>
<area shape="rect" title=" " alt="" coords="479,86,679,111"/>
<area shape="poly" title=" " alt="" coords="3470,22,2942,24,2137,32,1304,50,955,64,692,81,652,86,651,81,691,76,955,58,1304,45,2137,27,2942,19,3470,17"/>
<area shape="rect" title=" " alt="" coords="703,86,869,111"/>
<area shape="poly" title=" " alt="" coords="3469,22,2972,23,2222,30,1825,38,1449,48,1125,63,881,81,849,86,848,81,880,76,1125,57,1449,43,1824,32,2222,25,2972,18,3469,17"/>
<area shape="rect" title=" " alt="" coords="893,86,1068,111"/>
<area shape="poly" title=" " alt="" coords="3469,22,3005,25,2313,33,1602,51,1304,64,1080,81,1046,86,1045,81,1079,76,1304,59,1602,46,2313,28,3005,19,3469,17"/>
<area shape="rect" title=" " alt="" coords="1092,79,1251,119"/>
<area shape="poly" title=" " alt="" coords="3470,22,3041,25,2409,33,1756,51,1478,64,1265,81,1264,76,1478,59,1755,45,2409,28,3041,19,3470,17"/>
<area shape="rect" title=" " alt="" coords="1275,79,1436,119"/>
<area shape="poly" title=" " alt="" coords="3470,22,3073,26,2495,36,1899,53,1646,66,1450,81,1450,76,1646,61,1899,48,2494,30,3073,21,3470,17"/>
<area shape="rect" title=" " alt="" coords="1461,79,1626,119"/>
<area shape="poly" title=" " alt="" coords="3470,23,3105,27,2582,38,2045,55,1817,67,1640,81,1640,76,1817,62,2045,50,2582,32,3105,22,3470,17"/>
<area shape="rect" title=" " alt="" coords="1650,86,1858,111"/>
<area shape="poly" title=" " alt="" coords="3470,21,3202,22,2807,28,2344,47,2105,62,1870,81,1830,86,1829,81,1870,76,2104,56,2344,41,2807,23,3202,16,3470,16"/>
<area shape="rect" title=" " alt="" coords="1882,79,2069,119"/>
<area shape="poly" title=" " alt="" coords="3470,21,3234,22,2894,30,2494,48,2287,62,2083,81,2082,76,2286,57,2494,42,2893,24,3234,17,3470,16"/>
<area shape="rect" title=" " alt="" coords="2093,86,2231,111"/>
<area shape="poly" title=" " alt="" coords="3470,24,2852,42,2500,59,2353,70,2242,81,2218,86,2217,80,2242,76,2353,64,2499,54,2852,37,3470,18"/>
<area shape="rect" title=" " alt="" coords="2255,86,2371,111"/>
<area shape="poly" title=" " alt="" coords="3470,24,2918,42,2608,59,2480,70,2382,81,2363,85,2362,80,2382,76,2479,64,2608,54,2918,37,3470,19"/>
<area shape="rect" title=" " alt="" coords="2395,86,2505,111"/>
<area shape="poly" title=" " alt="" coords="3470,21,3296,22,3059,29,2790,47,2653,62,2518,81,2500,85,2499,80,2518,76,2652,57,2790,42,3059,24,3296,16,3470,16"/>
<area shape="rect" title=" " alt="" coords="2530,86,2693,111"/>
<area shape="poly" title=" " alt="" coords="3470,24,3135,41,2921,57,2705,81,2676,86,2675,81,2704,76,2920,52,3135,35,3470,19"/>
<area shape="rect" title=" " alt="" coords="2717,86,2879,111"/>
<area shape="poly" title=" " alt="" coords="3470,27,3211,46,3052,61,2892,81,2864,86,2863,81,2891,76,3051,56,3211,40,3470,21"/>
<area shape="rect" title=" " alt="" coords="2903,86,3042,111"/>
<area shape="poly" title=" " alt="" coords="3470,29,3280,49,3054,81,3032,86,3031,80,3054,76,3279,44,3469,24"/>
<area shape="rect" title=" " alt="" coords="3066,86,3189,111"/>
<area shape="poly" title=" " alt="" coords="3474,33,3346,54,3201,81,3183,85,3182,80,3200,76,3345,49,3474,28"/>
<area shape="rect" title=" " alt="" coords="3213,86,3391,111"/>
<area shape="poly" title=" " alt="" coords="3517,33,3352,84,3351,79,3515,28"/>
<area shape="rect" title=" " alt="" coords="3415,86,3541,111"/>
<area shape="poly" title=" " alt="" coords="3544,33,3500,78,3496,74,3540,29"/>
<area shape="rect" title=" " alt="" coords="3566,86,3691,111"/>
<area shape="poly" title=" " alt="" coords="3566,29,3610,74,3606,78,3562,33"/>
<area shape="rect" title=" " alt="" coords="3715,86,3942,111"/>
<area shape="poly" title=" " alt="" coords="3594,28,3776,80,3775,85,3592,33"/>
<area shape="rect" title=" " alt="" coords="3966,86,4099,111"/>
<area shape="poly" title=" " alt="" coords="3636,27,3785,47,3954,76,3975,80,3974,86,3954,81,3784,53,3635,32"/>
<area shape="rect" title=" " alt="" coords="4124,86,4267,111"/>
<area shape="poly" title=" " alt="" coords="3636,23,3852,42,3982,57,4112,76,4136,80,4135,86,4111,81,3981,63,3851,47,3635,28"/>
<area shape="rect" title=" " alt="" coords="4291,86,4516,111"/>
<area shape="poly" title=" " alt="" coords="3636,22,3921,42,4280,76,4320,81,4320,87,4279,81,3921,47,3635,27"/>
<area shape="rect" title=" " alt="" coords="4540,86,4739,111"/>
<area shape="poly" title=" " alt="" coords="3636,19,4022,35,4274,52,4529,76,4566,81,4566,86,4528,81,4274,57,4022,40,3636,24"/>
<area shape="rect" title=" " alt="" coords="4763,79,4961,119"/>
<area shape="poly" title=" " alt="" coords="3635,17,3831,21,4105,31,4422,48,4749,76,4748,81,4422,53,4105,36,3831,27,3635,23"/>
<area shape="rect" title=" " alt="" coords="4985,86,5168,111"/>
<area shape="poly" title=" " alt="" coords="3635,16,3866,17,4197,25,4582,43,4780,57,4974,76,5009,81,5008,86,4974,81,4780,63,4582,48,4197,30,3866,23,3635,21"/>
<area shape="rect" title=" " alt="" coords="5193,86,5390,111"/>
<area shape="poly" title=" " alt="" coords="3636,16,3895,16,4277,23,4724,41,4955,56,5181,76,5219,81,5218,86,5180,81,4955,61,4724,46,4277,28,3895,22,3636,21"/>
<area shape="rect" title=" " alt="" coords="5415,86,5616,111"/>
<area shape="poly" title=" " alt="" coords="3636,18,4505,36,5022,53,5239,64,5402,76,5443,81,5442,87,5402,81,5238,69,5022,58,4504,41,3635,23"/>
<area shape="rect" title=" " alt="" coords="5641,86,5809,111"/>
<area shape="poly" title=" " alt="" coords="3636,17,4033,21,4610,31,5197,49,5443,61,5629,76,5662,81,5661,86,5628,81,5443,66,5197,54,4610,36,4033,27,3636,23"/>
<area shape="rect" title=" " alt="" coords="5833,86,6021,111"/>
<area shape="poly" title=" " alt="" coords="3635,17,4065,21,4697,31,5345,49,5616,61,5821,76,5859,81,5858,86,5820,81,5616,66,5345,54,4697,37,4065,27,3635,23"/>
<area shape="rect" title=" " alt="" coords="6045,86,6207,111"/>
<area shape="poly" title=" " alt="" coords="3636,17,4101,19,4796,26,5510,44,5809,58,6034,76,6065,81,6064,86,6034,81,5808,63,5509,49,4795,32,4101,24,3636,22"/>
<area shape="rect" title=" " alt="" coords="6231,86,6413,111"/>
<area shape="poly" title=" " alt="" coords="3636,17,4132,19,4880,27,5652,45,5976,58,6220,76,6256,81,6255,86,6219,81,5975,64,5652,50,4880,32,4132,24,3636,22"/>
<area shape="rect" title=" " alt="" coords="6438,86,6649,111"/>
<area shape="poly" title=" " alt="" coords="3636,17,4166,19,4974,28,5810,46,6161,59,6426,76,6469,81,6468,87,6426,81,6161,64,5810,51,4974,33,4166,25,3636,22"/>
<area shape="rect" title=" " alt="" coords="6673,86,6808,111"/>
<area shape="poly" title=" " alt="" coords="3635,17,4260,22,5206,33,6123,51,6462,63,6661,76,6687,80,6686,86,6660,81,6461,68,6123,56,5206,39,4260,28,3635,23"/>
<area shape="rect" title=" " alt="" coords="6833,86,6923,111"/>
<area shape="poly" title=" " alt="" coords="3635,17,4289,19,5286,26,5797,34,6254,44,6611,58,6737,66,6821,76,6836,79,6835,85,6820,81,6737,72,6611,63,6254,49,5797,39,5286,32,4289,24,3635,22"/>
<area shape="rect" title=" " alt="" coords="6948,86,7083,111"/>
<area shape="poly" title=" " alt="" coords="3635,17,4309,21,5342,32,6346,50,6717,62,6936,76,6961,80,6961,86,6935,81,6717,67,6346,55,5342,37,4309,27,3635,22"/>
<area shape="rect" title=" " alt="" coords="7107,86,7217,111"/>
<area shape="poly" title=" " alt="" coords="3636,17,4338,19,5421,27,5978,35,6477,45,6866,59,7004,67,7096,76,7115,80,7114,85,7095,81,7004,72,6866,64,6477,51,5978,40,5421,33,4338,25,3636,22"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfecomp.html">fecomp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a996f7be338ccb40d1a2a5abc1ad61759" id="r_a996f7be338ccb40d1a2a5abc1ad61759"><td class="memItemLeft" align="right" valign="top"><a id="a996f7be338ccb40d1a2a5abc1ad61759" name="a996f7be338ccb40d1a2a5abc1ad61759"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ABS</b>(x)&#160;&#160;&#160;((x)&gt;0?(x):-(x))</td></tr>
<tr class="separator:a996f7be338ccb40d1a2a5abc1ad61759"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:adda1739cea110543aacd2570a170bc6e" id="r_adda1739cea110543aacd2570a170bc6e"><td class="memItemLeft" align="right" valign="top"><a id="adda1739cea110543aacd2570a170bc6e" name="adda1739cea110543aacd2570a170bc6e"></a>
typedef Intrepid::FunctionSpaceTools&#160;</td><td class="memItemRight" valign="bottom"><b>IntrepidFSTools</b></td></tr>
<tr class="separator:adda1739cea110543aacd2570a170bc6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb796cf323403440988ee7a695710af1" id="r_aeb796cf323403440988ee7a695710af1"><td class="memItemLeft" align="right" valign="top"><a id="aeb796cf323403440988ee7a695710af1" name="aeb796cf323403440988ee7a695710af1"></a>
typedef Intrepid::RealSpaceTools&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>IntrepidRSTools</b></td></tr>
<tr class="separator:aeb796cf323403440988ee7a695710af1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f0fe32769da9c6da24a4d0d2e6f802e" id="r_a5f0fe32769da9c6da24a4d0d2e6f802e"><td class="memItemLeft" align="right" valign="top"><a id="a5f0fe32769da9c6da24a4d0d2e6f802e" name="a5f0fe32769da9c6da24a4d0d2e6f802e"></a>
typedef Intrepid::CellTools&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>IntrepidCTools</b></td></tr>
<tr class="separator:a5f0fe32769da9c6da24a4d0d2e6f802e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae653458a9a8f534b25d27231b421b49f" id="r_ae653458a9a8f534b25d27231b421b49f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="example__GradDiv_8cpp.html#ae653458a9a8f534b25d27231b421b49f">Multiply_Abs</a> (const Epetra_CrsMatrix &amp;A, const Epetra_Vector &amp;x, Epetra_Vector &amp;y)</td></tr>
<tr class="memdesc:ae653458a9a8f534b25d27231b421b49f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Multiplies abs(A)x = y, where all non-zero entries of A are replaced with their absolute values value.  <br /></td></tr>
<tr class="separator:ae653458a9a8f534b25d27231b421b49f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99683f0919586ae5fbb92a6378200380" id="r_a99683f0919586ae5fbb92a6378200380"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="example__GradDiv_8cpp.html#a99683f0919586ae5fbb92a6378200380">TestMultiLevelPreconditioner_GradDiv</a> (char ProblemType[], Teuchos::ParameterList &amp;MLList, Epetra_CrsMatrix &amp;GradDiv, Epetra_CrsMatrix &amp;D0clean, Epetra_CrsMatrix &amp;D1clean, Epetra_CrsMatrix &amp;FaceNode, Epetra_CrsMatrix &amp;M1, Epetra_CrsMatrix &amp;M1inv, Epetra_CrsMatrix &amp;M2, Epetra_MultiVector &amp;xh, Epetra_MultiVector &amp;b, double &amp;TotalErrorResidual, double &amp;TotalErrorExactSol)</td></tr>
<tr class="memdesc:a99683f0919586ae5fbb92a6378200380"><td class="mdescLeft">&#160;</td><td class="mdescRight">ML Preconditioner.  <br /></td></tr>
<tr class="separator:a99683f0919586ae5fbb92a6378200380"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc70c1d859ea706bab25b57f74d17b47" id="r_abc70c1d859ea706bab25b57f74d17b47"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="example__GradDiv_8cpp.html#abc70c1d859ea706bab25b57f74d17b47">evalu</a> (double &amp;uExact0, double &amp;uExact1, double &amp;uExact2, double &amp;x, double &amp;y, double &amp;z)</td></tr>
<tr class="memdesc:abc70c1d859ea706bab25b57f74d17b47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exact solution evaluation.  <br /></td></tr>
<tr class="separator:abc70c1d859ea706bab25b57f74d17b47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b1e2d82b116aeada95393ff1a086335" id="r_a4b1e2d82b116aeada95393ff1a086335"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="example__GradDiv_8cpp.html#a4b1e2d82b116aeada95393ff1a086335">evalDivu</a> (double &amp;x, double &amp;y, double &amp;z)</td></tr>
<tr class="memdesc:a4b1e2d82b116aeada95393ff1a086335"><td class="mdescLeft">&#160;</td><td class="mdescRight">Divergence of exact solution.  <br /></td></tr>
<tr class="separator:a4b1e2d82b116aeada95393ff1a086335"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb8ca70e87a904c73bace95effd996ae" id="r_adb8ca70e87a904c73bace95effd996ae"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="example__GradDiv_8cpp.html#adb8ca70e87a904c73bace95effd996ae">evalGradDivu</a> (double &amp;gradDivu0, double &amp;gradDivu1, double &amp;gradDivu2, double &amp;x, double &amp;y, double &amp;z, double &amp;kappa)</td></tr>
<tr class="memdesc:adb8ca70e87a904c73bace95effd996ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Grad of Div of exact solution.  <br /></td></tr>
<tr class="separator:adb8ca70e87a904c73bace95effd996ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97" id="r_a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top"><a id="a0ddf1224851353fc92bfbff6f499fa97" name="a0ddf1224851353fc92bfbff6f499fa97"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>main</b> (int argc, char *argv[])</td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3de3e0aaf131132d5826fd10a3d1941" id="r_ae3de3e0aaf131132d5826fd10a3d1941"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="example__GradDiv_8cpp.html#ae3de3e0aaf131132d5826fd10a3d1941">Multiply_Ones</a> (const Epetra_CrsMatrix &amp;A, const Epetra_Vector &amp;x, Epetra_Vector &amp;y)</td></tr>
<tr class="memdesc:ae3de3e0aaf131132d5826fd10a3d1941"><td class="mdescLeft">&#160;</td><td class="mdescRight">Multiplies Ax = y, where all non-zero entries of A are replaced with the value 1.0.  <br /></td></tr>
<tr class="separator:ae3de3e0aaf131132d5826fd10a3d1941"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e6d87c364a8f93cf33d5c75c9876a5c" id="r_a0e6d87c364a8f93cf33d5c75c9876a5c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="example__GradDiv_8cpp.html#a0e6d87c364a8f93cf33d5c75c9876a5c">solution_test</a> (string msg, const Epetra_Operator &amp;A, const Epetra_MultiVector &amp;lhs, const Epetra_MultiVector &amp;rhs, const Epetra_MultiVector &amp;xexact, Epetra_Time &amp;Time, double &amp;TotalErrorExactSol, double &amp;TotalErrorResidual)</td></tr>
<tr class="memdesc:a0e6d87c364a8f93cf33d5c75c9876a5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute ML solution residual.  <br /></td></tr>
<tr class="separator:a0e6d87c364a8f93cf33d5c75c9876a5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f5912a0eef30279ea7dedf76e0589e7" id="r_a4f5912a0eef30279ea7dedf76e0589e7"><td class="memItemLeft" align="right" valign="top"><a id="a4f5912a0eef30279ea7dedf76e0589e7" name="a4f5912a0eef30279ea7dedf76e0589e7"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>evalCurlu</b> (double &amp;curlu0, double &amp;curlu1, double &amp;curlu2, double &amp;x, double &amp;y, double &amp;z, double &amp;mu)</td></tr>
<tr class="separator:a4f5912a0eef30279ea7dedf76e0589e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Example solution grad-div diffusion system with div-conforming (face) elements. </p>
<p>This example uses the following Trilinos packages: </p><ul>
<li>Pamgen to generate a Hexahedral mesh. </li>
<li>Intrepid to build the discretization matrices and right-hand side. </li>
<li>Epetra to handle the global matrix and vector. </li>
<li>ML to solve the linear system.</li>
</ul>
<p>For more details on the formulation see</p>
<ul>
<li>P. Bochev, K. Peterson, C. Siefert, "Analysis and Computation
of Compatible Least-Squares Methods for Div-Curl Equations", SIAM J. Numerical Analysis, vol 49, pp 159-191, 2011.</li>
</ul>
<pre class="fragment">Grad-Div System:

grad kappa div F + mu F  = g  in Omega

Corresponding discrete linear system for edge element coeficients (x):
(Kc + Mc)x = b

Kd    - Hdiv stiffness matrix
Md    - Hcdiv mass matrix
b    - right hand side vector</pre><dl class="section author"><dt>Author</dt><dd>Created by P. Bochev, D. Ridzal, K. Peterson, D. Hensinger, C. Siefert.</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>Usage <pre class="fragment">./TrilinosCouplings_examples_scaling_Example_GradDiv.exe  inputfile.xml

inputfile.xml (optional)  -  xml input file containing Pamgen mesh description
and material parameters for each Pamgen block,
if not present code attempts to read DivLSFEMin.xml.</pre> </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a4b1e2d82b116aeada95393ff1a086335" name="a4b1e2d82b116aeada95393ff1a086335"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b1e2d82b116aeada95393ff1a086335">&#9670;&#160;</a></span>evalDivu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double evalDivu </td>
          <td>(</td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Divergence of exact solution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>[in] x coordinate </td></tr>
    <tr><td class="paramname">y</td><td>[in] y coordinate </td></tr>
    <tr><td class="paramname">z</td><td>[in] z coordinate</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Value of the divergence of exact solution at (x,y,z) </dd></dl>

</div>
</div>
<a id="adb8ca70e87a904c73bace95effd996ae" name="adb8ca70e87a904c73bace95effd996ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb8ca70e87a904c73bace95effd996ae">&#9670;&#160;</a></span>evalGradDivu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evalGradDivu </td>
          <td>(</td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>gradDivu0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>gradDivu1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>gradDivu2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>kappa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Grad of Div of exact solution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gradDivu0</td><td>[out] first component of grad div of exact solution </td></tr>
    <tr><td class="paramname">gradDivu1</td><td>[out] second component of grad div of exact solution </td></tr>
    <tr><td class="paramname">gradDivu2</td><td>[out] third component of grad div of exact solution </td></tr>
    <tr><td class="paramname">x</td><td>[in] x coordinate </td></tr>
    <tr><td class="paramname">y</td><td>[in] y coordinate </td></tr>
    <tr><td class="paramname">z</td><td>[in] z coordinate </td></tr>
    <tr><td class="paramname">mu</td><td>[in] material parameter </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abc70c1d859ea706bab25b57f74d17b47" name="abc70c1d859ea706bab25b57f74d17b47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc70c1d859ea706bab25b57f74d17b47">&#9670;&#160;</a></span>evalu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evalu </td>
          <td>(</td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>uExact0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>uExact1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>uExact2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Exact solution evaluation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uExact0</td><td>[out] first component of exact solution at (x,y,z) </td></tr>
    <tr><td class="paramname">uExact1</td><td>[out] second component of exact solution at (x,y,z) </td></tr>
    <tr><td class="paramname">uExact2</td><td>[out] third component of exact solution at (x,y,z) </td></tr>
    <tr><td class="paramname">x</td><td>[in] x coordinate </td></tr>
    <tr><td class="paramname">y</td><td>[in] y coordinate </td></tr>
    <tr><td class="paramname">z</td><td>[in] z coordinate </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae653458a9a8f534b25d27231b421b49f" name="ae653458a9a8f534b25d27231b421b49f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae653458a9a8f534b25d27231b421b49f">&#9670;&#160;</a></span>Multiply_Abs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Multiply_Abs </td>
          <td>(</td>
          <td class="paramtype">const Epetra_CrsMatrix &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Epetra_Vector &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Epetra_Vector &amp;&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Multiplies abs(A)x = y, where all non-zero entries of A are replaced with their absolute values value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>[in] matrix </td></tr>
    <tr><td class="paramname">x</td><td>[in] vector </td></tr>
    <tr><td class="paramname">y</td><td>[out] vector </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae3de3e0aaf131132d5826fd10a3d1941" name="ae3de3e0aaf131132d5826fd10a3d1941"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3de3e0aaf131132d5826fd10a3d1941">&#9670;&#160;</a></span>Multiply_Ones()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Multiply_Ones </td>
          <td>(</td>
          <td class="paramtype">const Epetra_CrsMatrix &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Epetra_Vector &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Epetra_Vector &amp;&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Multiplies Ax = y, where all non-zero entries of A are replaced with the value 1.0. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>[in] matrix </td></tr>
    <tr><td class="paramname">x</td><td>[in] vector </td></tr>
    <tr><td class="paramname">y</td><td>[in] vector </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0e6d87c364a8f93cf33d5c75c9876a5c" name="a0e6d87c364a8f93cf33d5c75c9876a5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e6d87c364a8f93cf33d5c75c9876a5c">&#9670;&#160;</a></span>solution_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void solution_test </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Epetra_Operator &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Epetra_MultiVector &amp;&#160;</td>
          <td class="paramname"><em>lhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Epetra_MultiVector &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Epetra_MultiVector &amp;&#160;</td>
          <td class="paramname"><em>xexact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Epetra_Time &amp;&#160;</td>
          <td class="paramname"><em>Time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>TotalErrorExactSol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>TotalErrorResidual</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute ML solution residual. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>[in] discrete operator </td></tr>
    <tr><td class="paramname">lhs</td><td>[in] solution vector </td></tr>
    <tr><td class="paramname">rhs</td><td>[in] right hand side vector </td></tr>
    <tr><td class="paramname">Time</td><td>[in] elapsed time for output </td></tr>
    <tr><td class="paramname">TotalErrorResidual</td><td>[out] error residual </td></tr>
    <tr><td class="paramname">TotalErrorExactSol</td><td>[out] error in xh (not an appropriate measure for H(div) basis functions) </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">Referenced by <a class="el" href="example__GradDiv_8cpp.html#a99683f0919586ae5fbb92a6378200380">TestMultiLevelPreconditioner_GradDiv()</a>.</p>

</div>
</div>
<a id="a99683f0919586ae5fbb92a6378200380" name="a99683f0919586ae5fbb92a6378200380"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99683f0919586ae5fbb92a6378200380">&#9670;&#160;</a></span>TestMultiLevelPreconditioner_GradDiv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TestMultiLevelPreconditioner_GradDiv </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>ProblemType</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Teuchos::ParameterList &amp;&#160;</td>
          <td class="paramname"><em>MLList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Epetra_CrsMatrix &amp;&#160;</td>
          <td class="paramname"><em>GradDiv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Epetra_CrsMatrix &amp;&#160;</td>
          <td class="paramname"><em>D0clean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Epetra_CrsMatrix &amp;&#160;</td>
          <td class="paramname"><em>D1clean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Epetra_CrsMatrix &amp;&#160;</td>
          <td class="paramname"><em>FaceNode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Epetra_CrsMatrix &amp;&#160;</td>
          <td class="paramname"><em>M1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Epetra_CrsMatrix &amp;&#160;</td>
          <td class="paramname"><em>M1inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Epetra_CrsMatrix &amp;&#160;</td>
          <td class="paramname"><em>M2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Epetra_MultiVector &amp;&#160;</td>
          <td class="paramname"><em>xh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Epetra_MultiVector &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>TotalErrorResidual</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>TotalErrorExactSol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ML Preconditioner. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ProblemType</td><td>[in] problem type </td></tr>
    <tr><td class="paramname">MLList</td><td>[in] ML parameter list </td></tr>
    <tr><td class="paramname">GradDiv</td><td>[in] H(curl) stiffness matrix </td></tr>
    <tr><td class="paramname">D0clean</td><td>[in] Edge to node incidence matrix </td></tr>
    <tr><td class="paramname">D1clean</td><td>[in] Face to edge incidence matrix </td></tr>
    <tr><td class="paramname">FaceNode</td><td>[in] Face to node incidence matrix </td></tr>
    <tr><td class="paramname">M1inv</td><td>[in] H(curl) mass matrix inverse </td></tr>
    <tr><td class="paramname">M2</td><td>[in] H(div) mass matrix </td></tr>
    <tr><td class="paramname">xh</td><td>[out] solution vector </td></tr>
    <tr><td class="paramname">b</td><td>[in] right-hand-side vector </td></tr>
    <tr><td class="paramname">TotalErrorResidual</td><td>[out] error residual </td></tr>
    <tr><td class="paramname">TotalErrorExactSol</td><td>[out] error in xh </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="example__GradDiv_8cpp.html#a0e6d87c364a8f93cf33d5c75c9876a5c">solution_test()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
