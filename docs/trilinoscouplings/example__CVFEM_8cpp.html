<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TrilinosCouplings: example_CVFEM.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TrilinosCouplings<span id="projectnumber">&#160;Development</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d28a4824dc47e487b107a5db32ef43c4.html">examples</a></li><li class="navelem"><a class="el" href="dir_53e8f797ecf3ce10c23d13890752546e.html">scaling</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">example_CVFEM.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Example solution of an Advection Diffusion equation on a quadrilateral or triangular mesh using the CVFEM.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;Intrepid_FunctionSpaceTools.hpp&quot;</code><br />
<code>#include &quot;Intrepid_CellTools.hpp&quot;</code><br />
<code>#include &quot;Intrepid_ArrayTools.hpp&quot;</code><br />
<code>#include &quot;Intrepid_Basis.hpp&quot;</code><br />
<code>#include &quot;Intrepid_HGRAD_QUAD_C1_FEM.hpp&quot;</code><br />
<code>#include &quot;Intrepid_HCURL_QUAD_I1_FEM.hpp&quot;</code><br />
<code>#include &quot;Intrepid_HGRAD_TRI_C1_FEM.hpp&quot;</code><br />
<code>#include &quot;Intrepid_HCURL_TRI_I1_FEM.hpp&quot;</code><br />
<code>#include &quot;Intrepid_RealSpaceTools.hpp&quot;</code><br />
<code>#include &quot;Intrepid_DefaultCubatureFactory.hpp&quot;</code><br />
<code>#include &quot;Intrepid_Cubature.hpp&quot;</code><br />
<code>#include &quot;Intrepid_CubatureControlVolume.hpp&quot;</code><br />
<code>#include &quot;Intrepid_CubatureControlVolumeSide.hpp&quot;</code><br />
<code>#include &quot;Intrepid_Utils.hpp&quot;</code><br />
<code>#include &quot;Epetra_Time.h&quot;</code><br />
<code>#include &quot;Epetra_Map.h&quot;</code><br />
<code>#include &quot;Epetra_SerialComm.h&quot;</code><br />
<code>#include &quot;Epetra_FECrsMatrix.h&quot;</code><br />
<code>#include &quot;Epetra_FEVector.h&quot;</code><br />
<code>#include &quot;Epetra_Import.h&quot;</code><br />
<code>#include &quot;Teuchos_oblackholestream.hpp&quot;</code><br />
<code>#include &quot;Teuchos_RCP.hpp&quot;</code><br />
<code>#include &quot;Teuchos_BLAS.hpp&quot;</code><br />
<code>#include &quot;Teuchos_GlobalMPISession.hpp&quot;</code><br />
<code>#include &quot;Teuchos_XMLParameterListHelpers.hpp&quot;</code><br />
<code>#include &quot;Shards_CellTopology.hpp&quot;</code><br />
<code>#include &quot;EpetraExt_RowMatrixOut.h&quot;</code><br />
<code>#include &quot;EpetraExt_MultiVectorOut.h&quot;</code><br />
<code>#include &quot;AztecOO.h&quot;</code><br />
<code>#include &quot;ml_MultiLevelPreconditioner.h&quot;</code><br />
<code>#include &quot;ml_epetra_utils.h&quot;</code><br />
<code>#include &quot;Sacado.hpp&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for example_CVFEM.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="example__CVFEM_8cpp__incl.gif" border="0" usemap="#aexample__CVFEM_8cpp" alt=""/></div>
<map name="aexample__CVFEM_8cpp" id="aexample__CVFEM_8cpp">
<area shape="rect" title="Example solution of an Advection Diffusion equation on a quadrilateral or triangular mesh using the C..." alt="" coords="2977,5,3135,31"/>
<area shape="rect" title=" " alt="" coords="5,86,240,111"/>
<area shape="poly" title=" " alt="" coords="2976,22,2460,26,1671,36,854,53,511,66,252,81,204,87,203,81,252,76,511,61,854,48,1671,30,2460,21,2976,17"/>
<area shape="rect" title=" " alt="" coords="264,86,429,111"/>
<area shape="poly" title=" " alt="" coords="2976,22,2491,23,1757,31,1367,38,999,49,681,63,442,81,410,86,409,81,441,76,681,57,999,43,1367,33,1757,26,2491,18,2976,17"/>
<area shape="rect" title=" " alt="" coords="454,86,629,111"/>
<area shape="poly" title=" " alt="" coords="2977,22,2524,25,1848,34,1152,51,860,65,640,81,607,86,606,81,640,76,860,59,1151,46,1848,28,2524,20,2977,17"/>
<area shape="rect" title=" " alt="" coords="653,86,795,111"/>
<area shape="poly" title=" " alt="" coords="2976,22,2552,24,1924,32,1280,50,1011,64,808,81,782,86,781,80,808,76,1011,58,1280,44,1924,27,2551,19,2976,17"/>
<area shape="rect" title=" " alt="" coords="820,79,993,119"/>
<area shape="poly" title=" " alt="" coords="2976,23,2590,27,2026,37,1445,54,1198,67,1007,81,1007,76,1198,61,1445,49,2026,32,2590,22,2976,17"/>
<area shape="rect" title=" " alt="" coords="1017,79,1188,119"/>
<area shape="poly" title=" " alt="" coords="2977,23,2117,39,1596,56,1374,68,1202,81,1201,76,1374,62,1595,51,2117,33,2977,18"/>
<area shape="rect" title=" " alt="" coords="1212,79,1367,119"/>
<area shape="poly" title=" " alt="" coords="2976,23,2199,39,1733,57,1535,68,1380,81,1380,76,1534,63,1733,51,2199,34,2976,18"/>
<area shape="rect" title=" " alt="" coords="1391,79,1543,119"/>
<area shape="poly" title=" " alt="" coords="2977,23,2281,41,1869,58,1694,69,1557,81,1556,76,1694,64,1869,53,2281,36,2977,18"/>
<area shape="rect" title=" " alt="" coords="1567,86,1775,111"/>
<area shape="poly" title=" " alt="" coords="2976,23,2769,26,2475,35,2134,53,1787,81,1747,87,1746,81,1786,76,2133,48,2474,30,2769,21,2976,17"/>
<area shape="rect" title=" " alt="" coords="1799,79,1985,119"/>
<area shape="poly" title=" " alt="" coords="2976,23,2802,28,2562,38,2285,55,2000,81,1999,76,2284,49,2562,32,2802,22,2976,18"/>
<area shape="rect" title=" " alt="" coords="2010,86,2177,111"/>
<area shape="poly" title=" " alt="" coords="2976,24,2633,40,2412,57,2188,81,2159,86,2158,81,2188,76,2411,52,2633,35,2976,19"/>
<area shape="rect" title=" " alt="" coords="2201,79,2386,119"/>
<area shape="poly" title=" " alt="" coords="2977,27,2724,46,2400,81,2399,76,2723,41,2976,22"/>
<area shape="rect" title=" " alt="" coords="2410,79,2595,119"/>
<area shape="poly" title=" " alt="" coords="2977,31,2610,81,2609,76,2976,26"/>
<area shape="rect" title=" " alt="" coords="2619,86,2757,111"/>
<area shape="poly" title=" " alt="" coords="2999,33,2769,81,2749,86,2748,80,2767,76,2998,28"/>
<area shape="rect" title=" " alt="" coords="2781,86,2897,111"/>
<area shape="poly" title=" " alt="" coords="3025,33,2884,84,2882,79,3023,28"/>
<area shape="rect" title=" " alt="" coords="2921,86,3031,111"/>
<area shape="poly" title=" " alt="" coords="3046,33,3000,78,2996,74,3042,29"/>
<area shape="rect" title=" " alt="" coords="3056,86,3219,111"/>
<area shape="poly" title=" " alt="" coords="3070,29,3117,75,3114,78,3066,33"/>
<area shape="rect" title=" " alt="" coords="3243,86,3405,111"/>
<area shape="poly" title=" " alt="" coords="3096,28,3273,80,3271,85,3094,33"/>
<area shape="rect" title=" " alt="" coords="3429,86,3568,111"/>
<area shape="poly" title=" " alt="" coords="3135,28,3418,76,3439,80,3438,86,3417,81,3134,33"/>
<area shape="rect" title=" " alt="" coords="3593,86,3719,111"/>
<area shape="poly" title=" " alt="" coords="3136,22,3338,42,3459,57,3580,76,3601,80,3600,86,3580,81,3459,62,3337,47,3135,28"/>
<area shape="rect" title=" " alt="" coords="3744,86,3971,111"/>
<area shape="poly" title=" " alt="" coords="3136,22,3401,43,3732,76,3773,81,3772,87,3732,81,3401,48,3136,27"/>
<area shape="rect" title=" " alt="" coords="3995,86,4128,111"/>
<area shape="poly" title=" " alt="" coords="3136,17,3292,21,3503,30,3742,48,3983,76,4006,80,4005,86,3982,81,3742,53,3503,35,3292,26,3136,23"/>
<area shape="rect" title=" " alt="" coords="4153,86,4295,111"/>
<area shape="poly" title=" " alt="" coords="3136,17,3316,19,3565,27,3851,45,3997,59,4140,76,4166,81,4166,86,4140,81,3997,64,3851,50,3565,33,3316,24,3136,22"/>
<area shape="rect" title=" " alt="" coords="4319,86,4545,111"/>
<area shape="poly" title=" " alt="" coords="3136,18,3341,22,3631,32,3967,49,4308,76,4351,81,4351,87,4308,81,3966,54,3631,37,3340,27,3136,23"/>
<area shape="rect" title=" " alt="" coords="4569,79,4767,119"/>
<area shape="poly" title=" " alt="" coords="3136,16,3374,18,3723,25,4133,43,4346,57,4555,76,4555,81,4345,63,4133,48,3723,30,3374,23,3136,22"/>
<area shape="rect" title=" " alt="" coords="4791,86,4974,111"/>
<area shape="poly" title=" " alt="" coords="3136,18,3946,36,4427,53,4628,64,4780,76,4815,81,4815,86,4780,81,4628,69,4427,58,3946,41,3136,23"/>
<area shape="rect" title=" " alt="" coords="4999,86,5196,111"/>
<area shape="poly" title=" " alt="" coords="3136,18,4042,35,4587,52,4815,63,4987,76,5026,81,5025,86,4986,81,4814,69,4587,57,4042,40,3136,23"/>
<area shape="rect" title=" " alt="" coords="5221,86,5422,111"/>
<area shape="poly" title=" " alt="" coords="3136,17,4144,33,4757,51,5014,62,5208,76,5249,81,5248,86,5208,81,5014,68,4757,56,4143,38,3136,23"/>
<area shape="rect" title=" " alt="" coords="5447,86,5537,111"/>
<area shape="poly" title=" " alt="" coords="3136,17,3626,22,4344,33,5033,51,5286,62,5435,76,5450,79,5449,85,5434,81,5285,68,5033,56,4344,38,3626,28,3136,23"/>
<area shape="rect" title=" " alt="" coords="5561,86,5780,111"/>
<area shape="poly" title=" " alt="" coords="3136,17,3601,21,4299,31,5020,49,5322,61,5550,76,5594,81,5594,87,5549,81,5321,67,5019,54,4299,37,3601,27,3135,23"/>
<area shape="rect" title=" " alt="" coords="5805,86,5939,111"/>
<area shape="poly" title=" " alt="" coords="3136,17,4521,36,5323,53,5618,64,5792,76,5818,80,5817,86,5792,81,5618,69,5323,58,4521,41,3136,23"/>
<area shape="rect" title=" " alt="" coords="5963,86,6061,111"/>
<area shape="poly" title=" " alt="" coords="3136,17,3720,20,4601,30,5453,48,5767,60,5879,68,5952,76,5969,80,5968,85,5952,81,5878,73,5767,66,5453,53,4601,35,3720,26,3136,22"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a451a80b0b5add51ef44028dd0fe41c45" id="r_a451a80b0b5add51ef44028dd0fe41c45"><td class="memTemplParams" colspan="2">template&lt;typename Scalar &gt; </td></tr>
<tr class="memitem:a451a80b0b5add51ef44028dd0fe41c45"><td class="memTemplItemLeft" align="right" valign="top">const Scalar&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="example__CVFEM_8cpp.html#a451a80b0b5add51ef44028dd0fe41c45">exactSolution</a> (const Scalar &amp;x, const Scalar &amp;y)</td></tr>
<tr class="memdesc:a451a80b0b5add51ef44028dd0fe41c45"><td class="mdescLeft">&#160;</td><td class="mdescRight">User-defined exact solution.  <br /></td></tr>
<tr class="separator:a451a80b0b5add51ef44028dd0fe41c45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0989fda2e32dc35e7d4911a44b1399fc" id="r_a0989fda2e32dc35e7d4911a44b1399fc"><td class="memTemplParams" colspan="2">template&lt;typename Scalar &gt; </td></tr>
<tr class="memitem:a0989fda2e32dc35e7d4911a44b1399fc"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="example__CVFEM_8cpp.html#a0989fda2e32dc35e7d4911a44b1399fc">advectionVelocity</a> (Scalar advVel[2], const Scalar &amp;x, const Scalar &amp;y, const std::string problem)</td></tr>
<tr class="memdesc:a0989fda2e32dc35e7d4911a44b1399fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">User-defined advection velocity.  <br /></td></tr>
<tr class="separator:a0989fda2e32dc35e7d4911a44b1399fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6761b16d69a046ea8f128379e9094be8" id="r_a6761b16d69a046ea8f128379e9094be8"><td class="memTemplParams" colspan="2">template&lt;typename Scalar1 , typename Scalar2 &gt; </td></tr>
<tr class="memitem:a6761b16d69a046ea8f128379e9094be8"><td class="memTemplItemLeft" align="right" valign="top">const Scalar1&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="example__CVFEM_8cpp.html#a6761b16d69a046ea8f128379e9094be8">diffusivity</a> (const Scalar1 &amp;x, const Scalar1 &amp;y, const Scalar2 &amp;epsilon, const bool variableEpsilon)</td></tr>
<tr class="memdesc:a6761b16d69a046ea8f128379e9094be8"><td class="mdescLeft">&#160;</td><td class="mdescRight">User-defined diffusivity.  <br /></td></tr>
<tr class="separator:a6761b16d69a046ea8f128379e9094be8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39ad6b00a882135f38e06d1fe79d5b37" id="r_a39ad6b00a882135f38e06d1fe79d5b37"><td class="memTemplParams" colspan="2">template&lt;typename Scalar &gt; </td></tr>
<tr class="memitem:a39ad6b00a882135f38e06d1fe79d5b37"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="example__CVFEM_8cpp.html#a39ad6b00a882135f38e06d1fe79d5b37">exactSolutionGrad</a> (Scalar gradExact[2], const Scalar &amp;x, const Scalar &amp;y)</td></tr>
<tr class="memdesc:a39ad6b00a882135f38e06d1fe79d5b37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes gradient of the exact solution. Requires user-defined exact solution.  <br /></td></tr>
<tr class="separator:a39ad6b00a882135f38e06d1fe79d5b37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a359f364128be76b2e00b4b309bae4f1f" id="r_a359f364128be76b2e00b4b309bae4f1f"><td class="memTemplParams" colspan="2">template&lt;typename Scalar1 , typename Scalar2 &gt; </td></tr>
<tr class="memitem:a359f364128be76b2e00b4b309bae4f1f"><td class="memTemplItemLeft" align="right" valign="top">const Scalar1&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="example__CVFEM_8cpp.html#a359f364128be76b2e00b4b309bae4f1f">sourceTerm</a> (Scalar1 &amp;x, Scalar1 &amp;y, Scalar2 &amp;epsilon, const bool variableEpsilon, const std::string problem)</td></tr>
<tr class="memdesc:a359f364128be76b2e00b4b309bae4f1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes source term: f = -div(J_n). Requires user-defined exact solution and material parameters.  <br /></td></tr>
<tr class="separator:a359f364128be76b2e00b4b309bae4f1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1618d152ee05bde4c0e26519eacf14e" id="r_af1618d152ee05bde4c0e26519eacf14e"><td class="memTemplParams" colspan="2">template&lt;class ArrayOut , class ArrayIn &gt; </td></tr>
<tr class="memitem:af1618d152ee05bde4c0e26519eacf14e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="example__CVFEM_8cpp.html#af1618d152ee05bde4c0e26519eacf14e">evaluateExactSolution</a> (ArrayOut &amp;exactSolutionValues, const ArrayIn &amp;evaluationPoints)</td></tr>
<tr class="memdesc:af1618d152ee05bde4c0e26519eacf14e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computation of the exact solution at array of points in physical space.  <br /></td></tr>
<tr class="separator:af1618d152ee05bde4c0e26519eacf14e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf5fe8202359578160eb300c38b0db0e" id="r_aaf5fe8202359578160eb300c38b0db0e"><td class="memTemplParams" colspan="2">template&lt;class ArrayOut , class ArrayIn &gt; </td></tr>
<tr class="memitem:aaf5fe8202359578160eb300c38b0db0e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="example__CVFEM_8cpp.html#aaf5fe8202359578160eb300c38b0db0e">evaluateExactSolutionGrad</a> (ArrayOut &amp;exactSolutionGradValues, const ArrayIn &amp;evaluationPoints)</td></tr>
<tr class="memdesc:aaf5fe8202359578160eb300c38b0db0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computation of the gradient of the exact solution at array of points in physical space.  <br /></td></tr>
<tr class="separator:aaf5fe8202359578160eb300c38b0db0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ea20da6c3ee648be291829d47fbf25c" id="r_a8ea20da6c3ee648be291829d47fbf25c"><td class="memTemplParams" colspan="2">template&lt;class ArrayOut1 , class ArrayOut2 , class Scalar &gt; </td></tr>
<tr class="memitem:a8ea20da6c3ee648be291829d47fbf25c"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="example__CVFEM_8cpp.html#a8ea20da6c3ee648be291829d47fbf25c">createMesh</a> (ArrayOut1 &amp;elemToNode, ArrayOut2 &amp;nodeCoords, ArrayOut1 &amp;bcLeftId, ArrayOut1 &amp;bcRightId, ArrayOut1 &amp;bcTopId, ArrayOut1 &amp;bcBotId, const std::string &amp;meshType, const Scalar &amp;meshSize)</td></tr>
<tr class="memdesc:a8ea20da6c3ee648be291829d47fbf25c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create quadrilateral or triangle mesh on the domain [0,1]x[0,1].  <br /></td></tr>
<tr class="separator:a8ea20da6c3ee648be291829d47fbf25c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97" id="r_a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top"><a id="a0ddf1224851353fc92bfbff6f499fa97" name="a0ddf1224851353fc92bfbff6f499fa97"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>main</b> (int argc, char *argv[])</td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Example solution of an Advection Diffusion equation on a quadrilateral or triangular mesh using the CVFEM. </p>
<pre class="fragment"> Advection diffusion system:

      - div (epsilon grad phi - u phi) = f in Omega
                                   phi = g on Gamma

   where
         u is the advection velocity
         epsilon is the diffusion coefficient
         f is a given source term


 Corresponding discrete linear system for nodal coefficients(x):

             Kx = b

        K - HGrad stiffness matrix
        b - right hand side vector</pre><dl class="section author"><dt>Author</dt><dd>K. Peterson</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>Usage: <div class="fragment"><div class="line">./TrilinosCouplings_Example_CVFEM.exe &lt;input.xml&gt;  </div>
</div><!-- fragment --></dd>
<dd>
Example requires an xml input file with mesh and solver settings.</dd></dl>
<p>NOTE: This problem does not currently work on more than one core (<a href="#" onclick="location.href='mai'+'lto:'+'csi'+'ef'+'er@'+'sa'+'ndi'+'a.'+'gov'; return false;">csief<span class="obfuscator">.nosp@m.</span>er@s<span class="obfuscator">.nosp@m.</span>andia<span class="obfuscator">.nosp@m.</span>.gov</a> 3/17/16) </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a0989fda2e32dc35e7d4911a44b1399fc" name="a0989fda2e32dc35e7d4911a44b1399fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0989fda2e32dc35e7d4911a44b1399fc">&#9670;&#160;</a></span>advectionVelocity()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Scalar &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void advectionVelocity </td>
          <td>(</td>
          <td class="paramtype">Scalar&#160;</td>
          <td class="paramname"><em>advVel</em>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Scalar &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Scalar &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>problem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>User-defined advection velocity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">advVel</td><td>[out] advection velocity evaluated at (x,y) </td></tr>
    <tr><td class="paramname">x</td><td>[in] x-coordinate of the evaluation point </td></tr>
    <tr><td class="paramname">y</td><td>[in] y-coordinate of the evaluation point </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">Referenced by <a class="el" href="example__CVFEM_8cpp.html#a359f364128be76b2e00b4b309bae4f1f">sourceTerm()</a>.</p>

</div>
</div>
<a id="a8ea20da6c3ee648be291829d47fbf25c" name="a8ea20da6c3ee648be291829d47fbf25c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ea20da6c3ee648be291829d47fbf25c">&#9670;&#160;</a></span>createMesh()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ArrayOut1 , class ArrayOut2 , class Scalar &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void createMesh </td>
          <td>(</td>
          <td class="paramtype">ArrayOut1 &amp;&#160;</td>
          <td class="paramname"><em>elemToNode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ArrayOut2 &amp;&#160;</td>
          <td class="paramname"><em>nodeCoords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ArrayOut1 &amp;&#160;</td>
          <td class="paramname"><em>bcLeftId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ArrayOut1 &amp;&#160;</td>
          <td class="paramname"><em>bcRightId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ArrayOut1 &amp;&#160;</td>
          <td class="paramname"><em>bcTopId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ArrayOut1 &amp;&#160;</td>
          <td class="paramname"><em>bcBotId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>meshType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Scalar &amp;&#160;</td>
          <td class="paramname"><em>meshSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create quadrilateral or triangle mesh on the domain [0,1]x[0,1]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">elemToNode</td><td>[out] Array with element to node mapping </td></tr>
    <tr><td class="paramname">nodeCoords</td><td>[out] Array with nodal coordinates </td></tr>
    <tr><td class="paramname">bcLeftId</td><td>[out] Array with ids of left boundary nodes, </td></tr>
    <tr><td class="paramname">bcRightId</td><td>[out] Array with ids of right boundary nodes </td></tr>
    <tr><td class="paramname">bcTopId</td><td>[out] Array with ids of top boundary nodes </td></tr>
    <tr><td class="paramname">bcBotId</td><td>[out] Array with ids of bottom boundary nodes </td></tr>
    <tr><td class="paramname">meshType</td><td>[in] Mesh type (quad or tri) </td></tr>
    <tr><td class="paramname">meshSize</td><td>[in] Number of elements in each direction </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6761b16d69a046ea8f128379e9094be8" name="a6761b16d69a046ea8f128379e9094be8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6761b16d69a046ea8f128379e9094be8">&#9670;&#160;</a></span>diffusivity()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Scalar1 , typename Scalar2 &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const Scalar1 diffusivity </td>
          <td>(</td>
          <td class="paramtype">const Scalar1 &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Scalar1 &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Scalar2 &amp;&#160;</td>
          <td class="paramname"><em>epsilon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>variableEpsilon</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>User-defined diffusivity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>[in] x-coordinate of the evaluation point </td></tr>
    <tr><td class="paramname">y</td><td>[in] y-coordinate of the evaluation point </td></tr>
    <tr><td class="paramname">epsilon</td><td>[in] diffusion coefficient from xml imput file</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Value of the diffusivity at (x,y) </dd></dl>

<p class="reference">Referenced by <a class="el" href="example__CVFEM_8cpp.html#a359f364128be76b2e00b4b309bae4f1f">sourceTerm()</a>.</p>

</div>
</div>
<a id="af1618d152ee05bde4c0e26519eacf14e" name="af1618d152ee05bde4c0e26519eacf14e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1618d152ee05bde4c0e26519eacf14e">&#9670;&#160;</a></span>evaluateExactSolution()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ArrayOut , class ArrayIn &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void evaluateExactSolution </td>
          <td>(</td>
          <td class="paramtype">ArrayOut &amp;&#160;</td>
          <td class="paramname"><em>exactSolutionValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ArrayIn &amp;&#160;</td>
          <td class="paramname"><em>evaluationPoints</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computation of the exact solution at array of points in physical space. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exactSolutionValues</td><td>[out] Rank-2 (C,P) array with the values of the exact solution </td></tr>
    <tr><td class="paramname">evaluationPoints</td><td>[in] Rank-3 (C,P,D) array with the evaluation points in physical frame </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aaf5fe8202359578160eb300c38b0db0e" name="aaf5fe8202359578160eb300c38b0db0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf5fe8202359578160eb300c38b0db0e">&#9670;&#160;</a></span>evaluateExactSolutionGrad()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ArrayOut , class ArrayIn &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void evaluateExactSolutionGrad </td>
          <td>(</td>
          <td class="paramtype">ArrayOut &amp;&#160;</td>
          <td class="paramname"><em>exactSolutionGradValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ArrayIn &amp;&#160;</td>
          <td class="paramname"><em>evaluationPoints</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computation of the gradient of the exact solution at array of points in physical space. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exactSolutionGradValues</td><td>[out] Rank-3 (C,P,D) array with the values of the gradient of the exact solution </td></tr>
    <tr><td class="paramname">evaluationPoints</td><td>[in] Rank-3 (C,P,D) array with the evaluation points in physical frame </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a451a80b0b5add51ef44028dd0fe41c45" name="a451a80b0b5add51ef44028dd0fe41c45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a451a80b0b5add51ef44028dd0fe41c45">&#9670;&#160;</a></span>exactSolution()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Scalar &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const Scalar exactSolution </td>
          <td>(</td>
          <td class="paramtype">const Scalar &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Scalar &amp;&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>User-defined exact solution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>[in] x-coordinate of the evaluation point </td></tr>
    <tr><td class="paramname">y</td><td>[in] y-coordinate of the evaluation point</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Value of the exact solution at (x,y) </dd></dl>

<p class="reference">Referenced by <a class="el" href="example__CVFEM_8cpp.html#a39ad6b00a882135f38e06d1fe79d5b37">exactSolutionGrad()</a>, and <a class="el" href="example__CVFEM_8cpp.html#a359f364128be76b2e00b4b309bae4f1f">sourceTerm()</a>.</p>

</div>
</div>
<a id="a39ad6b00a882135f38e06d1fe79d5b37" name="a39ad6b00a882135f38e06d1fe79d5b37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39ad6b00a882135f38e06d1fe79d5b37">&#9670;&#160;</a></span>exactSolutionGrad()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Scalar &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void exactSolutionGrad </td>
          <td>(</td>
          <td class="paramtype">Scalar&#160;</td>
          <td class="paramname"><em>gradExact</em>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Scalar &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Scalar &amp;&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes gradient of the exact solution. Requires user-defined exact solution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gradExact</td><td>[out] gradient of the exact solution evaluated at (x,y) </td></tr>
    <tr><td class="paramname">x</td><td>[in] x-coordinate of the evaluation point </td></tr>
    <tr><td class="paramname">y</td><td>[in] y-coordinate of the evaluation point </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="example__CVFEM_8cpp.html#a451a80b0b5add51ef44028dd0fe41c45">exactSolution()</a>.</p>

<p class="reference">Referenced by <a class="el" href="example__CVFEM_8cpp.html#a359f364128be76b2e00b4b309bae4f1f">sourceTerm()</a>.</p>

</div>
</div>
<a id="a359f364128be76b2e00b4b309bae4f1f" name="a359f364128be76b2e00b4b309bae4f1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a359f364128be76b2e00b4b309bae4f1f">&#9670;&#160;</a></span>sourceTerm()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Scalar1 , typename Scalar2 &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const Scalar1 sourceTerm </td>
          <td>(</td>
          <td class="paramtype">Scalar1 &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar1 &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar2 &amp;&#160;</td>
          <td class="paramname"><em>epsilon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>variableEpsilon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>problem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes source term: f = -div(J_n). Requires user-defined exact solution and material parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>[in] x-coordinate of the evaluation point </td></tr>
    <tr><td class="paramname">y</td><td>[in] y-coordinate of the evaluation point </td></tr>
    <tr><td class="paramname">epsilon</td><td>[in] diffusion coefficient</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Source term corresponding to the user-defined exact solution evaluated at (x,y) </dd></dl>

<p class="reference">References <a class="el" href="example__CVFEM_8cpp.html#a0989fda2e32dc35e7d4911a44b1399fc">advectionVelocity()</a>, <a class="el" href="example__CVFEM_8cpp.html#a6761b16d69a046ea8f128379e9094be8">diffusivity()</a>, <a class="el" href="example__CVFEM_8cpp.html#a451a80b0b5add51ef44028dd0fe41c45">exactSolution()</a>, and <a class="el" href="example__CVFEM_8cpp.html#a39ad6b00a882135f38e06d1fe79d5b37">exactSolutionGrad()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 9 2025 21:01:06 for TrilinosCouplings by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
