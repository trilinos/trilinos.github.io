<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IFPACK: General description of incomplete factorizations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">IFPACK<span id="projectnumber">&#160;Development</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">General description of incomplete factorizations</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The IFPACK incomplete factorizations (IC, ICT, ILU, ILUT) compute a "Relaxed" LDL^T or ILU factorization of a given <a class="elRef" href="../../../epetra/doc/html/classEpetra__RowMatrix.html">Epetra_RowMatrix</a>. The factorization that is produced is a function of several parameters.</p>
<ol>
<li>
<p class="startli">The pattern of the matrix (for <a class="el" href="classIfpack__IC.html" title="Ifpack_IC: A class for constructing and using an incomplete Cholesky factorization of a given Epetra_...">Ifpack_IC</a> and <a class="el" href="classIfpack__ILU.html" title="Ifpack_ILU: A class for constructing and using an incomplete lower/upper (ILU) factorization of a giv...">Ifpack_ILU</a>) - All fill is derived from the original matrix nonzero structure. Level zero fill is defined as the original matrix pattern (nonzero structure), even if the matrix value at an entry is stored as a zero. (Thus it is possible to add entries to the ILU factors by adding zero entries the original matrix.)</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Level of fill (for <a class="el" href="classIfpack__IC.html" title="Ifpack_IC: A class for constructing and using an incomplete Cholesky factorization of a given Epetra_...">Ifpack_IC</a> and <a class="el" href="classIfpack__ILU.html" title="Ifpack_ILU: A class for constructing and using an incomplete lower/upper (ILU) factorization of a giv...">Ifpack_ILU</a>) - (integer value) Starting with the original matrix pattern as level fill of zero, the next level of fill is determined by analyzing the graph of the previous level and determining nonzero fill that is a result of combining entries that were from previous level only (not the current level). This rule limits fill to entries that are direct decendents from the previous level graph. Fill for level k is determined by applying this rule recursively. For sufficiently large values of k, the fill would eventually be complete and an exact LU factorization would be computed. object.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Level of fill (for <a class="el" href="classIfpack__ICT.html" title="Ifpack_ICT: A class for constructing and using an incomplete Cholesky factorization of a given Epetra...">Ifpack_ICT</a> and <a class="el" href="classIfpack__ILUT.html" title="Ifpack_ILUT: A class for constructing and using an incomplete LU factorization of a given Epetra_RowM...">Ifpack_ILUT</a>) - (double value) During the factorization, a complete row of the factors is computed, then only the fill-in-value * nonzeros-in-row elements with largest magnitude are kept (fill-in-value is the specified level of fill, and nonzeros-in-row is the number of nonzeros in the original matrix nonzero structure).</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Drop tolerance (for <a class="el" href="classIfpack__ICT.html" title="Ifpack_ICT: A class for constructing and using an incomplete Cholesky factorization of a given Epetra...">Ifpack_ICT</a> and <a class="el" href="classIfpack__ILUT.html" title="Ifpack_ILUT: A class for constructing and using an incomplete LU factorization of a given Epetra_RowM...">Ifpack_ILUT</a>) - (double value) Entries with magnitude less than the drop tolerance will be dropped. <a class="el" href="classIfpack.html" title="Ifpack: a function class to define Ifpack preconditioners.">Ifpack</a> may perform this dropping on the original matrix A instead of the factors L and U. Thus, <a class="el" href="classIfpack__ILUT.html" title="Ifpack_ILUT: A class for constructing and using an incomplete LU factorization of a given Epetra_RowM...">Ifpack_ILUT</a> will give a slightly different preconditioner than the standard ILUT.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Fraction of relaxation - <a class="el" href="classIfpack__ILU.html" title="Ifpack_ILU: A class for constructing and using an incomplete lower/upper (ILU) factorization of a giv...">Ifpack_ILU</a> computes the ILU factorization row-by-row. As entries at a given row are computed, some number of them will be dropped because they do match the prescribed sparsity pattern. The relaxation factor determines how these dropped values will be handled. If the RelaxValue is zero, then these extra entries will by dropped. This is a classical ILU approach. If the RelaxValue is 1, then the sum of the extra entries will be added to the diagonal. This is a classical Modified ILU (MILU) approach. If RelaxValue is between 0 and 1, then RelaxValue times the sum of extra entries will be added to the diagonal.</p>
<p class="interli">For most situations, RelaxValue should be set to zero. For certain kinds of problems, e.g., reservoir modeling, there is a conservation principle involved such that any operator should obey a zero row-sum property. MILU was designed for these cases and you should set the RelaxValue to 1. For other situations, setting RelaxValue to some nonzero value may improve the stability of factorization, and can be used if the computed ILU factors are poorly conditioned.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Diagonal perturbation - Prior to computing the factorization, it is possible to modify the diagonal entries of the matrix for which the factorization will be computing. If the absolute and relative perturbation values are zero and one, respectively, the factorization will be compute for the original user matrix A. Otherwise, the factorization will computed for a matrix that differs from the original user matrix in the diagonal values only. More details can be found below.</p>
<p class="interli">Given the above method to estimate the conditioning of the incomplete factors, if we detect that our factorization is too ill-conditioned we can improve the conditioning by perturbing the matrix diagonal and restarting the factorization using this more diagonally dominant matrix. In order to apply perturbation, prior to starting the factorization, we compute a diagonal perturbation of our matrix \(A\) and perform the factorization on this perturbed matrix. The overhead cost of perturbing the diagonal is minimal since the first step in computing the incomplete factors is to copy the matrix \(A\) into the memory space for the incomplete factors. We simply compute the perturbed diagonal at this point. The actual perturbation values we use are the diagonal values \((d_1, d_2, \ldots, d_n)\) with \(d_i = \rho sgn(d_i)\alpha + d_i\rho\), \(i=1, 2, \ldots, n\), where \(n\) is the matrix dimension and \(sgn(d_i)\) returns the sign of the diagonal entry. This has the effect of forcing the diagonal values to have minimal magnitude of \(\alpha\) and to increase each by an amount proportional to \(\rho\), and still keep the sign of the original diagonal entry.</p>
<p class="endli"></p>
</li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 9 2025 20:38:00 for IFPACK by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
