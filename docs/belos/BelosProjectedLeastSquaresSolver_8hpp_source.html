<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Belos: BelosProjectedLeastSquaresSolver.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Belos<span id="projectnumber">&#160;Version of the Day</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">BelosProjectedLeastSquaresSolver.hpp</div></div>
</div><!--header-->
<div class="contents">
<a href="BelosProjectedLeastSquaresSolver_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// @HEADER</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">// *****************************************************************************</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">//                 Belos: Block Linear Solvers Package</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">//</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">// Copyright 2004-2016 NTESS and the Belos contributors.</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">// SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">// *****************************************************************************</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">// @HEADER</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span> </div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#ifndef __Belos_ProjectedLeastSquaresSolver_hpp</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#define __Belos_ProjectedLeastSquaresSolver_hpp</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span> </div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &quot;<a class="code" href="BelosConfigDefs_8hpp.html">BelosConfigDefs.hpp</a>&quot;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &quot;<a class="code" href="BelosTypes_8hpp.html">BelosTypes.hpp</a>&quot;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &quot;Teuchos_Array.hpp&quot;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &quot;Teuchos_BLAS.hpp&quot;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &quot;Teuchos_LAPACK.hpp&quot;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &quot;Teuchos_oblackholestream.hpp&quot;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &quot;Teuchos_ScalarTraits.hpp&quot;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &quot;Teuchos_SerialDenseMatrix.hpp&quot;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &quot;Teuchos_StandardParameterEntryValidators.hpp&quot;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span> </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span> </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespaceBelos.html">Belos</a> {</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span> </div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>  <span class="keyword">namespace </span><a class="code hl_namespace" href="namespacedetails.html">details</a> {</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span> </div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>    <span class="comment">// Anonymous namespace restricts contents to file scope.</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>    <span class="keyword">namespace </span>{</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>      <span class="keyword">template</span>&lt;<span class="keyword">class</span> Scalar&gt;</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>      <span class="keywordtype">void</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>      printMatrix (std::ostream&amp; out,</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>                   <span class="keyword">const</span> std::string&amp; name,</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>                   <span class="keyword">const</span> Teuchos::SerialDenseMatrix&lt;int, Scalar&gt;&amp; A)</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>      {</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>        <span class="keyword">using </span>std::endl;</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span> </div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> numRows = A.numRows();</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> numCols = A.numCols();</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span> </div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>        out &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; endl &lt;&lt; <span class="charliteral">&#39;[&#39;</span>;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>        <span class="keywordflow">if</span> (numCols == 1) {</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>          <span class="comment">// Compact form for column vectors; valid Matlab.</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numRows; ++i) {</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>            out &lt;&lt; A(i,0);</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>            <span class="keywordflow">if</span> (i &lt; numRows-1) {</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>              out &lt;&lt; <span class="stringliteral">&quot;; &quot;</span>;</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>            }</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>          }</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numRows; ++i) {</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; numCols; ++j) {</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>              out &lt;&lt; A(i,j);</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>              <span class="keywordflow">if</span> (j &lt; numCols-1) {</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>                out &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>              } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &lt; numRows-1) {</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>                out &lt;&lt; <span class="charliteral">&#39;;&#39;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>              }</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>            }</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>          }</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>        }</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>        out &lt;&lt; <span class="charliteral">&#39;]&#39;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>      }</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span> </div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>      <span class="keyword">template</span>&lt;<span class="keyword">class</span> Scalar&gt;</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>      <span class="keywordtype">void</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>      print (std::ostream&amp; out,</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>             <span class="keyword">const</span> Teuchos::SerialDenseMatrix&lt;int, Scalar&gt;&amp; A,</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>             <span class="keyword">const</span> std::string&amp; linePrefix)</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>      {</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>        <span class="keyword">using </span>std::endl;</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span> </div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> numRows = A.numRows();</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> numCols = A.numCols();</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span> </div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>        out &lt;&lt; linePrefix &lt;&lt; <span class="charliteral">&#39;[&#39;</span>;</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>        <span class="keywordflow">if</span> (numCols == 1) {</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>          <span class="comment">// Compact form for column vectors; valid Matlab.</span></div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numRows; ++i) {</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>            out &lt;&lt; A(i,0);</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>            <span class="keywordflow">if</span> (i &lt; numRows-1) {</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>              out &lt;&lt; <span class="stringliteral">&quot;; &quot;</span>;</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>            }</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>          }</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numRows; ++i) {</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; numCols; ++j) {</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>              <span class="keywordflow">if</span> (numRows &gt; 1) {</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>                out &lt;&lt; linePrefix &lt;&lt; <span class="stringliteral">&quot;  &quot;</span>;</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>              }</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>              out &lt;&lt; A(i,j);</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>              <span class="keywordflow">if</span> (j &lt; numCols-1) {</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>                out &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>              } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &lt; numRows-1) {</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>                out &lt;&lt; <span class="charliteral">&#39;;&#39;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>              }</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>            }</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>          }</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>        }</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>        out &lt;&lt; linePrefix &lt;&lt; <span class="charliteral">&#39;]&#39;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>      }</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>    } <span class="comment">// namespace (anonymous)</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span> </div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    <span class="keyword">template</span>&lt;<span class="keyword">class</span> Scalar&gt;</div>
<div class="foldopen" id="foldopen00127" data-start="{" data-end="};">
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html">  127</a></span>    <span class="keyword">class </span><a class="code hl_class" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html">ProjectedLeastSquaresProblem</a> {</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    <span class="keyword">public</span>:</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#ab71a50f286e258d8c2df88cba39d39ca">  131</a></span>      <span class="keyword">typedef</span> <a class="code hl_class" href="classBelos_1_1Operator.html">Scalar</a> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#ab71a50f286e258d8c2df88cba39d39ca">scalar_type</a>;</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a8e09cf6ea2e782fe8a3362fbc6b3b8ad">  134</a></span>      <span class="keyword">typedef</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::magnitudeType <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a8e09cf6ea2e782fe8a3362fbc6b3b8ad">magnitude_type</a>;</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span> </div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#aa736d8bbc3aad714ddb3c11a1c33d8c6">  143</a></span>      Teuchos::SerialDenseMatrix&lt;int,Scalar&gt; <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#aa736d8bbc3aad714ddb3c11a1c33d8c6">H</a>;</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span> </div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a595fefd7bec1c6bd5d06e997f4b5ee54">  156</a></span>      Teuchos::SerialDenseMatrix&lt;int,Scalar&gt; <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a595fefd7bec1c6bd5d06e997f4b5ee54">R</a>;</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span> </div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a03c4e75ac42c4459c52a07ca61e67f8b">  168</a></span>      Teuchos::SerialDenseMatrix&lt;int,Scalar&gt; <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a03c4e75ac42c4459c52a07ca61e67f8b">y</a>;</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span> </div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#ac33a0fe3de247c253c6a3ebaeac52137">  178</a></span>      Teuchos::SerialDenseMatrix&lt;int,Scalar&gt; <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#ac33a0fe3de247c253c6a3ebaeac52137">z</a>;</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span> </div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#acdde43030557f55687f17d04621aafb1">  189</a></span>      Teuchos::Array&lt;Scalar&gt; <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#acdde43030557f55687f17d04621aafb1">theCosines</a>;</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span> </div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#ad433f50d642093438c9547658c7643f7">  195</a></span>      Teuchos::Array&lt;Scalar&gt; <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#ad433f50d642093438c9547658c7643f7">theSines</a>;</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span> </div>
<div class="foldopen" id="foldopen00205" data-start="{" data-end="}">
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a9811a3cba918c4eb88df9aa15ef14bcc">  205</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a9811a3cba918c4eb88df9aa15ef14bcc">ProjectedLeastSquaresProblem</a> (<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>) :</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>        <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#aa736d8bbc3aad714ddb3c11a1c33d8c6">H</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>+1, <a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>),</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>        <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a595fefd7bec1c6bd5d06e997f4b5ee54">R</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>+1, <a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>),</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>        <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a03c4e75ac42c4459c52a07ca61e67f8b">y</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>+1, 1),</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>        <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#ac33a0fe3de247c253c6a3ebaeac52137">z</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>+1, 1),</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>        <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#acdde43030557f55687f17d04621aafb1">theCosines</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>+1),</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>        <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#ad433f50d642093438c9547658c7643f7">theSines</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>+1)</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>      {}</div>
</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span> </div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>      <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00233" data-start="{" data-end="}">
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#aad9c4e982451e86800680537c6fa379d">  233</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#aad9c4e982451e86800680537c6fa379d">reset</a> (<span class="keyword">const</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::magnitudeType beta)</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>      {</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>        <span class="keyword">typedef</span> Teuchos::ScalarTraits&lt;Scalar&gt; STS;</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span> </div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>        <span class="comment">// Zero out the right-hand side of the least-squares problem.</span></div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>        <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#ac33a0fe3de247c253c6a3ebaeac52137">z</a>.putScalar (STS::zero());</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span> </div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>        <span class="comment">// Promote the initial residual norm from a magnitude type to</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>        <span class="comment">// a scalar type, so we can assign it to the first entry of z.</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>        <span class="keyword">const</span> <a class="code hl_class" href="classBelos_1_1Operator.html">Scalar</a> <a class="code hl_class" href="classBelos_1_1Operator.html">initialResidualNorm</a> (beta);</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>        <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#ac33a0fe3de247c253c6a3ebaeac52137">z</a>(0,0) = <a class="code hl_class" href="classBelos_1_1Operator.html">initialResidualNorm</a>;</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>      }</div>
</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span> </div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>      <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00260" data-start="{" data-end="}">
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a218f467b5d8a31fc111a3e81290fefc0">  260</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a218f467b5d8a31fc111a3e81290fefc0">reallocateAndReset</a> (<span class="keyword">const</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::magnitudeType beta,</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>                          <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>)</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>      {</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>        <span class="keyword">typedef</span> Teuchos::ScalarTraits&lt;Scalar&gt; STS;</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>        <span class="keyword">typedef</span> Teuchos::ScalarTraits&lt;magnitude_type&gt; STM;</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span> </div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(beta &lt; STM::zero(), std::invalid_argument,</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>                           <span class="stringliteral">&quot;ProjectedLeastSquaresProblem::reset: initial &quot;</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>                           <span class="stringliteral">&quot;residual beta = &quot;</span> &lt;&lt; beta &lt;&lt; <span class="stringliteral">&quot; &lt; 0.&quot;</span>);</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a> &lt;= 0, std::invalid_argument,</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>                           <span class="stringliteral">&quot;ProjectedLeastSquaresProblem::reset: maximum number &quot;</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>                           <span class="stringliteral">&quot;of iterations &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a> &lt;&lt; <span class="stringliteral">&quot; &lt;= 0.&quot;</span>);</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span> </div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#aa736d8bbc3aad714ddb3c11a1c33d8c6">H</a>.numRows() &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>+1 || <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#aa736d8bbc3aad714ddb3c11a1c33d8c6">H</a>.numCols() &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>) {</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">errcode</a> = <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#aa736d8bbc3aad714ddb3c11a1c33d8c6">H</a>.reshape (<a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>+1, <a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>);</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">errcode</a> != 0, std::runtime_error,</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>                             <span class="stringliteral">&quot;Failed to reshape H into a &quot;</span> &lt;&lt; (<a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>+1)</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>                             &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a> &lt;&lt; <span class="stringliteral">&quot; matrix.&quot;</span>);</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>        }</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>        (<a class="code hl_class" href="classBelos_1_1Operator.html">void</a>) <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#aa736d8bbc3aad714ddb3c11a1c33d8c6">H</a>.putScalar (STS::zero());</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span> </div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a595fefd7bec1c6bd5d06e997f4b5ee54">R</a>.numRows() &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>+1 || <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a595fefd7bec1c6bd5d06e997f4b5ee54">R</a>.numCols() &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>) {</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">errcode</a> = <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a595fefd7bec1c6bd5d06e997f4b5ee54">R</a>.reshape (<a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>+1, <a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>);</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">errcode</a> != 0, std::runtime_error,</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>                             <span class="stringliteral">&quot;Failed to reshape R into a &quot;</span> &lt;&lt; (<a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>+1)</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>                             &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a> &lt;&lt; <span class="stringliteral">&quot; matrix.&quot;</span>);</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>        }</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>        (<a class="code hl_class" href="classBelos_1_1Operator.html">void</a>) <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a595fefd7bec1c6bd5d06e997f4b5ee54">R</a>.putScalar (STS::zero());</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span> </div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a03c4e75ac42c4459c52a07ca61e67f8b">y</a>.numRows() &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>+1 || <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a03c4e75ac42c4459c52a07ca61e67f8b">y</a>.numCols() &lt; 1) {</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">errcode</a> = <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a03c4e75ac42c4459c52a07ca61e67f8b">y</a>.reshape (<a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>+1, 1);</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">errcode</a> != 0, std::runtime_error,</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>                             <span class="stringliteral">&quot;Failed to reshape y into a &quot;</span> &lt;&lt; (<a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>+1)</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>                             &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot; matrix.&quot;</span>);</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>        }</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>        (<a class="code hl_class" href="classBelos_1_1Operator.html">void</a>) <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a03c4e75ac42c4459c52a07ca61e67f8b">y</a>.putScalar (STS::zero());</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span> </div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#ac33a0fe3de247c253c6a3ebaeac52137">z</a>.numRows() &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>+1 || <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#ac33a0fe3de247c253c6a3ebaeac52137">z</a>.numCols() &lt; 1) {</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">errcode</a> = <a class="code hl_variable" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#ac33a0fe3de247c253c6a3ebaeac52137">z</a>.reshape (<a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>+1, 1);</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">errcode</a> != 0, std::runtime_error,</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>                             <span class="stringliteral">&quot;Failed to reshape z into a &quot;</span> &lt;&lt; (<a class="code hl_class" href="classBelos_1_1Operator.html">maxNumIterations</a>+1)</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>                             &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot; matrix.&quot;</span>);</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>        }</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>        <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#aad9c4e982451e86800680537c6fa379d">reset</a> (beta);</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>      }</div>
</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span> </div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    };</div>
</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span> </div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span> </div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>    <span class="keyword">template</span>&lt;<span class="keyword">class</span> Scalar&gt;</div>
<div class="foldopen" id="foldopen00317" data-start="{" data-end="};">
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html">  317</a></span>    <span class="keyword">class </span><a class="code hl_class" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html">LocalDenseMatrixOps</a> {</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>    <span class="keyword">public</span>:</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#ad47d22f96d5d234cdb67bcfa7150ad4a">  321</a></span>      <span class="keyword">typedef</span> <a class="code hl_class" href="classBelos_1_1Operator.html">Scalar</a> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#ad47d22f96d5d234cdb67bcfa7150ad4a">scalar_type</a>;</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a900304936f47883a6fc3d2a0cff7059f">  324</a></span>      <span class="keyword">typedef</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::magnitudeType <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a900304936f47883a6fc3d2a0cff7059f">magnitude_type</a>;</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">  327</a></span>      <span class="keyword">typedef</span> Teuchos::SerialDenseMatrix&lt;int,Scalar&gt; <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>;</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span> </div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>    <span class="keyword">private</span>:</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>      <span class="keyword">typedef</span> Teuchos::ScalarTraits&lt;scalar_type&gt; STS;</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>      <span class="keyword">typedef</span> Teuchos::ScalarTraits&lt;magnitude_type&gt; STM;</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>      <span class="keyword">typedef</span> Teuchos::BLAS&lt;int, scalar_type&gt; blas_type;</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>      <span class="keyword">typedef</span> Teuchos::LAPACK&lt;int, scalar_type&gt; lapack_type;</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span> </div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    <span class="keyword">public</span>:</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>      <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00338" data-start="{" data-end="}">
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a2ae3df9261d1506caf172ecc2b4c2ca3">  338</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a2ae3df9261d1506caf172ecc2b4c2ca3">conjugateTranspose</a> (<a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A_star</a>, <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows(); ++<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>) {</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numCols(); ++<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>) {</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>            <a class="code hl_class" href="classBelos_1_1Operator.html">A_star</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>) = STS::conjugate (<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>));</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>          }</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>        }</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>      }</div>
</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span> </div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>      <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00349" data-start="{" data-end="}">
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a85e72fea03ba05ebd17e8de9d870d17d">  349</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a85e72fea03ba05ebd17e8de9d870d17d">conjugateTransposeOfUpperTriangular</a> (<a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">L</a>, <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; R)<span class="keyword"> const</span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">N</a> = R.numCols();</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span> </div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>; ++<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>) {</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> &lt;= <a class="code hl_class" href="classBelos_1_1Operator.html">j</a>; ++<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>) {</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>            <a class="code hl_class" href="classBelos_1_1Operator.html">L</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>) = STS::conjugate (R(<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>));</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>          }</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>        }</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>      }</div>
</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span> </div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>      <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00362" data-start="{" data-end="}">
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a4d69fff43e0ce49b4d6def139c2b527e">  362</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a4d69fff43e0ce49b4d6def139c2b527e">zeroOutStrictLowerTriangle</a> (<a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">N</a> = std::min (<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows(), <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numCols());</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span> </div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>; ++<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>) {</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">j</a>+1; <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows(); ++<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>) {</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>            <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>) = STS::zero();</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>          }</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>        }</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>      }</div>
</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span> </div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>      <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00382" data-start="{" data-end="}">
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a9a585a3ba38a6ebb1e3635b3fe7ba042">  382</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a9a585a3ba38a6ebb1e3635b3fe7ba042">partition</a> (Teuchos::RCP&lt;mat_type&gt;&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A_11</a>,</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>                 Teuchos::RCP&lt;mat_type&gt;&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A_21</a>,</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>                 Teuchos::RCP&lt;mat_type&gt;&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A_12</a>,</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>                 Teuchos::RCP&lt;mat_type&gt;&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A_22</a>,</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>                 <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>,</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>                 <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">numRows1</a>,</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>                 <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">numRows2</a>,</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>                 <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">numCols1</a>,</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>                 <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">numCols2</a>)</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>      {</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>        <span class="keyword">using </span>Teuchos::rcp;</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>        <span class="keyword">using </span>Teuchos::View;</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span> </div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">A_11</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">rcp</a> (<span class="keyword">new</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">View</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numRows1</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols1</a>, 0, 0));</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">A_21</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">rcp</a> (<span class="keyword">new</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">View</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numRows2</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols1</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numRows1</a>, 0));</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">A_12</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">rcp</a> (<span class="keyword">new</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">View</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numRows1</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols2</a>, 0, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols1</a>));</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">A_22</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">rcp</a> (<span class="keyword">new</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">View</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numRows2</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols2</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numRows1</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols1</a>));</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>      }</div>
</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span> </div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>      <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00403" data-start="{" data-end="}">
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a8ee9305483b5b55a10eeaf863c7b80b9">  403</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a8ee9305483b5b55a10eeaf863c7b80b9">matScale</a> (<a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>, <span class="keyword">const</span> <a class="code hl_class" href="classBelos_1_1Operator.html">scalar_type</a>&amp; alpha)<span class="keyword"> const</span></div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>        <span class="comment">// const int LDA = A.stride(); // unused</span></div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows();</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numCols();</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span> </div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a> == 0 || <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a> == 0) {</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>          <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>; ++<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>) {</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>            <a class="code hl_class" href="classBelos_1_1Operator.html">scalar_type</a>* <span class="keyword">const</span> <a class="code hl_class" href="classBelos_1_1Operator.html">A_j</a> = &amp;<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>(0,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>);</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span> </div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a>; ++<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>) {</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>              <a class="code hl_class" href="classBelos_1_1Operator.html">A_j</a>[<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>] *= alpha;</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>            }</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>          }</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>        }</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>      }</div>
</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span> </div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>      <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00427" data-start="{" data-end="}">
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#aa3c69a02923207f2da046ebca725deeb">  427</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#aa3c69a02923207f2da046ebca725deeb">axpy</a> (<a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; Y,</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>            <span class="keyword">const</span> <a class="code hl_class" href="classBelos_1_1Operator.html">scalar_type</a>&amp; alpha,</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a> = Y.numRows();</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a> = Y.numCols();</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span> </div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a> != <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numRows() || <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a> != <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numCols(),</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>                           std::invalid_argument, <span class="stringliteral">&quot;Dimensions of X and Y don&#39;t &quot;</span></div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>                           <span class="stringliteral">&quot;match.  X is &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numRows() &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numCols()</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>                           &lt;&lt; <span class="stringliteral">&quot;, and Y is &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a> &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>; ++<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>) {</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a>; ++<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>) {</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>            Y(<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>) += alpha * <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>);</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>          }</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>        }</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>      }</div>
</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span> </div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>      <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00447" data-start="{" data-end="}">
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a9b18be863fd7a37e12805b56c6a16186">  447</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a9b18be863fd7a37e12805b56c6a16186">matAdd</a> (<a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>, <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; B)<span class="keyword"> const</span></div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows();</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numCols();</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span> </div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>          B.numRows() != <a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a> || B.numCols() != <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>,</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>          std::invalid_argument,</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>          <span class="stringliteral">&quot;matAdd: The input matrices A and B have incompatible dimensions.  &quot;</span></div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>          <span class="stringliteral">&quot;A is &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a> &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a> &lt;&lt; <span class="stringliteral">&quot;, but B is &quot;</span> &lt;&lt;</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>          B.numRows () &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; B.numCols () &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a> == 0 || <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a> == 0) {</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>          <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>; ++<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>) {</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>            <a class="code hl_class" href="classBelos_1_1Operator.html">scalar_type</a>* <span class="keyword">const</span> <a class="code hl_class" href="classBelos_1_1Operator.html">A_j</a> = &amp;<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>(0,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>);</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>            <span class="keyword">const</span> <a class="code hl_class" href="classBelos_1_1Operator.html">scalar_type</a>* <span class="keyword">const</span> <a class="code hl_class" href="classBelos_1_1Operator.html">B_j</a> = &amp;B(0,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>);</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span> </div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a>; ++<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>) {</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>              <a class="code hl_class" href="classBelos_1_1Operator.html">A_j</a>[<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>] += <a class="code hl_class" href="classBelos_1_1Operator.html">B_j</a>[<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>];</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>            }</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>          }</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>        }</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>      }</div>
</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span> </div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>      <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00474" data-start="{" data-end="}">
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a346e571daaf8890c3b0078048b7c8b2c">  474</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a346e571daaf8890c3b0078048b7c8b2c">matSub</a> (<a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>, <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; B)<span class="keyword"> const</span></div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows();</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numCols();</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span> </div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>          B.numRows() != <a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a> || B.numCols() != <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>,</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>          std::invalid_argument,</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>          <span class="stringliteral">&quot;matSub: The input matrices A and B have incompatible dimensions.  &quot;</span></div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>          <span class="stringliteral">&quot;A is &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a> &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a> &lt;&lt; <span class="stringliteral">&quot;, but B is &quot;</span> &lt;&lt;</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>          B.numRows () &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; B.numCols () &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a> == 0 || <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a> == 0) {</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>          <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>; ++<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>) {</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>            <a class="code hl_class" href="classBelos_1_1Operator.html">scalar_type</a>* <span class="keyword">const</span> <a class="code hl_class" href="classBelos_1_1Operator.html">A_j</a> = &amp;<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>(0,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>);</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>            <span class="keyword">const</span> <a class="code hl_class" href="classBelos_1_1Operator.html">scalar_type</a>* <span class="keyword">const</span> <a class="code hl_class" href="classBelos_1_1Operator.html">B_j</a> = &amp;B(0,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>);</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span> </div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a>; ++<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>) {</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>              <a class="code hl_class" href="classBelos_1_1Operator.html">A_j</a>[<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>] -= <a class="code hl_class" href="classBelos_1_1Operator.html">B_j</a>[<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>];</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>            }</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>          }</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>        }</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>      }</div>
</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span> </div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>      <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00504" data-start="{" data-end="}">
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a1f7418279fcbc6e1691c315929411f35">  504</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a1f7418279fcbc6e1691c315929411f35">rightUpperTriSolve</a> (<a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; B,</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>                          <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; R)<span class="keyword"> const</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(B.numCols() != R.numRows(),</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>                           std::invalid_argument,</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>                           <span class="stringliteral">&quot;rightUpperTriSolve: R and B have incompatible &quot;</span></div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>                           <span class="stringliteral">&quot;dimensions.  B has &quot;</span> &lt;&lt; B.numCols() &lt;&lt; <span class="stringliteral">&quot; columns, &quot;</span></div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>                           <span class="stringliteral">&quot;but R has &quot;</span> &lt;&lt; R.numRows() &lt;&lt; <span class="stringliteral">&quot; rows.&quot;</span>);</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>        blas_type <a class="code hl_class" href="classBelos_1_1Operator.html">blas</a>;</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">blas</a>.TRSM (Teuchos::RIGHT_SIDE, Teuchos::UPPER_TRI,</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>                   Teuchos::NO_TRANS, Teuchos::NON_UNIT_DIAG,</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>                   R.numCols(), B.numCols(),</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>                   STS::one(), R.values(), R.stride(),</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>                   B.values(), B.stride());</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>      }</div>
</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span> </div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>      <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00526" data-start="{" data-end="}">
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#aba579c63d92058ea180ae3efd94e84fd">  526</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#aba579c63d92058ea180ae3efd94e84fd">matMatMult</a> (<span class="keyword">const</span> <a class="code hl_class" href="classBelos_1_1Operator.html">scalar_type</a>&amp; beta,</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>                  <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; C,</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>                  <span class="keyword">const</span> <a class="code hl_class" href="classBelos_1_1Operator.html">scalar_type</a>&amp; alpha,</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>                  <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>,</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>                  <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; B)<span class="keyword"> const</span></div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>        <span class="keyword">using </span>Teuchos::NO_TRANS;</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span> </div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numCols() != B.numRows(),</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>                           std::invalid_argument,</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>                           <span class="stringliteral">&quot;matMatMult: The input matrices A and B have &quot;</span></div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>                           <span class="stringliteral">&quot;incompatible dimensions.  A is &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows()</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>                           &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numCols() &lt;&lt; <span class="stringliteral">&quot;, but B is &quot;</span></div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>                           &lt;&lt; B.numRows() &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; B.numCols() &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows() != C.numRows(),</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>                           std::invalid_argument,</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>                           <span class="stringliteral">&quot;matMatMult: The input matrix A and the output &quot;</span></div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>                           <span class="stringliteral">&quot;matrix C have incompatible dimensions.  A has &quot;</span></div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>                           &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows() &lt;&lt; <span class="stringliteral">&quot; rows, but C has &quot;</span> &lt;&lt; C.numRows()</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>                           &lt;&lt; <span class="stringliteral">&quot; rows.&quot;</span>);</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(B.numCols() != C.numCols(),</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>                           std::invalid_argument,</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>                           <span class="stringliteral">&quot;matMatMult: The input matrix B and the output &quot;</span></div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>                           <span class="stringliteral">&quot;matrix C have incompatible dimensions.  B has &quot;</span></div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>                           &lt;&lt; B.numCols() &lt;&lt; <span class="stringliteral">&quot; columns, but C has &quot;</span></div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>                           &lt;&lt; C.numCols() &lt;&lt; <span class="stringliteral">&quot; columns.&quot;</span>);</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>        blas_type <a class="code hl_class" href="classBelos_1_1Operator.html">blas</a>;</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">blas</a>.GEMM (<a class="code hl_class" href="classBelos_1_1Operator.html">NO_TRANS</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">NO_TRANS</a>, C.numRows(), C.numCols(), <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numCols(),</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>                   alpha, <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.values(), <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.stride(), B.values(), B.stride(),</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>                   beta, C.values(), C.stride());</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>      }</div>
</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span> </div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>      <span class="keywordtype">int</span></div>
<div class="foldopen" id="foldopen00566" data-start="{" data-end="}">
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a61767554ecbd3da2331483d359e8350d">  566</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a61767554ecbd3da2331483d359e8350d">infNaNCount</a> (<span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>, <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_class" href="classBelos_1_1Operator.html">upperTriangular</a>=<span class="keyword">false</span>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>        <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">count</a> = 0;</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numCols(); ++<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>) {</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>          <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">upperTriangular</a>) {</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> &lt;= <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> &amp;&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows(); ++<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>) {</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>              <span class="keywordflow">if</span> (STS::isnaninf (<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>))) {</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>                ++<a class="code hl_class" href="classBelos_1_1Operator.html">count</a>;</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>              }</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>            }</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>          } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows(); ++<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>) {</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>              <span class="keywordflow">if</span> (STS::isnaninf (<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>))) {</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>                ++<a class="code hl_class" href="classBelos_1_1Operator.html">count</a>;</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>              }</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>            }</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>          }</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>        }</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classBelos_1_1Operator.html">count</a>;</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>      }</div>
</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span> </div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>      std::pair&lt;bool, std::pair&lt;magnitude_type, magnitude_type&gt; &gt;</div>
<div class="foldopen" id="foldopen00593" data-start="{" data-end="}">
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a6262f83f52467d059290462a060917cf">  593</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a6262f83f52467d059290462a060917cf">isUpperTriangular</a> (<span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a900304936f47883a6fc3d2a0cff7059f">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">lowerTri</a> = STM::zero();</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a900304936f47883a6fc3d2a0cff7059f">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">upperTri</a> = STM::zero();</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>        <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">count</a> = 0;</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span> </div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numCols(); ++<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>) {</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>          <span class="comment">// Compute the Frobenius norm of the upper triangle /</span></div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>          <span class="comment">// trapezoid of A.  The second clause of the loop upper</span></div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>          <span class="comment">// bound is for matrices with fewer rows than columns.</span></div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> &lt;= <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> &amp;&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows(); ++<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>) {</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a900304936f47883a6fc3d2a0cff7059f">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">A_ij_mag</a> = STS::magnitude (<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>));</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>            <a class="code hl_class" href="classBelos_1_1Operator.html">upperTri</a> += <a class="code hl_class" href="classBelos_1_1Operator.html">A_ij_mag</a> * <a class="code hl_class" href="classBelos_1_1Operator.html">A_ij_mag</a>;</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>          }</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>          <span class="comment">// Scan the strict lower triangle / trapezoid of A.</span></div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">j</a>+1; <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows(); ++<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>) {</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a900304936f47883a6fc3d2a0cff7059f">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">A_ij_mag</a> = STS::magnitude (<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>));</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>            <a class="code hl_class" href="classBelos_1_1Operator.html">lowerTri</a> += <a class="code hl_class" href="classBelos_1_1Operator.html">A_ij_mag</a> * <a class="code hl_class" href="classBelos_1_1Operator.html">A_ij_mag</a>;</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">A_ij_mag</a> != STM::zero()) {</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>              ++<a class="code hl_class" href="classBelos_1_1Operator.html">count</a>;</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>            }</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>          }</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>        }</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>        <span class="keywordflow">return</span> std::make_pair (<a class="code hl_class" href="classBelos_1_1Operator.html">count</a> == 0, std::make_pair (<a class="code hl_class" href="classBelos_1_1Operator.html">lowerTri</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">upperTri</a>));</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>      }</div>
</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span> </div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span> </div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>      std::pair&lt;bool, std::pair&lt;magnitude_type, magnitude_type&gt; &gt;</div>
<div class="foldopen" id="foldopen00626" data-start="{" data-end="}">
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#ae0c3a8a562007a13f642aa8a29f9d204">  626</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#ae0c3a8a562007a13f642aa8a29f9d204">isUpperHessenberg</a> (<span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a900304936f47883a6fc3d2a0cff7059f">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">lower</a> = STM::zero();</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a900304936f47883a6fc3d2a0cff7059f">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">upper</a> = STM::zero();</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>        <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">count</a> = 0;</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span> </div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numCols(); ++<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>) {</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>          <span class="comment">// Compute the Frobenius norm of the upper Hessenberg part</span></div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>          <span class="comment">// of A.  The second clause of the loop upper bound is for</span></div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>          <span class="comment">// matrices with fewer rows than columns.</span></div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> &lt;= <a class="code hl_class" href="classBelos_1_1Operator.html">j</a>+1 &amp;&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows(); ++<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>) {</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a900304936f47883a6fc3d2a0cff7059f">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">A_ij_mag</a> = STS::magnitude (<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>));</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>            <a class="code hl_class" href="classBelos_1_1Operator.html">upper</a> += <a class="code hl_class" href="classBelos_1_1Operator.html">A_ij_mag</a> * <a class="code hl_class" href="classBelos_1_1Operator.html">A_ij_mag</a>;</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>          }</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>          <span class="comment">// Scan the strict lower part of A.</span></div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">j</a>+2; <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows(); ++<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>) {</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a900304936f47883a6fc3d2a0cff7059f">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">A_ij_mag</a> = STS::magnitude (<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>));</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>            <a class="code hl_class" href="classBelos_1_1Operator.html">lower</a> += <a class="code hl_class" href="classBelos_1_1Operator.html">A_ij_mag</a> * <a class="code hl_class" href="classBelos_1_1Operator.html">A_ij_mag</a>;</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">A_ij_mag</a> != STM::zero()) {</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>              ++<a class="code hl_class" href="classBelos_1_1Operator.html">count</a>;</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>            }</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>          }</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>        }</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>        <span class="keywordflow">return</span> std::make_pair (<a class="code hl_class" href="classBelos_1_1Operator.html">count</a> == 0, std::make_pair (<a class="code hl_class" href="classBelos_1_1Operator.html">lower</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">upper</a>));</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>      }</div>
</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span> </div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>      <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00659" data-start="{" data-end="}">
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#afa3f00c956143edb2a5a4b8d9e9fa1e7">  659</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#afa3f00c956143edb2a5a4b8d9e9fa1e7">ensureUpperTriangular</a> (<span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>,</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>                             <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> <a class="code hl_class" href="classBelos_1_1Operator.html">matrixName</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>        std::pair&lt;bool, std::pair&lt;magnitude_type, magnitude_type&gt; &gt; result =</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>          <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a6262f83f52467d059290462a060917cf">isUpperTriangular</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>);</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span> </div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(! result.first, std::invalid_argument,</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>                           <span class="stringliteral">&quot;The &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows() &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numCols()</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>                           &lt;&lt; <span class="stringliteral">&quot; matrix &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">matrixName</a> &lt;&lt; <span class="stringliteral">&quot; is not upper &quot;</span></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>                           <span class="stringliteral">&quot;triangular.  ||tril(A)||_F = &quot;</span></div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>                           &lt;&lt; result.second.first &lt;&lt; <span class="stringliteral">&quot; and ||A||_F = &quot;</span></div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>                           &lt;&lt; result.second.second &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>      }</div>
</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span> </div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>      <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00680" data-start="{" data-end="}">
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#af7a9c91468c269e10f2bb5101987f2bf">  680</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#af7a9c91468c269e10f2bb5101987f2bf">ensureUpperHessenberg</a> (<span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>,</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>                             <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> <a class="code hl_class" href="classBelos_1_1Operator.html">matrixName</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>        std::pair&lt;bool, std::pair&lt;magnitude_type, magnitude_type&gt; &gt; result =</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>          <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#ae0c3a8a562007a13f642aa8a29f9d204">isUpperHessenberg</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>);</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span> </div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(! result.first, std::invalid_argument,</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>                           <span class="stringliteral">&quot;The &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows() &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numCols()</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>                           &lt;&lt; <span class="stringliteral">&quot; matrix &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">matrixName</a> &lt;&lt; <span class="stringliteral">&quot; is not upper &quot;</span></div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>                           <span class="stringliteral">&quot;triangular.  ||tril(A(2:end, :))||_F = &quot;</span></div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>                           &lt;&lt; result.second.first &lt;&lt; <span class="stringliteral">&quot; and ||A||_F = &quot;</span></div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>                           &lt;&lt; result.second.second &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>      }</div>
</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span> </div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>      <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00710" data-start="{" data-end="}">
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a6b80f357230af3223a1c6ceabc02e572">  710</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a6b80f357230af3223a1c6ceabc02e572">ensureUpperHessenberg</a> (<span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>,</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>                             <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> <a class="code hl_class" href="classBelos_1_1Operator.html">matrixName</a>,</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>                             <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a900304936f47883a6fc3d2a0cff7059f">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">relativeTolerance</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>        std::pair&lt;bool, std::pair&lt;magnitude_type, magnitude_type&gt; &gt; result =</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>          <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#ae0c3a8a562007a13f642aa8a29f9d204">isUpperHessenberg</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>);</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span> </div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>        <span class="keywordflow">if</span> (result.first) {</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>          <span class="comment">// Mollified relative departure from upper Hessenberg.</span></div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a900304936f47883a6fc3d2a0cff7059f">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">err</a> = (result.second.second == STM::zero() ?</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>                                      result.second.first :</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>                                      result.second.first / result.second.second);</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">err</a> &gt; <a class="code hl_class" href="classBelos_1_1Operator.html">relativeTolerance</a>, std::invalid_argument,</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>                             <span class="stringliteral">&quot;The &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows() &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numCols()</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>                             &lt;&lt; <span class="stringliteral">&quot; matrix &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">matrixName</a> &lt;&lt; <span class="stringliteral">&quot; is not upper &quot;</span></div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>                             <span class="stringliteral">&quot;triangular.  ||tril(A(2:end, :))||_F &quot;</span></div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>                             &lt;&lt; (result.second.second == STM::zero() ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot; / ||A||_F&quot;</span>)</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>                             &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">err</a> &lt;&lt; <span class="stringliteral">&quot; &gt; &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">relativeTolerance</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>        }</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>      }</div>
</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span> </div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>      <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00743" data-start="{" data-end="}">
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#afebb4f3b204f6ac494db5c916690647c">  743</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#afebb4f3b204f6ac494db5c916690647c">ensureMinimumDimensions</a> (<span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>,</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>                               <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> <a class="code hl_class" href="classBelos_1_1Operator.html">matrixName</a>,</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>                               <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">minNumRows</a>,</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>                               <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">minNumCols</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows() &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">minNumRows</a> || <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numCols() &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">minNumCols</a>,</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>                           std::invalid_argument,</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>                           <span class="stringliteral">&quot;The matrix &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">matrixName</a> &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows()</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>                           &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numCols() &lt;&lt; <span class="stringliteral">&quot;, and therefore does not &quot;</span></div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>                           <span class="stringliteral">&quot;satisfy the minimum dimensions &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">minNumRows</a></div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>                           &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">minNumCols</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>      }</div>
</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span> </div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>      <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00768" data-start="{" data-end="}">
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#ae475da8666980270bf3ed5d1bb4af499">  768</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#ae475da8666980270bf3ed5d1bb4af499">ensureEqualDimensions</a> (<span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>,</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>                             <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> <a class="code hl_class" href="classBelos_1_1Operator.html">matrixName</a>,</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>                             <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a>,</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>                             <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span><span class="keyword">      </span>{</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows() != <a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a> || <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numCols() != <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>,</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>                           std::invalid_argument,</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>                           <span class="stringliteral">&quot;The matrix &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">matrixName</a> &lt;&lt; <span class="stringliteral">&quot; is supposed to be &quot;</span></div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>                           &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a> &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a> &lt;&lt; <span class="stringliteral">&quot;, but is &quot;</span></div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>                           &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows() &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numCols() &lt;&lt; <span class="stringliteral">&quot; instead.&quot;</span>);</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>      }</div>
</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span> </div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>    };</div>
</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span> </div>
<div class="foldopen" id="foldopen00800" data-start="{" data-end="};">
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno"><a class="line" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfe">  800</a></span>    <span class="keyword">enum</span> <a class="code hl_enumeration" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfe">ERobustness</a> {</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno"><a class="line" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea7c00a13d1ab30f47de58763504fd9d50">  801</a></span>      <a class="code hl_enumvalue" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea7c00a13d1ab30f47de58763504fd9d50">ROBUSTNESS_NONE</a>,</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno"><a class="line" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea4c0000ab10503cf9942a38072a6219d1">  802</a></span>      <a class="code hl_enumvalue" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea4c0000ab10503cf9942a38072a6219d1">ROBUSTNESS_SOME</a>,</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno"><a class="line" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea2837d067913425b6279342d1e0f405a2">  803</a></span>      <a class="code hl_enumvalue" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea2837d067913425b6279342d1e0f405a2">ROBUSTNESS_LOTS</a>,</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>      <a class="code hl_enumvalue" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfeaf78083034b642ee97afd4b87d313776e">ROBUSTNESS_INVALID</a></div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno"><a class="line" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfeaf78083034b642ee97afd4b87d313776e">  805</a></span>    };</div>
</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span> </div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>    <span class="keyword">inline</span> std::string</div>
<div class="foldopen" id="foldopen00809" data-start="{" data-end="}">
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno"><a class="line" href="namespaceBelos_1_1details.html#a9bbb015263348f701b5135eeeadfaf55">  809</a></span>    <a class="code hl_function" href="namespaceBelos_1_1details.html#a9bbb015263348f701b5135eeeadfaf55">robustnessEnumToString</a> (<span class="keyword">const</span> <a class="code hl_enumeration" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfe">ERobustness</a> <a class="code hl_class" href="classBelos_1_1Operator.html">x</a>)</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>    {</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code hl_class" href="classBelos_1_1Operator.html">strings</a>[] = {<span class="stringliteral">&quot;None&quot;</span>, <span class="stringliteral">&quot;Some&quot;</span>, <span class="stringliteral">&quot;Lots&quot;</span>};</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>      <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">x &lt; ROBUSTNESS_NONE || x &gt;</a>= <a class="code hl_enumvalue" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfeaf78083034b642ee97afd4b87d313776e">ROBUSTNESS_INVALID</a>,</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>                         std::invalid_argument,</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>                         <span class="stringliteral">&quot;Invalid enum value &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">x</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>      <span class="keywordflow">return</span> std::string (<a class="code hl_class" href="classBelos_1_1Operator.html">strings</a>[<a class="code hl_class" href="classBelos_1_1Operator.html">x</a>]);</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>    }</div>
</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span> </div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>    <a class="code hl_enumeration" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfe">ERobustness</a></div>
<div class="foldopen" id="foldopen00820" data-start="{" data-end="}">
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno"><a class="line" href="namespaceBelos_1_1details.html#a2b0edd0440b97b9e6dccb58dbe1a85f3">  820</a></span>    <span class="keyword">inline</span> <a class="code hl_function" href="namespaceBelos_1_1details.html#a2b0edd0440b97b9e6dccb58dbe1a85f3">robustnessStringToEnum</a> (<span class="keyword">const</span> std::string&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">x</a>)</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>    {</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>      <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code hl_class" href="classBelos_1_1Operator.html">strings</a>[] = {<span class="stringliteral">&quot;None&quot;</span>, <span class="stringliteral">&quot;Some&quot;</span>, <span class="stringliteral">&quot;Lots&quot;</span>};</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">r &lt; static_cast&lt;int&gt;</a> (<a class="code hl_enumvalue" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfeaf78083034b642ee97afd4b87d313776e">ROBUSTNESS_INVALID</a>); ++r) {</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">x</a> == <a class="code hl_class" href="classBelos_1_1Operator.html">strings</a>[r]) {</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>          <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfe">ERobustness</a><span class="keyword">&gt;</span> (r);</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>        }</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>      }</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>      <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<span class="keyword">true</span>, std::invalid_argument,</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>                         <span class="stringliteral">&quot;Invalid robustness string &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">x</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>    }</div>
</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span> </div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>    <span class="keyword">inline</span> Teuchos::RCP&lt;Teuchos::ParameterEntryValidator&gt;</div>
<div class="foldopen" id="foldopen00843" data-start="{" data-end="}">
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno"><a class="line" href="namespaceBelos_1_1details.html#afac90446e8d21f4139cbc674ab2d12e6">  843</a></span>    <a class="code hl_function" href="namespaceBelos_1_1details.html#afac90446e8d21f4139cbc674ab2d12e6">robustnessValidator</a> ()</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>    {</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>      <span class="keyword">using </span>Teuchos::stringToIntegralParameterEntryValidator;</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span> </div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>      Teuchos::Array&lt;std::string&gt; <a class="code hl_class" href="classBelos_1_1Operator.html">strs</a> (3);</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>      <a class="code hl_class" href="classBelos_1_1Operator.html">strs</a>[0] = <a class="code hl_function" href="namespaceBelos_1_1details.html#a9bbb015263348f701b5135eeeadfaf55">robustnessEnumToString</a> (<a class="code hl_enumvalue" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea7c00a13d1ab30f47de58763504fd9d50">ROBUSTNESS_NONE</a>);</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>      <a class="code hl_class" href="classBelos_1_1Operator.html">strs</a>[1] = <a class="code hl_function" href="namespaceBelos_1_1details.html#a9bbb015263348f701b5135eeeadfaf55">robustnessEnumToString</a> (<a class="code hl_enumvalue" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea4c0000ab10503cf9942a38072a6219d1">ROBUSTNESS_SOME</a>);</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>      <a class="code hl_class" href="classBelos_1_1Operator.html">strs</a>[2] = <a class="code hl_function" href="namespaceBelos_1_1details.html#a9bbb015263348f701b5135eeeadfaf55">robustnessEnumToString</a> (<a class="code hl_enumvalue" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea2837d067913425b6279342d1e0f405a2">ROBUSTNESS_LOTS</a>);</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>      Teuchos::Array&lt;std::string&gt; <a class="code hl_class" href="classBelos_1_1Operator.html">docs</a> (3);</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>      <a class="code hl_class" href="classBelos_1_1Operator.html">docs</a>[0] = <span class="stringliteral">&quot;Use the BLAS&#39; triangular solve.  This may result in Inf or &quot;</span></div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>        <span class="stringliteral">&quot;NaN output if the triangular matrix is rank deficient.&quot;</span>;</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>      <a class="code hl_class" href="classBelos_1_1Operator.html">docs</a>[1] = <span class="stringliteral">&quot;Robustness somewhere between \&quot;None\&quot; and \&quot;Lots\&quot;.&quot;</span>;</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>      <a class="code hl_class" href="classBelos_1_1Operator.html">docs</a>[2] = <span class="stringliteral">&quot;Solve the triangular system in a least-squares sense, using &quot;</span></div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>        <span class="stringliteral">&quot;an SVD-based algorithm.  This will always succeed, though the &quot;</span></div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>        <span class="stringliteral">&quot;solution may not make sense for GMRES.&quot;</span>;</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>      Teuchos::Array&lt;ERobustness&gt; <a class="code hl_class" href="classBelos_1_1Operator.html">ints</a> (3);</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>      <a class="code hl_class" href="classBelos_1_1Operator.html">ints</a>[0] = <a class="code hl_enumvalue" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea7c00a13d1ab30f47de58763504fd9d50">ROBUSTNESS_NONE</a>;</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>      <a class="code hl_class" href="classBelos_1_1Operator.html">ints</a>[1] = <a class="code hl_enumvalue" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea4c0000ab10503cf9942a38072a6219d1">ROBUSTNESS_SOME</a>;</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>      <a class="code hl_class" href="classBelos_1_1Operator.html">ints</a>[2] = <a class="code hl_enumvalue" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea2837d067913425b6279342d1e0f405a2">ROBUSTNESS_LOTS</a>;</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>      <span class="keyword">const</span> std::string <a class="code hl_class" href="classBelos_1_1Operator.html">pname</a> (<span class="stringliteral">&quot;Robustness of Projected Least-Squares Solve&quot;</span>);</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span> </div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>      <span class="keywordflow">return</span> <a class="code hl_class" href="classBelos_1_1Operator.html">stringToIntegralParameterEntryValidator&lt;ERobustness&gt;</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">strs</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">docs</a>,</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>                                                                   <a class="code hl_class" href="classBelos_1_1Operator.html">ints</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">pname</a>);</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>    }</div>
</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span> </div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>    <span class="keyword">template</span>&lt;<span class="keyword">class</span> Scalar&gt;</div>
<div class="foldopen" id="foldopen00931" data-start="{" data-end="};">
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html">  931</a></span>    <span class="keyword">class </span><a class="code hl_class" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html">ProjectedLeastSquaresSolver</a> {</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>    <span class="keyword">public</span>:</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a622dfd03a79f805859cfb05e976d1c2d">  939</a></span>      <span class="keyword">typedef</span> <a class="code hl_class" href="classBelos_1_1Operator.html">Scalar</a> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a622dfd03a79f805859cfb05e976d1c2d">scalar_type</a>;</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">  944</a></span>      <span class="keyword">typedef</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::magnitudeType <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a>;</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">  947</a></span>      <span class="keyword">typedef</span> Teuchos::SerialDenseMatrix&lt;int,Scalar&gt; <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>;</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span> </div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>    <span class="keyword">private</span>:</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>      <span class="keyword">typedef</span> Teuchos::ScalarTraits&lt;scalar_type&gt; STS;</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>      <span class="keyword">typedef</span> Teuchos::ScalarTraits&lt;magnitude_type&gt; STM;</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>      <span class="keyword">typedef</span> Teuchos::BLAS&lt;int, scalar_type&gt; blas_type;</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>      <span class="keyword">typedef</span> Teuchos::LAPACK&lt;int, scalar_type&gt; lapack_type;</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span> </div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>    <span class="keyword">public</span>:</div>
<div class="foldopen" id="foldopen00969" data-start="{" data-end="}">
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a91bd1ee4bf5be51c01757365a356c07e">  969</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a91bd1ee4bf5be51c01757365a356c07e">ProjectedLeastSquaresSolver</a> (std::ostream&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">warnStream</a>,</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>                                   <span class="keyword">const</span> <a class="code hl_enumeration" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfe">ERobustness</a> <a class="code hl_class" href="classBelos_1_1Operator.html">defaultRobustness</a>=<a class="code hl_enumvalue" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea7c00a13d1ab30f47de58763504fd9d50">ROBUSTNESS_NONE</a>) :</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>        warn_ (<a class="code hl_class" href="classBelos_1_1Operator.html">warnStream</a>),</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>        defaultRobustness_ (<a class="code hl_class" href="classBelos_1_1Operator.html">defaultRobustness</a>)</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>      {}</div>
</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span> </div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>      <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a></div>
<div class="foldopen" id="foldopen00989" data-start="{" data-end="}">
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a5f1c639b20014faec6608efe288a1e3f">  989</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a5f1c639b20014faec6608efe288a1e3f">updateColumn</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">ProjectedLeastSquaresProblem&lt;Scalar&gt;</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">problem</a>,</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>                    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">curCol</a>)</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>      {</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>        <span class="keywordflow">return</span> updateColumnGivens (<a class="code hl_class" href="classBelos_1_1Operator.html">problem</a>.H, <a class="code hl_class" href="classBelos_1_1Operator.html">problem</a>.R, <a class="code hl_class" href="classBelos_1_1Operator.html">problem</a>.y, <a class="code hl_class" href="classBelos_1_1Operator.html">problem</a>.z,</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>                                   <a class="code hl_class" href="classBelos_1_1Operator.html">problem</a>.theCosines, <a class="code hl_class" href="classBelos_1_1Operator.html">problem</a>.theSines, <a class="code hl_class" href="classBelos_1_1Operator.html">curCol</a>);</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>      }</div>
</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span> </div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>      <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a></div>
<div class="foldopen" id="foldopen01011" data-start="{" data-end="}">
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a8588e4764ff64e526c9843eb9f2f211f"> 1011</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a8588e4764ff64e526c9843eb9f2f211f">updateColumns</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">ProjectedLeastSquaresProblem&lt;Scalar&gt;</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">problem</a>,</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>                     <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">startCol</a>,</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>                     <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">endCol</a>)</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>      {</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>        <span class="keywordflow">return</span> updateColumnsGivens (<a class="code hl_class" href="classBelos_1_1Operator.html">problem</a>.H, <a class="code hl_class" href="classBelos_1_1Operator.html">problem</a>.R, <a class="code hl_class" href="classBelos_1_1Operator.html">problem</a>.y, <a class="code hl_class" href="classBelos_1_1Operator.html">problem</a>.z,</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>                                    <a class="code hl_class" href="classBelos_1_1Operator.html">problem</a>.theCosines, <a class="code hl_class" href="classBelos_1_1Operator.html">problem</a>.theSines,</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>                                    <a class="code hl_class" href="classBelos_1_1Operator.html">startCol</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">endCol</a>);</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>      }</div>
</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span> </div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>      <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01034" data-start="{" data-end="}">
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a58833b753a276c726f421ae859a49812"> 1034</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a58833b753a276c726f421ae859a49812">solve</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">ProjectedLeastSquaresProblem&lt;Scalar&gt;</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">problem</a>,</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>             <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">curCol</a>)</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>      {</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>        solveGivens (<a class="code hl_class" href="classBelos_1_1Operator.html">problem</a>.y, <a class="code hl_class" href="classBelos_1_1Operator.html">problem</a>.R, <a class="code hl_class" href="classBelos_1_1Operator.html">problem</a>.z, <a class="code hl_class" href="classBelos_1_1Operator.html">curCol</a>);</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>      }</div>
</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span> </div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>      std::pair&lt;int, bool&gt;</div>
<div class="foldopen" id="foldopen01045" data-start="{" data-end="}">
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ab8c6c7371f15ee5b192c5e8fc71ff9ea"> 1045</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ab8c6c7371f15ee5b192c5e8fc71ff9ea">solveUpperTriangularSystem</a> (Teuchos::ESide <a class="code hl_class" href="classBelos_1_1Operator.html">side</a>,</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>                                  <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>,</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>                                  <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; R,</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>                                  <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; B)</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>      {</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ab8c6c7371f15ee5b192c5e8fc71ff9ea">solveUpperTriangularSystem</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">side</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>, R, B, defaultRobustness_);</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>      }</div>
</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span> </div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>      std::pair&lt;int, bool&gt;</div>
<div class="foldopen" id="foldopen01092" data-start="{" data-end="}">
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a8da32d06b9749ce498dc51348607362e"> 1092</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a8da32d06b9749ce498dc51348607362e">solveUpperTriangularSystem</a> (Teuchos::ESide <a class="code hl_class" href="classBelos_1_1Operator.html">side</a>,</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>                                  <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>,</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>                                  <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; R,</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>                                  <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; B,</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>                                  <span class="keyword">const</span> <a class="code hl_enumeration" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfe">ERobustness</a> <a class="code hl_class" href="classBelos_1_1Operator.html">robustness</a>)</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>      {</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numRows() != B.numRows(), std::invalid_argument,</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>                           <span class="stringliteral">&quot;The output X and right-hand side B have different &quot;</span></div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>                           <span class="stringliteral">&quot;numbers of rows.  X has &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numRows() &lt;&lt; <span class="stringliteral">&quot; rows&quot;</span></div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>                           <span class="stringliteral">&quot;, and B has &quot;</span> &lt;&lt; B.numRows() &lt;&lt; <span class="stringliteral">&quot; rows.&quot;</span>);</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>        <span class="comment">// If B has more columns than X, we ignore the remaining</span></div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>        <span class="comment">// columns of B when solving the upper triangular system.  If</span></div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>        <span class="comment">// B has _fewer_ columns than X, we can&#39;t solve for all the</span></div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>        <span class="comment">// columns of X, so we throw an exception.</span></div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numCols() &gt; B.numCols(), std::invalid_argument,</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>                           <span class="stringliteral">&quot;The output X has more columns than the &quot;</span></div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>                           <span class="stringliteral">&quot;right-hand side B.  X has &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numCols()</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>                           &lt;&lt; <span class="stringliteral">&quot; columns and B has &quot;</span> &lt;&lt; B.numCols()</div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>                           &lt;&lt; <span class="stringliteral">&quot; columns.&quot;</span>);</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>        <span class="comment">// See above explaining the number of columns in B_view.</span></div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">B_view</a> (Teuchos::View, B, B.numRows(), <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numCols());</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span> </div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>        <span class="comment">// Both the BLAS&#39; _TRSM and LAPACK&#39;s _LATRS overwrite the</span></div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>        <span class="comment">// right-hand side with the solution, so first copy B_view</span></div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>        <span class="comment">// into X.</span></div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.assign (<a class="code hl_class" href="classBelos_1_1Operator.html">B_view</a>);</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span> </div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>        <span class="comment">// Solve the upper triangular system.</span></div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a97457fe317f1ae345faba1a47657e2a3">solveUpperTriangularSystemInPlace</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">side</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>, R, <a class="code hl_class" href="classBelos_1_1Operator.html">robustness</a>);</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>      }</div>
</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span> </div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>      std::pair&lt;int, bool&gt;</div>
<div class="foldopen" id="foldopen01128" data-start="{" data-end="}">
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a97457fe317f1ae345faba1a47657e2a3"> 1128</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a97457fe317f1ae345faba1a47657e2a3">solveUpperTriangularSystemInPlace</a> (Teuchos::ESide <a class="code hl_class" href="classBelos_1_1Operator.html">side</a>,</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>                                         <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>,</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>                                         <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; R)</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>      {</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a97457fe317f1ae345faba1a47657e2a3">solveUpperTriangularSystemInPlace</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">side</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>, R, defaultRobustness_);</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>      }</div>
</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span> </div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>      std::pair&lt;int, bool&gt;</div>
<div class="foldopen" id="foldopen01143" data-start="{" data-end="}">
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a4e441bd9c5b65b3d6299148826133526"> 1143</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a4e441bd9c5b65b3d6299148826133526">solveUpperTriangularSystemInPlace</a> (Teuchos::ESide <a class="code hl_class" href="classBelos_1_1Operator.html">side</a>,</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>                                         <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>,</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>                                         <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; R,</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>                                         <span class="keyword">const</span> <a class="code hl_enumeration" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfe">ERobustness</a> <a class="code hl_class" href="classBelos_1_1Operator.html">robustness</a>)</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>      {</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>        <span class="keyword">using </span>Teuchos::Array;</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>        <span class="keyword">using </span>Teuchos::Copy;</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>        <span class="keyword">using </span>Teuchos::LEFT_SIDE;</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>        <span class="keyword">using </span>Teuchos::RIGHT_SIDE;</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">LocalDenseMatrixOps&lt;Scalar&gt;</a> <a class="code hl_class" href="classBelos_1_1Operator.html">ops</a>;</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span> </div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">M</a> = R.numRows();</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">N</a> = R.numCols();</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">M</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>, std::invalid_argument,</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span>                           <span class="stringliteral">&quot;The input matrix R has fewer columns than rows.  &quot;</span></div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>                           <span class="stringliteral">&quot;R is &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">M</a> &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">N</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>        <span class="comment">// Ignore any additional rows of R by working with a square view.</span></div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">R_view</a> (Teuchos::View, R, <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>);</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span> </div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">side</a> == <a class="code hl_class" href="classBelos_1_1Operator.html">LEFT_SIDE</a>) {</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numRows() &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>, std::invalid_argument,</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>                             <span class="stringliteral">&quot;The input/output matrix X has only &quot;</span></div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>                             &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numRows() &lt;&lt; <span class="stringliteral">&quot; rows, but needs at least &quot;</span></div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>                             &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">N</a> &lt;&lt; <span class="stringliteral">&quot; rows to match the matrix for a &quot;</span></div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>                             <span class="stringliteral">&quot;left-side solve R \\ X.&quot;</span>);</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">side</a> == <a class="code hl_class" href="classBelos_1_1Operator.html">RIGHT_SIDE</a>) {</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numCols() &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>, std::invalid_argument,</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>                             <span class="stringliteral">&quot;The input/output matrix X has only &quot;</span></div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>                             &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numCols() &lt;&lt; <span class="stringliteral">&quot; columns, but needs at least &quot;</span></div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>                             &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">N</a> &lt;&lt; <span class="stringliteral">&quot; columns to match the matrix for a &quot;</span></div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>                             <span class="stringliteral">&quot;right-side solve X / R.&quot;</span>);</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>        }</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">robustness</a> &lt; <a class="code hl_enumvalue" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea7c00a13d1ab30f47de58763504fd9d50">ROBUSTNESS_NONE</a> ||</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>                           <a class="code hl_class" href="classBelos_1_1Operator.html">robustness</a> &gt;= <a class="code hl_enumvalue" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfeaf78083034b642ee97afd4b87d313776e">ROBUSTNESS_INVALID</a>,</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>                           std::invalid_argument,</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>                           <span class="stringliteral">&quot;Invalid robustness value &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">robustness</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span> </div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>        <span class="comment">// In robust mode, scan the matrix and right-hand side(s) for</span></div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>        <span class="comment">// Infs and NaNs.  Only look at the upper triangle of the</span></div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>        <span class="comment">// matrix.</span></div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">robustness</a> &gt; <a class="code hl_enumvalue" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea7c00a13d1ab30f47de58763504fd9d50">ROBUSTNESS_NONE</a>) {</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>          <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">count</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">ops</a>.infNaNCount (<a class="code hl_class" href="classBelos_1_1Operator.html">R_view</a>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">count</a> &gt; 0, std::runtime_error,</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>                             <span class="stringliteral">&quot;There &quot;</span> &lt;&lt; (<a class="code hl_class" href="classBelos_1_1Operator.html">count</a> != 1 ? <span class="stringliteral">&quot;are&quot;</span> : <span class="stringliteral">&quot;is&quot;</span>)</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>                             &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">count</a> &lt;&lt; <span class="stringliteral">&quot; Inf or NaN entr&quot;</span></div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>                             &lt;&lt; (<a class="code hl_class" href="classBelos_1_1Operator.html">count</a> != 1 ? <span class="stringliteral">&quot;ies&quot;</span> : <span class="stringliteral">&quot;y&quot;</span>)</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>                             &lt;&lt; <span class="stringliteral">&quot; in the upper triangle of R.&quot;</span>);</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">count</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">ops</a>.infNaNCount (<a class="code hl_class" href="classBelos_1_1Operator.html">X</a>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">count</a> &gt; 0, std::runtime_error,</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>                             <span class="stringliteral">&quot;There &quot;</span> &lt;&lt; (<a class="code hl_class" href="classBelos_1_1Operator.html">count</a> != 1 ? <span class="stringliteral">&quot;are&quot;</span> : <span class="stringliteral">&quot;is&quot;</span>)</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>                             &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">count</a> &lt;&lt; <span class="stringliteral">&quot; Inf or NaN entr&quot;</span></div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>                             &lt;&lt; (<a class="code hl_class" href="classBelos_1_1Operator.html">count</a> != 1 ? <span class="stringliteral">&quot;ies&quot;</span> : <span class="stringliteral">&quot;y&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; in the &quot;</span></div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>                             <span class="stringliteral">&quot;right-hand side(s) X.&quot;</span>);</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>        }</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span> </div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>        <span class="comment">// Pair of values to return from this method.</span></div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>        <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">rank</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>;</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>        <span class="keywordtype">bool</span> <a class="code hl_class" href="classBelos_1_1Operator.html">foundRankDeficiency</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span> </div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>        <span class="comment">// Solve for X.</span></div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>        blas_type <a class="code hl_class" href="classBelos_1_1Operator.html">blas</a>;</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span> </div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">robustness</a> == <a class="code hl_enumvalue" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea7c00a13d1ab30f47de58763504fd9d50">ROBUSTNESS_NONE</a>) {</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>          <span class="comment">// Fast triangular solve using the BLAS&#39; _TRSM.  This does</span></div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>          <span class="comment">// no checking for rank deficiency.</span></div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">blas</a>.TRSM(<a class="code hl_class" href="classBelos_1_1Operator.html">side</a>, Teuchos::UPPER_TRI, Teuchos::NO_TRANS,</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>                    Teuchos::NON_UNIT_DIAG, <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numRows(), <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numCols(),</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>                    STS::one(), R.values(), R.stride(),</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>                    <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.values(), <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.stride());</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">robustness</a> &lt; <a class="code hl_enumvalue" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfeaf78083034b642ee97afd4b87d313776e">ROBUSTNESS_INVALID</a>) {</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>          <span class="comment">// Save a copy of X, since X contains the right-hand side on</span></div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>          <span class="comment">// input.</span></div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>          <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> B (<a class="code hl_class" href="classBelos_1_1Operator.html">Copy</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numRows(), <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numCols());</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span> </div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>          <span class="comment">// Fast triangular solve using the BLAS&#39; _TRSM.  This does</span></div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>          <span class="comment">// no checking for rank deficiency.</span></div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">blas</a>.TRSM(<a class="code hl_class" href="classBelos_1_1Operator.html">side</a>, Teuchos::UPPER_TRI, Teuchos::NO_TRANS,</div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>                    Teuchos::NON_UNIT_DIAG, <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numRows(), <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numCols(),</div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>                    STS::one(), R.values(), R.stride(),</div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>                    <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.values(), <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.stride());</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span> </div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>          <span class="comment">// Check for Infs or NaNs in X.  If there are any, then</span></div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>          <span class="comment">// assume that TRSM failed, and use a more robust algorithm.</span></div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span>          <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">ops</a>.infNaNCount (<a class="code hl_class" href="classBelos_1_1Operator.html">X</a>, <span class="keyword">false</span>) != 0) {</div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span> </div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>            warn_ &lt;&lt; <span class="stringliteral">&quot;Upper triangular solve: Found Infs and/or NaNs in the &quot;</span></div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>              <span class="stringliteral">&quot;solution after using the fast algorithm.  Retrying using a more &quot;</span></div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>              <span class="stringliteral">&quot;robust algorithm.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span> </div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>            <span class="comment">// Restore X from the copy.</span></div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span>            <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.assign (B);</div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span> </div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>            <span class="comment">// Find the minimum-norm solution to the least-squares</span></div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>            <span class="comment">// problem $\min_x \|RX - B\|_2$, using the singular value</span></div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span>            <span class="comment">// decomposition (SVD).</span></div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>            <a class="code hl_class" href="classBelos_1_1Operator.html">LocalDenseMatrixOps&lt;Scalar&gt;</a> <a class="code hl_class" href="classBelos_1_1Operator.html">ops</a>;</div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">side</a> == <a class="code hl_class" href="classBelos_1_1Operator.html">LEFT_SIDE</a>) {</div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>              <span class="comment">// _GELSS overwrites its matrix input, so make a copy.</span></div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>              <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">R_copy</a> (Teuchos::Copy, <a class="code hl_class" href="classBelos_1_1Operator.html">R_view</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>);</div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span> </div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>              <span class="comment">// Zero out the lower triangle of R_copy, since the</span></div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>              <span class="comment">// mat_type constructor copies all the entries, not just</span></div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>              <span class="comment">// the upper triangle.  _GELSS will read all the entries</span></div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>              <span class="comment">// of the input matrix.</span></div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>              <a class="code hl_class" href="classBelos_1_1Operator.html">ops</a>.zeroOutStrictLowerTriangle (<a class="code hl_class" href="classBelos_1_1Operator.html">R_copy</a>);</div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span> </div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>              <span class="comment">// Solve the least-squares problem.</span></div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>              <a class="code hl_class" href="classBelos_1_1Operator.html">rank</a> = solveLeastSquaresUsingSVD (<a class="code hl_class" href="classBelos_1_1Operator.html">R_copy</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>);</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>              <span class="comment">// If solving with R on the right-hand side, the interface</span></div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>              <span class="comment">// requires that instead of solving $\min \|XR - B\|_2$,</span></div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>              <span class="comment">// we have to solve $\min \|R^* X^* - B^*\|_2$.  We</span></div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>              <span class="comment">// compute (conjugate) transposes in newly allocated</span></div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>              <span class="comment">// temporary matrices X_star resp. R_star.  (B is already</span></div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>              <span class="comment">// in X and _GELSS overwrites its input vector X with the</span></div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>              <span class="comment">// solution.)</span></div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>              <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">X_star</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numCols(), <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.numRows());</div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>              <a class="code hl_class" href="classBelos_1_1Operator.html">ops</a>.conjugateTranspose (<a class="code hl_class" href="classBelos_1_1Operator.html">X_star</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>);</div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>              <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">R_star</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">N</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>); <span class="comment">// Filled with zeros automatically.</span></div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>              <a class="code hl_class" href="classBelos_1_1Operator.html">ops</a>.conjugateTransposeOfUpperTriangular (<a class="code hl_class" href="classBelos_1_1Operator.html">R_star</a>, R);</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span> </div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>              <span class="comment">// Solve the least-squares problem.</span></div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>              <a class="code hl_class" href="classBelos_1_1Operator.html">rank</a> = solveLeastSquaresUsingSVD (<a class="code hl_class" href="classBelos_1_1Operator.html">R_star</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">X_star</a>);</div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span> </div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>              <span class="comment">// Copy the transpose of X_star back into X.</span></div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>              <a class="code hl_class" href="classBelos_1_1Operator.html">ops</a>.conjugateTranspose (<a class="code hl_class" href="classBelos_1_1Operator.html">X</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">X_star</a>);</div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>            }</div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">rank</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>) {</div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>              <a class="code hl_class" href="classBelos_1_1Operator.html">foundRankDeficiency</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>            }</div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>          }</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<span class="keyword">true</span>, std::logic_error,</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>                             <span class="stringliteral">&quot;Should never get here!  Invalid robustness value &quot;</span></div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>                             &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">robustness</a> &lt;&lt; <span class="stringliteral">&quot;.  Please report this bug to the &quot;</span></div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>                             <span class="stringliteral">&quot;Belos developers.&quot;</span>);</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>        }</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>        <span class="keywordflow">return</span> std::make_pair (<a class="code hl_class" href="classBelos_1_1Operator.html">rank</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">foundRankDeficiency</a>);</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>      }</div>
</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span> </div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span> </div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>    <span class="keyword">public</span>:</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>      <span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen01294" data-start="{" data-end="}">
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a0cd9b4f3a6eb51ffceaa1532f03aa778"> 1294</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a0cd9b4f3a6eb51ffceaa1532f03aa778">testGivensRotations</a> (std::ostream&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">out</a>)</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>      {</div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>        <span class="keyword">using </span>std::endl;</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span> </div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">out</a> &lt;&lt; <span class="stringliteral">&quot;Testing Givens rotations:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">Scalar</a> <a class="code hl_class" href="classBelos_1_1Operator.html">x</a> = STS::random();</div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">Scalar</a> y = STS::random();</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">out</a> &lt;&lt; <span class="stringliteral">&quot;  x = &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">x</a> &lt;&lt; <span class="stringliteral">&quot;, y = &quot;</span> &lt;&lt; y &lt;&lt; endl;</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span> </div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">Scalar</a> <a class="code hl_class" href="classBelos_1_1Operator.html">theCosine</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">theSine</a>, result;</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>        blas_type <a class="code hl_class" href="classBelos_1_1Operator.html">blas</a>;</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>        computeGivensRotation (<a class="code hl_class" href="classBelos_1_1Operator.html">x</a>, y, <a class="code hl_class" href="classBelos_1_1Operator.html">theCosine</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">theSine</a>, result);</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">out</a> &lt;&lt; <span class="stringliteral">&quot;-- After computing rotation:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">out</a> &lt;&lt; <span class="stringliteral">&quot;---- cos,sin = &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">theCosine</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">theSine</a> &lt;&lt; endl;</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">out</a> &lt;&lt; <span class="stringliteral">&quot;---- x = &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">x</a> &lt;&lt; <span class="stringliteral">&quot;, y = &quot;</span> &lt;&lt; y</div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>            &lt;&lt; <span class="stringliteral">&quot;, result = &quot;</span> &lt;&lt; result &lt;&lt; endl;</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span> </div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">blas</a>.ROT (1, &amp;<a class="code hl_class" href="classBelos_1_1Operator.html">x</a>, 1, &amp;y, 1, &amp;<a class="code hl_class" href="classBelos_1_1Operator.html">theCosine</a>, &amp;<a class="code hl_class" href="classBelos_1_1Operator.html">theSine</a>);</div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">out</a> &lt;&lt; <span class="stringliteral">&quot;-- After applying rotation:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">out</a> &lt;&lt; <span class="stringliteral">&quot;---- cos,sin = &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">theCosine</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">theSine</a> &lt;&lt; endl;</div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">out</a> &lt;&lt; <span class="stringliteral">&quot;---- x = &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">x</a> &lt;&lt; <span class="stringliteral">&quot;, y = &quot;</span> &lt;&lt; y &lt;&lt; endl;</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span> </div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>        <span class="comment">// Allow only a tiny bit of wiggle room for zeroing-out of y.</span></div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>        <span class="keywordflow">if</span> (STS::magnitude(y) &gt; 2*STS::eps())</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span>          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>      }</div>
</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span> </div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>      <span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen01353" data-start="{" data-end="}">
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2fcd5ddf8d07272cae3eab562704b702"> 1353</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2fcd5ddf8d07272cae3eab562704b702">testUpdateColumn</a> (std::ostream&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">out</a>,</div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>                        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>,</div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span>                        <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_class" href="classBelos_1_1Operator.html">testBlockGivens</a>=<span class="keyword">false</span>,</div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span>                        <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_class" href="classBelos_1_1Operator.html">extraVerbose</a>=<span class="keyword">false</span>)</div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span>      {</div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span>        <span class="keyword">using </span>Teuchos::Array;</div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span>        <span class="keyword">using </span>std::endl;</div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span> </div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a> &lt;= 0, std::invalid_argument,</div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span>                           <span class="stringliteral">&quot;numCols = &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a> &lt;&lt; <span class="stringliteral">&quot; &lt;= 0.&quot;</span>);</div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a> + 1;</div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span> </div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> H (<a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>);</div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> z (<a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a>, 1);</div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span> </div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">R_givens</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>);</div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">y_givens</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a>, 1);</div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">z_givens</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a>, 1);</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">Array&lt;Scalar&gt;</a> theCosines (<a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>);</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">Array&lt;Scalar&gt;</a> theSines (<a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>);</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span> </div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">R_blockGivens</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>);</div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">y_blockGivens</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a>, 1);</div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">z_blockGivens</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a>, 1);</div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">Array&lt;Scalar&gt;</a> <a class="code hl_class" href="classBelos_1_1Operator.html">blockCosines</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>);</div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">Array&lt;Scalar&gt;</a> <a class="code hl_class" href="classBelos_1_1Operator.html">blockSines</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>);</div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">panelWidth</a> = std::min (3, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>);</div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span> </div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">R_lapack</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>);</div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">y_lapack</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a>, 1);</div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">z_lapack</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a>, 1);</div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span> </div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>        <span class="comment">// Make a random least-squares problem.</span></div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>        makeRandomProblem (H, z);</div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">extraVerbose</a>) {</div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">printMatrix&lt;Scalar&gt;</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">out</a>, <span class="stringliteral">&quot;H&quot;</span>, H);</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">printMatrix&lt;Scalar&gt;</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">out</a>, <span class="stringliteral">&quot;z&quot;</span>, z);</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span>        }</div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span> </div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>        <span class="comment">// Set up the right-hand side copies for each of the methods.</span></div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>        <span class="comment">// Each method is free to overwrite its given right-hand side.</span></div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">z_givens</a>.assign (z);</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">testBlockGivens</a>) {</div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">z_blockGivens</a>.assign (z);</div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span>        }</div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">z_lapack</a>.assign (z);</div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span> </div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span>        <span class="comment">//</span></div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span>        <span class="comment">// Imitate how one would update the least-squares problem in a</span></div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span>        <span class="comment">// typical GMRES implementation, for each updating method.</span></div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span>        <span class="comment">//</span></div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span>        <span class="comment">// Update using Givens rotations, one at a time.</span></div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">residualNormGivens</a> = STM::zero();</div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">curCol</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">curCol</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>; ++<a class="code hl_class" href="classBelos_1_1Operator.html">curCol</a>) {</div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">residualNormGivens</a> = updateColumnGivens (H, <a class="code hl_class" href="classBelos_1_1Operator.html">R_givens</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">y_givens</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">z_givens</a>,</div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>                                                   theCosines, theSines, <a class="code hl_class" href="classBelos_1_1Operator.html">curCol</a>);</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span>        }</div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>        solveGivens (<a class="code hl_class" href="classBelos_1_1Operator.html">y_givens</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">R_givens</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">z_givens</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>-1);</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span> </div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>        <span class="comment">// Update using the &quot;panel left-looking&quot; Givens approach, with</span></div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>        <span class="comment">// the given panel width.</span></div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">residualNormBlockGivens</a> = STM::zero();</div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">testBlockGivens</a>) {</div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>          <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_class" href="classBelos_1_1Operator.html">testBlocksAtATime</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span>          <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">testBlocksAtATime</a>) {</div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span>            <span class="comment">// Blocks of columns at a time.</span></div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">startCol</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">startCol</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>; <a class="code hl_class" href="classBelos_1_1Operator.html">startCol</a> += <a class="code hl_class" href="classBelos_1_1Operator.html">panelWidth</a>) {</div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span>              <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">endCol</a> = std::min (<a class="code hl_class" href="classBelos_1_1Operator.html">startCol</a> + <a class="code hl_class" href="classBelos_1_1Operator.html">panelWidth</a> - 1, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a> - 1);</div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span>              <a class="code hl_class" href="classBelos_1_1Operator.html">residualNormBlockGivens</a> =</div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span>                updateColumnsGivens (H, <a class="code hl_class" href="classBelos_1_1Operator.html">R_blockGivens</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">y_blockGivens</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">z_blockGivens</a>,</div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span>                                     <a class="code hl_class" href="classBelos_1_1Operator.html">blockCosines</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">blockSines</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">startCol</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">endCol</a>);</div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>            }</div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span>          } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span>            <span class="comment">// One column at a time.  This is good as a sanity check</span></div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>            <span class="comment">// to make sure updateColumnsGivens() with a single column</span></div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>            <span class="comment">// does the same thing as updateColumnGivens().</span></div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">startCol</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">startCol</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>; ++<a class="code hl_class" href="classBelos_1_1Operator.html">startCol</a>) {</div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span>              <a class="code hl_class" href="classBelos_1_1Operator.html">residualNormBlockGivens</a> =</div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span>                updateColumnsGivens (H, <a class="code hl_class" href="classBelos_1_1Operator.html">R_blockGivens</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">y_blockGivens</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">z_blockGivens</a>,</div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span>                                     <a class="code hl_class" href="classBelos_1_1Operator.html">blockCosines</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">blockSines</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">startCol</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">startCol</a>);</div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span>            }</div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span>          }</div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span>          <span class="comment">// The panel version of Givens should compute the same</span></div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>          <span class="comment">// cosines and sines as the non-panel version, and should</span></div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span>          <span class="comment">// update the right-hand side z in the same way.  Thus, we</span></div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span>          <span class="comment">// should be able to use the same triangular solver.</span></div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span>          solveGivens (<a class="code hl_class" href="classBelos_1_1Operator.html">y_blockGivens</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">R_blockGivens</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">z_blockGivens</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>-1);</div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span>        }</div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span> </div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>        <span class="comment">// Solve using LAPACK&#39;s least-squares solver.</span></div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">residualNormLapack</a> =</div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span>          solveLapack (H, <a class="code hl_class" href="classBelos_1_1Operator.html">R_lapack</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">y_lapack</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">z_lapack</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>-1);</div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span> </div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span>        <span class="comment">// Compute the condition number of the least-squares problem.</span></div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span>        <span class="comment">// This requires a residual, so use the residual from the</span></div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span>        <span class="comment">// LAPACK method.  All that the method needs for an accurate</span></div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span>        <span class="comment">// residual norm is forward stability.</span></div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">leastSquaresCondNum</a> =</div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span>          leastSquaresConditionNumber (H, z, <a class="code hl_class" href="classBelos_1_1Operator.html">residualNormLapack</a>);</div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span> </div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span>        <span class="comment">// Compute the relative least-squares solution error for both</span></div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span>        <span class="comment">// Givens methods.  We assume that the LAPACK solution is</span></div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span>        <span class="comment">// &quot;exact&quot; and compare against the Givens rotations solution.</span></div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span>        <span class="comment">// This is taking liberties with the definition of condition</span></div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span>        <span class="comment">// number, but it&#39;s the best we can do, since we don&#39;t know</span></div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"> 1458</span>        <span class="comment">// the exact solution and don&#39;t have an extended-precision</span></div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span>        <span class="comment">// solver.</span></div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span> </div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span>        <span class="comment">// The solution lives only in y[0 .. numCols-1].</span></div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">y_givens_view</a> (Teuchos::View, <a class="code hl_class" href="classBelos_1_1Operator.html">y_givens</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>, 1);</div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">y_blockGivens_view</a> (Teuchos::View, <a class="code hl_class" href="classBelos_1_1Operator.html">y_blockGivens</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>, 1);</div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">y_lapack_view</a> (Teuchos::View, <a class="code hl_class" href="classBelos_1_1Operator.html">y_lapack</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>, 1);</div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"> 1465</span> </div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">givensSolutionError</a> =</div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span>          solutionError (<a class="code hl_class" href="classBelos_1_1Operator.html">y_givens_view</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">y_lapack_view</a>);</div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">blockGivensSolutionError</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">testBlockGivens</a> ?</div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span>          solutionError (<a class="code hl_class" href="classBelos_1_1Operator.html">y_blockGivens_view</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">y_lapack_view</a>) :</div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span>          STM::zero();</div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span> </div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span>        <span class="comment">// If printing out the matrices, copy out the upper triangular</span></div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span>        <span class="comment">// factors for printing.  (Both methods are free to leave data</span></div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span>        <span class="comment">// below the lower triangle.)</span></div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">extraVerbose</a>) {</div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>          <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">R_factorFromGivens</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>);</div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span>          <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">R_factorFromBlockGivens</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>);</div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span>          <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">R_factorFromLapack</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>);</div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span> </div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a>; ++<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>) {</div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"> 1481</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> &lt;= <a class="code hl_class" href="classBelos_1_1Operator.html">j</a>; ++<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>) {</div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span>              <a class="code hl_class" href="classBelos_1_1Operator.html">R_factorFromGivens</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>) = <a class="code hl_class" href="classBelos_1_1Operator.html">R_givens</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>);</div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span>              <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">testBlockGivens</a>) {</div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span>                <a class="code hl_class" href="classBelos_1_1Operator.html">R_factorFromBlockGivens</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>) = <a class="code hl_class" href="classBelos_1_1Operator.html">R_blockGivens</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>);</div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span>              }</div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span>              <a class="code hl_class" href="classBelos_1_1Operator.html">R_factorFromLapack</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>) = <a class="code hl_class" href="classBelos_1_1Operator.html">R_lapack</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>);</div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>            }</div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span>          }</div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span> </div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">printMatrix&lt;Scalar&gt;</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">out</a>, <span class="stringliteral">&quot;R_givens&quot;</span>, <a class="code hl_class" href="classBelos_1_1Operator.html">R_factorFromGivens</a>);</div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">printMatrix&lt;Scalar&gt;</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">out</a>, <span class="stringliteral">&quot;y_givens&quot;</span>, <a class="code hl_class" href="classBelos_1_1Operator.html">y_givens_view</a>);</div>
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"> 1492</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">printMatrix&lt;Scalar&gt;</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">out</a>, <span class="stringliteral">&quot;z_givens&quot;</span>, <a class="code hl_class" href="classBelos_1_1Operator.html">z_givens</a>);</div>
<div class="line"><a id="l01493" name="l01493"></a><span class="lineno"> 1493</span> </div>
<div class="line"><a id="l01494" name="l01494"></a><span class="lineno"> 1494</span>          <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">testBlockGivens</a>) {</div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"> 1495</span>            <a class="code hl_class" href="classBelos_1_1Operator.html">printMatrix&lt;Scalar&gt;</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">out</a>, <span class="stringliteral">&quot;R_blockGivens&quot;</span>, <a class="code hl_class" href="classBelos_1_1Operator.html">R_factorFromBlockGivens</a>);</div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span>            <a class="code hl_class" href="classBelos_1_1Operator.html">printMatrix&lt;Scalar&gt;</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">out</a>, <span class="stringliteral">&quot;y_blockGivens&quot;</span>, <a class="code hl_class" href="classBelos_1_1Operator.html">y_blockGivens_view</a>);</div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span>            <a class="code hl_class" href="classBelos_1_1Operator.html">printMatrix&lt;Scalar&gt;</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">out</a>, <span class="stringliteral">&quot;z_blockGivens&quot;</span>, <a class="code hl_class" href="classBelos_1_1Operator.html">z_blockGivens</a>);</div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span>          }</div>
<div class="line"><a id="l01499" name="l01499"></a><span class="lineno"> 1499</span> </div>
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"> 1500</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">printMatrix&lt;Scalar&gt;</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">out</a>, <span class="stringliteral">&quot;R_lapack&quot;</span>, <a class="code hl_class" href="classBelos_1_1Operator.html">R_factorFromLapack</a>);</div>
<div class="line"><a id="l01501" name="l01501"></a><span class="lineno"> 1501</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">printMatrix&lt;Scalar&gt;</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">out</a>, <span class="stringliteral">&quot;y_lapack&quot;</span>, <a class="code hl_class" href="classBelos_1_1Operator.html">y_lapack_view</a>);</div>
<div class="line"><a id="l01502" name="l01502"></a><span class="lineno"> 1502</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">printMatrix&lt;Scalar&gt;</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">out</a>, <span class="stringliteral">&quot;z_lapack&quot;</span>, <a class="code hl_class" href="classBelos_1_1Operator.html">z_lapack</a>);</div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span>        }</div>
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"> 1504</span> </div>
<div class="line"><a id="l01505" name="l01505"></a><span class="lineno"> 1505</span>        <span class="comment">// Compute the (Frobenius) norm of the original matrix H.</span></div>
<div class="line"><a id="l01506" name="l01506"></a><span class="lineno"> 1506</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">H_norm</a> = H.normFrobenius();</div>
<div class="line"><a id="l01507" name="l01507"></a><span class="lineno"> 1507</span> </div>
<div class="line"><a id="l01508" name="l01508"></a><span class="lineno"> 1508</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">out</a> &lt;&lt; <span class="stringliteral">&quot;||H||_F = &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">H_norm</a> &lt;&lt; endl;</div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span> </div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">out</a> &lt;&lt; <span class="stringliteral">&quot;||H y_givens - z||_2 / ||H||_F = &quot;</span></div>
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"> 1511</span>            &lt;&lt; leastSquaresResidualNorm (H, <a class="code hl_class" href="classBelos_1_1Operator.html">y_givens_view</a>, z) / <a class="code hl_class" href="classBelos_1_1Operator.html">H_norm</a> &lt;&lt; endl;</div>
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"> 1512</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">testBlockGivens</a>) {</div>
<div class="line"><a id="l01513" name="l01513"></a><span class="lineno"> 1513</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">out</a> &lt;&lt; <span class="stringliteral">&quot;||H y_blockGivens - z||_2 / ||H||_F = &quot;</span></div>
<div class="line"><a id="l01514" name="l01514"></a><span class="lineno"> 1514</span>              &lt;&lt; leastSquaresResidualNorm (H, <a class="code hl_class" href="classBelos_1_1Operator.html">y_blockGivens_view</a>, z) / <a class="code hl_class" href="classBelos_1_1Operator.html">H_norm</a> &lt;&lt; endl;</div>
<div class="line"><a id="l01515" name="l01515"></a><span class="lineno"> 1515</span>        }</div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">out</a> &lt;&lt; <span class="stringliteral">&quot;||H y_lapack - z||_2 / ||H||_F = &quot;</span></div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span>            &lt;&lt; leastSquaresResidualNorm (H, <a class="code hl_class" href="classBelos_1_1Operator.html">y_lapack_view</a>, z) / <a class="code hl_class" href="classBelos_1_1Operator.html">H_norm</a> &lt;&lt; endl;</div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"> 1518</span> </div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">out</a> &lt;&lt; <span class="stringliteral">&quot;||y_givens - y_lapack||_2 / ||y_lapack||_2 = &quot;</span></div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span>            &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">givensSolutionError</a> &lt;&lt; endl;</div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">testBlockGivens</a>) {</div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">out</a> &lt;&lt; <span class="stringliteral">&quot;||y_blockGivens - y_lapack||_2 / ||y_lapack||_2 = &quot;</span></div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span>              &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">blockGivensSolutionError</a> &lt;&lt; endl;</div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span>        }</div>
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"> 1525</span> </div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">out</a> &lt;&lt; <span class="stringliteral">&quot;Least-squares condition number = &quot;</span></div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span>            &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">leastSquaresCondNum</a> &lt;&lt; endl;</div>
<div class="line"><a id="l01528" name="l01528"></a><span class="lineno"> 1528</span> </div>
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"> 1529</span>        <span class="comment">// Now for the controversial part of the test: judging whether</span></div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span>        <span class="comment">// we succeeded.  This includes the problem&#39;s condition</span></div>
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"> 1531</span>        <span class="comment">// number, which is a measure of the maximum perturbation in</span></div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span>        <span class="comment">// the solution for which we can still say that the solution</span></div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"> 1533</span>        <span class="comment">// is valid.  We include a little wiggle room by including a</span></div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span>        <span class="comment">// factor proportional to the square root of the number of</span></div>
<div class="line"><a id="l01535" name="l01535"></a><span class="lineno"> 1535</span>        <span class="comment">// floating-point operations that influence the last entry</span></div>
<div class="line"><a id="l01536" name="l01536"></a><span class="lineno"> 1536</span>        <span class="comment">// (the conventional Wilkinsonian heuristic), times 10 for</span></div>
<div class="line"><a id="l01537" name="l01537"></a><span class="lineno"> 1537</span>        <span class="comment">// good measure.</span></div>
<div class="line"><a id="l01538" name="l01538"></a><span class="lineno"> 1538</span>        <span class="comment">//</span></div>
<div class="line"><a id="l01539" name="l01539"></a><span class="lineno"> 1539</span>        <span class="comment">// (The square root looks like it has something to do with an</span></div>
<div class="line"><a id="l01540" name="l01540"></a><span class="lineno"> 1540</span>        <span class="comment">// average-case probabilistic argument, but doesn&#39;t really.</span></div>
<div class="line"><a id="l01541" name="l01541"></a><span class="lineno"> 1541</span>        <span class="comment">// What&#39;s an &quot;average problem&quot;?)</span></div>
<div class="line"><a id="l01542" name="l01542"></a><span class="lineno"> 1542</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">wiggleFactor</a> =</div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"> 1543</span>          10 * STM::squareroot( <a class="code hl_class" href="classBelos_1_1Operator.html">numRows</a>*<a class="code hl_class" href="classBelos_1_1Operator.html">numCols</a> );</div>
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"> 1544</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">solutionErrorBoundFactor</a> =</div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">wiggleFactor</a> * <a class="code hl_class" href="classBelos_1_1Operator.html">leastSquaresCondNum</a>;</div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">solutionErrorBound</a> =</div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">solutionErrorBoundFactor</a> * STS::eps();</div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">out</a> &lt;&lt; <span class="stringliteral">&quot;Solution error bound: &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">solutionErrorBoundFactor</a></div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span>            &lt;&lt; <span class="stringliteral">&quot; * eps = &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">solutionErrorBound</a> &lt;&lt; endl;</div>
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"> 1550</span> </div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span>        <span class="comment">// Remember that NaN is not greater than, not less than, and</span></div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span>        <span class="comment">// not equal to any other number, including itself.  Some</span></div>
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"> 1553</span>        <span class="comment">// compilers will rudely optimize away the &quot;x != x&quot; test.</span></div>
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span>        <span class="keywordflow">if</span> (STM::isnaninf (<a class="code hl_class" href="classBelos_1_1Operator.html">solutionErrorBound</a>)) {</div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span>          <span class="comment">// Hm, the solution error bound is Inf or NaN.  This</span></div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span>          <span class="comment">// probably means that the test problem was generated</span></div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span>          <span class="comment">// incorrectly.  We should return false in this case.</span></div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span>          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"> 1559</span>        } <span class="keywordflow">else</span> { <span class="comment">// solution error bound is finite.</span></div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span>          <span class="keywordflow">if</span> (STM::isnaninf (<a class="code hl_class" href="classBelos_1_1Operator.html">givensSolutionError</a>)) {</div>
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"> 1561</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"> 1562</span>          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">givensSolutionError</a> &gt; <a class="code hl_class" href="classBelos_1_1Operator.html">solutionErrorBound</a>) {</div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span>          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">testBlockGivens</a>) {</div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span>            <span class="keywordflow">if</span> (STM::isnaninf (<a class="code hl_class" href="classBelos_1_1Operator.html">blockGivensSolutionError</a>)) {</div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span>              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="classBelos_1_1Operator.html">blockGivensSolutionError</a> &gt; <a class="code hl_class" href="classBelos_1_1Operator.html">solutionErrorBound</a>) {</div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span>              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span>            } <span class="keywordflow">else</span> { <span class="comment">// Givens and Block Givens tests succeeded.</span></div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span>              <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span>            }</div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span>          } <span class="keywordflow">else</span> { <span class="comment">// Not testing block Givens; Givens test succeeded.</span></div>
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"> 1573</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"> 1574</span>          }</div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span>        }</div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span>      }</div>
</div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span> </div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span>      <span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen01594" data-start="{" data-end="}">
<div class="line"><a id="l01594" name="l01594"></a><span class="lineno"><a class="line" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#aaf40eb15d1a8d7fd92948ee630fd1d31"> 1594</a></span>      <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#aaf40eb15d1a8d7fd92948ee630fd1d31">testTriangularSolves</a> (std::ostream&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">out</a>,</div>
<div class="line"><a id="l01595" name="l01595"></a><span class="lineno"> 1595</span>                            <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">testProblemSize</a>,</div>
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"> 1596</span>                            <span class="keyword">const</span> <a class="code hl_enumeration" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfe">ERobustness</a> <a class="code hl_class" href="classBelos_1_1Operator.html">robustness</a>,</div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span>                            <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_class" href="classBelos_1_1Operator.html">verbose</a>=<span class="keyword">false</span>)</div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span>      {</div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span>        <span class="keyword">using </span>Teuchos::LEFT_SIDE;</div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span>        <span class="keyword">using </span>Teuchos::RIGHT_SIDE;</div>
<div class="line"><a id="l01601" name="l01601"></a><span class="lineno"> 1601</span>        <span class="keyword">using </span>std::endl;</div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span>        <span class="keyword">typedef</span> Teuchos::SerialDenseMatrix&lt;int, scalar_type&gt; <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>;</div>
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"> 1603</span> </div>
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"> 1604</span>        Teuchos::oblackholestream <a class="code hl_class" href="classBelos_1_1Operator.html">blackHole</a>;</div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span>        std::ostream&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">verboseOut</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">verbose</a> ? <a class="code hl_class" href="classBelos_1_1Operator.html">out</a> : <a class="code hl_class" href="classBelos_1_1Operator.html">blackHole</a>;</div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span> </div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">verboseOut</a> &lt;&lt; <span class="stringliteral">&quot;Testing upper triangular solves&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span>        <span class="comment">//</span></div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span>        <span class="comment">// Construct an upper triangular linear system to solve.</span></div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span>        <span class="comment">//</span></div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">verboseOut</a> &lt;&lt; <span class="stringliteral">&quot;-- Generating test matrix&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">N</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">testProblemSize</a>;</div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> R (<a class="code hl_class" href="classBelos_1_1Operator.html">N</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>);</div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span>        <span class="comment">// Fill the upper triangle of R with random numbers.</span></div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">j</a> &lt; <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>; ++<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>) {</div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> = 0; <a class="code hl_class" href="classBelos_1_1Operator.html">i</a> &lt;= <a class="code hl_class" href="classBelos_1_1Operator.html">j</a>; ++<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>) {</div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span>            R(<a class="code hl_class" href="classBelos_1_1Operator.html">i</a>,<a class="code hl_class" href="classBelos_1_1Operator.html">j</a>) = STS::random ();</div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span>          }</div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span>        }</div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span>        <span class="comment">// Compute the Frobenius norm of R for later use.</span></div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"> 1621</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">R_norm</a> = R.normFrobenius ();</div>
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"> 1622</span>        <span class="comment">// Fill the right-hand side B with random numbers.</span></div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> B (<a class="code hl_class" href="classBelos_1_1Operator.html">N</a>, 1);</div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span>        B.random ();</div>
<div class="line"><a id="l01625" name="l01625"></a><span class="lineno"> 1625</span>        <span class="comment">// Compute the Frobenius norm of B for later use.</span></div>
<div class="line"><a id="l01626" name="l01626"></a><span class="lineno"> 1626</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">B_norm</a> = B.normFrobenius ();</div>
<div class="line"><a id="l01627" name="l01627"></a><span class="lineno"> 1627</span> </div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span>        <span class="comment">// Save a copy of the original upper triangular system.</span></div>
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"> 1629</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">R_copy</a> (Teuchos::Copy, R, <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>);</div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">B_copy</a> (Teuchos::Copy, B, <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>, 1);</div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span> </div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span>        <span class="comment">// Solution vector.</span></div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">X</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">N</a>, 1);</div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span> </div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span>        <span class="comment">// Solve RX = B.</span></div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">verboseOut</a> &lt;&lt; <span class="stringliteral">&quot;-- Solving RX=B&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span>        <span class="comment">// We&#39;re ignoring the return values for now.</span></div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span>        (<a class="code hl_class" href="classBelos_1_1Operator.html">void</a>) <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ab8c6c7371f15ee5b192c5e8fc71ff9ea">solveUpperTriangularSystem</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">LEFT_SIDE</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>, R, B, <a class="code hl_class" href="classBelos_1_1Operator.html">robustness</a>);</div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span>        <span class="comment">// Test the residual error.</span></div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">Resid</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">N</a>, 1);</div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">Resid</a>.assign (<a class="code hl_class" href="classBelos_1_1Operator.html">B_copy</a>);</div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span>        <a class="code hl_class" href="classBelos_1_1details_1_1LocalDenseMatrixOps.html">Belos::details::LocalDenseMatrixOps&lt;scalar_type&gt;</a> <a class="code hl_class" href="classBelos_1_1Operator.html">ops</a>;</div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">ops</a>.matMatMult (STS::one(), <a class="code hl_class" href="classBelos_1_1Operator.html">Resid</a>, -STS::one(), <a class="code hl_class" href="classBelos_1_1Operator.html">R_copy</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>);</div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">verboseOut</a> &lt;&lt; <span class="stringliteral">&quot;---- ||R*X - B||_F = &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">Resid</a>.normFrobenius() &lt;&lt; endl;</div>
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"> 1645</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">verboseOut</a> &lt;&lt; <span class="stringliteral">&quot;---- ||R||_F ||X||_F + ||B||_F = &quot;</span></div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span>                   &lt;&lt; (<a class="code hl_class" href="classBelos_1_1Operator.html">R_norm</a> * <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>.normFrobenius() + <a class="code hl_class" href="classBelos_1_1Operator.html">B_norm</a>)</div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span>                   &lt;&lt; endl;</div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span> </div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span>        <span class="comment">// Restore R and B.</span></div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span>        R.assign (<a class="code hl_class" href="classBelos_1_1Operator.html">R_copy</a>);</div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span>        B.assign (<a class="code hl_class" href="classBelos_1_1Operator.html">B_copy</a>);</div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span> </div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span>        <span class="comment">//</span></div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span>        <span class="comment">// Set up a right-side test problem: YR = B^*.</span></div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span>        <span class="comment">//</span></div>
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"> 1656</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> Y (1, <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>);</div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">B_star</a> (1, <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>);</div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">ops</a>.conjugateTranspose (<a class="code hl_class" href="classBelos_1_1Operator.html">B_star</a>, B);</div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">B_star_copy</a> (1, <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>);</div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">B_star_copy</a>.assign (<a class="code hl_class" href="classBelos_1_1Operator.html">B_star</a>);</div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span>        <span class="comment">// Solve YR = B^*.</span></div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">verboseOut</a> &lt;&lt; <span class="stringliteral">&quot;-- Solving YR=B^*&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span>        <span class="comment">// We&#39;re ignoring the return values for now.</span></div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span>        (<a class="code hl_class" href="classBelos_1_1Operator.html">void</a>) <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ab8c6c7371f15ee5b192c5e8fc71ff9ea">solveUpperTriangularSystem</a> (<a class="code hl_class" href="classBelos_1_1Operator.html">RIGHT_SIDE</a>, Y, R, <a class="code hl_class" href="classBelos_1_1Operator.html">B_star</a>, <a class="code hl_class" href="classBelos_1_1Operator.html">robustness</a>);</div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span>        <span class="comment">// Test the residual error.</span></div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">Resid2</a> (1, <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>);</div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">Resid2</a>.assign (<a class="code hl_class" href="classBelos_1_1Operator.html">B_star_copy</a>);</div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">ops</a>.matMatMult (STS::one(), <a class="code hl_class" href="classBelos_1_1Operator.html">Resid2</a>, -STS::one(), Y, <a class="code hl_class" href="classBelos_1_1Operator.html">R_copy</a>);</div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">verboseOut</a> &lt;&lt; <span class="stringliteral">&quot;---- ||Y*R - B^*||_F = &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">Resid2</a>.normFrobenius() &lt;&lt; endl;</div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">verboseOut</a> &lt;&lt; <span class="stringliteral">&quot;---- ||Y||_F ||R||_F + ||B^*||_F = &quot;</span></div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span>                   &lt;&lt; (Y.normFrobenius() * <a class="code hl_class" href="classBelos_1_1Operator.html">R_norm</a> + <a class="code hl_class" href="classBelos_1_1Operator.html">B_norm</a>)</div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span>                   &lt;&lt; endl;</div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span> </div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span>        <span class="comment">// FIXME (mfh 14 Oct 2011) The test always &quot;passes&quot; for now;</span></div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span>        <span class="comment">// you have to inspect the output in order to see whether it</span></div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span>        <span class="comment">// succeeded.  We really should fix the above to use the</span></div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span>        <span class="comment">// infinity-norm bounds in Higham&#39;s book for triangular</span></div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span>        <span class="comment">// solves.  That would automate the test.</span></div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span>      }</div>
</div>
<div class="line"><a id="l01681" name="l01681"></a><span class="lineno"> 1681</span> </div>
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"> 1682</span>    <span class="keyword">private</span>:</div>
<div class="line"><a id="l01684" name="l01684"></a><span class="lineno"> 1684</span>      std::ostream&amp; warn_;</div>
<div class="line"><a id="l01685" name="l01685"></a><span class="lineno"> 1685</span> </div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span>      <a class="code hl_enumeration" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfe">ERobustness</a> defaultRobustness_;</div>
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"> 1691</span> </div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span>    <span class="keyword">private</span>:</div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span>      <span class="keywordtype">int</span></div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span>      solveLeastSquaresUsingSVD (<a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>, <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; <a class="code hl_class" href="classBelos_1_1Operator.html">X</a>)</div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span>      {</div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span>        <span class="keyword">using </span>Teuchos::Array;</div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">LocalDenseMatrixOps&lt;Scalar&gt;</a> <a class="code hl_class" href="classBelos_1_1Operator.html">ops</a>;</div>
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"> 1709</span> </div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span>        <span class="keywordflow">if</span> (defaultRobustness_ &gt; <a class="code hl_enumvalue" href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea4c0000ab10503cf9942a38072a6219d1">ROBUSTNESS_SOME</a>) {</div>
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"> 1711</span>          <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">count</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">ops</a>.infNaNCount (<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>);</div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">count</a> != 0, std::invalid_argument,</div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span>                             <span class="stringliteral">&quot;solveLeastSquaresUsingSVD: The input matrix A &quot;</span></div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"> 1714</span>                             <span class="stringliteral">&quot;contains &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">count</a> &lt;&lt; <span class="stringliteral">&quot;Inf and/or NaN entr&quot;</span></div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span>                             &lt;&lt; (<a class="code hl_class" href="classBelos_1_1Operator.html">count</a> != 1 ? <span class="stringliteral">&quot;ies&quot;</span> : <span class="stringliteral">&quot;y&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">count</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">ops</a>.infNaNCount (<a class="code hl_class" href="classBelos_1_1Operator.html">X</a>);</div>
<div class="line"><a id="l01717" name="l01717"></a><span class="lineno"> 1717</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classBelos_1_1Operator.html">count</a> != 0, std::invalid_argument,</div>
<div class="line"><a id="l01718" name="l01718"></a><span class="lineno"> 1718</span>                             <span class="stringliteral">&quot;solveLeastSquaresUsingSVD: The input matrix X &quot;</span></div>
<div class="line"><a id="l01719" name="l01719"></a><span class="lineno"> 1719</span>                             <span class="stringliteral">&quot;contains &quot;</span> &lt;&lt; <a class="code hl_class" href="classBelos_1_1Operator.html">count</a> &lt;&lt; <span class="stringliteral">&quot;Inf and/or NaN entr&quot;</span></div>
<div class="line"><a id="l01720" name="l01720"></a><span class="lineno"> 1720</span>                             &lt;&lt; (<a class="code hl_class" href="classBelos_1_1Operator.html">count</a> != 1 ? <span class="stringliteral">&quot;ies&quot;</span> : <span class="stringliteral">&quot;y&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l01721" name="l01721"></a><span class="lineno"> 1721</span>        }</div>
<div class="line"><a id="l01722" name="l01722"></a><span class="lineno"> 1722</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">N</a> = std::min (<a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numRows(), <a class="code hl_class" href="classBelos_1_1Operator.html">A</a>.numCols());</div>
<div class="line"><a id="l01723" name="l01723"></a><span class="lineno"> 1723</span>        lapack_type lapack;</div>
<div class="line"><a id="l01724" name="l01724"></a><span class="lineno"> 1724</span> </div>
<div class="line"><a id="l01725" name="l01725"></a><span class="lineno"> 1725</span>        <span class="comment">// Rank of A; to be computed by _GELSS and returned.</span></div>
<div class="line"><a id="l01726" name="l01726"></a><span class="lineno"> 1726</span>        <span class="keywordtype">int</span> <a class="code hl_class" href="classBelos_1_1Operator.html">rank</a> = <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>;</div>
<div class="line"><a id="l01727" name="l01727"></a><span class="lineno"> 1727</span> </div>
<div class="line"><a id="l01728" name="l01728"></a><span class="lineno"> 1728</span>        <span class="comment">// Use Scalar&#39;s machine precision for the rank tolerance,</span></div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"> 1729</span>        <span class="comment">// not magnitude_type&#39;s machine precision.</span></div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> <a class="code hl_class" href="classBelos_1_1Operator.html">rankTolerance</a> = STS::eps();</div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span> </div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span>        <span class="comment">// Array of singular values.</span></div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">Array&lt;magnitude_type&gt;</a> singularValues (<a class="code hl_class" href="classBelos_1_1Operator.html">N</a>);</div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span> </div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span>        <span class="comment">// Extra workspace.  This is only used by _GELSS if Scalar is</span></div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span>        <span class="comment">// complex.  Teuchos::LAPACK presents a unified interface to</span></div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span>        <span class="comment">// _GELSS that always includes the RWORK argument, even though</span></div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span>        <span class="comment">// LAPACK&#39;s SGELSS and DGELSS don&#39;t have the RWORK argument.</span></div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span>        <span class="comment">// We always allocate at least one entry so that &amp;rwork[0]</span></div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span>        <span class="comment">// makes sense.</span></div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span>        <a class="code hl_class" href="classBelos_1_1Operator.html">Array&lt;magnitude_type&gt;</a> <a class="code hl_class" href="classBelos_1_1Operator.html">rwork</a> (1);</div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"> 1742</span>        <span class="keywordflow">if</span> (STS::isComplex) {</div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span>          <a class="code hl_class" href="classBelos_1_1Operator.html">rwork</a>.resize (std::max (1, 5 * <a class="code hl_class" href="classBelos_1_1Operator.html">N</a>));</div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span>        }</div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span>        <span class="comment">//</span></div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span>        <span class="comment">// Workspace query</span></div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span>        <span class="comment">//</span></div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span>        Scalar lworkScalar = STS::one(); <span class="comment">// To be set by workspace query</span></div>
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"> 1749</span>        <span class="keywordtype">int</span> info = 0;</div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span>        lapack.GELSS (A.numRows(), A.numCols(), X.numCols(),</div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span>                      A.values(), A.stride(), X.values(), X.stride(),</div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span>                      &amp;singularValues[0], rankTolerance, &amp;rank,</div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span>                      &amp;lworkScalar, -1, &amp;rwork[0], &amp;info);</div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"> 1754</span>        TEUCHOS_TEST_FOR_EXCEPTION(info != 0, std::logic_error,</div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span>                           <span class="stringliteral">&quot;_GELSS workspace query returned INFO = &quot;</span></div>
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"> 1756</span>                           &lt;&lt; info &lt;&lt; <span class="stringliteral">&quot; != 0.&quot;</span>);</div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> lwork = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (STS::real (lworkScalar));</div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span>        TEUCHOS_TEST_FOR_EXCEPTION(lwork &lt; 0, std::logic_error,</div>
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"> 1759</span>                           <span class="stringliteral">&quot;_GELSS workspace query returned LWORK = &quot;</span></div>
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"> 1760</span>                           &lt;&lt; lwork &lt;&lt; <span class="stringliteral">&quot; &lt; 0.&quot;</span>);</div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span>        <span class="comment">// Allocate workspace.  Size &gt; 0 means &amp;work[0] makes sense.</span></div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span>        Array&lt;Scalar&gt; work (std::max (1, lwork));</div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span>        <span class="comment">// Solve the least-squares problem.</span></div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span>        lapack.GELSS (A.numRows(), A.numCols(), X.numCols(),</div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span>                      A.values(), A.stride(), X.values(), X.stride(),</div>
<div class="line"><a id="l01766" name="l01766"></a><span class="lineno"> 1766</span>                      &amp;singularValues[0], rankTolerance, &amp;rank,</div>
<div class="line"><a id="l01767" name="l01767"></a><span class="lineno"> 1767</span>                      &amp;work[0], lwork, &amp;rwork[0], &amp;info);</div>
<div class="line"><a id="l01768" name="l01768"></a><span class="lineno"> 1768</span>        TEUCHOS_TEST_FOR_EXCEPTION(info != 0, std::runtime_error,</div>
<div class="line"><a id="l01769" name="l01769"></a><span class="lineno"> 1769</span>                           <span class="stringliteral">&quot;_GELSS returned INFO = &quot;</span> &lt;&lt; info &lt;&lt; <span class="stringliteral">&quot; != 0.&quot;</span>);</div>
<div class="line"><a id="l01770" name="l01770"></a><span class="lineno"> 1770</span>        <span class="keywordflow">return</span> rank;</div>
<div class="line"><a id="l01771" name="l01771"></a><span class="lineno"> 1771</span>      }</div>
<div class="line"><a id="l01772" name="l01772"></a><span class="lineno"> 1772</span> </div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"> 1779</span>      <span class="keywordtype">void</span></div>
<div class="line"><a id="l01780" name="l01780"></a><span class="lineno"> 1780</span>      solveGivens (<a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; y,</div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span>                   <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; R,</div>
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"> 1782</span>                   <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; z,</div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"> 1783</span>                   <span class="keyword">const</span> <span class="keywordtype">int</span> curCol)</div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span>      {</div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"> 1785</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> numRows = curCol + 2;</div>
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"> 1786</span> </div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"> 1787</span>        <span class="comment">// Now that we have the updated R factor of H, and the updated</span></div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span>        <span class="comment">// right-hand side z, solve the least-squares problem by</span></div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"> 1789</span>        <span class="comment">// solving the upper triangular linear system Ry=z for y.</span></div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> R_view (Teuchos::View, R, numRows-1, numRows-1);</div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> z_view (Teuchos::View, z, numRows-1, z.numCols());</div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> y_view (Teuchos::View, y, numRows-1, y.numCols());</div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span> </div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span>        (void) <a class="code hl_function" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ab8c6c7371f15ee5b192c5e8fc71ff9ea">solveUpperTriangularSystem</a> (Teuchos::LEFT_SIDE, y_view,</div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span>                                           R_view, z_view, defaultRobustness_);</div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span>      }</div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span> </div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span>      <span class="keywordtype">void</span></div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span>      makeRandomProblem (<a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; H, <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; z)</div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span>      {</div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span>        <span class="comment">// In GMRES, z always starts out with only the first entry</span></div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span>        <span class="comment">// being nonzero.  That entry always has nonnegative real part</span></div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span>        <span class="comment">// and zero imaginary part, since it is the initial residual</span></div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span>        <span class="comment">// norm.</span></div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"> 1806</span>        H.random ();</div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"> 1807</span>        <span class="comment">// Zero out the entries below the subdiagonal of H, so that it</span></div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span>        <span class="comment">// is upper Hessenberg.</span></div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; H.numCols(); ++j) {</div>
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"> 1810</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = j+2; i &lt; H.numRows(); ++i) {</div>
<div class="line"><a id="l01811" name="l01811"></a><span class="lineno"> 1811</span>            H(i,j) = STS::zero();</div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"> 1812</span>          }</div>
<div class="line"><a id="l01813" name="l01813"></a><span class="lineno"> 1813</span>        }</div>
<div class="line"><a id="l01814" name="l01814"></a><span class="lineno"> 1814</span>        <span class="comment">// Initialize z, the right-hand side of the least-squares</span></div>
<div class="line"><a id="l01815" name="l01815"></a><span class="lineno"> 1815</span>        <span class="comment">// problem.  Make the first entry of z nonzero.</span></div>
<div class="line"><a id="l01816" name="l01816"></a><span class="lineno"> 1816</span>        {</div>
<div class="line"><a id="l01817" name="l01817"></a><span class="lineno"> 1817</span>          <span class="comment">// It&#39;s still possible that a random number will come up</span></div>
<div class="line"><a id="l01818" name="l01818"></a><span class="lineno"> 1818</span>          <span class="comment">// zero after 1000 trials, but unlikely.  Nevertheless, it&#39;s</span></div>
<div class="line"><a id="l01819" name="l01819"></a><span class="lineno"> 1819</span>          <span class="comment">// still important not to allow an infinite loop, for</span></div>
<div class="line"><a id="l01820" name="l01820"></a><span class="lineno"> 1820</span>          <span class="comment">// example if the pseudorandom number generator is broken</span></div>
<div class="line"><a id="l01821" name="l01821"></a><span class="lineno"> 1821</span>          <span class="comment">// and always returns zero.</span></div>
<div class="line"><a id="l01822" name="l01822"></a><span class="lineno"> 1822</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> numTrials = 1000;</div>
<div class="line"><a id="l01823" name="l01823"></a><span class="lineno"> 1823</span>          <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> z_init = STM::zero();</div>
<div class="line"><a id="l01824" name="l01824"></a><span class="lineno"> 1824</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> trial = 0; trial &lt; numTrials &amp;&amp; z_init == STM::zero(); ++trial) {</div>
<div class="line"><a id="l01825" name="l01825"></a><span class="lineno"> 1825</span>            z_init = STM::random();</div>
<div class="line"><a id="l01826" name="l01826"></a><span class="lineno"> 1826</span>          }</div>
<div class="line"><a id="l01827" name="l01827"></a><span class="lineno"> 1827</span>          TEUCHOS_TEST_FOR_EXCEPTION(z_init == STM::zero(), std::runtime_error,</div>
<div class="line"><a id="l01828" name="l01828"></a><span class="lineno"> 1828</span>                             <span class="stringliteral">&quot;After &quot;</span> &lt;&lt; numTrials &lt;&lt; <span class="stringliteral">&quot; trial&quot;</span></div>
<div class="line"><a id="l01829" name="l01829"></a><span class="lineno"> 1829</span>                             &lt;&lt; (numTrials != 1 ? <span class="stringliteral">&quot;s&quot;</span> : <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a id="l01830" name="l01830"></a><span class="lineno"> 1830</span>                             &lt;&lt; <span class="stringliteral">&quot;, we were unable to generate a nonzero pseudo&quot;</span></div>
<div class="line"><a id="l01831" name="l01831"></a><span class="lineno"> 1831</span>                             <span class="stringliteral">&quot;random real number.  This most likely indicates a &quot;</span></div>
<div class="line"><a id="l01832" name="l01832"></a><span class="lineno"> 1832</span>                             <span class="stringliteral">&quot;broken pseudorandom number generator.&quot;</span>);</div>
<div class="line"><a id="l01833" name="l01833"></a><span class="lineno"> 1833</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> z_first = (z_init &lt; 0) ? -z_init : z_init;</div>
<div class="line"><a id="l01834" name="l01834"></a><span class="lineno"> 1834</span> </div>
<div class="line"><a id="l01835" name="l01835"></a><span class="lineno"> 1835</span>          <span class="comment">// NOTE I&#39;m assuming here that &quot;scalar_type = magnitude_type&quot;</span></div>
<div class="line"><a id="l01836" name="l01836"></a><span class="lineno"> 1836</span>          <span class="comment">// assignments make sense.</span></div>
<div class="line"><a id="l01837" name="l01837"></a><span class="lineno"> 1837</span>          z(0,0) = z_first;</div>
<div class="line"><a id="l01838" name="l01838"></a><span class="lineno"> 1838</span>        }</div>
<div class="line"><a id="l01839" name="l01839"></a><span class="lineno"> 1839</span>      }</div>
<div class="line"><a id="l01840" name="l01840"></a><span class="lineno"> 1840</span> </div>
<div class="line"><a id="l01844" name="l01844"></a><span class="lineno"> 1844</span>      <span class="keywordtype">void</span></div>
<div class="line"><a id="l01845" name="l01845"></a><span class="lineno"> 1845</span>      computeGivensRotation (<span class="keyword">const</span> Scalar&amp; x,</div>
<div class="line"><a id="l01846" name="l01846"></a><span class="lineno"> 1846</span>                             <span class="keyword">const</span> Scalar&amp; y,</div>
<div class="line"><a id="l01847" name="l01847"></a><span class="lineno"> 1847</span>                             Scalar&amp; theCosine,</div>
<div class="line"><a id="l01848" name="l01848"></a><span class="lineno"> 1848</span>                             Scalar&amp; theSine,</div>
<div class="line"><a id="l01849" name="l01849"></a><span class="lineno"> 1849</span>                             Scalar&amp; result)</div>
<div class="line"><a id="l01850" name="l01850"></a><span class="lineno"> 1850</span>      {</div>
<div class="line"><a id="l01851" name="l01851"></a><span class="lineno"> 1851</span>        <span class="comment">// _LARTG, an LAPACK aux routine, is slower but more accurate</span></div>
<div class="line"><a id="l01852" name="l01852"></a><span class="lineno"> 1852</span>        <span class="comment">// than the BLAS&#39; _ROTG.</span></div>
<div class="line"><a id="l01853" name="l01853"></a><span class="lineno"> 1853</span>        <span class="keyword">const</span> <span class="keywordtype">bool</span> useLartg = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01854" name="l01854"></a><span class="lineno"> 1854</span> </div>
<div class="line"><a id="l01855" name="l01855"></a><span class="lineno"> 1855</span>        <span class="keywordflow">if</span> (useLartg) {</div>
<div class="line"><a id="l01856" name="l01856"></a><span class="lineno"> 1856</span>          lapack_type lapack;</div>
<div class="line"><a id="l01857" name="l01857"></a><span class="lineno"> 1857</span>          <span class="comment">// _LARTG doesn&#39;t clobber its input arguments x and y.</span></div>
<div class="line"><a id="l01858" name="l01858"></a><span class="lineno"> 1858</span>          lapack.LARTG (x, y, &amp;theCosine, &amp;theSine, &amp;result);</div>
<div class="line"><a id="l01859" name="l01859"></a><span class="lineno"> 1859</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01860" name="l01860"></a><span class="lineno"> 1860</span>          <span class="comment">// _ROTG clobbers its first two arguments.  x is overwritten</span></div>
<div class="line"><a id="l01861" name="l01861"></a><span class="lineno"> 1861</span>          <span class="comment">// with the result of applying the Givens rotation: [x; y] -&gt;</span></div>
<div class="line"><a id="l01862" name="l01862"></a><span class="lineno"> 1862</span>          <span class="comment">// [x (on output); 0].  y is overwritten with the &quot;fast&quot;</span></div>
<div class="line"><a id="l01863" name="l01863"></a><span class="lineno"> 1863</span>          <span class="comment">// Givens transform (see Golub and Van Loan, 3rd ed.).</span></div>
<div class="line"><a id="l01864" name="l01864"></a><span class="lineno"> 1864</span>          Scalar x_temp = x;</div>
<div class="line"><a id="l01865" name="l01865"></a><span class="lineno"> 1865</span>          Scalar y_temp = y;</div>
<div class="line"><a id="l01866" name="l01866"></a><span class="lineno"> 1866</span>          blas_type blas;</div>
<div class="line"><a id="l01867" name="l01867"></a><span class="lineno"> 1867</span>          blas.ROTG (&amp;x_temp, &amp;y_temp, &amp;theCosine, &amp;theSine);</div>
<div class="line"><a id="l01868" name="l01868"></a><span class="lineno"> 1868</span>          result = x_temp;</div>
<div class="line"><a id="l01869" name="l01869"></a><span class="lineno"> 1869</span>        }</div>
<div class="line"><a id="l01870" name="l01870"></a><span class="lineno"> 1870</span>      }</div>
<div class="line"><a id="l01871" name="l01871"></a><span class="lineno"> 1871</span> </div>
<div class="line"><a id="l01873" name="l01873"></a><span class="lineno"> 1873</span>      <span class="keywordtype">void</span></div>
<div class="line"><a id="l01874" name="l01874"></a><span class="lineno"> 1874</span>      singularValues (<span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; A,</div>
<div class="line"><a id="l01875" name="l01875"></a><span class="lineno"> 1875</span>                      Teuchos::ArrayView&lt;magnitude_type&gt; sigmas)</div>
<div class="line"><a id="l01876" name="l01876"></a><span class="lineno"> 1876</span>      {</div>
<div class="line"><a id="l01877" name="l01877"></a><span class="lineno"> 1877</span>        <span class="keyword">using </span>Teuchos::Array;</div>
<div class="line"><a id="l01878" name="l01878"></a><span class="lineno"> 1878</span>        <span class="keyword">using </span>Teuchos::ArrayView;</div>
<div class="line"><a id="l01879" name="l01879"></a><span class="lineno"> 1879</span> </div>
<div class="line"><a id="l01880" name="l01880"></a><span class="lineno"> 1880</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> numRows = A.numRows();</div>
<div class="line"><a id="l01881" name="l01881"></a><span class="lineno"> 1881</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> numCols = A.numCols();</div>
<div class="line"><a id="l01882" name="l01882"></a><span class="lineno"> 1882</span>        TEUCHOS_TEST_FOR_EXCEPTION(sigmas.size() &lt; std::min (numRows, numCols),</div>
<div class="line"><a id="l01883" name="l01883"></a><span class="lineno"> 1883</span>                           std::invalid_argument,</div>
<div class="line"><a id="l01884" name="l01884"></a><span class="lineno"> 1884</span>                           <span class="stringliteral">&quot;The sigmas array is only of length &quot;</span> &lt;&lt; sigmas.size()</div>
<div class="line"><a id="l01885" name="l01885"></a><span class="lineno"> 1885</span>                           &lt;&lt; <span class="stringliteral">&quot;, but must be of length at least &quot;</span></div>
<div class="line"><a id="l01886" name="l01886"></a><span class="lineno"> 1886</span>                           &lt;&lt; std::min (numRows, numCols)</div>
<div class="line"><a id="l01887" name="l01887"></a><span class="lineno"> 1887</span>                           &lt;&lt; <span class="stringliteral">&quot; in order to hold all the singular values of the &quot;</span></div>
<div class="line"><a id="l01888" name="l01888"></a><span class="lineno"> 1888</span>                           <span class="stringliteral">&quot;matrix A.&quot;</span>);</div>
<div class="line"><a id="l01889" name="l01889"></a><span class="lineno"> 1889</span> </div>
<div class="line"><a id="l01890" name="l01890"></a><span class="lineno"> 1890</span>        <span class="comment">// Compute the condition number of the matrix A, using a singular</span></div>
<div class="line"><a id="l01891" name="l01891"></a><span class="lineno"> 1891</span>        <span class="comment">// value decomposition (SVD).  LAPACK&#39;s SVD routine overwrites the</span></div>
<div class="line"><a id="l01892" name="l01892"></a><span class="lineno"> 1892</span>        <span class="comment">// input matrix, so make a copy.</span></div>
<div class="line"><a id="l01893" name="l01893"></a><span class="lineno"> 1893</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> A_copy (numRows, numCols);</div>
<div class="line"><a id="l01894" name="l01894"></a><span class="lineno"> 1894</span>        A_copy.assign (A);</div>
<div class="line"><a id="l01895" name="l01895"></a><span class="lineno"> 1895</span> </div>
<div class="line"><a id="l01896" name="l01896"></a><span class="lineno"> 1896</span>        <span class="comment">// Workspace query.</span></div>
<div class="line"><a id="l01897" name="l01897"></a><span class="lineno"> 1897</span>        lapack_type lapack;</div>
<div class="line"><a id="l01898" name="l01898"></a><span class="lineno"> 1898</span>        <span class="keywordtype">int</span> info = 0;</div>
<div class="line"><a id="l01899" name="l01899"></a><span class="lineno"> 1899</span>        Scalar lworkScalar = STS::zero();</div>
<div class="line"><a id="l01900" name="l01900"></a><span class="lineno"> 1900</span>        Array&lt;magnitude_type&gt; rwork (std::max (std::min (numRows, numCols) - 1, 1));</div>
<div class="line"><a id="l01901" name="l01901"></a><span class="lineno"> 1901</span>        lapack.GESVD (<span class="charliteral">&#39;N&#39;</span>, <span class="charliteral">&#39;N&#39;</span>, numRows, numCols,</div>
<div class="line"><a id="l01902" name="l01902"></a><span class="lineno"> 1902</span>                      A_copy.values(), A_copy.stride(), &amp;sigmas[0],</div>
<div class="line"><a id="l01903" name="l01903"></a><span class="lineno"> 1903</span>                      (Scalar*) NULL, 1, (Scalar*) NULL, 1,</div>
<div class="line"><a id="l01904" name="l01904"></a><span class="lineno"> 1904</span>                      &amp;lworkScalar, -1, &amp;rwork[0], &amp;info);</div>
<div class="line"><a id="l01905" name="l01905"></a><span class="lineno"> 1905</span> </div>
<div class="line"><a id="l01906" name="l01906"></a><span class="lineno"> 1906</span>        TEUCHOS_TEST_FOR_EXCEPTION(info != 0, std::logic_error,</div>
<div class="line"><a id="l01907" name="l01907"></a><span class="lineno"> 1907</span>                           <span class="stringliteral">&quot;LAPACK _GESVD workspace query failed with INFO = &quot;</span></div>
<div class="line"><a id="l01908" name="l01908"></a><span class="lineno"> 1908</span>                           &lt;&lt; info &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l01909" name="l01909"></a><span class="lineno"> 1909</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> lwork = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (STS::real (lworkScalar));</div>
<div class="line"><a id="l01910" name="l01910"></a><span class="lineno"> 1910</span>        TEUCHOS_TEST_FOR_EXCEPTION(lwork &lt; 0, std::logic_error,</div>
<div class="line"><a id="l01911" name="l01911"></a><span class="lineno"> 1911</span>                           <span class="stringliteral">&quot;LAPACK _GESVD workspace query returned LWORK = &quot;</span></div>
<div class="line"><a id="l01912" name="l01912"></a><span class="lineno"> 1912</span>                           &lt;&lt; lwork &lt;&lt; <span class="stringliteral">&quot; &lt; 0.&quot;</span>);</div>
<div class="line"><a id="l01913" name="l01913"></a><span class="lineno"> 1913</span>        <span class="comment">// Make sure that the workspace array always has positive</span></div>
<div class="line"><a id="l01914" name="l01914"></a><span class="lineno"> 1914</span>        <span class="comment">// length, so that &amp;work[0] makes sense.</span></div>
<div class="line"><a id="l01915" name="l01915"></a><span class="lineno"> 1915</span>        Teuchos::Array&lt;Scalar&gt; work (std::max (1, lwork));</div>
<div class="line"><a id="l01916" name="l01916"></a><span class="lineno"> 1916</span> </div>
<div class="line"><a id="l01917" name="l01917"></a><span class="lineno"> 1917</span>        <span class="comment">// Compute the singular values of A.</span></div>
<div class="line"><a id="l01918" name="l01918"></a><span class="lineno"> 1918</span>        lapack.GESVD (<span class="charliteral">&#39;N&#39;</span>, <span class="charliteral">&#39;N&#39;</span>, numRows, numCols,</div>
<div class="line"><a id="l01919" name="l01919"></a><span class="lineno"> 1919</span>                      A_copy.values(), A_copy.stride(), &amp;sigmas[0],</div>
<div class="line"><a id="l01920" name="l01920"></a><span class="lineno"> 1920</span>                      (Scalar*) NULL, 1, (Scalar*) NULL, 1,</div>
<div class="line"><a id="l01921" name="l01921"></a><span class="lineno"> 1921</span>                      &amp;work[0], lwork, &amp;rwork[0], &amp;info);</div>
<div class="line"><a id="l01922" name="l01922"></a><span class="lineno"> 1922</span>        TEUCHOS_TEST_FOR_EXCEPTION(info != 0, std::logic_error,</div>
<div class="line"><a id="l01923" name="l01923"></a><span class="lineno"> 1923</span>                           <span class="stringliteral">&quot;LAPACK _GESVD failed with INFO = &quot;</span> &lt;&lt; info &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l01924" name="l01924"></a><span class="lineno"> 1924</span>      }</div>
<div class="line"><a id="l01925" name="l01925"></a><span class="lineno"> 1925</span> </div>
<div class="line"><a id="l01933" name="l01933"></a><span class="lineno"> 1933</span>      std::pair&lt;magnitude_type, magnitude_type&gt;</div>
<div class="line"><a id="l01934" name="l01934"></a><span class="lineno"> 1934</span>      extremeSingularValues (<span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; A)</div>
<div class="line"><a id="l01935" name="l01935"></a><span class="lineno"> 1935</span>      {</div>
<div class="line"><a id="l01936" name="l01936"></a><span class="lineno"> 1936</span>        <span class="keyword">using </span>Teuchos::Array;</div>
<div class="line"><a id="l01937" name="l01937"></a><span class="lineno"> 1937</span> </div>
<div class="line"><a id="l01938" name="l01938"></a><span class="lineno"> 1938</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> numRows = A.numRows();</div>
<div class="line"><a id="l01939" name="l01939"></a><span class="lineno"> 1939</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> numCols = A.numCols();</div>
<div class="line"><a id="l01940" name="l01940"></a><span class="lineno"> 1940</span> </div>
<div class="line"><a id="l01941" name="l01941"></a><span class="lineno"> 1941</span>        Array&lt;magnitude_type&gt; sigmas (std::min (numRows, numCols));</div>
<div class="line"><a id="l01942" name="l01942"></a><span class="lineno"> 1942</span>        singularValues (A, sigmas);</div>
<div class="line"><a id="l01943" name="l01943"></a><span class="lineno"> 1943</span>        <span class="keywordflow">return</span> std::make_pair (sigmas[0], sigmas[std::min(numRows, numCols) - 1]);</div>
<div class="line"><a id="l01944" name="l01944"></a><span class="lineno"> 1944</span>      }</div>
<div class="line"><a id="l01945" name="l01945"></a><span class="lineno"> 1945</span> </div>
<div class="line"><a id="l01956" name="l01956"></a><span class="lineno"> 1956</span>      <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a></div>
<div class="line"><a id="l01957" name="l01957"></a><span class="lineno"> 1957</span>      leastSquaresConditionNumber (<span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; A,</div>
<div class="line"><a id="l01958" name="l01958"></a><span class="lineno"> 1958</span>                                   <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; b,</div>
<div class="line"><a id="l01959" name="l01959"></a><span class="lineno"> 1959</span>                                   <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a>&amp; residualNorm)</div>
<div class="line"><a id="l01960" name="l01960"></a><span class="lineno"> 1960</span>      {</div>
<div class="line"><a id="l01961" name="l01961"></a><span class="lineno"> 1961</span>        <span class="comment">// Extreme singular values of A.</span></div>
<div class="line"><a id="l01962" name="l01962"></a><span class="lineno"> 1962</span>        <span class="keyword">const</span> std::pair&lt;magnitude_type, magnitude_type&gt; sigmaMaxMin =</div>
<div class="line"><a id="l01963" name="l01963"></a><span class="lineno"> 1963</span>          extremeSingularValues (A);</div>
<div class="line"><a id="l01964" name="l01964"></a><span class="lineno"> 1964</span> </div>
<div class="line"><a id="l01965" name="l01965"></a><span class="lineno"> 1965</span>        <span class="comment">// Our solvers currently assume that H has full rank.  If the</span></div>
<div class="line"><a id="l01966" name="l01966"></a><span class="lineno"> 1966</span>        <span class="comment">// test matrix doesn&#39;t have full rank, we stop right away.</span></div>
<div class="line"><a id="l01967" name="l01967"></a><span class="lineno"> 1967</span>        TEUCHOS_TEST_FOR_EXCEPTION(sigmaMaxMin.second == STM::zero(), std::runtime_error,</div>
<div class="line"><a id="l01968" name="l01968"></a><span class="lineno"> 1968</span>                           <span class="stringliteral">&quot;The test matrix is rank deficient; LAPACK&#39;s _GESVD &quot;</span></div>
<div class="line"><a id="l01969" name="l01969"></a><span class="lineno"> 1969</span>                           <span class="stringliteral">&quot;routine reports that its smallest singular value is &quot;</span></div>
<div class="line"><a id="l01970" name="l01970"></a><span class="lineno"> 1970</span>                           <span class="stringliteral">&quot;zero.&quot;</span>);</div>
<div class="line"><a id="l01971" name="l01971"></a><span class="lineno"> 1971</span>        <span class="comment">// 2-norm condition number of A.  We checked above that the</span></div>
<div class="line"><a id="l01972" name="l01972"></a><span class="lineno"> 1972</span>        <span class="comment">// denominator is nonzero.</span></div>
<div class="line"><a id="l01973" name="l01973"></a><span class="lineno"> 1973</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> A_cond = sigmaMaxMin.first / sigmaMaxMin.second;</div>
<div class="line"><a id="l01974" name="l01974"></a><span class="lineno"> 1974</span> </div>
<div class="line"><a id="l01975" name="l01975"></a><span class="lineno"> 1975</span>        <span class="comment">// &quot;Theta&quot; in the variable names below refers to the angle between</span></div>
<div class="line"><a id="l01976" name="l01976"></a><span class="lineno"> 1976</span>        <span class="comment">// the vectors b and A*x, where x is the computed solution.  It</span></div>
<div class="line"><a id="l01977" name="l01977"></a><span class="lineno"> 1977</span>        <span class="comment">// measures whether the residual norm is large (near ||b||) or</span></div>
<div class="line"><a id="l01978" name="l01978"></a><span class="lineno"> 1978</span>        <span class="comment">// small (near 0).</span></div>
<div class="line"><a id="l01979" name="l01979"></a><span class="lineno"> 1979</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> sinTheta = residualNorm / b.normFrobenius();</div>
<div class="line"><a id="l01980" name="l01980"></a><span class="lineno"> 1980</span> </div>
<div class="line"><a id="l01981" name="l01981"></a><span class="lineno"> 1981</span>        <span class="comment">// \sin^2 \theta + \cos^2 \theta = 1.</span></div>
<div class="line"><a id="l01982" name="l01982"></a><span class="lineno"> 1982</span>        <span class="comment">//</span></div>
<div class="line"><a id="l01983" name="l01983"></a><span class="lineno"> 1983</span>        <span class="comment">// The range of sine is [-1,1], so squaring it won&#39;t overflow.</span></div>
<div class="line"><a id="l01984" name="l01984"></a><span class="lineno"> 1984</span>        <span class="comment">// We still have to check whether sinTheta &gt; 1, though.  This</span></div>
<div class="line"><a id="l01985" name="l01985"></a><span class="lineno"> 1985</span>        <span class="comment">// is impossible in exact arithmetic, assuming that the</span></div>
<div class="line"><a id="l01986" name="l01986"></a><span class="lineno"> 1986</span>        <span class="comment">// least-squares solver worked (b-A*0 = b and x minimizes</span></div>
<div class="line"><a id="l01987" name="l01987"></a><span class="lineno"> 1987</span>        <span class="comment">// ||b-A*x||_2, so ||b-A*0||_2 &gt;= ||b-A*x||_2).  However, it</span></div>
<div class="line"><a id="l01988" name="l01988"></a><span class="lineno"> 1988</span>        <span class="comment">// might just be possible in floating-point arithmetic.  We&#39;re</span></div>
<div class="line"><a id="l01989" name="l01989"></a><span class="lineno"> 1989</span>        <span class="comment">// just looking for an estimate, so if sinTheta &gt; 1, we cap it</span></div>
<div class="line"><a id="l01990" name="l01990"></a><span class="lineno"> 1990</span>        <span class="comment">// at 1.</span></div>
<div class="line"><a id="l01991" name="l01991"></a><span class="lineno"> 1991</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> cosTheta = (sinTheta &gt; STM::one()) ?</div>
<div class="line"><a id="l01992" name="l01992"></a><span class="lineno"> 1992</span>          STM::zero() : STM::squareroot (1 - sinTheta * sinTheta);</div>
<div class="line"><a id="l01993" name="l01993"></a><span class="lineno"> 1993</span> </div>
<div class="line"><a id="l01994" name="l01994"></a><span class="lineno"> 1994</span>        <span class="comment">// This may result in Inf, if cosTheta is zero.  That&#39;s OK; in</span></div>
<div class="line"><a id="l01995" name="l01995"></a><span class="lineno"> 1995</span>        <span class="comment">// that case, the condition number of the (full-rank)</span></div>
<div class="line"><a id="l01996" name="l01996"></a><span class="lineno"> 1996</span>        <span class="comment">// least-squares problem is rightfully infinite.</span></div>
<div class="line"><a id="l01997" name="l01997"></a><span class="lineno"> 1997</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> tanTheta = sinTheta / cosTheta;</div>
<div class="line"><a id="l01998" name="l01998"></a><span class="lineno"> 1998</span> </div>
<div class="line"><a id="l01999" name="l01999"></a><span class="lineno"> 1999</span>        <span class="comment">// Condition number for the full-rank least-squares problem.</span></div>
<div class="line"><a id="l02000" name="l02000"></a><span class="lineno"> 2000</span>        <span class="keywordflow">return</span> 2 * A_cond / cosTheta + tanTheta * A_cond * A_cond;</div>
<div class="line"><a id="l02001" name="l02001"></a><span class="lineno"> 2001</span>      }</div>
<div class="line"><a id="l02002" name="l02002"></a><span class="lineno"> 2002</span> </div>
<div class="line"><a id="l02004" name="l02004"></a><span class="lineno"> 2004</span>      <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a></div>
<div class="line"><a id="l02005" name="l02005"></a><span class="lineno"> 2005</span>      leastSquaresResidualNorm (<span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; A,</div>
<div class="line"><a id="l02006" name="l02006"></a><span class="lineno"> 2006</span>                                <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; x,</div>
<div class="line"><a id="l02007" name="l02007"></a><span class="lineno"> 2007</span>                                <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; b)</div>
<div class="line"><a id="l02008" name="l02008"></a><span class="lineno"> 2008</span>      {</div>
<div class="line"><a id="l02009" name="l02009"></a><span class="lineno"> 2009</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> r (b.numRows(), b.numCols());</div>
<div class="line"><a id="l02010" name="l02010"></a><span class="lineno"> 2010</span> </div>
<div class="line"><a id="l02011" name="l02011"></a><span class="lineno"> 2011</span>        <span class="comment">// r := b - A*x</span></div>
<div class="line"><a id="l02012" name="l02012"></a><span class="lineno"> 2012</span>        r.assign (b);</div>
<div class="line"><a id="l02013" name="l02013"></a><span class="lineno"> 2013</span>        LocalDenseMatrixOps&lt;Scalar&gt; ops;</div>
<div class="line"><a id="l02014" name="l02014"></a><span class="lineno"> 2014</span>        ops.matMatMult (STS::one(), r, -STS::one(), A, x);</div>
<div class="line"><a id="l02015" name="l02015"></a><span class="lineno"> 2015</span>        <span class="keywordflow">return</span> r.normFrobenius ();</div>
<div class="line"><a id="l02016" name="l02016"></a><span class="lineno"> 2016</span>      }</div>
<div class="line"><a id="l02017" name="l02017"></a><span class="lineno"> 2017</span> </div>
<div class="line"><a id="l02022" name="l02022"></a><span class="lineno"> 2022</span>      <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a></div>
<div class="line"><a id="l02023" name="l02023"></a><span class="lineno"> 2023</span>      solutionError (<span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; x_approx,</div>
<div class="line"><a id="l02024" name="l02024"></a><span class="lineno"> 2024</span>                     <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; x_exact)</div>
<div class="line"><a id="l02025" name="l02025"></a><span class="lineno"> 2025</span>      {</div>
<div class="line"><a id="l02026" name="l02026"></a><span class="lineno"> 2026</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> numRows = x_exact.numRows();</div>
<div class="line"><a id="l02027" name="l02027"></a><span class="lineno"> 2027</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> numCols = x_exact.numCols();</div>
<div class="line"><a id="l02028" name="l02028"></a><span class="lineno"> 2028</span> </div>
<div class="line"><a id="l02029" name="l02029"></a><span class="lineno"> 2029</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> x_diff (numRows, numCols);</div>
<div class="line"><a id="l02030" name="l02030"></a><span class="lineno"> 2030</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; numCols; ++j) {</div>
<div class="line"><a id="l02031" name="l02031"></a><span class="lineno"> 2031</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numRows; ++i) {</div>
<div class="line"><a id="l02032" name="l02032"></a><span class="lineno"> 2032</span>            x_diff(i,j) = x_exact(i,j) - x_approx(i,j);</div>
<div class="line"><a id="l02033" name="l02033"></a><span class="lineno"> 2033</span>          }</div>
<div class="line"><a id="l02034" name="l02034"></a><span class="lineno"> 2034</span>        }</div>
<div class="line"><a id="l02035" name="l02035"></a><span class="lineno"> 2035</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> scalingFactor = x_exact.normFrobenius();</div>
<div class="line"><a id="l02036" name="l02036"></a><span class="lineno"> 2036</span> </div>
<div class="line"><a id="l02037" name="l02037"></a><span class="lineno"> 2037</span>        <span class="comment">// If x_exact has zero norm, just use the absolute difference.</span></div>
<div class="line"><a id="l02038" name="l02038"></a><span class="lineno"> 2038</span>        <span class="keywordflow">return</span> x_diff.normFrobenius() /</div>
<div class="line"><a id="l02039" name="l02039"></a><span class="lineno"> 2039</span>          (scalingFactor == STM::zero() ? STM::one() : scalingFactor);</div>
<div class="line"><a id="l02040" name="l02040"></a><span class="lineno"> 2040</span>      }</div>
<div class="line"><a id="l02041" name="l02041"></a><span class="lineno"> 2041</span> </div>
<div class="line"><a id="l02088" name="l02088"></a><span class="lineno"> 2088</span>      <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a></div>
<div class="line"><a id="l02089" name="l02089"></a><span class="lineno"> 2089</span>      updateColumnGivens (<span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; H,</div>
<div class="line"><a id="l02090" name="l02090"></a><span class="lineno"> 2090</span>                          <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; R,</div>
<div class="line"><a id="l02091" name="l02091"></a><span class="lineno"> 2091</span>                          <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; y,</div>
<div class="line"><a id="l02092" name="l02092"></a><span class="lineno"> 2092</span>                          <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; z,</div>
<div class="line"><a id="l02093" name="l02093"></a><span class="lineno"> 2093</span>                          Teuchos::ArrayView&lt;scalar_type&gt; theCosines,</div>
<div class="line"><a id="l02094" name="l02094"></a><span class="lineno"> 2094</span>                          Teuchos::ArrayView&lt;scalar_type&gt; theSines,</div>
<div class="line"><a id="l02095" name="l02095"></a><span class="lineno"> 2095</span>                          <span class="keyword">const</span> <span class="keywordtype">int</span> curCol)</div>
<div class="line"><a id="l02096" name="l02096"></a><span class="lineno"> 2096</span>      {</div>
<div class="line"><a id="l02097" name="l02097"></a><span class="lineno"> 2097</span>        <span class="keyword">using </span>std::cerr;</div>
<div class="line"><a id="l02098" name="l02098"></a><span class="lineno"> 2098</span>        <span class="keyword">using </span>std::endl;</div>
<div class="line"><a id="l02099" name="l02099"></a><span class="lineno"> 2099</span> </div>
<div class="line"><a id="l02100" name="l02100"></a><span class="lineno"> 2100</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> numRows = curCol + 2; <span class="comment">// curCol is zero-based</span></div>
<div class="line"><a id="l02101" name="l02101"></a><span class="lineno"> 2101</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> LDR = R.stride();</div>
<div class="line"><a id="l02102" name="l02102"></a><span class="lineno"> 2102</span>        <span class="keyword">const</span> <span class="keywordtype">bool</span> extraDebug = <span class="keyword">false</span>;</div>
<div class="line"><a id="l02103" name="l02103"></a><span class="lineno"> 2103</span> </div>
<div class="line"><a id="l02104" name="l02104"></a><span class="lineno"> 2104</span>        <span class="keywordflow">if</span> (extraDebug) {</div>
<div class="line"><a id="l02105" name="l02105"></a><span class="lineno"> 2105</span>          cerr &lt;&lt; <span class="stringliteral">&quot;updateColumnGivens: curCol = &quot;</span> &lt;&lt; curCol &lt;&lt; endl;</div>
<div class="line"><a id="l02106" name="l02106"></a><span class="lineno"> 2106</span>        }</div>
<div class="line"><a id="l02107" name="l02107"></a><span class="lineno"> 2107</span> </div>
<div class="line"><a id="l02108" name="l02108"></a><span class="lineno"> 2108</span>        <span class="comment">// View of H( 1:curCol+1, curCol ) (in Matlab notation, if</span></div>
<div class="line"><a id="l02109" name="l02109"></a><span class="lineno"> 2109</span>        <span class="comment">// curCol were a one-based index, as it would be in Matlab but</span></div>
<div class="line"><a id="l02110" name="l02110"></a><span class="lineno"> 2110</span>        <span class="comment">// is not here).</span></div>
<div class="line"><a id="l02111" name="l02111"></a><span class="lineno"> 2111</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> H_col (Teuchos::View, H, numRows, 1, 0, curCol);</div>
<div class="line"><a id="l02112" name="l02112"></a><span class="lineno"> 2112</span> </div>
<div class="line"><a id="l02113" name="l02113"></a><span class="lineno"> 2113</span>        <span class="comment">// View of R( 1:curCol+1, curCol ) (again, in Matlab notation,</span></div>
<div class="line"><a id="l02114" name="l02114"></a><span class="lineno"> 2114</span>        <span class="comment">// if curCol were a one-based index).</span></div>
<div class="line"><a id="l02115" name="l02115"></a><span class="lineno"> 2115</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> R_col (Teuchos::View, R, numRows, 1, 0, curCol);</div>
<div class="line"><a id="l02116" name="l02116"></a><span class="lineno"> 2116</span> </div>
<div class="line"><a id="l02117" name="l02117"></a><span class="lineno"> 2117</span>        <span class="comment">// 1. Copy the current column from H into R, where it will be</span></div>
<div class="line"><a id="l02118" name="l02118"></a><span class="lineno"> 2118</span>        <span class="comment">//    modified.</span></div>
<div class="line"><a id="l02119" name="l02119"></a><span class="lineno"> 2119</span>        R_col.assign (H_col);</div>
<div class="line"><a id="l02120" name="l02120"></a><span class="lineno"> 2120</span> </div>
<div class="line"><a id="l02121" name="l02121"></a><span class="lineno"> 2121</span>        <span class="keywordflow">if</span> (extraDebug) {</div>
<div class="line"><a id="l02122" name="l02122"></a><span class="lineno"> 2122</span>          printMatrix&lt;Scalar&gt; (cerr, <span class="stringliteral">&quot;R_col before &quot;</span>, R_col);</div>
<div class="line"><a id="l02123" name="l02123"></a><span class="lineno"> 2123</span>        }</div>
<div class="line"><a id="l02124" name="l02124"></a><span class="lineno"> 2124</span> </div>
<div class="line"><a id="l02125" name="l02125"></a><span class="lineno"> 2125</span>        <span class="comment">// 2. Apply all the previous Givens rotations, if any, to the</span></div>
<div class="line"><a id="l02126" name="l02126"></a><span class="lineno"> 2126</span>        <span class="comment">//    current column of the matrix.</span></div>
<div class="line"><a id="l02127" name="l02127"></a><span class="lineno"> 2127</span>        blas_type blas;</div>
<div class="line"><a id="l02128" name="l02128"></a><span class="lineno"> 2128</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; curCol; ++j) {</div>
<div class="line"><a id="l02129" name="l02129"></a><span class="lineno"> 2129</span>          <span class="comment">// BLAS::ROT really should take &quot;const Scalar*&quot; for these</span></div>
<div class="line"><a id="l02130" name="l02130"></a><span class="lineno"> 2130</span>          <span class="comment">// arguments, but it wants a &quot;Scalar*&quot; instead, alas.</span></div>
<div class="line"><a id="l02131" name="l02131"></a><span class="lineno"> 2131</span>          Scalar theCosine = theCosines[j];</div>
<div class="line"><a id="l02132" name="l02132"></a><span class="lineno"> 2132</span>          Scalar theSine = theSines[j];</div>
<div class="line"><a id="l02133" name="l02133"></a><span class="lineno"> 2133</span> </div>
<div class="line"><a id="l02134" name="l02134"></a><span class="lineno"> 2134</span>          <span class="keywordflow">if</span> (extraDebug) {</div>
<div class="line"><a id="l02135" name="l02135"></a><span class="lineno"> 2135</span>            cerr &lt;&lt; <span class="stringliteral">&quot;  j = &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;: (cos,sin) = &quot;</span></div>
<div class="line"><a id="l02136" name="l02136"></a><span class="lineno"> 2136</span>                 &lt;&lt; theCosines[j] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; theSines[j] &lt;&lt; endl;</div>
<div class="line"><a id="l02137" name="l02137"></a><span class="lineno"> 2137</span>          }</div>
<div class="line"><a id="l02138" name="l02138"></a><span class="lineno"> 2138</span>          blas.ROT (1, &amp;R_col(j,0), LDR, &amp;R_col(j+1,0), LDR,</div>
<div class="line"><a id="l02139" name="l02139"></a><span class="lineno"> 2139</span>                    &amp;theCosine, &amp;theSine);</div>
<div class="line"><a id="l02140" name="l02140"></a><span class="lineno"> 2140</span>        }</div>
<div class="line"><a id="l02141" name="l02141"></a><span class="lineno"> 2141</span>        <span class="keywordflow">if</span> (extraDebug &amp;&amp; curCol &gt; 0) {</div>
<div class="line"><a id="l02142" name="l02142"></a><span class="lineno"> 2142</span>          printMatrix&lt;Scalar&gt; (cerr, <span class="stringliteral">&quot;R_col after applying previous &quot;</span></div>
<div class="line"><a id="l02143" name="l02143"></a><span class="lineno"> 2143</span>                               <span class="stringliteral">&quot;Givens rotations&quot;</span>, R_col);</div>
<div class="line"><a id="l02144" name="l02144"></a><span class="lineno"> 2144</span>        }</div>
<div class="line"><a id="l02145" name="l02145"></a><span class="lineno"> 2145</span> </div>
<div class="line"><a id="l02146" name="l02146"></a><span class="lineno"> 2146</span>        <span class="comment">// 3. Calculate new Givens rotation for R(curCol, curCol),</span></div>
<div class="line"><a id="l02147" name="l02147"></a><span class="lineno"> 2147</span>        <span class="comment">//    R(curCol+1, curCol).</span></div>
<div class="line"><a id="l02148" name="l02148"></a><span class="lineno"> 2148</span>        Scalar theCosine, theSine, result;</div>
<div class="line"><a id="l02149" name="l02149"></a><span class="lineno"> 2149</span>        computeGivensRotation (R_col(curCol,0), R_col(curCol+1,0),</div>
<div class="line"><a id="l02150" name="l02150"></a><span class="lineno"> 2150</span>                               theCosine, theSine, result);</div>
<div class="line"><a id="l02151" name="l02151"></a><span class="lineno"> 2151</span>        theCosines[curCol] = theCosine;</div>
<div class="line"><a id="l02152" name="l02152"></a><span class="lineno"> 2152</span>        theSines[curCol] = theSine;</div>
<div class="line"><a id="l02153" name="l02153"></a><span class="lineno"> 2153</span> </div>
<div class="line"><a id="l02154" name="l02154"></a><span class="lineno"> 2154</span>        <span class="keywordflow">if</span> (extraDebug) {</div>
<div class="line"><a id="l02155" name="l02155"></a><span class="lineno"> 2155</span>          cerr &lt;&lt; <span class="stringliteral">&quot;  New cos,sin = &quot;</span> &lt;&lt; theCosine &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; theSine &lt;&lt; endl;</div>
<div class="line"><a id="l02156" name="l02156"></a><span class="lineno"> 2156</span>        }</div>
<div class="line"><a id="l02157" name="l02157"></a><span class="lineno"> 2157</span> </div>
<div class="line"><a id="l02158" name="l02158"></a><span class="lineno"> 2158</span>        <span class="comment">// 4. _Apply_ the new Givens rotation.  We don&#39;t need to</span></div>
<div class="line"><a id="l02159" name="l02159"></a><span class="lineno"> 2159</span>        <span class="comment">//    invoke _ROT here, because computeGivensRotation()</span></div>
<div class="line"><a id="l02160" name="l02160"></a><span class="lineno"> 2160</span>        <span class="comment">//    already gives us the result: [x; y] -&gt; [result; 0].</span></div>
<div class="line"><a id="l02161" name="l02161"></a><span class="lineno"> 2161</span>        R_col(curCol, 0) = result;</div>
<div class="line"><a id="l02162" name="l02162"></a><span class="lineno"> 2162</span>        R_col(curCol+1, 0) = STS::zero();</div>
<div class="line"><a id="l02163" name="l02163"></a><span class="lineno"> 2163</span> </div>
<div class="line"><a id="l02164" name="l02164"></a><span class="lineno"> 2164</span>        <span class="keywordflow">if</span> (extraDebug) {</div>
<div class="line"><a id="l02165" name="l02165"></a><span class="lineno"> 2165</span>          printMatrix&lt;Scalar&gt; (cerr, <span class="stringliteral">&quot;R_col after applying current &quot;</span></div>
<div class="line"><a id="l02166" name="l02166"></a><span class="lineno"> 2166</span>                               <span class="stringliteral">&quot;Givens rotation&quot;</span>, R_col);</div>
<div class="line"><a id="l02167" name="l02167"></a><span class="lineno"> 2167</span>        }</div>
<div class="line"><a id="l02168" name="l02168"></a><span class="lineno"> 2168</span> </div>
<div class="line"><a id="l02169" name="l02169"></a><span class="lineno"> 2169</span>        <span class="comment">// 5. Apply the resulting Givens rotation to z (the right-hand</span></div>
<div class="line"><a id="l02170" name="l02170"></a><span class="lineno"> 2170</span>        <span class="comment">//    side of the projected least-squares problem).</span></div>
<div class="line"><a id="l02171" name="l02171"></a><span class="lineno"> 2171</span>        <span class="comment">//</span></div>
<div class="line"><a id="l02172" name="l02172"></a><span class="lineno"> 2172</span>        <span class="comment">// We prefer overgeneralization to undergeneralization by assuming</span></div>
<div class="line"><a id="l02173" name="l02173"></a><span class="lineno"> 2173</span>        <span class="comment">// here that z may have more than one column.</span></div>
<div class="line"><a id="l02174" name="l02174"></a><span class="lineno"> 2174</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> LDZ = z.stride();</div>
<div class="line"><a id="l02175" name="l02175"></a><span class="lineno"> 2175</span>        blas.ROT (z.numCols(),</div>
<div class="line"><a id="l02176" name="l02176"></a><span class="lineno"> 2176</span>                  &amp;z(curCol,0), LDZ, &amp;z(curCol+1,0), LDZ,</div>
<div class="line"><a id="l02177" name="l02177"></a><span class="lineno"> 2177</span>                  &amp;theCosine, &amp;theSine);</div>
<div class="line"><a id="l02178" name="l02178"></a><span class="lineno"> 2178</span> </div>
<div class="line"><a id="l02179" name="l02179"></a><span class="lineno"> 2179</span>        <span class="keywordflow">if</span> (extraDebug) {</div>
<div class="line"><a id="l02180" name="l02180"></a><span class="lineno"> 2180</span>          <span class="comment">//mat_type R_after (Teuchos::View, R, numRows, numRows-1);</span></div>
<div class="line"><a id="l02181" name="l02181"></a><span class="lineno"> 2181</span>          <span class="comment">//printMatrix&lt;Scalar&gt; (cerr, &quot;R_after&quot;, R_after);</span></div>
<div class="line"><a id="l02182" name="l02182"></a><span class="lineno"> 2182</span>          <span class="comment">//mat_type z_after (Teuchos::View, z, numRows, z.numCols());</span></div>
<div class="line"><a id="l02183" name="l02183"></a><span class="lineno"> 2183</span>          printMatrix&lt;Scalar&gt; (cerr, <span class="stringliteral">&quot;z_after&quot;</span>, z);</div>
<div class="line"><a id="l02184" name="l02184"></a><span class="lineno"> 2184</span>        }</div>
<div class="line"><a id="l02185" name="l02185"></a><span class="lineno"> 2185</span> </div>
<div class="line"><a id="l02186" name="l02186"></a><span class="lineno"> 2186</span>        <span class="comment">// The last entry of z is the nonzero part of the residual of the</span></div>
<div class="line"><a id="l02187" name="l02187"></a><span class="lineno"> 2187</span>        <span class="comment">// least-squares problem.  Its magnitude gives the residual 2-norm</span></div>
<div class="line"><a id="l02188" name="l02188"></a><span class="lineno"> 2188</span>        <span class="comment">// of the least-squares problem.</span></div>
<div class="line"><a id="l02189" name="l02189"></a><span class="lineno"> 2189</span>        <span class="keywordflow">return</span> STS::magnitude( z(numRows-1, 0) );</div>
<div class="line"><a id="l02190" name="l02190"></a><span class="lineno"> 2190</span>      }</div>
<div class="line"><a id="l02191" name="l02191"></a><span class="lineno"> 2191</span> </div>
<div class="line"><a id="l02225" name="l02225"></a><span class="lineno"> 2225</span>      <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a></div>
<div class="line"><a id="l02226" name="l02226"></a><span class="lineno"> 2226</span>      solveLapack (<span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; H,</div>
<div class="line"><a id="l02227" name="l02227"></a><span class="lineno"> 2227</span>                   <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; R,</div>
<div class="line"><a id="l02228" name="l02228"></a><span class="lineno"> 2228</span>                   <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; y,</div>
<div class="line"><a id="l02229" name="l02229"></a><span class="lineno"> 2229</span>                   <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; z,</div>
<div class="line"><a id="l02230" name="l02230"></a><span class="lineno"> 2230</span>                   <span class="keyword">const</span> <span class="keywordtype">int</span> curCol)</div>
<div class="line"><a id="l02231" name="l02231"></a><span class="lineno"> 2231</span>      {</div>
<div class="line"><a id="l02232" name="l02232"></a><span class="lineno"> 2232</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> numRows = curCol + 2;</div>
<div class="line"><a id="l02233" name="l02233"></a><span class="lineno"> 2233</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> numCols = curCol + 1;</div>
<div class="line"><a id="l02234" name="l02234"></a><span class="lineno"> 2234</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> LDR = R.stride();</div>
<div class="line"><a id="l02235" name="l02235"></a><span class="lineno"> 2235</span> </div>
<div class="line"><a id="l02236" name="l02236"></a><span class="lineno"> 2236</span>        <span class="comment">// Copy H( 1:curCol+1, 1:curCol ) into R( 1:curCol+1, 1:curCol ).</span></div>
<div class="line"><a id="l02237" name="l02237"></a><span class="lineno"> 2237</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> H_view (Teuchos::View, H, numRows, numCols);</div>
<div class="line"><a id="l02238" name="l02238"></a><span class="lineno"> 2238</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> R_view (Teuchos::View, R, numRows, numCols);</div>
<div class="line"><a id="l02239" name="l02239"></a><span class="lineno"> 2239</span>        R_view.assign (H_view);</div>
<div class="line"><a id="l02240" name="l02240"></a><span class="lineno"> 2240</span> </div>
<div class="line"><a id="l02241" name="l02241"></a><span class="lineno"> 2241</span>        <span class="comment">// The LAPACK least-squares solver overwrites the right-hand side</span></div>
<div class="line"><a id="l02242" name="l02242"></a><span class="lineno"> 2242</span>        <span class="comment">// vector with the solution, so first copy z into y.</span></div>
<div class="line"><a id="l02243" name="l02243"></a><span class="lineno"> 2243</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> y_view (Teuchos::View, y, numRows, y.numCols());</div>
<div class="line"><a id="l02244" name="l02244"></a><span class="lineno"> 2244</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> z_view (Teuchos::View, z, numRows, y.numCols());</div>
<div class="line"><a id="l02245" name="l02245"></a><span class="lineno"> 2245</span>        y_view.assign (z_view);</div>
<div class="line"><a id="l02246" name="l02246"></a><span class="lineno"> 2246</span> </div>
<div class="line"><a id="l02247" name="l02247"></a><span class="lineno"> 2247</span>        <span class="comment">// Workspace query for the least-squares routine.</span></div>
<div class="line"><a id="l02248" name="l02248"></a><span class="lineno"> 2248</span>        <span class="keywordtype">int</span> info = 0;</div>
<div class="line"><a id="l02249" name="l02249"></a><span class="lineno"> 2249</span>        Scalar lworkScalar = STS::zero();</div>
<div class="line"><a id="l02250" name="l02250"></a><span class="lineno"> 2250</span>        lapack_type lapack;</div>
<div class="line"><a id="l02251" name="l02251"></a><span class="lineno"> 2251</span>        lapack.GELS (<span class="charliteral">&#39;N&#39;</span>, numRows, numCols, y_view.numCols(),</div>
<div class="line"><a id="l02252" name="l02252"></a><span class="lineno"> 2252</span>                     NULL, LDR, NULL, y_view.stride(),</div>
<div class="line"><a id="l02253" name="l02253"></a><span class="lineno"> 2253</span>                     &amp;lworkScalar, -1, &amp;info);</div>
<div class="line"><a id="l02254" name="l02254"></a><span class="lineno"> 2254</span>        TEUCHOS_TEST_FOR_EXCEPTION(info != 0, std::logic_error,</div>
<div class="line"><a id="l02255" name="l02255"></a><span class="lineno"> 2255</span>                           <span class="stringliteral">&quot;LAPACK _GELS workspace query failed with INFO = &quot;</span></div>
<div class="line"><a id="l02256" name="l02256"></a><span class="lineno"> 2256</span>                           &lt;&lt; info &lt;&lt; <span class="stringliteral">&quot;, for a &quot;</span> &lt;&lt; numRows &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; numCols</div>
<div class="line"><a id="l02257" name="l02257"></a><span class="lineno"> 2257</span>                           &lt;&lt; <span class="stringliteral">&quot; matrix with &quot;</span> &lt;&lt; y_view.numCols()</div>
<div class="line"><a id="l02258" name="l02258"></a><span class="lineno"> 2258</span>                           &lt;&lt; <span class="stringliteral">&quot; right hand side&quot;</span></div>
<div class="line"><a id="l02259" name="l02259"></a><span class="lineno"> 2259</span>                           &lt;&lt; ((y_view.numCols() != 1) ? <span class="stringliteral">&quot;s&quot;</span> : <span class="stringliteral">&quot;&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l02260" name="l02260"></a><span class="lineno"> 2260</span>        TEUCHOS_TEST_FOR_EXCEPTION(STS::real(lworkScalar) &lt; STM::zero(),</div>
<div class="line"><a id="l02261" name="l02261"></a><span class="lineno"> 2261</span>                           std::logic_error,</div>
<div class="line"><a id="l02262" name="l02262"></a><span class="lineno"> 2262</span>                           <span class="stringliteral">&quot;LAPACK _GELS workspace query returned an LWORK with &quot;</span></div>
<div class="line"><a id="l02263" name="l02263"></a><span class="lineno"> 2263</span>                           <span class="stringliteral">&quot;negative real part: LWORK = &quot;</span> &lt;&lt; lworkScalar</div>
<div class="line"><a id="l02264" name="l02264"></a><span class="lineno"> 2264</span>                           &lt;&lt; <span class="stringliteral">&quot;.  That should never happen.  Please report this &quot;</span></div>
<div class="line"><a id="l02265" name="l02265"></a><span class="lineno"> 2265</span>                           <span class="stringliteral">&quot;to the Belos developers.&quot;</span>);</div>
<div class="line"><a id="l02266" name="l02266"></a><span class="lineno"> 2266</span>        TEUCHOS_TEST_FOR_EXCEPTION(STS::isComplex &amp;&amp; STS::imag(lworkScalar) != STM::zero(),</div>
<div class="line"><a id="l02267" name="l02267"></a><span class="lineno"> 2267</span>                           std::logic_error,</div>
<div class="line"><a id="l02268" name="l02268"></a><span class="lineno"> 2268</span>                           <span class="stringliteral">&quot;LAPACK _GELS workspace query returned an LWORK with &quot;</span></div>
<div class="line"><a id="l02269" name="l02269"></a><span class="lineno"> 2269</span>                           <span class="stringliteral">&quot;nonzero imaginary part: LWORK = &quot;</span> &lt;&lt; lworkScalar</div>
<div class="line"><a id="l02270" name="l02270"></a><span class="lineno"> 2270</span>                           &lt;&lt; <span class="stringliteral">&quot;.  That should never happen.  Please report this &quot;</span></div>
<div class="line"><a id="l02271" name="l02271"></a><span class="lineno"> 2271</span>                           <span class="stringliteral">&quot;to the Belos developers.&quot;</span>);</div>
<div class="line"><a id="l02272" name="l02272"></a><span class="lineno"> 2272</span>        <span class="comment">// Cast workspace from Scalar to int.  Scalar may be complex,</span></div>
<div class="line"><a id="l02273" name="l02273"></a><span class="lineno"> 2273</span>        <span class="comment">// hence the request for the real part.  Don&#39;t ask for the</span></div>
<div class="line"><a id="l02274" name="l02274"></a><span class="lineno"> 2274</span>        <span class="comment">// magnitude, since computing the magnitude may overflow due</span></div>
<div class="line"><a id="l02275" name="l02275"></a><span class="lineno"> 2275</span>        <span class="comment">// to squaring and square root to int.  Hopefully LAPACK</span></div>
<div class="line"><a id="l02276" name="l02276"></a><span class="lineno"> 2276</span>        <span class="comment">// doesn&#39;t ever overflow int this way.</span></div>
<div class="line"><a id="l02277" name="l02277"></a><span class="lineno"> 2277</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> lwork = std::max (1, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (STS::real (lworkScalar)));</div>
<div class="line"><a id="l02278" name="l02278"></a><span class="lineno"> 2278</span> </div>
<div class="line"><a id="l02279" name="l02279"></a><span class="lineno"> 2279</span>        <span class="comment">// Allocate workspace for solving the least-squares problem.</span></div>
<div class="line"><a id="l02280" name="l02280"></a><span class="lineno"> 2280</span>        Teuchos::Array&lt;Scalar&gt; work (lwork);</div>
<div class="line"><a id="l02281" name="l02281"></a><span class="lineno"> 2281</span> </div>
<div class="line"><a id="l02282" name="l02282"></a><span class="lineno"> 2282</span>        <span class="comment">// Solve the least-squares problem.  The ?: operator prevents</span></div>
<div class="line"><a id="l02283" name="l02283"></a><span class="lineno"> 2283</span>        <span class="comment">// accessing the first element of the work array, if it has</span></div>
<div class="line"><a id="l02284" name="l02284"></a><span class="lineno"> 2284</span>        <span class="comment">// length zero.</span></div>
<div class="line"><a id="l02285" name="l02285"></a><span class="lineno"> 2285</span>        lapack.GELS (<span class="charliteral">&#39;N&#39;</span>, numRows, numCols, y_view.numCols(),</div>
<div class="line"><a id="l02286" name="l02286"></a><span class="lineno"> 2286</span>                     R_view.values(), R_view.stride(),</div>
<div class="line"><a id="l02287" name="l02287"></a><span class="lineno"> 2287</span>                     y_view.values(), y_view.stride(),</div>
<div class="line"><a id="l02288" name="l02288"></a><span class="lineno"> 2288</span>                     (lwork &gt; 0 ? &amp;work[0] : (Scalar*) NULL),</div>
<div class="line"><a id="l02289" name="l02289"></a><span class="lineno"> 2289</span>                     lwork, &amp;info);</div>
<div class="line"><a id="l02290" name="l02290"></a><span class="lineno"> 2290</span> </div>
<div class="line"><a id="l02291" name="l02291"></a><span class="lineno"> 2291</span>        TEUCHOS_TEST_FOR_EXCEPTION(info != 0, std::logic_error,</div>
<div class="line"><a id="l02292" name="l02292"></a><span class="lineno"> 2292</span>                           <span class="stringliteral">&quot;Solving projected least-squares problem with LAPACK &quot;</span></div>
<div class="line"><a id="l02293" name="l02293"></a><span class="lineno"> 2293</span>                           <span class="stringliteral">&quot;_GELS failed with INFO = &quot;</span> &lt;&lt; info &lt;&lt; <span class="stringliteral">&quot;, for a &quot;</span></div>
<div class="line"><a id="l02294" name="l02294"></a><span class="lineno"> 2294</span>                           &lt;&lt; numRows &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; numCols &lt;&lt; <span class="stringliteral">&quot; matrix with &quot;</span></div>
<div class="line"><a id="l02295" name="l02295"></a><span class="lineno"> 2295</span>                           &lt;&lt; y_view.numCols() &lt;&lt; <span class="stringliteral">&quot; right hand side&quot;</span></div>
<div class="line"><a id="l02296" name="l02296"></a><span class="lineno"> 2296</span>                           &lt;&lt; (y_view.numCols() != 1 ? <span class="stringliteral">&quot;s&quot;</span> : <span class="stringliteral">&quot;&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l02297" name="l02297"></a><span class="lineno"> 2297</span>        <span class="comment">// Extract the projected least-squares problem&#39;s residual error.</span></div>
<div class="line"><a id="l02298" name="l02298"></a><span class="lineno"> 2298</span>        <span class="comment">// It&#39;s the magnitude of the last entry of y_view on output from</span></div>
<div class="line"><a id="l02299" name="l02299"></a><span class="lineno"> 2299</span>        <span class="comment">// LAPACK&#39;s least-squares solver.</span></div>
<div class="line"><a id="l02300" name="l02300"></a><span class="lineno"> 2300</span>        <span class="keywordflow">return</span> STS::magnitude( y_view(numRows-1, 0) );</div>
<div class="line"><a id="l02301" name="l02301"></a><span class="lineno"> 2301</span>      }</div>
<div class="line"><a id="l02302" name="l02302"></a><span class="lineno"> 2302</span> </div>
<div class="line"><a id="l02313" name="l02313"></a><span class="lineno"> 2313</span>      <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a></div>
<div class="line"><a id="l02314" name="l02314"></a><span class="lineno"> 2314</span>      updateColumnsGivens (<span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; H,</div>
<div class="line"><a id="l02315" name="l02315"></a><span class="lineno"> 2315</span>                           <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; R,</div>
<div class="line"><a id="l02316" name="l02316"></a><span class="lineno"> 2316</span>                           <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; y,</div>
<div class="line"><a id="l02317" name="l02317"></a><span class="lineno"> 2317</span>                           <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; z,</div>
<div class="line"><a id="l02318" name="l02318"></a><span class="lineno"> 2318</span>                           Teuchos::ArrayView&lt;scalar_type&gt; theCosines,</div>
<div class="line"><a id="l02319" name="l02319"></a><span class="lineno"> 2319</span>                           Teuchos::ArrayView&lt;scalar_type&gt; theSines,</div>
<div class="line"><a id="l02320" name="l02320"></a><span class="lineno"> 2320</span>                           <span class="keyword">const</span> <span class="keywordtype">int</span> startCol,</div>
<div class="line"><a id="l02321" name="l02321"></a><span class="lineno"> 2321</span>                           <span class="keyword">const</span> <span class="keywordtype">int</span> endCol)</div>
<div class="line"><a id="l02322" name="l02322"></a><span class="lineno"> 2322</span>      {</div>
<div class="line"><a id="l02323" name="l02323"></a><span class="lineno"> 2323</span>        TEUCHOS_TEST_FOR_EXCEPTION(startCol &gt; endCol, std::invalid_argument,</div>
<div class="line"><a id="l02324" name="l02324"></a><span class="lineno"> 2324</span>                           <span class="stringliteral">&quot;updateColumnGivens: startCol = &quot;</span> &lt;&lt; startCol</div>
<div class="line"><a id="l02325" name="l02325"></a><span class="lineno"> 2325</span>                           &lt;&lt; <span class="stringliteral">&quot; &gt; endCol = &quot;</span> &lt;&lt; endCol &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l02326" name="l02326"></a><span class="lineno"> 2326</span>        <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a> lastResult = STM::zero();</div>
<div class="line"><a id="l02327" name="l02327"></a><span class="lineno"> 2327</span>        <span class="comment">// [startCol, endCol] is an inclusive range.</span></div>
<div class="line"><a id="l02328" name="l02328"></a><span class="lineno"> 2328</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> curCol = startCol; curCol &lt;= endCol; ++curCol) {</div>
<div class="line"><a id="l02329" name="l02329"></a><span class="lineno"> 2329</span>          lastResult = updateColumnGivens (H, R, y, z, theCosines, theSines, curCol);</div>
<div class="line"><a id="l02330" name="l02330"></a><span class="lineno"> 2330</span>        }</div>
<div class="line"><a id="l02331" name="l02331"></a><span class="lineno"> 2331</span>        <span class="keywordflow">return</span> lastResult;</div>
<div class="line"><a id="l02332" name="l02332"></a><span class="lineno"> 2332</span>      }</div>
<div class="line"><a id="l02333" name="l02333"></a><span class="lineno"> 2333</span> </div>
<div class="line"><a id="l02346" name="l02346"></a><span class="lineno"> 2346</span>      <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">magnitude_type</a></div>
<div class="line"><a id="l02347" name="l02347"></a><span class="lineno"> 2347</span>      updateColumnsGivensBlock (<span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; H,</div>
<div class="line"><a id="l02348" name="l02348"></a><span class="lineno"> 2348</span>                                <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; R,</div>
<div class="line"><a id="l02349" name="l02349"></a><span class="lineno"> 2349</span>                                <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; y,</div>
<div class="line"><a id="l02350" name="l02350"></a><span class="lineno"> 2350</span>                                <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a>&amp; z,</div>
<div class="line"><a id="l02351" name="l02351"></a><span class="lineno"> 2351</span>                                Teuchos::ArrayView&lt;scalar_type&gt; theCosines,</div>
<div class="line"><a id="l02352" name="l02352"></a><span class="lineno"> 2352</span>                                Teuchos::ArrayView&lt;scalar_type&gt; theSines,</div>
<div class="line"><a id="l02353" name="l02353"></a><span class="lineno"> 2353</span>                                <span class="keyword">const</span> <span class="keywordtype">int</span> startCol,</div>
<div class="line"><a id="l02354" name="l02354"></a><span class="lineno"> 2354</span>                                <span class="keyword">const</span> <span class="keywordtype">int</span> endCol)</div>
<div class="line"><a id="l02355" name="l02355"></a><span class="lineno"> 2355</span>      {</div>
<div class="line"><a id="l02356" name="l02356"></a><span class="lineno"> 2356</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> numRows = endCol + 2;</div>
<div class="line"><a id="l02357" name="l02357"></a><span class="lineno"> 2357</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> numColsToUpdate = endCol - startCol + 1;</div>
<div class="line"><a id="l02358" name="l02358"></a><span class="lineno"> 2358</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> LDR = R.stride();</div>
<div class="line"><a id="l02359" name="l02359"></a><span class="lineno"> 2359</span> </div>
<div class="line"><a id="l02360" name="l02360"></a><span class="lineno"> 2360</span>        <span class="comment">// 1. Copy columns [startCol, endCol] from H into R, where they</span></div>
<div class="line"><a id="l02361" name="l02361"></a><span class="lineno"> 2361</span>        <span class="comment">//    will be modified.</span></div>
<div class="line"><a id="l02362" name="l02362"></a><span class="lineno"> 2362</span>        {</div>
<div class="line"><a id="l02363" name="l02363"></a><span class="lineno"> 2363</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> H_view (Teuchos::View, H, numRows, numColsToUpdate, 0, startCol);</div>
<div class="line"><a id="l02364" name="l02364"></a><span class="lineno"> 2364</span>          <a class="code hl_typedef" href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">mat_type</a> R_view (Teuchos::View, R, numRows, numColsToUpdate, 0, startCol);</div>
<div class="line"><a id="l02365" name="l02365"></a><span class="lineno"> 2365</span>          R_view.assign (H_view);</div>
<div class="line"><a id="l02366" name="l02366"></a><span class="lineno"> 2366</span>        }</div>
<div class="line"><a id="l02367" name="l02367"></a><span class="lineno"> 2367</span> </div>
<div class="line"><a id="l02368" name="l02368"></a><span class="lineno"> 2368</span>        <span class="comment">// 2. Apply all the previous Givens rotations, if any, to</span></div>
<div class="line"><a id="l02369" name="l02369"></a><span class="lineno"> 2369</span>        <span class="comment">//    columns [startCol, endCol] of the matrix.  (Remember</span></div>
<div class="line"><a id="l02370" name="l02370"></a><span class="lineno"> 2370</span>        <span class="comment">//    that we&#39;re using a left-looking QR factorization</span></div>
<div class="line"><a id="l02371" name="l02371"></a><span class="lineno"> 2371</span>        <span class="comment">//    approach; we haven&#39;t yet touched those columns.)</span></div>
<div class="line"><a id="l02372" name="l02372"></a><span class="lineno"> 2372</span>        blas_type blas;</div>
<div class="line"><a id="l02373" name="l02373"></a><span class="lineno"> 2373</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; startCol; ++j) {</div>
<div class="line"><a id="l02374" name="l02374"></a><span class="lineno"> 2374</span>          blas.ROT (numColsToUpdate,</div>
<div class="line"><a id="l02375" name="l02375"></a><span class="lineno"> 2375</span>                    &amp;R(j, startCol), LDR, &amp;R(j+1, startCol), LDR,</div>
<div class="line"><a id="l02376" name="l02376"></a><span class="lineno"> 2376</span>                    &amp;theCosines[j], &amp;theSines[j]);</div>
<div class="line"><a id="l02377" name="l02377"></a><span class="lineno"> 2377</span>        }</div>
<div class="line"><a id="l02378" name="l02378"></a><span class="lineno"> 2378</span> </div>
<div class="line"><a id="l02379" name="l02379"></a><span class="lineno"> 2379</span>        <span class="comment">// 3. Update each column in turn of columns [startCol, endCol].</span></div>
<div class="line"><a id="l02380" name="l02380"></a><span class="lineno"> 2380</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> curCol = startCol; curCol &lt; endCol; ++curCol) {</div>
<div class="line"><a id="l02381" name="l02381"></a><span class="lineno"> 2381</span>          <span class="comment">// a. Apply the Givens rotations computed in previous</span></div>
<div class="line"><a id="l02382" name="l02382"></a><span class="lineno"> 2382</span>          <span class="comment">//    iterations of this loop to the current column of R.</span></div>
<div class="line"><a id="l02383" name="l02383"></a><span class="lineno"> 2383</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = startCol; j &lt; curCol; ++j) {</div>
<div class="line"><a id="l02384" name="l02384"></a><span class="lineno"> 2384</span>            blas.ROT (1, &amp;R(j, curCol), LDR, &amp;R(j+1, curCol), LDR,</div>
<div class="line"><a id="l02385" name="l02385"></a><span class="lineno"> 2385</span>                      &amp;theCosines[j], &amp;theSines[j]);</div>
<div class="line"><a id="l02386" name="l02386"></a><span class="lineno"> 2386</span>          }</div>
<div class="line"><a id="l02387" name="l02387"></a><span class="lineno"> 2387</span>          <span class="comment">// b. Calculate new Givens rotation for R(curCol, curCol),</span></div>
<div class="line"><a id="l02388" name="l02388"></a><span class="lineno"> 2388</span>          <span class="comment">//    R(curCol+1, curCol).</span></div>
<div class="line"><a id="l02389" name="l02389"></a><span class="lineno"> 2389</span>          Scalar theCosine, theSine, result;</div>
<div class="line"><a id="l02390" name="l02390"></a><span class="lineno"> 2390</span>          computeGivensRotation (R(curCol, curCol), R(curCol+1, curCol),</div>
<div class="line"><a id="l02391" name="l02391"></a><span class="lineno"> 2391</span>                                 theCosine, theSine, result);</div>
<div class="line"><a id="l02392" name="l02392"></a><span class="lineno"> 2392</span>          theCosines[curCol] = theCosine;</div>
<div class="line"><a id="l02393" name="l02393"></a><span class="lineno"> 2393</span>          theSines[curCol] = theSine;</div>
<div class="line"><a id="l02394" name="l02394"></a><span class="lineno"> 2394</span> </div>
<div class="line"><a id="l02395" name="l02395"></a><span class="lineno"> 2395</span>          <span class="comment">// c. _Apply_ the new Givens rotation.  We don&#39;t need to</span></div>
<div class="line"><a id="l02396" name="l02396"></a><span class="lineno"> 2396</span>          <span class="comment">//    invoke _ROT here, because computeGivensRotation()</span></div>
<div class="line"><a id="l02397" name="l02397"></a><span class="lineno"> 2397</span>          <span class="comment">//    already gives us the result: [x; y] -&gt; [result; 0].</span></div>
<div class="line"><a id="l02398" name="l02398"></a><span class="lineno"> 2398</span>          R(curCol+1, curCol) = result;</div>
<div class="line"><a id="l02399" name="l02399"></a><span class="lineno"> 2399</span>          R(curCol+1, curCol) = STS::zero();</div>
<div class="line"><a id="l02400" name="l02400"></a><span class="lineno"> 2400</span> </div>
<div class="line"><a id="l02401" name="l02401"></a><span class="lineno"> 2401</span>          <span class="comment">// d. Apply the resulting Givens rotation to z (the right-hand</span></div>
<div class="line"><a id="l02402" name="l02402"></a><span class="lineno"> 2402</span>          <span class="comment">//    side of the projected least-squares problem).</span></div>
<div class="line"><a id="l02403" name="l02403"></a><span class="lineno"> 2403</span>          <span class="comment">//</span></div>
<div class="line"><a id="l02404" name="l02404"></a><span class="lineno"> 2404</span>          <span class="comment">// We prefer overgeneralization to undergeneralization by</span></div>
<div class="line"><a id="l02405" name="l02405"></a><span class="lineno"> 2405</span>          <span class="comment">// assuming here that z may have more than one column.</span></div>
<div class="line"><a id="l02406" name="l02406"></a><span class="lineno"> 2406</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> LDZ = z.stride();</div>
<div class="line"><a id="l02407" name="l02407"></a><span class="lineno"> 2407</span>          blas.ROT (z.numCols(),</div>
<div class="line"><a id="l02408" name="l02408"></a><span class="lineno"> 2408</span>                    &amp;z(curCol,0), LDZ, &amp;z(curCol+1,0), LDZ,</div>
<div class="line"><a id="l02409" name="l02409"></a><span class="lineno"> 2409</span>                    &amp;theCosine, &amp;theSine);</div>
<div class="line"><a id="l02410" name="l02410"></a><span class="lineno"> 2410</span>        }</div>
<div class="line"><a id="l02411" name="l02411"></a><span class="lineno"> 2411</span> </div>
<div class="line"><a id="l02412" name="l02412"></a><span class="lineno"> 2412</span>        <span class="comment">// The last entry of z is the nonzero part of the residual of the</span></div>
<div class="line"><a id="l02413" name="l02413"></a><span class="lineno"> 2413</span>        <span class="comment">// least-squares problem.  Its magnitude gives the residual 2-norm</span></div>
<div class="line"><a id="l02414" name="l02414"></a><span class="lineno"> 2414</span>        <span class="comment">// of the least-squares problem.</span></div>
<div class="line"><a id="l02415" name="l02415"></a><span class="lineno"> 2415</span>        <span class="keywordflow">return</span> STS::magnitude( z(numRows-1, 0) );</div>
<div class="line"><a id="l02416" name="l02416"></a><span class="lineno"> 2416</span>      }</div>
<div class="line"><a id="l02417" name="l02417"></a><span class="lineno"> 2417</span>    }; <span class="comment">// class ProjectedLeastSquaresSolver</span></div>
</div>
<div class="line"><a id="l02418" name="l02418"></a><span class="lineno"> 2418</span>  } <span class="comment">// namespace details</span></div>
<div class="line"><a id="l02419" name="l02419"></a><span class="lineno"> 2419</span>} <span class="comment">// namespace Belos</span></div>
<div class="line"><a id="l02420" name="l02420"></a><span class="lineno"> 2420</span> </div>
<div class="line"><a id="l02421" name="l02421"></a><span class="lineno"> 2421</span><span class="preprocessor">#endif </span><span class="comment">// __Belos_ProjectedLeastSquaresSolver_hpp</span></div>
<div class="ttc" id="aBelosConfigDefs_8hpp_html"><div class="ttname"><a href="BelosConfigDefs_8hpp.html">BelosConfigDefs.hpp</a></div><div class="ttdoc">Belos header file which uses auto-configuration information to include necessary C++ headers.</div></div>
<div class="ttc" id="aBelosTypes_8hpp_html"><div class="ttname"><a href="BelosTypes_8hpp.html">BelosTypes.hpp</a></div><div class="ttdoc">Collection of types and exceptions used within the Belos solvers.</div></div>
<div class="ttc" id="aclassBelos_1_1Operator_html"><div class="ttname"><a href="classBelos_1_1Operator.html">Belos::Operator</a></div><div class="ttdoc">Alternative run-time polymorphic interface for operators.</div><div class="ttdef"><b>Definition</b> <a href="BelosOperator_8hpp_source.html#l00048">BelosOperator.hpp:48</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html">Belos::details::LocalDenseMatrixOps</a></div><div class="ttdoc">Low-level operations on non-distributed dense matrices.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00317">BelosProjectedLeastSquaresSolver.hpp:317</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_a1f7418279fcbc6e1691c315929411f35"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a1f7418279fcbc6e1691c315929411f35">Belos::details::LocalDenseMatrixOps::rightUpperTriSolve</a></div><div class="ttdeci">void rightUpperTriSolve(mat_type &amp;B, const mat_type &amp;R) const</div><div class="ttdoc">In Matlab notation: B = B / R, where R is upper triangular.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00504">BelosProjectedLeastSquaresSolver.hpp:504</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_a225ce097eb27a31879f23ce4c90d43b1"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a225ce097eb27a31879f23ce4c90d43b1">Belos::details::LocalDenseMatrixOps::mat_type</a></div><div class="ttdeci">Teuchos::SerialDenseMatrix&lt; int, Scalar &gt; mat_type</div><div class="ttdoc">The type of a dense matrix (or vector) of scalar_type.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00327">BelosProjectedLeastSquaresSolver.hpp:327</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_a2ae3df9261d1506caf172ecc2b4c2ca3"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a2ae3df9261d1506caf172ecc2b4c2ca3">Belos::details::LocalDenseMatrixOps::conjugateTranspose</a></div><div class="ttdeci">void conjugateTranspose(mat_type &amp;A_star, const mat_type &amp;A) const</div><div class="ttdoc">A_star := (conjugate) transpose of A.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00338">BelosProjectedLeastSquaresSolver.hpp:338</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_a346e571daaf8890c3b0078048b7c8b2c"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a346e571daaf8890c3b0078048b7c8b2c">Belos::details::LocalDenseMatrixOps::matSub</a></div><div class="ttdeci">void matSub(mat_type &amp;A, const mat_type &amp;B) const</div><div class="ttdoc">A := A - B.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00474">BelosProjectedLeastSquaresSolver.hpp:474</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_a4d69fff43e0ce49b4d6def139c2b527e"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a4d69fff43e0ce49b4d6def139c2b527e">Belos::details::LocalDenseMatrixOps::zeroOutStrictLowerTriangle</a></div><div class="ttdeci">void zeroOutStrictLowerTriangle(mat_type &amp;A) const</div><div class="ttdoc">Zero out everything below the diagonal of A.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00362">BelosProjectedLeastSquaresSolver.hpp:362</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_a61767554ecbd3da2331483d359e8350d"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a61767554ecbd3da2331483d359e8350d">Belos::details::LocalDenseMatrixOps::infNaNCount</a></div><div class="ttdeci">int infNaNCount(const mat_type &amp;A, const bool upperTriangular=false) const</div><div class="ttdoc">Return the number of Inf or NaN entries in the matrix A.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00566">BelosProjectedLeastSquaresSolver.hpp:566</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_a6262f83f52467d059290462a060917cf"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a6262f83f52467d059290462a060917cf">Belos::details::LocalDenseMatrixOps::isUpperTriangular</a></div><div class="ttdeci">std::pair&lt; bool, std::pair&lt; magnitude_type, magnitude_type &gt; &gt; isUpperTriangular(const mat_type &amp;A) const</div><div class="ttdoc">Is the matrix A upper triangular / trapezoidal?</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00593">BelosProjectedLeastSquaresSolver.hpp:593</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_a6b80f357230af3223a1c6ceabc02e572"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a6b80f357230af3223a1c6ceabc02e572">Belos::details::LocalDenseMatrixOps::ensureUpperHessenberg</a></div><div class="ttdeci">void ensureUpperHessenberg(const mat_type &amp;A, const char *const matrixName, const magnitude_type relativeTolerance) const</div><div class="ttdoc">Throw an exception if A is not &quot;approximately&quot; upper Hessenberg.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00710">BelosProjectedLeastSquaresSolver.hpp:710</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_a85e72fea03ba05ebd17e8de9d870d17d"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a85e72fea03ba05ebd17e8de9d870d17d">Belos::details::LocalDenseMatrixOps::conjugateTransposeOfUpperTriangular</a></div><div class="ttdeci">void conjugateTransposeOfUpperTriangular(mat_type &amp;L, const mat_type &amp;R) const</div><div class="ttdoc">L := (conjugate) transpose of R (upper triangular).</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00349">BelosProjectedLeastSquaresSolver.hpp:349</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_a8ee9305483b5b55a10eeaf863c7b80b9"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a8ee9305483b5b55a10eeaf863c7b80b9">Belos::details::LocalDenseMatrixOps::matScale</a></div><div class="ttdeci">void matScale(mat_type &amp;A, const scalar_type &amp;alpha) const</div><div class="ttdoc">A := alpha * A.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00403">BelosProjectedLeastSquaresSolver.hpp:403</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_a900304936f47883a6fc3d2a0cff7059f"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a900304936f47883a6fc3d2a0cff7059f">Belos::details::LocalDenseMatrixOps::magnitude_type</a></div><div class="ttdeci">Teuchos::ScalarTraits&lt; Scalar &gt;::magnitudeType magnitude_type</div><div class="ttdoc">The type of the magnitude of a scalar_type value.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00324">BelosProjectedLeastSquaresSolver.hpp:324</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_a9a585a3ba38a6ebb1e3635b3fe7ba042"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a9a585a3ba38a6ebb1e3635b3fe7ba042">Belos::details::LocalDenseMatrixOps::partition</a></div><div class="ttdeci">void partition(Teuchos::RCP&lt; mat_type &gt; &amp;A_11, Teuchos::RCP&lt; mat_type &gt; &amp;A_21, Teuchos::RCP&lt; mat_type &gt; &amp;A_12, Teuchos::RCP&lt; mat_type &gt; &amp;A_22, mat_type &amp;A, const int numRows1, const int numRows2, const int numCols1, const int numCols2)</div><div class="ttdoc">A -&gt; [A_11, A_21, A_12, A_22].</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00382">BelosProjectedLeastSquaresSolver.hpp:382</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_a9b18be863fd7a37e12805b56c6a16186"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#a9b18be863fd7a37e12805b56c6a16186">Belos::details::LocalDenseMatrixOps::matAdd</a></div><div class="ttdeci">void matAdd(mat_type &amp;A, const mat_type &amp;B) const</div><div class="ttdoc">A := A + B.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00447">BelosProjectedLeastSquaresSolver.hpp:447</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_aa3c69a02923207f2da046ebca725deeb"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#aa3c69a02923207f2da046ebca725deeb">Belos::details::LocalDenseMatrixOps::axpy</a></div><div class="ttdeci">void axpy(mat_type &amp;Y, const scalar_type &amp;alpha, const mat_type &amp;X) const</div><div class="ttdoc">Y := Y + alpha * X.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00427">BelosProjectedLeastSquaresSolver.hpp:427</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_aba579c63d92058ea180ae3efd94e84fd"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#aba579c63d92058ea180ae3efd94e84fd">Belos::details::LocalDenseMatrixOps::matMatMult</a></div><div class="ttdeci">void matMatMult(const scalar_type &amp;beta, mat_type &amp;C, const scalar_type &amp;alpha, const mat_type &amp;A, const mat_type &amp;B) const</div><div class="ttdoc">C := beta*C + alpha*A*B.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00526">BelosProjectedLeastSquaresSolver.hpp:526</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_ad47d22f96d5d234cdb67bcfa7150ad4a"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#ad47d22f96d5d234cdb67bcfa7150ad4a">Belos::details::LocalDenseMatrixOps::scalar_type</a></div><div class="ttdeci">Scalar scalar_type</div><div class="ttdoc">The template parameter of this class.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00321">BelosProjectedLeastSquaresSolver.hpp:321</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_ae0c3a8a562007a13f642aa8a29f9d204"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#ae0c3a8a562007a13f642aa8a29f9d204">Belos::details::LocalDenseMatrixOps::isUpperHessenberg</a></div><div class="ttdeci">std::pair&lt; bool, std::pair&lt; magnitude_type, magnitude_type &gt; &gt; isUpperHessenberg(const mat_type &amp;A) const</div><div class="ttdoc">Is the matrix A upper Hessenberg?</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00626">BelosProjectedLeastSquaresSolver.hpp:626</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_ae475da8666980270bf3ed5d1bb4af499"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#ae475da8666980270bf3ed5d1bb4af499">Belos::details::LocalDenseMatrixOps::ensureEqualDimensions</a></div><div class="ttdeci">void ensureEqualDimensions(const mat_type &amp;A, const char *const matrixName, const int numRows, const int numCols) const</div><div class="ttdoc">Ensure that the matrix A is exactly numRows by numCols.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00768">BelosProjectedLeastSquaresSolver.hpp:768</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_af7a9c91468c269e10f2bb5101987f2bf"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#af7a9c91468c269e10f2bb5101987f2bf">Belos::details::LocalDenseMatrixOps::ensureUpperHessenberg</a></div><div class="ttdeci">void ensureUpperHessenberg(const mat_type &amp;A, const char *const matrixName) const</div><div class="ttdoc">Throw an exception if A is not (strictly) upper Hessenberg.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00680">BelosProjectedLeastSquaresSolver.hpp:680</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_afa3f00c956143edb2a5a4b8d9e9fa1e7"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#afa3f00c956143edb2a5a4b8d9e9fa1e7">Belos::details::LocalDenseMatrixOps::ensureUpperTriangular</a></div><div class="ttdeci">void ensureUpperTriangular(const mat_type &amp;A, const char *const matrixName) const</div><div class="ttdoc">Throw an exception if A is not upper triangular / trapezoidal.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00659">BelosProjectedLeastSquaresSolver.hpp:659</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1LocalDenseMatrixOps_html_afebb4f3b204f6ac494db5c916690647c"><div class="ttname"><a href="classBelos_1_1details_1_1LocalDenseMatrixOps.html#afebb4f3b204f6ac494db5c916690647c">Belos::details::LocalDenseMatrixOps::ensureMinimumDimensions</a></div><div class="ttdeci">void ensureMinimumDimensions(const mat_type &amp;A, const char *const matrixName, const int minNumRows, const int minNumCols) const</div><div class="ttdoc">Ensure that the matrix A is at least minNumRows by minNumCols.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00743">BelosProjectedLeastSquaresSolver.hpp:743</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresProblem_html"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html">Belos::details::ProjectedLeastSquaresProblem</a></div><div class="ttdoc">&quot;Container&quot; for the GMRES projected least-squares problem.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00127">BelosProjectedLeastSquaresSolver.hpp:127</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresProblem_html_a03c4e75ac42c4459c52a07ca61e67f8b"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a03c4e75ac42c4459c52a07ca61e67f8b">Belos::details::ProjectedLeastSquaresProblem::y</a></div><div class="ttdeci">Teuchos::SerialDenseMatrix&lt; int, Scalar &gt; y</div><div class="ttdoc">Current solution of the projected least-squares problem.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00168">BelosProjectedLeastSquaresSolver.hpp:168</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresProblem_html_a218f467b5d8a31fc111a3e81290fefc0"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a218f467b5d8a31fc111a3e81290fefc0">Belos::details::ProjectedLeastSquaresProblem::reallocateAndReset</a></div><div class="ttdeci">void reallocateAndReset(const typename Teuchos::ScalarTraits&lt; Scalar &gt;::magnitudeType beta, const int maxNumIterations)</div><div class="ttdoc">(Re)allocate and reset the projected least-squares problem.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00260">BelosProjectedLeastSquaresSolver.hpp:260</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresProblem_html_a595fefd7bec1c6bd5d06e997f4b5ee54"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a595fefd7bec1c6bd5d06e997f4b5ee54">Belos::details::ProjectedLeastSquaresProblem::R</a></div><div class="ttdeci">Teuchos::SerialDenseMatrix&lt; int, Scalar &gt; R</div><div class="ttdoc">Upper triangular factor from the QR factorization of H.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00156">BelosProjectedLeastSquaresSolver.hpp:156</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresProblem_html_a8e09cf6ea2e782fe8a3362fbc6b3b8ad"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a8e09cf6ea2e782fe8a3362fbc6b3b8ad">Belos::details::ProjectedLeastSquaresProblem::magnitude_type</a></div><div class="ttdeci">Teuchos::ScalarTraits&lt; Scalar &gt;::magnitudeType magnitude_type</div><div class="ttdoc">The type of the magnitude of scalar_type values.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00134">BelosProjectedLeastSquaresSolver.hpp:134</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresProblem_html_a9811a3cba918c4eb88df9aa15ef14bcc"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#a9811a3cba918c4eb88df9aa15ef14bcc">Belos::details::ProjectedLeastSquaresProblem::ProjectedLeastSquaresProblem</a></div><div class="ttdeci">ProjectedLeastSquaresProblem(const int maxNumIterations)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00205">BelosProjectedLeastSquaresSolver.hpp:205</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresProblem_html_aa736d8bbc3aad714ddb3c11a1c33d8c6"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#aa736d8bbc3aad714ddb3c11a1c33d8c6">Belos::details::ProjectedLeastSquaresProblem::H</a></div><div class="ttdeci">Teuchos::SerialDenseMatrix&lt; int, Scalar &gt; H</div><div class="ttdoc">The upper Hessenberg matrix from GMRES.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00143">BelosProjectedLeastSquaresSolver.hpp:143</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresProblem_html_aad9c4e982451e86800680537c6fa379d"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#aad9c4e982451e86800680537c6fa379d">Belos::details::ProjectedLeastSquaresProblem::reset</a></div><div class="ttdeci">void reset(const typename Teuchos::ScalarTraits&lt; Scalar &gt;::magnitudeType beta)</div><div class="ttdoc">Reset the projected least-squares problem.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00233">BelosProjectedLeastSquaresSolver.hpp:233</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresProblem_html_ab71a50f286e258d8c2df88cba39d39ca"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#ab71a50f286e258d8c2df88cba39d39ca">Belos::details::ProjectedLeastSquaresProblem::scalar_type</a></div><div class="ttdeci">Scalar scalar_type</div><div class="ttdoc">The type of the entries in the projected least-squares problem.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00131">BelosProjectedLeastSquaresSolver.hpp:131</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresProblem_html_ac33a0fe3de247c253c6a3ebaeac52137"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#ac33a0fe3de247c253c6a3ebaeac52137">Belos::details::ProjectedLeastSquaresProblem::z</a></div><div class="ttdeci">Teuchos::SerialDenseMatrix&lt; int, Scalar &gt; z</div><div class="ttdoc">Current right-hand side of the projected least-squares problem.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00178">BelosProjectedLeastSquaresSolver.hpp:178</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresProblem_html_acdde43030557f55687f17d04621aafb1"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#acdde43030557f55687f17d04621aafb1">Belos::details::ProjectedLeastSquaresProblem::theCosines</a></div><div class="ttdeci">Teuchos::Array&lt; Scalar &gt; theCosines</div><div class="ttdoc">Array of cosines from the computed Givens rotations.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00189">BelosProjectedLeastSquaresSolver.hpp:189</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresProblem_html_ad433f50d642093438c9547658c7643f7"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresProblem.html#ad433f50d642093438c9547658c7643f7">Belos::details::ProjectedLeastSquaresProblem::theSines</a></div><div class="ttdeci">Teuchos::Array&lt; Scalar &gt; theSines</div><div class="ttdoc">Array of sines from the computed Givens rotations.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00195">BelosProjectedLeastSquaresSolver.hpp:195</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresSolver_html"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html">Belos::details::ProjectedLeastSquaresSolver</a></div><div class="ttdoc">Methods for solving GMRES' projected least-squares problem.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00931">BelosProjectedLeastSquaresSolver.hpp:931</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresSolver_html_a0cd9b4f3a6eb51ffceaa1532f03aa778"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a0cd9b4f3a6eb51ffceaa1532f03aa778">Belos::details::ProjectedLeastSquaresSolver::testGivensRotations</a></div><div class="ttdeci">bool testGivensRotations(std::ostream &amp;out)</div><div class="ttdoc">Test Givens rotations.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l01294">BelosProjectedLeastSquaresSolver.hpp:1294</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresSolver_html_a2ec287ac8999f9d6516e8899c7ced733"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2ec287ac8999f9d6516e8899c7ced733">Belos::details::ProjectedLeastSquaresSolver::mat_type</a></div><div class="ttdeci">Teuchos::SerialDenseMatrix&lt; int, Scalar &gt; mat_type</div><div class="ttdoc">The type of a dense matrix (or vector) of scalar_type.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00947">BelosProjectedLeastSquaresSolver.hpp:947</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresSolver_html_a2fcd5ddf8d07272cae3eab562704b702"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a2fcd5ddf8d07272cae3eab562704b702">Belos::details::ProjectedLeastSquaresSolver::testUpdateColumn</a></div><div class="ttdeci">bool testUpdateColumn(std::ostream &amp;out, const int numCols, const bool testBlockGivens=false, const bool extraVerbose=false)</div><div class="ttdoc">Test update and solve using Givens rotations.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l01353">BelosProjectedLeastSquaresSolver.hpp:1353</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresSolver_html_a4e441bd9c5b65b3d6299148826133526"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a4e441bd9c5b65b3d6299148826133526">Belos::details::ProjectedLeastSquaresSolver::solveUpperTriangularSystemInPlace</a></div><div class="ttdeci">std::pair&lt; int, bool &gt; solveUpperTriangularSystemInPlace(Teuchos::ESide side, mat_type &amp;X, const mat_type &amp;R, const ERobustness robustness)</div><div class="ttdoc">Solve square upper triangular linear system(s) in place.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l01143">BelosProjectedLeastSquaresSolver.hpp:1143</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresSolver_html_a58833b753a276c726f421ae859a49812"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a58833b753a276c726f421ae859a49812">Belos::details::ProjectedLeastSquaresSolver::solve</a></div><div class="ttdeci">void solve(ProjectedLeastSquaresProblem&lt; Scalar &gt; &amp;problem, const int curCol)</div><div class="ttdoc">Solve the projected least-squares problem.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l01034">BelosProjectedLeastSquaresSolver.hpp:1034</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresSolver_html_a5f1c639b20014faec6608efe288a1e3f"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a5f1c639b20014faec6608efe288a1e3f">Belos::details::ProjectedLeastSquaresSolver::updateColumn</a></div><div class="ttdeci">magnitude_type updateColumn(ProjectedLeastSquaresProblem&lt; Scalar &gt; &amp;problem, const int curCol)</div><div class="ttdoc">Update column curCol of the projected least-squares problem.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00989">BelosProjectedLeastSquaresSolver.hpp:989</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresSolver_html_a622dfd03a79f805859cfb05e976d1c2d"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a622dfd03a79f805859cfb05e976d1c2d">Belos::details::ProjectedLeastSquaresSolver::scalar_type</a></div><div class="ttdeci">Scalar scalar_type</div><div class="ttdoc">The template parameter of this class.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00939">BelosProjectedLeastSquaresSolver.hpp:939</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresSolver_html_a8588e4764ff64e526c9843eb9f2f211f"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a8588e4764ff64e526c9843eb9f2f211f">Belos::details::ProjectedLeastSquaresSolver::updateColumns</a></div><div class="ttdeci">magnitude_type updateColumns(ProjectedLeastSquaresProblem&lt; Scalar &gt; &amp;problem, const int startCol, const int endCol)</div><div class="ttdoc">Update columns [startCol,endCol] of the projected least-squares problem.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l01011">BelosProjectedLeastSquaresSolver.hpp:1011</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresSolver_html_a8da32d06b9749ce498dc51348607362e"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a8da32d06b9749ce498dc51348607362e">Belos::details::ProjectedLeastSquaresSolver::solveUpperTriangularSystem</a></div><div class="ttdeci">std::pair&lt; int, bool &gt; solveUpperTriangularSystem(Teuchos::ESide side, mat_type &amp;X, const mat_type &amp;R, const mat_type &amp;B, const ERobustness robustness)</div><div class="ttdoc">Solve the given square upper triangular linear system(s).</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l01092">BelosProjectedLeastSquaresSolver.hpp:1092</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresSolver_html_a91bd1ee4bf5be51c01757365a356c07e"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a91bd1ee4bf5be51c01757365a356c07e">Belos::details::ProjectedLeastSquaresSolver::ProjectedLeastSquaresSolver</a></div><div class="ttdeci">ProjectedLeastSquaresSolver(std::ostream &amp;warnStream, const ERobustness defaultRobustness=ROBUSTNESS_NONE)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00969">BelosProjectedLeastSquaresSolver.hpp:969</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresSolver_html_a97457fe317f1ae345faba1a47657e2a3"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#a97457fe317f1ae345faba1a47657e2a3">Belos::details::ProjectedLeastSquaresSolver::solveUpperTriangularSystemInPlace</a></div><div class="ttdeci">std::pair&lt; int, bool &gt; solveUpperTriangularSystemInPlace(Teuchos::ESide side, mat_type &amp;X, const mat_type &amp;R)</div><div class="ttdoc">Solve square upper triangular linear system(s) in place.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l01128">BelosProjectedLeastSquaresSolver.hpp:1128</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresSolver_html_aaf40eb15d1a8d7fd92948ee630fd1d31"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#aaf40eb15d1a8d7fd92948ee630fd1d31">Belos::details::ProjectedLeastSquaresSolver::testTriangularSolves</a></div><div class="ttdeci">bool testTriangularSolves(std::ostream &amp;out, const int testProblemSize, const ERobustness robustness, const bool verbose=false)</div><div class="ttdoc">Test upper triangular solves.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l01594">BelosProjectedLeastSquaresSolver.hpp:1594</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresSolver_html_ab8c6c7371f15ee5b192c5e8fc71ff9ea"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ab8c6c7371f15ee5b192c5e8fc71ff9ea">Belos::details::ProjectedLeastSquaresSolver::solveUpperTriangularSystem</a></div><div class="ttdeci">std::pair&lt; int, bool &gt; solveUpperTriangularSystem(Teuchos::ESide side, mat_type &amp;X, const mat_type &amp;R, const mat_type &amp;B)</div><div class="ttdoc">Solve the given square upper triangular linear system(s).</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l01045">BelosProjectedLeastSquaresSolver.hpp:1045</a></div></div>
<div class="ttc" id="aclassBelos_1_1details_1_1ProjectedLeastSquaresSolver_html_ad61f14ea2f38123761af1adf6900b987"><div class="ttname"><a href="classBelos_1_1details_1_1ProjectedLeastSquaresSolver.html#ad61f14ea2f38123761af1adf6900b987">Belos::details::ProjectedLeastSquaresSolver::magnitude_type</a></div><div class="ttdeci">Teuchos::ScalarTraits&lt; Scalar &gt;::magnitudeType magnitude_type</div><div class="ttdoc">The type of the magnitude of a scalar_type value.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00944">BelosProjectedLeastSquaresSolver.hpp:944</a></div></div>
<div class="ttc" id="anamespaceBelos_1_1details_html_a05bc807f8daacda97634f46ded62adfe"><div class="ttname"><a href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfe">Belos::details::ERobustness</a></div><div class="ttdeci">ERobustness</div><div class="ttdoc">Robustness level of projected least-squares solver operations.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00800">BelosProjectedLeastSquaresSolver.hpp:800</a></div></div>
<div class="ttc" id="anamespaceBelos_1_1details_html_a05bc807f8daacda97634f46ded62adfea2837d067913425b6279342d1e0f405a2"><div class="ttname"><a href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea2837d067913425b6279342d1e0f405a2">Belos::details::ROBUSTNESS_LOTS</a></div><div class="ttdeci">@ ROBUSTNESS_LOTS</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00803">BelosProjectedLeastSquaresSolver.hpp:803</a></div></div>
<div class="ttc" id="anamespaceBelos_1_1details_html_a05bc807f8daacda97634f46ded62adfea4c0000ab10503cf9942a38072a6219d1"><div class="ttname"><a href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea4c0000ab10503cf9942a38072a6219d1">Belos::details::ROBUSTNESS_SOME</a></div><div class="ttdeci">@ ROBUSTNESS_SOME</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00802">BelosProjectedLeastSquaresSolver.hpp:802</a></div></div>
<div class="ttc" id="anamespaceBelos_1_1details_html_a05bc807f8daacda97634f46ded62adfea7c00a13d1ab30f47de58763504fd9d50"><div class="ttname"><a href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfea7c00a13d1ab30f47de58763504fd9d50">Belos::details::ROBUSTNESS_NONE</a></div><div class="ttdeci">@ ROBUSTNESS_NONE</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00801">BelosProjectedLeastSquaresSolver.hpp:801</a></div></div>
<div class="ttc" id="anamespaceBelos_1_1details_html_a05bc807f8daacda97634f46ded62adfeaf78083034b642ee97afd4b87d313776e"><div class="ttname"><a href="namespaceBelos_1_1details.html#a05bc807f8daacda97634f46ded62adfeaf78083034b642ee97afd4b87d313776e">Belos::details::ROBUSTNESS_INVALID</a></div><div class="ttdeci">@ ROBUSTNESS_INVALID</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00805">BelosProjectedLeastSquaresSolver.hpp:804</a></div></div>
<div class="ttc" id="anamespaceBelos_1_1details_html_a2b0edd0440b97b9e6dccb58dbe1a85f3"><div class="ttname"><a href="namespaceBelos_1_1details.html#a2b0edd0440b97b9e6dccb58dbe1a85f3">Belos::details::robustnessStringToEnum</a></div><div class="ttdeci">ERobustness robustnessStringToEnum(const std::string &amp;x)</div><div class="ttdoc">Convert the given robustness string value to an ERobustness enum.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00820">BelosProjectedLeastSquaresSolver.hpp:820</a></div></div>
<div class="ttc" id="anamespaceBelos_1_1details_html_a9bbb015263348f701b5135eeeadfaf55"><div class="ttname"><a href="namespaceBelos_1_1details.html#a9bbb015263348f701b5135eeeadfaf55">Belos::details::robustnessEnumToString</a></div><div class="ttdeci">std::string robustnessEnumToString(const ERobustness x)</div><div class="ttdoc">Convert the given ERobustness enum value to a string.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00809">BelosProjectedLeastSquaresSolver.hpp:809</a></div></div>
<div class="ttc" id="anamespaceBelos_1_1details_html_afac90446e8d21f4139cbc674ab2d12e6"><div class="ttname"><a href="namespaceBelos_1_1details.html#afac90446e8d21f4139cbc674ab2d12e6">Belos::details::robustnessValidator</a></div><div class="ttdeci">Teuchos::RCP&lt; Teuchos::ParameterEntryValidator &gt; robustnessValidator()</div><div class="ttdoc">Make a ParameterList validator for ERobustness.</div><div class="ttdef"><b>Definition</b> <a href="BelosProjectedLeastSquaresSolver_8hpp_source.html#l00843">BelosProjectedLeastSquaresSolver.hpp:843</a></div></div>
<div class="ttc" id="anamespaceBelos_html"><div class="ttname"><a href="namespaceBelos.html">Belos</a></div><div class="ttdef"><b>Definition</b> <a href="Belos__Details__EBelosSolverType_8cpp_source.html#l00013">Belos_Details_EBelosSolverType.cpp:13</a></div></div>
<div class="ttc" id="anamespacedetails_html"><div class="ttname"><a href="namespacedetails.html">details</a></div><div class="ttdoc">Namespace containing implementation details of Belos solvers.</div></div>
</div><!-- fragment --></div><!-- contents -->

<!-- Assumes Doxygen adds the jquery script. Otherwise, uncomment following
     line:
<script type="text/javascript" 
        src="common/parameterList/js/jquery.js"></script> 
-->
<script type="text/javascript" 
        src="common/parameterList/js/iframeResizer.min.js"></script> 
<script type="text/javascript">
iFrameResize({
  log                 : true,   // Enable console logging
  enablePublicMethods : true,   // Enable methods within iframe hosted page
  sizeHeight:true,
  interval: -1,
  resizedCallback     : function(messageData){ // Callback fn when msg recd
    $('p#callback').html(
        '<b>Frame ID:</b> '    + messageData.iframe.id +
        ' <b>Height:</b> '     + messageData.height +
        ' <b>Width:</b> '      + messageData.width +
        ' <b>Event type:</b> ' + messageData.type
     );
  }
});
</script>
<hr size="1"><address style="align: right;"><small>
Generated on Thu Oct 9 2025 20:36:27 for Belos by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.9.8</small></address>
</body>
</html>
