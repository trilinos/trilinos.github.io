<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Belos: tpetra/example/PCPG/PCPGTpetraExFile.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Belos<span id="projectnumber">&#160;Version of the Day</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">tpetra/example/PCPG/PCPGTpetraExFile.cpp</div></div>
</div><!--header-->
<div class="contents">
<p>This is an example of how to use <a class="el" href="classBelos_1_1PCPGSolMgr.html" title="PCPG iterative linear solver.">Belos::PCPGSolMgr</a> with Tpetra.</p>
<p>This is an example of how to use <a class="el" href="classBelos_1_1PCPGSolMgr.html" title="PCPG iterative linear solver.">Belos::PCPGSolMgr</a> with Tpetra.</p>
<div class="fragment"><div class="line"><span class="comment">// @HEADER</span></div>
<div class="line"><span class="comment">// *****************************************************************************</span></div>
<div class="line"><span class="comment">//                 Belos: Block Linear Solvers Package</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Copyright 2004-2016 NTESS and the Belos contributors.</span></div>
<div class="line"><span class="comment">// SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><span class="comment">// *****************************************************************************</span></div>
<div class="line"><span class="comment">// @HEADER</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Purpose</span></div>
<div class="line"><span class="comment">// The example tests the successive right-hand sides capabilities of ML</span></div>
<div class="line"><span class="comment">// and Belos on a heat flow u_t = u_xx problem.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// A sequence of linear systems with the same coefficient matrix and</span></div>
<div class="line"><span class="comment">// different right-hand sides is solved.  A seed space is generated dynamically,</span></div>
<div class="line"><span class="comment">// and a deflated linear system is solved.  After each solves, the first</span></div>
<div class="line"><span class="comment">// few Krylov vectors are saved, and used to reduce the number of iterations</span></div>
<div class="line"><span class="comment">// for later solves.</span></div>
<div class="line"><span class="comment">// The optimal numbers of vectors to deflate and save are not known.</span></div>
<div class="line"><span class="comment">// Presently, the maximum number of vectors to deflate (seed space dimension)</span></div>
<div class="line"><span class="comment">// and to save are user paraemters.</span></div>
<div class="line"><span class="comment">// The seed space dimension is less than or equal to total number of vectors</span></div>
<div class="line"><span class="comment">// saved. The difference between the seed space dimension and the total number</span></div>
<div class="line"><span class="comment">// of vectors, is the number of vectors used to update the seed space after each</span></div>
<div class="line"><span class="comment">// solve. I guess that a seed space whose dimension is a small fraction of the</span></div>
<div class="line"><span class="comment">// total space will be best.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// maxSave=1 and maxDeflate=0 uses no recycling (not tested ).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// TODO: Instrument with timers, so that we can tell what is going on besides</span></div>
<div class="line"><span class="comment">//       by counting the numbers of iterations.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Adapted from PCPGEpetraExFile.cpp by David M. Day (with original comments)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// All preconditioning has been commented out</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Tpetra</span></div>
<div class="line"><span class="preprocessor">#include &lt;TpetraExt_MatrixMatrix.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Tpetra_Core.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Tpetra_CrsMatrix_fwd.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Tpetra_Map_fwd.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Tpetra_Vector_fwd.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// MueLu</span></div>
<div class="line"><span class="comment">// #include &lt;MueLu_TpetraOperator.hpp&gt;</span></div>
<div class="line"><span class="comment">// #include &lt;MueLu_CreateTpetraPreconditioner.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Teuchos</span></div>
<div class="line"><span class="preprocessor">#include &lt;Teuchos_Comm.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Teuchos_CommHelpers.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Teuchos_CommandLineProcessor.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Teuchos_DefaultComm.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Teuchos_FancyOStream.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Teuchos_ParameterList.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Teuchos_RCP.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Teuchos_StandardCatchMacros.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Teuchos_Tuple.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Teuchos_VerboseObject.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Belos</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="BelosLinearProblem_8hpp.html">BelosLinearProblem.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="BelosPCPGSolMgr_8hpp.html">BelosPCPGSolMgr.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;BelosTpetraAdapter.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ScalarType&gt;</div>
<div class="line"><span class="keywordtype">int</span> run(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Laplace&#39;s equation, homogeneous Dirichlet boundary conditions, [0,1]^2</span></div>
<div class="line">  <span class="comment">// regular mesh, Q1 finite elements</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span>Teuchos::ParameterList;</div>
<div class="line">  <span class="keyword">using </span>Teuchos::RCP;</div>
<div class="line">  <span class="keyword">using </span>Teuchos::rcp;</div>
<div class="line">  <span class="keyword">using </span>Teuchos::tuple;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span>ST = <span class="keyword">typename</span> Tpetra::MultiVector&lt;ScalarType&gt;::scalar_type;</div>
<div class="line">  <span class="keyword">using </span>LO = <span class="keyword">typename</span> Tpetra::Vector&lt;&gt;::local_ordinal_type;</div>
<div class="line">  <span class="keyword">using </span>GO = <span class="keyword">typename</span> Tpetra::Vector&lt;&gt;::global_ordinal_type;</div>
<div class="line">  <span class="keyword">using </span>NT = <span class="keyword">typename</span> Tpetra::Vector&lt;&gt;::node_type;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span>V = <span class="keyword">typename</span> Tpetra::Vector&lt;ST, LO, GO, NT&gt;;</div>
<div class="line">  <span class="keyword">using </span>MV = <span class="keyword">typename</span> Tpetra::MultiVector&lt;ST, LO, GO, NT&gt;;</div>
<div class="line">  <span class="keyword">using </span>OP = <span class="keyword">typename</span> Tpetra::Operator&lt;ST, LO, GO, NT&gt;;</div>
<div class="line">  <span class="keyword">using </span>MVT = <span class="keyword">typename</span> <a id="_a0" name="_a0"></a><a class="code hl_class" href="classBelos_1_1Operator.html">Belos::MultiVecTraits&lt;ST, MV&gt;</a>;</div>
<div class="line">  <span class="keyword">using </span>OPT = <span class="keyword">typename</span> <a class="code hl_class" href="classBelos_1_1Operator.html">Belos::OperatorTraits&lt;ST, MV, OP&gt;</a>;</div>
<div class="line">  <span class="keyword">using </span>MAP = <span class="keyword">typename</span> Tpetra::Map&lt;LO, GO, NT&gt;;</div>
<div class="line">  <span class="keyword">using </span>MAT = <span class="keyword">typename</span> Tpetra::CrsMatrix&lt;ST, LO, GO, NT&gt;;</div>
<div class="line">  <span class="keyword">using </span>SCT = <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;ST&gt;;</div>
<div class="line">  <span class="keyword">using </span>MT = <span class="keyword">typename</span> SCT::magnitudeType;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span>LinearProblem = <span class="keyword">typename</span> <a class="code hl_class" href="classBelos_1_1Operator.html">Belos::LinearProblem&lt;ST, MV, OP&gt;</a>;</div>
<div class="line">  <span class="keyword">using </span>PCPGSolMgr = <a class="code hl_class" href="classBelos_1_1Operator.html">::Belos::PCPGSolMgr&lt;ST, MV, OP&gt;</a>;</div>
<div class="line"> </div>
<div class="line">  Teuchos::GlobalMPISession session(&amp;argc, &amp;argv, NULL);</div>
<div class="line">  RCP&lt;const Teuchos::Comm&lt;int&gt;&gt; comm = Tpetra::getDefaultComm();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">bool</span> verbose = <span class="keyword">false</span>;</div>
<div class="line">  <span class="keywordtype">bool</span> success = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line">    <span class="keywordtype">bool</span> procVerbose = <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordtype">int</span> frequency = -1;  <span class="comment">// frequency of status test output.</span></div>
<div class="line">    <span class="keywordtype">int</span> blocksize = 1;   <span class="comment">// blocksize, PCPGIter</span></div>
<div class="line">    <span class="keywordtype">int</span> numRhs = 1;      <span class="comment">// number of right-hand sides to solve for</span></div>
<div class="line">    <span class="keywordtype">int</span> maxIters = 30;   <span class="comment">// maximum number of iterations allowed per linear system</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> maxDeflate = 4;  <span class="comment">// maximum number of vectors deflated from the linear system;</span></div>
<div class="line">    <span class="comment">// There is no overhead cost assoc with changing maxDeflate between solves</span></div>
<div class="line">    <span class="keywordtype">int</span> maxSave = 8;  <span class="comment">// maximum number of vectors saved from current and previous .&quot;);</span></div>
<div class="line">    <span class="comment">// If maxSave changes between solves, then re-initialize (setSize).</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Hypothesis: seed vectors are conjugate.</span></div>
<div class="line">    <span class="comment">// Initial versions allowed users to supply a seed space et cetera, but no</span></div>
<div class="line">    <span class="comment">// longer.</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// The documentation it suitable for certain tasks, like defining a modules</span></div>
<div class="line">    <span class="comment">// grammar,</span></div>
<div class="line">    std::string ortho(<span class="stringliteral">&quot;ICGS&quot;</span>);  <span class="comment">// The Belos documentation obscures the fact that</span></div>
<div class="line">    <span class="comment">// IMGS is Iterated Modified Gram Schmidt,</span></div>
<div class="line">    <span class="comment">// ICGS is Iterated Classical Gram Schmidt, and</span></div>
<div class="line">    <span class="comment">// DKGS is another Iterated Classical Gram Schmidt.</span></div>
<div class="line">    <span class="comment">// Mathematical issues, such as the difference between ICGS and DKGS, are</span></div>
<div class="line">    <span class="comment">// not documented at all. UH tells me that Anasazi::SVQBOrthoManager is</span></div>
<div class="line">    <span class="comment">// available;  I need it for Belos</span></div>
<div class="line">    MT tol = sqrt(std::numeric_limits&lt;ST&gt;::epsilon());  <span class="comment">// relative residual tolerance</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// How do command line parsers work?</span></div>
<div class="line">    Teuchos::CommandLineProcessor cmdp(<span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line">    cmdp.setOption(<span class="stringliteral">&quot;verbose&quot;</span>, <span class="stringliteral">&quot;quiet&quot;</span>, &amp;verbose, <span class="stringliteral">&quot;Print messages and results&quot;</span>);</div>
<div class="line">    cmdp.setOption(<span class="stringliteral">&quot;frequency&quot;</span>, &amp;frequency, <span class="stringliteral">&quot;Solvers frequency for printing residuals (#iters)&quot;</span>);</div>
<div class="line">    cmdp.setOption(<span class="stringliteral">&quot;tol&quot;</span>, &amp;tol, <span class="stringliteral">&quot;Relative residual tolerance used by PCPG solver&quot;</span>);</div>
<div class="line">    cmdp.setOption(<span class="stringliteral">&quot;num-rhs&quot;</span>, &amp;numRhs, <span class="stringliteral">&quot;Number of right-hand sides to be solved for&quot;</span>);</div>
<div class="line">    cmdp.setOption(<span class="stringliteral">&quot;max-iters&quot;</span>, &amp;maxIters,</div>
<div class="line">                   <span class="stringliteral">&quot;Maximum number of iterations per linear system (-1 = &quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;adapted to problem/block size)&quot;</span>);</div>
<div class="line">    cmdp.setOption(<span class="stringliteral">&quot;num-deflate&quot;</span>, &amp;maxDeflate, <span class="stringliteral">&quot;Number of vectors deflated from the linear system&quot;</span>);</div>
<div class="line">    cmdp.setOption(<span class="stringliteral">&quot;num-save&quot;</span>, &amp;maxSave, <span class="stringliteral">&quot;Number of vectors saved from old Krylov subspaces&quot;</span>);</div>
<div class="line">    cmdp.setOption(<span class="stringliteral">&quot;ortho-type&quot;</span>, &amp;ortho, <span class="stringliteral">&quot;Orthogonalization type, either DGKS, ICGS or IMGS&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (cmdp.parse(argc, argv) != Teuchos::CommandLineProcessor::PARSE_SUCCESSFUL) {</div>
<div class="line">      <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (!verbose)</div>
<div class="line">      frequency = -1;  <span class="comment">// reset frequency if test is not verbose</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// *************Form the problem****************</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="keywordtype">int</span> numTimeStep = 4;</div>
<div class="line">    GO numElePerDirection = 14 * comm-&gt;getSize();  <span class="comment">// 5 -&gt; 20</span></div>
<div class="line">    <span class="keywordtype">size_t</span> numNodes = (numElePerDirection - 1) * (numElePerDirection - 1);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// By the way, either matrix has (3*numElePerDirection - 2)^2 nonzeros.</span></div>
<div class="line">    RCP&lt;MAP&gt; map = rcp(<span class="keyword">new</span> MAP(numNodes, 0, comm));</div>
<div class="line">    RCP&lt;MAT&gt; stiff = rcp(<span class="keyword">new</span> MAT(map, numNodes));</div>
<div class="line">    RCP&lt;MAT&gt; mass = rcp(<span class="keyword">new</span> MAT(map, numNodes));</div>
<div class="line">    RCP&lt;V&gt; vecLHS = rcp(<span class="keyword">new</span> V(map));</div>
<div class="line">    RCP&lt;V&gt; vecRHS = rcp(<span class="keyword">new</span> V(map));</div>
<div class="line">    RCP&lt;MV&gt; LHS, RHS;</div>
<div class="line"> </div>
<div class="line">    ST ko = 8.0 / 3.0, k1 = -1.0 / 3.0;</div>
<div class="line"> </div>
<div class="line">    ST h = 1.0 / <span class="keyword">static_cast&lt;</span>ST<span class="keyword">&gt;</span>(numElePerDirection);  <span class="comment">// x=(iX,iY)h</span></div>
<div class="line">    ST mo = h * h * 4.0 / 9.0, m1 = h * h / 9.0, m2 = h * h / 36.0;</div>
<div class="line"> </div>
<div class="line">    ST pi = 4.0 * atan(1.0), valueLHS;</div>
<div class="line">    GO node, iX, iY;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (LO lid = map-&gt;getMinLocalIndex(); lid &lt;= map-&gt;getMaxLocalIndex(); lid++) {</div>
<div class="line">      node = map-&gt;getGlobalElement(lid);</div>
<div class="line">      iX = node % (numElePerDirection - 1);</div>
<div class="line">      iY = (node - iX) / (numElePerDirection - 1);</div>
<div class="line">      GO pos = node;</div>
<div class="line">      stiff-&gt;insertGlobalValues(node, tuple(pos), tuple(ko));</div>
<div class="line">      mass-&gt;insertGlobalValues(node, tuple(pos),</div>
<div class="line">                               tuple(mo));  <span class="comment">// init guess violates hom Dir bc</span></div>
<div class="line">      valueLHS = sin(pi * h * ((ST)iX + 1)) * cos(2.0 * pi * h * ((ST)iY + 1));</div>
<div class="line">      vecLHS-&gt;replaceGlobalValue(1, valueLHS);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (iY &gt; 0) {</div>
<div class="line">        pos = iX + (iY - 1) * (numElePerDirection - 1);</div>
<div class="line">        stiff-&gt;insertGlobalValues(node, tuple(pos), tuple(k1));  <span class="comment">// North</span></div>
<div class="line">        mass-&gt;insertGlobalValues(node, tuple(pos), tuple(m1));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (iY &lt; numElePerDirection - 2) {</div>
<div class="line">        pos = iX + (iY + 1) * (numElePerDirection - 1);</div>
<div class="line">        stiff-&gt;insertGlobalValues(node, tuple(pos), tuple(k1));  <span class="comment">// South</span></div>
<div class="line">        mass-&gt;insertGlobalValues(node, tuple(pos), tuple(m1));</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (iX &gt; 0) {</div>
<div class="line">        pos = iX - 1 + iY * (numElePerDirection - 1);</div>
<div class="line">        stiff-&gt;insertGlobalValues(node, tuple(pos), tuple(k1));  <span class="comment">// West</span></div>
<div class="line">        mass-&gt;insertGlobalValues(node, tuple(pos), tuple(m1));</div>
<div class="line">        <span class="keywordflow">if</span> (iY &gt; 0) {</div>
<div class="line">          pos = iX - 1 + (iY - 1) * (numElePerDirection - 1);</div>
<div class="line">          stiff-&gt;insertGlobalValues(node, tuple(pos), tuple(k1));  <span class="comment">// North West</span></div>
<div class="line">          mass-&gt;insertGlobalValues(node, tuple(pos), tuple(m2));</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (iY &lt; numElePerDirection - 2) {</div>
<div class="line">          pos = iX - 1 + (iY + 1) * (numElePerDirection - 1);</div>
<div class="line">          stiff-&gt;insertGlobalValues(node, tuple(pos), tuple(k1));  <span class="comment">// South West</span></div>
<div class="line">          mass-&gt;insertGlobalValues(node, tuple(pos), tuple(m2));</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (iX &lt; numElePerDirection - 2) {</div>
<div class="line">        pos = iX + 1 + iY * (numElePerDirection - 1);</div>
<div class="line">        stiff-&gt;insertGlobalValues(node, tuple(pos), tuple(k1));  <span class="comment">// East</span></div>
<div class="line">        mass-&gt;insertGlobalValues(node, tuple(pos), tuple(m1));</div>
<div class="line">        <span class="keywordflow">if</span> (iY &gt; 0) {</div>
<div class="line">          pos = iX + 1 + (iY - 1) * (numElePerDirection - 1);</div>
<div class="line">          stiff-&gt;insertGlobalValues(node, tuple(pos), tuple(k1));  <span class="comment">// North East</span></div>
<div class="line">          mass-&gt;insertGlobalValues(node, tuple(pos), tuple(m2));</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (iY &lt; numElePerDirection - 2) {</div>
<div class="line">          pos = iX + 1 + (iY + 1) * (numElePerDirection - 1);</div>
<div class="line">          stiff-&gt;insertGlobalValues(node, tuple(pos), tuple(k1));  <span class="comment">// South East</span></div>
<div class="line">          mass-&gt;insertGlobalValues(node, tuple(pos), tuple(m2));</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    stiff-&gt;fillComplete();</div>
<div class="line">    mass-&gt;fillComplete();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> ST one = SCT::one();</div>
<div class="line">    ST hdt = .00005;  <span class="comment">// half time step</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// A = Mass+Stiff*dt/2</span></div>
<div class="line">    RCP&lt;MAT&gt; A = Tpetra::MatrixMatrix::add(one, <span class="keyword">false</span>, *mass, hdt, <span class="keyword">false</span>, *stiff);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// B = Mass-Stiff*dt/2</span></div>
<div class="line">    hdt = -hdt;</div>
<div class="line">    RCP&lt;MAT&gt; B = Tpetra::MatrixMatrix::add(one, <span class="keyword">false</span>, *mass, hdt, <span class="keyword">false</span>, *stiff);</div>
<div class="line"> </div>
<div class="line">    B-&gt;apply(*vecLHS, *vecRHS);</div>
<div class="line"> </div>
<div class="line">    procVerbose = verbose &amp;&amp; (comm-&gt;getRank() == 0);  <span class="comment">// Only print on the zero processor</span></div>
<div class="line"> </div>
<div class="line">    LHS = Teuchos::rcp_implicit_cast&lt;MV&gt;(vecLHS);</div>
<div class="line">    RHS = Teuchos::rcp_implicit_cast&lt;MV&gt;(vecRHS);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// **********Construct preconditioner***********</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Teuchos::ParameterList MLList; // Set MLList for Smoothed Aggregation</span></div>
<div class="line">    <span class="comment">// ML_Tpetra::SetDefaults(&quot;SA&quot;,MLList); // reset parameters ML User&#39;s Guide</span></div>
<div class="line">    <span class="comment">// MLList.set(&quot;smoother: type&quot;,&quot;CHEBYSHEV&quot;); // Chebyshev smoother  ... aztec??</span></div>
<div class="line">    <span class="comment">// MLList.set(&quot;smoother: sweeps&quot;,3);</span></div>
<div class="line">    <span class="comment">// MLList.set(&quot;smoother: pre or post&quot;, &quot;both&quot;); // both pre- and post-smoothing</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// #ifdef HAVE_MUELU_AMESOS2</span></div>
<div class="line">    <span class="comment">//     MueLuList.set(&quot;coarse: type&quot;, &quot;KLU2&quot;); // solve with serial direct</span></div>
<div class="line">    <span class="comment">//     solver KLU</span></div>
<div class="line">    <span class="comment">// #else</span></div>
<div class="line">    <span class="comment">//     MLList.set(&quot;coarse: type&quot;, &quot;Jacobi&quot;);     // not recommended</span></div>
<div class="line">    <span class="comment">//     puts(&quot;Warning: Iterative coarse grid solve&quot;);</span></div>
<div class="line">    <span class="comment">// #endif</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// RCP&lt;OP&gt; prec = MueLu::CreateTpetraPreconditioner(A, MLList );</span></div>
<div class="line">    <span class="comment">// assert(prec != Teuchos::null);</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create the Belos preconditioned operator from the preconditioner.</span></div>
<div class="line">    <span class="comment">// NOTE:  This is necessary because Belos expects an operator to apply the</span></div>
<div class="line">    <span class="comment">//        preconditioner with Apply() NOT ApplyInverse().</span></div>
<div class="line">    <span class="comment">// RCP&lt;Belos::EpetraPrecOp&gt; belosPrec = rcp( new Belos::EpetraPrecOp( Prec )</span></div>
<div class="line">    <span class="comment">// );</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create parameter list for the PCPG solver manager</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> numGlobalElements = RHS-&gt;getGlobalLength();</div>
<div class="line">    <span class="keywordflow">if</span> (maxIters == -1)</div>
<div class="line">      maxIters = numGlobalElements / blocksize - 1;  <span class="comment">// maximum number of iterations to run</span></div>
<div class="line"> </div>
<div class="line">    RCP&lt;ParameterList&gt; belosList = rcp(<span class="keyword">new</span> ParameterList());</div>
<div class="line">    belosList-&gt;set(<span class="stringliteral">&quot;Block Size&quot;</span>,</div>
<div class="line">                   blocksize);  <span class="comment">// Blocksize to be used by iterative solver</span></div>
<div class="line">    belosList-&gt;set(<span class="stringliteral">&quot;Maximum Iterations&quot;</span>,</div>
<div class="line">                   maxIters);  <span class="comment">// Maximum number of iterations allowed</span></div>
<div class="line">    belosList-&gt;set(<span class="stringliteral">&quot;Convergence Tolerance&quot;</span>,</div>
<div class="line">                   tol);  <span class="comment">// Relative convergence tolerance requested</span></div>
<div class="line">    belosList-&gt;set(<span class="stringliteral">&quot;Num Deflated Blocks&quot;</span>,</div>
<div class="line">                   maxDeflate);  <span class="comment">// Number of vectors in seed space</span></div>
<div class="line">    belosList-&gt;set(<span class="stringliteral">&quot;Num Saved Blocks&quot;</span>,</div>
<div class="line">                   maxSave);                     <span class="comment">// Number of vectors saved from old spaces</span></div>
<div class="line">    belosList-&gt;set(<span class="stringliteral">&quot;Orthogonalization&quot;</span>, ortho);  <span class="comment">// Orthogonalization type</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (numRhs &gt; 1) {</div>
<div class="line">      belosList-&gt;set(<span class="stringliteral">&quot;Show Maximum Residual Norm Only&quot;</span>,</div>
<div class="line">                     <span class="keyword">true</span>);  <span class="comment">// although numRhs = 1.</span></div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (verbose) {</div>
<div class="line">      belosList-&gt;set(<span class="stringliteral">&quot;Verbosity&quot;</span>, <a id="a1" name="a1"></a><a class="code hl_enumvalue" href="namespaceBelos.html#a2a2aa51a3ef87c278fd43945578b3612a63033b406b3bb6a654a538f9b13e34ec">Belos::Errors</a> + <a id="a2" name="a2"></a><a class="code hl_enumvalue" href="namespaceBelos.html#a2a2aa51a3ef87c278fd43945578b3612a7ea40ab539dda8218818a3b391f88ff7">Belos::Warnings</a> + <a id="a3" name="a3"></a><a class="code hl_enumvalue" href="namespaceBelos.html#a2a2aa51a3ef87c278fd43945578b3612a54629124d7d6823ab26d8e1df854d962">Belos::TimingDetails</a> +</div>
<div class="line">                                      <a id="a4" name="a4"></a><a class="code hl_enumvalue" href="namespaceBelos.html#a2a2aa51a3ef87c278fd43945578b3612a3d2ead26155f56c6510e37e50221d7fd">Belos::FinalSummary</a> + <a id="a5" name="a5"></a><a class="code hl_enumvalue" href="namespaceBelos.html#a2a2aa51a3ef87c278fd43945578b3612a214b85228315388f0b0fea24202ba4e4">Belos::StatusTestDetails</a>);</div>
<div class="line">      <span class="keywordflow">if</span> (frequency &gt; 0)</div>
<div class="line">        belosList-&gt;set(<span class="stringliteral">&quot;Output Frequency&quot;</span>, frequency);</div>
<div class="line">    } <span class="keywordflow">else</span></div>
<div class="line">      belosList-&gt;set(<span class="stringliteral">&quot;Verbosity&quot;</span>, <a class="code hl_enumvalue" href="namespaceBelos.html#a2a2aa51a3ef87c278fd43945578b3612a63033b406b3bb6a654a538f9b13e34ec">Belos::Errors</a> + <a class="code hl_enumvalue" href="namespaceBelos.html#a2a2aa51a3ef87c278fd43945578b3612a7ea40ab539dda8218818a3b391f88ff7">Belos::Warnings</a> + <a class="code hl_enumvalue" href="namespaceBelos.html#a2a2aa51a3ef87c278fd43945578b3612a3d2ead26155f56c6510e37e50221d7fd">Belos::FinalSummary</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Construct a preconditioned linear problem</span></div>
<div class="line">    RCP&lt;LinearProblem&gt; problem = rcp(<span class="keyword">new</span> LinearProblem(A, LHS, RHS));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// problem-&gt;setLeftPrec( prec );</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> set = problem-&gt;setProblem();</div>
<div class="line">    <span class="keywordflow">if</span> (set == <span class="keyword">false</span>) {</div>
<div class="line">      <span class="keywordflow">if</span> (procVerbose)</div>
<div class="line">        std::cout &lt;&lt; std::endl</div>
<div class="line">                  &lt;&lt; <span class="stringliteral">&quot;ERROR:  Belos::LinearProblem failed to set up correctly!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create an iterative solver manager.</span></div>
<div class="line">    RCP&lt;PCPGSolMgr&gt; solver = rcp(<span class="keyword">new</span> PCPGSolMgr(problem, belosList));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// *******************************************************************</span></div>
<div class="line">    <span class="comment">// ************************* Iterate PCPG ****************************</span></div>
<div class="line">    <span class="comment">// *******************************************************************</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="keywordflow">if</span> (procVerbose) {</div>
<div class="line">      std::cout &lt;&lt; std::endl &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Dimension of matrix: &quot;</span> &lt;&lt; numGlobalElements &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Number of right-hand sides: &quot;</span> &lt;&lt; numRhs &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Block size used by solver: &quot;</span> &lt;&lt; blocksize &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Maximum number of iterations allowed: &quot;</span> &lt;&lt; maxIters &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Relative residual tolerance: &quot;</span> &lt;&lt; tol &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">bool</span> badRes;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> timeStep = 0; timeStep &lt; numTimeStep; timeStep++) {</div>
<div class="line">      <span class="keywordflow">if</span> (timeStep) {</div>
<div class="line">        <span class="comment">// old epetra B-&gt;multiply(false, *vecLHS, *vecRHS); // rhs_new :=</span></div>
<div class="line">        <span class="comment">// B*lhs_old,</span></div>
<div class="line">        B-&gt;apply(*LHS, *RHS);  <span class="comment">// rhs_new := B*lhs_old,</span></div>
<div class="line">        set = problem-&gt;setProblem(LHS, RHS);</div>
<div class="line">        <span class="keywordflow">if</span> (set == <span class="keyword">false</span>) {</div>
<div class="line">          <span class="keywordflow">if</span> (procVerbose)</div>
<div class="line">            std::cout &lt;&lt; std::endl</div>
<div class="line">                      &lt;&lt; <span class="stringliteral">&quot;ERROR:  Belos::LinearProblem failed to set up correctly!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">          <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">      }  <span class="comment">// if timeStep</span></div>
<div class="line">      std::vector&lt;ST&gt; rhs_norm(numRhs);</div>
<div class="line">      MVT::MvNorm(*RHS, rhs_norm);</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;                  RHS norm is ... &quot;</span> &lt;&lt; rhs_norm[0] &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Perform solve</span></div>
<div class="line">      <a class="code hl_enumeration" href="namespaceBelos.html#a58f4f203f3b36e10cb1ffd4614bbd18b">Belos::ReturnType</a> ret = solver-&gt;solve();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Compute actual residuals.</span></div>
<div class="line">      badRes = <span class="keyword">false</span>;</div>
<div class="line">      std::vector&lt;ST&gt; actual_resids(numRhs);</div>
<div class="line">      MV resid(map, numRhs);</div>
<div class="line">      OPT::Apply(*A, *LHS, resid);</div>
<div class="line">      MVT::MvAddMv(-1.0, resid, 1.0, *RHS, resid);</div>
<div class="line">      MVT::MvNorm(resid, actual_resids);</div>
<div class="line">      MVT::MvNorm(*RHS, rhs_norm);</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;                    RHS norm is ... &quot;</span> &lt;&lt; rhs_norm[0] &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (procVerbose) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;---------- Actual Residuals (normalized) ----------&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                  &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numRhs; i++) {</div>
<div class="line">          <span class="keywordtype">double</span> actRes = actual_resids[i] / rhs_norm[i];</div>
<div class="line">          std::cout &lt;&lt; <span class="stringliteral">&quot;Problem &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; : \t&quot;</span> &lt;&lt; actRes &lt;&lt; std::endl;</div>
<div class="line">          <span class="keywordflow">if</span> (actRes &gt; tol)</div>
<div class="line">            badRes = <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (ret != <a id="a6" name="a6"></a><a class="code hl_enumvalue" href="namespaceBelos.html#a58f4f203f3b36e10cb1ffd4614bbd18ba6ea972a4ffdcac04da6f3cd6369f22c4">Belos::Converged</a> || badRes) {</div>
<div class="line">        success = <span class="keyword">false</span>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">    }  <span class="comment">// for timeStep</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (procVerbose) {</div>
<div class="line">      <span class="keywordflow">if</span> (success)</div>
<div class="line">        std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;SUCCESS:  Belos converged!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">else</span></div>
<div class="line">        std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;ERROR:  Belos did not converge!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">  }  <span class="comment">// end try</span></div>
<div class="line">  TEUCHOS_STANDARD_CATCH_STATEMENTS(verbose, std::cerr, success);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> success ? EXIT_SUCCESS : EXIT_FAILURE;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) { </div>
<div class="line">  <span class="keywordflow">return</span> run&lt;double&gt;(argc, argv);</div>
<div class="line">  <span class="comment">// return run&lt;float&gt;(argc, argv); }</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// end PCPGTpetraExFile.cpp</span></div>
<div class="ttc" id="aBelosLinearProblem_8hpp_html"><div class="ttname"><a href="BelosLinearProblem_8hpp.html">BelosLinearProblem.hpp</a></div><div class="ttdoc">Class which describes the linear problem to be solved by the iterative solver.</div></div>
<div class="ttc" id="aBelosPCPGSolMgr_8hpp_html"><div class="ttname"><a href="BelosPCPGSolMgr_8hpp.html">BelosPCPGSolMgr.hpp</a></div><div class="ttdoc">Declaration and definition of Belos::PCPGSolMgr (PCPG iterative linear solver).</div></div>
<div class="ttc" id="aclassBelos_1_1Operator_html"><div class="ttname"><a href="classBelos_1_1Operator.html">Belos::Operator</a></div><div class="ttdoc">Alternative run-time polymorphic interface for operators.</div><div class="ttdef"><b>Definition</b> <a href="BelosOperator_8hpp_source.html#l00048">BelosOperator.hpp:48</a></div></div>
<div class="ttc" id="anamespaceBelos_html_a2a2aa51a3ef87c278fd43945578b3612a214b85228315388f0b0fea24202ba4e4"><div class="ttname"><a href="namespaceBelos.html#a2a2aa51a3ef87c278fd43945578b3612a214b85228315388f0b0fea24202ba4e4">Belos::StatusTestDetails</a></div><div class="ttdeci">@ StatusTestDetails</div><div class="ttdef"><b>Definition</b> <a href="BelosTypes_8hpp_source.html#l00229">BelosTypes.hpp:229</a></div></div>
<div class="ttc" id="anamespaceBelos_html_a2a2aa51a3ef87c278fd43945578b3612a3d2ead26155f56c6510e37e50221d7fd"><div class="ttname"><a href="namespaceBelos.html#a2a2aa51a3ef87c278fd43945578b3612a3d2ead26155f56c6510e37e50221d7fd">Belos::FinalSummary</a></div><div class="ttdeci">@ FinalSummary</div><div class="ttdef"><b>Definition</b> <a href="BelosTypes_8hpp_source.html#l00227">BelosTypes.hpp:227</a></div></div>
<div class="ttc" id="anamespaceBelos_html_a2a2aa51a3ef87c278fd43945578b3612a54629124d7d6823ab26d8e1df854d962"><div class="ttname"><a href="namespaceBelos.html#a2a2aa51a3ef87c278fd43945578b3612a54629124d7d6823ab26d8e1df854d962">Belos::TimingDetails</a></div><div class="ttdeci">@ TimingDetails</div><div class="ttdef"><b>Definition</b> <a href="BelosTypes_8hpp_source.html#l00228">BelosTypes.hpp:228</a></div></div>
<div class="ttc" id="anamespaceBelos_html_a2a2aa51a3ef87c278fd43945578b3612a63033b406b3bb6a654a538f9b13e34ec"><div class="ttname"><a href="namespaceBelos.html#a2a2aa51a3ef87c278fd43945578b3612a63033b406b3bb6a654a538f9b13e34ec">Belos::Errors</a></div><div class="ttdeci">@ Errors</div><div class="ttdef"><b>Definition</b> <a href="BelosTypes_8hpp_source.html#l00223">BelosTypes.hpp:223</a></div></div>
<div class="ttc" id="anamespaceBelos_html_a2a2aa51a3ef87c278fd43945578b3612a7ea40ab539dda8218818a3b391f88ff7"><div class="ttname"><a href="namespaceBelos.html#a2a2aa51a3ef87c278fd43945578b3612a7ea40ab539dda8218818a3b391f88ff7">Belos::Warnings</a></div><div class="ttdeci">@ Warnings</div><div class="ttdef"><b>Definition</b> <a href="BelosTypes_8hpp_source.html#l00224">BelosTypes.hpp:224</a></div></div>
<div class="ttc" id="anamespaceBelos_html_a58f4f203f3b36e10cb1ffd4614bbd18b"><div class="ttname"><a href="namespaceBelos.html#a58f4f203f3b36e10cb1ffd4614bbd18b">Belos::ReturnType</a></div><div class="ttdeci">ReturnType</div><div class="ttdoc">Whether the Belos solve converged for all linear systems.</div><div class="ttdef"><b>Definition</b> <a href="BelosTypes_8hpp_source.html#l00123">BelosTypes.hpp:123</a></div></div>
<div class="ttc" id="anamespaceBelos_html_a58f4f203f3b36e10cb1ffd4614bbd18ba6ea972a4ffdcac04da6f3cd6369f22c4"><div class="ttname"><a href="namespaceBelos.html#a58f4f203f3b36e10cb1ffd4614bbd18ba6ea972a4ffdcac04da6f3cd6369f22c4">Belos::Converged</a></div><div class="ttdeci">@ Converged</div><div class="ttdef"><b>Definition</b> <a href="BelosTypes_8hpp_source.html#l00124">BelosTypes.hpp:124</a></div></div>
</div><!-- fragment --> </div><!-- contents -->

<!-- Assumes Doxygen adds the jquery script. Otherwise, uncomment following
     line:
<script type="text/javascript" 
        src="common/parameterList/js/jquery.js"></script> 
-->
<script type="text/javascript" 
        src="common/parameterList/js/iframeResizer.min.js"></script> 
<script type="text/javascript">
iFrameResize({
  log                 : true,   // Enable console logging
  enablePublicMethods : true,   // Enable methods within iframe hosted page
  sizeHeight:true,
  interval: -1,
  resizedCallback     : function(messageData){ // Callback fn when msg recd
    $('p#callback').html(
        '<b>Frame ID:</b> '    + messageData.iframe.id +
        ' <b>Height:</b> '     + messageData.height +
        ' <b>Width:</b> '      + messageData.width +
        ' <b>Event type:</b> ' + messageData.type
     );
  }
});
</script>
<hr size="1"><address style="align: right;"><small>
Generated on Thu Oct 9 2025 20:36:27 for Belos by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.9.8</small></address>
</body>
</html>
