<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Anasazi: AnasaziTraceMinBaseSolMgr.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Anasazi<span id="projectnumber">&#160;Version of the Day</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">AnasaziTraceMinBaseSolMgr.hpp</div></div>
</div><!--header-->
<div class="contents">
<a href="AnasaziTraceMinBaseSolMgr_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// @HEADER</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">// *****************************************************************************</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">//                 Anasazi: Block Eigensolvers Package</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">//</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">// Copyright 2004 NTESS and the Anasazi contributors.</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">// SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">// *****************************************************************************</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">// @HEADER</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span> </div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#ifndef ANASAZI_TraceMinBase_SOLMGR_HPP</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#define ANASAZI_TraceMinBase_SOLMGR_HPP</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span> </div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &quot;<a class="code" href="AnasaziBasicOrthoManager_8hpp.html">AnasaziBasicOrthoManager.hpp</a>&quot;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &quot;<a class="code" href="AnasaziOutputManager_8hpp.html">AnasaziOutputManager.hpp</a>&quot;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &quot;<a class="code" href="AnasaziOutputStreamTraits_8hpp.html">AnasaziOutputStreamTraits.hpp</a>&quot;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &quot;<a class="code" href="AnasaziBasicSort_8hpp.html">AnasaziBasicSort.hpp</a>&quot;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &quot;<a class="code" href="AnasaziConfigDefs_8hpp.html">AnasaziConfigDefs.hpp</a>&quot;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &quot;<a class="code" href="AnasaziEigenproblem_8hpp.html">AnasaziEigenproblem.hpp</a>&quot;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &quot;<a class="code" href="AnasaziICGSOrthoManager_8hpp.html">AnasaziICGSOrthoManager.hpp</a>&quot;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &quot;<a class="code" href="AnasaziSolverManager_8hpp.html">AnasaziSolverManager.hpp</a>&quot;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &quot;<a class="code" href="AnasaziSolverUtils_8hpp.html">AnasaziSolverUtils.hpp</a>&quot;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &quot;<a class="code" href="AnasaziStatusTestCombo_8hpp.html">AnasaziStatusTestCombo.hpp</a>&quot;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &quot;<a class="code" href="AnasaziStatusTestOutput_8hpp.html">AnasaziStatusTestOutput.hpp</a>&quot;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &quot;<a class="code" href="AnasaziStatusTestResNorm_8hpp.html">AnasaziStatusTestResNorm.hpp</a>&quot;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &quot;AnasaziStatusTestSpecTrans.hpp&quot;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &quot;<a class="code" href="AnasaziStatusTestWithOrdering_8hpp.html">AnasaziStatusTestWithOrdering.hpp</a>&quot;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &quot;<a class="code" href="AnasaziSVQBOrthoManager_8hpp.html">AnasaziSVQBOrthoManager.hpp</a>&quot;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &quot;<a class="code" href="AnasaziTraceMinBase_8hpp.html">AnasaziTraceMinBase.hpp</a>&quot;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &quot;<a class="code" href="AnasaziTraceMinTypes_8hpp.html">AnasaziTraceMinTypes.hpp</a>&quot;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &quot;<a class="code" href="AnasaziTypes_8hpp.html">AnasaziTypes.hpp</a>&quot;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span> </div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &quot;Teuchos_TimeMonitor.hpp&quot;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#include &quot;Teuchos_FancyOStream.hpp&quot;</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span> </div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="keyword">using </span>Teuchos::RCP;</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="keyword">using </span>Teuchos::rcp;</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span> </div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespaceAnasazi.html">Anasazi</a> {</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespaceExperimental.html">Experimental</a> {</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span> </div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span> </div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span><span class="keyword">template</span>&lt;<span class="keyword">class</span> ScalarType, <span class="keyword">class</span> MV, <span class="keyword">class</span> OP&gt;</div>
<div class="foldopen" id="foldopen00079" data-start="{" data-end="};">
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno"><a class="line" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html">   79</a></span><span class="keyword">class </span><a class="code hl_class" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html">TraceMinBaseSolMgr</a> : <span class="keyword">public</span> <a class="code hl_class" href="classAnasazi_1_1SolverManager.html">SolverManager</a>&lt;ScalarType,MV,OP&gt; {</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>  <span class="keyword">private</span>:</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    <span class="keyword">typedef</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">MultiVecTraits&lt;ScalarType,MV&gt;</a> <a class="code hl_class" href="classAnasazi_1_1Operator.html">MVT</a>;</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    <span class="keyword">typedef</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">OperatorTraits&lt;ScalarType,MV,OP&gt;</a> <a class="code hl_class" href="classAnasazi_1_1Operator.html">OPT</a>;</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    <span class="keyword">typedef</span> Teuchos::ScalarTraits&lt;ScalarType&gt; SCT;</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;ScalarType&gt;::magnitudeType MagnitudeType;</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    <span class="keyword">typedef</span> Teuchos::ScalarTraits&lt;MagnitudeType&gt; MT;</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>    </div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>  <span class="keyword">public</span>:</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span> </div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span> </div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span> </div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>  <a class="code hl_class" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html">TraceMinBaseSolMgr</a>( <span class="keyword">const</span> RCP&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">Eigenproblem&lt;ScalarType,MV,OP&gt;</a> &gt; &amp;<a class="code hl_class" href="classAnasazi_1_1Operator.html">problem</a>,</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>                             Teuchos::ParameterList &amp;<a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a> );</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span> </div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno"><a class="line" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a917fc86b5071814867e990bfd16539ed">  142</a></span>  <span class="keyword">virtual</span> <a class="code hl_function" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a917fc86b5071814867e990bfd16539ed">~TraceMinBaseSolMgr</a>() {};</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>  </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span> </div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span> </div>
<div class="foldopen" id="foldopen00149" data-start="{" data-end="}">
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno"><a class="line" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#aedafe273b314c89601d0699fb8420e72">  149</a></span>  <span class="keyword">const</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">Eigenproblem&lt;ScalarType,MV,OP&gt;</a>&amp; <a class="code hl_function" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#aedafe273b314c89601d0699fb8420e72">getProblem</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    <span class="keywordflow">return</span> *problem_;</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>  }</div>
</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span> </div>
<div class="foldopen" id="foldopen00154" data-start="{" data-end="}">
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno"><a class="line" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#abab897a4e7467c265e9fdf2cbdde4082">  154</a></span>  <span class="keywordtype">int</span> <a class="code hl_function" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#abab897a4e7467c265e9fdf2cbdde4082">getNumIters</a>()<span class="keyword"> const </span>{ </div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    <span class="keywordflow">return</span> numIters_; </div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>  }</div>
</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span> </div>
<div class="foldopen" id="foldopen00165" data-start="{" data-end="}">
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno"><a class="line" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a15e7ee4798afaef8e0824283b51147ff">  165</a></span>   Teuchos::Array&lt;RCP&lt;Teuchos::Time&gt; &gt; <a class="code hl_function" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a15e7ee4798afaef8e0824283b51147ff">getTimers</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>     <span class="keywordflow">return</span> Teuchos::tuple(_timerSolve, _timerRestarting, _timerLocking);</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>   }</div>
</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span> </div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span> </div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span> </div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>    </div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>  <a class="code hl_enumeration" href="namespaceAnasazi.html#a823537bb3d658892d7388be67cf036a6">ReturnType</a> <a class="code hl_function" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a59c1a503e51b9c8a6bc0fed63a52db1a">solve</a>();</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span> </div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>  <span class="keywordtype">void</span> <a class="code hl_function" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a7b66c53456be2b709dc8cd98d25f70d8">setGlobalStatusTest</a>(<span class="keyword">const</span> RCP&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">StatusTest&lt;ScalarType,MV,OP&gt;</a> &gt; &amp;<a class="code hl_class" href="classAnasazi_1_1Operator.html">global</a>);</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span> </div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>  <span class="keyword">const</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt; StatusTest&lt;ScalarType,MV,OP&gt;</a> &gt; &amp; <a class="code hl_function" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#ae776246440e7262333dcbc9b48f2a9fb">getGlobalStatusTest</a>() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span> </div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>  <span class="keywordtype">void</span> <a class="code hl_function" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#acdfa5f1703cd4a41f36aa4628e055bf8">setLockingStatusTest</a>(<span class="keyword">const</span> RCP&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">StatusTest&lt;ScalarType,MV,OP&gt;</a> &gt; &amp;<a class="code hl_class" href="classAnasazi_1_1Operator.html">locking</a>);</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span> </div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>  <span class="keyword">const</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt; StatusTest&lt;ScalarType,MV,OP&gt;</a> &gt; &amp; <a class="code hl_function" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a082bff49e2bda2cb18ad8a026379e13c">getLockingStatusTest</a>() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span> </div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>  <span class="keywordtype">void</span> <a class="code hl_function" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a7749b35a9722e15ef37a26dc0384b489">setDebugStatusTest</a>(<span class="keyword">const</span> RCP&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">StatusTest&lt;ScalarType,MV,OP&gt;</a> &gt; &amp;<a class="code hl_class" href="classAnasazi_1_1Operator.html">debug</a>);</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span> </div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>  <span class="keyword">const</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt; StatusTest&lt;ScalarType,MV,OP&gt;</a> &gt; &amp; <a class="code hl_function" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a20f805f76054c9317129603f2469a830">getDebugStatusTest</a>() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span> </div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span> </div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>  <span class="keyword">protected</span>:</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;Eigenproblem&lt;ScalarType,MV,OP&gt;</a> &gt; problem_;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>  <span class="keywordtype">int</span> numIters_;</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span> </div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>  <span class="comment">// Block variables</span></div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>  <span class="keywordtype">int</span> blockSize_, numBlocks_, numRestartBlocks_;</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span> </div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>  <span class="comment">// Output variables</span></div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;OutputManager&lt;ScalarType&gt;</a> &gt; printer_;</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span> </div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>  <span class="comment">// Convergence variables</span></div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>  MagnitudeType convTol_;</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>  <span class="keywordtype">bool</span> relConvTol_;</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>  <span class="keyword">enum</span> <a class="code hl_enumeration" href="namespaceAnasazi.html#a842d441a9c0641dc12d8c263180416ef">ResType</a> convNorm_;</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span> </div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>  <span class="comment">// Locking variables</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>  MagnitudeType lockTol_;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>  <span class="keywordtype">int</span> maxLocked_, lockQuorum_;</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>  <span class="keywordtype">bool</span> useLocking_, relLockTol_;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>  <span class="keyword">enum</span> <a class="code hl_enumeration" href="namespaceAnasazi.html#a842d441a9c0641dc12d8c263180416ef">ResType</a> lockNorm_;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span> </div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>  <span class="comment">// Shifting variables</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>  <span class="keyword">enum</span> WhenToShiftType whenToShift_;</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>  MagnitudeType traceThresh_, shiftTol_;</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>  <span class="keyword">enum</span> HowToShiftType howToShift_;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>  <span class="keywordtype">bool</span> useMultipleShifts_, relShiftTol_, considerClusters_;</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>  std::string shiftNorm_;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>  </div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>  <span class="comment">// Other variables</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>  <span class="keywordtype">int</span> maxKrylovIter_;</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>  std::string ortho_, which_;</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>  <span class="keyword">enum</span> SaddleSolType saddleSolType_;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>  <span class="keywordtype">bool</span> projectAllVecs_, projectLockedVecs_, computeAllRes_, useRHSR_, useHarmonic_, noSort_;</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>  MagnitudeType alpha_;</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span> </div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>  <span class="comment">// Timers</span></div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;Teuchos::Time&gt;</a> _timerSolve, _timerRestarting, _timerLocking;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span> </div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>  <span class="comment">// Status tests</span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;StatusTest&lt;ScalarType,MV,OP&gt;</a> &gt; globalTest_;</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;StatusTest&lt;ScalarType,MV,OP&gt;</a> &gt; lockingTest_; </div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;StatusTest&lt;ScalarType,MV,OP&gt;</a> &gt; debugTest_;</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>  <span class="comment">// TraceMin specific functions</span></div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>  <span class="keywordtype">void</span> copyPartOfState(<span class="keyword">const</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">TraceMinBaseState&lt;ScalarType,MV&gt;</a>&amp; <a class="code hl_class" href="classAnasazi_1_1Operator.html">oldState</a>, <a class="code hl_class" href="classAnasazi_1_1Operator.html">TraceMinBaseState&lt;ScalarType,MV&gt;</a>&amp; <a class="code hl_class" href="classAnasazi_1_1Operator.html">newState</a>, <span class="keyword">const</span> std::vector&lt;int&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">indToCopy</a>) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span> </div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>  <span class="keywordtype">void</span> setParameters(Teuchos::ParameterList &amp;<a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span> </div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>  <span class="keywordtype">void</span> printParameters(std::ostream &amp;<a class="code hl_class" href="classAnasazi_1_1Operator.html">os</a>) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span> </div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>  <span class="keyword">virtual</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt; TraceMinBase&lt;ScalarType,MV,OP&gt;</a> &gt; createSolver( </div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>            <span class="keyword">const</span> RCP&lt;<a class="code hl_class" href="classAnasazi_1_1SortManager.html">SortManager</a>&lt;<span class="keyword">typename</span> Teuchos::ScalarTraits&lt;ScalarType&gt;::magnitudeType&gt; &gt; &amp;<a class="code hl_class" href="classAnasazi_1_1Operator.html">sorter</a>,</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>            <span class="keyword">const</span> RCP&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">StatusTest&lt;ScalarType,MV,OP&gt;</a> &gt;      &amp;<a class="code hl_class" href="classAnasazi_1_1Operator.html">outputtest</a>,</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>            <span class="keyword">const</span> RCP&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">MatOrthoManager&lt;ScalarType,MV,OP&gt;</a> &gt; &amp;<a class="code hl_class" href="classAnasazi_1_1Operator.html">ortho</a>,</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>            Teuchos::ParameterList &amp;<a class="code hl_class" href="classAnasazi_1_1Operator.html">plist</a></div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>          ) =0;</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span> </div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> needToRestart(<span class="keyword">const</span> RCP&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">TraceMinBase&lt;ScalarType,MV,OP&gt;</a> &gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">solver</a>) =0;</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span> </div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> performRestart(<span class="keywordtype">int</span> &amp;<a class="code hl_class" href="classAnasazi_1_1Operator.html">numRestarts</a>, RCP&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">TraceMinBase&lt;ScalarType,MV,OP&gt;</a> &gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">solver</a>) =0;</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>};</div>
</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span> </div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span> </div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span><span class="comment">// Constructor</span></div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span><span class="keyword">template</span>&lt;<span class="keyword">class</span> ScalarType, <span class="keyword">class</span> MV, <span class="keyword">class</span> OP&gt;</div>
<div class="foldopen" id="foldopen00287" data-start="{" data-end="}">
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno"><a class="line" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#aa5737ee98a223af69cfda529a777027e">  287</a></span><a class="code hl_function" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#aa5737ee98a223af69cfda529a777027e">TraceMinBaseSolMgr&lt;ScalarType,MV,OP&gt;::TraceMinBaseSolMgr</a>( </div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>        <span class="keyword">const</span> RCP&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">Eigenproblem&lt;ScalarType,MV,OP&gt;</a> &gt; &amp;<a class="code hl_class" href="classAnasazi_1_1Operator.html">problem</a>,</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>        Teuchos::ParameterList &amp;<a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a> ) : </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>  problem_(<a class="code hl_class" href="classAnasazi_1_1Operator.html">problem</a>)</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>#<a class="code hl_class" href="classAnasazi_1_1Operator.html">ifdef</a> <a class="code hl_class" href="classAnasazi_1_1Operator.html">ANASAZI_TEUCHOS_TIME_MONITOR</a></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>  , _timerSolve(Teuchos::<a class="code hl_class" href="classAnasazi_1_1Operator.html">TimeMonitor</a>::<a class="code hl_class" href="classAnasazi_1_1Operator.html">getNewTimer</a>(<span class="stringliteral">&quot;Anasazi: TraceMinBaseSolMgr::solve()&quot;</span>)),</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>  _timerRestarting(Teuchos::<a class="code hl_class" href="classAnasazi_1_1Operator.html">TimeMonitor</a>::<a class="code hl_class" href="classAnasazi_1_1Operator.html">getNewTimer</a>(<span class="stringliteral">&quot;Anasazi: TraceMinBaseSolMgr restarting&quot;</span>)),</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>  _timerLocking(Teuchos::<a class="code hl_class" href="classAnasazi_1_1Operator.html">TimeMonitor</a>::<a class="code hl_class" href="classAnasazi_1_1Operator.html">getNewTimer</a>(<span class="stringliteral">&quot;Anasazi: TraceMinBaseSolMgr locking&quot;</span>))</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>#<a class="code hl_class" href="classAnasazi_1_1Operator.html">endif</a></div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>{</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(problem_ == Teuchos::null,              std::invalid_argument, <span class="stringliteral">&quot;Problem not given to solver manager.&quot;</span>);</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(!problem_-&gt;isProblemSet(),              std::invalid_argument, <span class="stringliteral">&quot;Problem not set.&quot;</span>);</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(!problem_-&gt;isHermitian(),               std::invalid_argument, <span class="stringliteral">&quot;Problem not symmetric.&quot;</span>);</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(problem_-&gt;getInitVec() == Teuchos::null,std::invalid_argument, <span class="stringliteral">&quot;Problem does not contain initial vectors to clone from.&quot;</span>);</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span> </div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>  std::string <a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a>;</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span> </div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>  <span class="comment">// Block parameters</span></div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span> </div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>  <span class="comment">// TODO: the default is different for TraceMin and TraceMin-Davidson</span></div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>  <span class="comment">// block size: default is nev()</span></div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span><span class="comment">//  blockSize_ = pl.get(&quot;Block Size&quot;,problem_-&gt;getNEV());</span></div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span><span class="comment">//  TEUCHOS_TEST_FOR_EXCEPTION(blockSize_ &lt;= 0, std::invalid_argument,</span></div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span><span class="comment">//                     &quot;Anasazi::TraceMinBaseSolMgr: \&quot;Block Size\&quot; must be strictly positive.&quot;);</span></div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span> </div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>  <span class="comment">// TODO: add Num Blocks as a parameter to both child classes, since they have different default values</span></div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span><span class="comment">//  numBlocks_ = pl.get(&quot;Num Blocks&quot;,5);</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span><span class="comment">//  TEUCHOS_TEST_FOR_EXCEPTION(numBlocks_ &lt; 2, std::invalid_argument,</span></div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span><span class="comment">//                     &quot;Anasazi::TraceMinBaseSolMgr: \&quot;Num Blocks\&quot; must be &gt;= 2.&quot;);</span></div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span> </div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>  <span class="comment">// Output parameters</span></div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span> </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>  <span class="comment">// Create a formatted output stream to print to.</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>  <span class="comment">// See if user requests output processor.</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>  <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">osProc</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Output Processor&quot;</span>, 0);</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>     </div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>  <span class="comment">// If not passed in by user, it will be chosen based upon operator type.</span></div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>  Teuchos::RCP&lt;Teuchos::FancyOStream&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">osp</a>;</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span> </div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.isParameter(<span class="stringliteral">&quot;Output Stream&quot;</span>)) {</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">osp</a> = Teuchos::getParameter&lt;Teuchos::RCP&lt;Teuchos::FancyOStream&gt; &gt;(<a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>,<span class="stringliteral">&quot;Output Stream&quot;</span>);</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>  }</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">osp</a> = <a class="code hl_class" href="structAnasazi_1_1OutputStreamTraits.html">OutputStreamTraits&lt;OP&gt;::getOutputStream</a> (*problem_-&gt;getOperator(), <a class="code hl_class" href="classAnasazi_1_1Operator.html">osProc</a>);</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>  }</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span> </div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>  <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">verbosity</a> = <a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2c41d6eeeab5121d3c26c70ac5d18239">Anasazi::Errors</a>;</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.isParameter(<span class="stringliteral">&quot;Verbosity&quot;</span>)) {</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>    <span class="keywordflow">if</span> (Teuchos::isParameterType&lt;int&gt;(<a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>,<span class="stringliteral">&quot;Verbosity&quot;</span>)) {</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>      <a class="code hl_class" href="classAnasazi_1_1Operator.html">verbosity</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Verbosity&quot;</span>, <a class="code hl_class" href="classAnasazi_1_1Operator.html">verbosity</a>);</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>      <a class="code hl_class" href="classAnasazi_1_1Operator.html">verbosity</a> = (<a class="code hl_class" href="classAnasazi_1_1Operator.html">int</a>)Teuchos::getParameter&lt;Anasazi::MsgType&gt;(<a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>,<span class="stringliteral">&quot;Verbosity&quot;</span>);</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>    }</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>  }</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>  printer_ = rcp( <span class="keyword">new</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">OutputManager&lt;ScalarType&gt;</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">verbosity</a>,<a class="code hl_class" href="classAnasazi_1_1Operator.html">osp</a>) );</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span> </div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>  <span class="comment">// TODO: Add restart parameters to TraceMin-Davidson</span></div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span> </div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>  <span class="comment">// Convergence parameters</span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>  convTol_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Convergence Tolerance&quot;</span>,MT::prec());</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(convTol_ &lt; 0, std::invalid_argument,</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>                     <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: \&quot;Convergence Tolerance\&quot; must be nonnegative.&quot;</span>);</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span> </div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>  relConvTol_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Relative Convergence Tolerance&quot;</span>,<span class="keyword">true</span>);</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Convergence Norm&quot;</span>,std::string(<span class="stringliteral">&quot;2&quot;</span>));</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> == <span class="stringliteral">&quot;2&quot;</span>) {</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>    convNorm_ = RES_2NORM;</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>  }</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> == <span class="stringliteral">&quot;M&quot;</span>) {</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>    convNorm_ = RES_ORTH;</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>  }</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<span class="keyword">true</span>, std::invalid_argument, </div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>        <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: Invalid Convergence Norm.&quot;</span>);</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>  }</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span> </div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>  <span class="comment">// Locking parameters</span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>  useLocking_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Use Locking&quot;</span>,<span class="keyword">true</span>);</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>  relLockTol_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Relative Locking Tolerance&quot;</span>,<span class="keyword">true</span>);</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>  lockTol_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Locking Tolerance&quot;</span>,convTol_/10);</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span> </div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(relConvTol_ != relLockTol_, std::invalid_argument,</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>         <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: \&quot;Relative Convergence Tolerance\&quot; and \&quot;Relative Locking Tolerance\&quot; have different values.  If you set one, you should always set the other.&quot;</span>);</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span> </div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(lockTol_ &lt; 0, std::invalid_argument,</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>                     <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: \&quot;Locking Tolerance\&quot; must be nonnegative.&quot;</span>);</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span> </div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Locking Norm&quot;</span>,std::string(<span class="stringliteral">&quot;2&quot;</span>));</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> == <span class="stringliteral">&quot;2&quot;</span>) {</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>    lockNorm_ = RES_2NORM;</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>  }</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> == <span class="stringliteral">&quot;M&quot;</span>) {</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>    lockNorm_ = RES_ORTH;</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>  }</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<span class="keyword">true</span>, std::invalid_argument, </div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>        <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: Invalid Locking Norm.&quot;</span>);</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>  }</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span> </div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>  <span class="comment">// max locked: default is nev(), must satisfy maxLocked_ + blockSize_ &gt;= nev</span></div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>  <span class="keywordflow">if</span> (useLocking_) {</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>    maxLocked_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Max Locked&quot;</span>,problem_-&gt;getNEV());</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(maxLocked_ &lt;= 0, std::invalid_argument,</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>           <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: \&quot;Max Locked\&quot; must be strictly positive.&quot;</span>);</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>  }</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>    maxLocked_ = 0;</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>  }</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span> </div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>  <span class="keywordflow">if</span> (useLocking_) {</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>    lockQuorum_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Locking Quorum&quot;</span>,1);</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(lockQuorum_ &lt;= 0, std::invalid_argument,</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>                       <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: \&quot;Locking Quorum\&quot; must be strictly positive.&quot;</span>);</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>  }</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span> </div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>  <span class="comment">// Ritz shift parameters</span></div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span> </div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>  <span class="comment">// When to shift - what triggers a shift?</span></div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;When To Shift&quot;</span>, <span class="stringliteral">&quot;Always&quot;</span>);</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span> </div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>  <span class="keywordflow">if</span>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> == <span class="stringliteral">&quot;Never&quot;</span>)</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>    whenToShift_ = NEVER_SHIFT;</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> == <span class="stringliteral">&quot;After Trace Levels&quot;</span>)</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    whenToShift_ = SHIFT_WHEN_TRACE_LEVELS;</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> == <span class="stringliteral">&quot;Residual Becomes Small&quot;</span>)</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>    whenToShift_ = SHIFT_WHEN_RESID_SMALL;</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> == <span class="stringliteral">&quot;Always&quot;</span>)</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>    whenToShift_ = ALWAYS_SHIFT;</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<span class="keyword">true</span>, std::invalid_argument,</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>           <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: Invalid value for \&quot;When To Shift\&quot;; valid options are \&quot;Never\&quot;, \&quot;After Trace Levels\&quot;, \&quot;Residual Becomes Small\&quot;, \&quot;Always\&quot;.&quot;</span>);  </div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span> </div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span> </div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>  <span class="comment">// How small does the % change in trace have to get before shifting?</span></div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>  traceThresh_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Trace Threshold&quot;</span>, 0.02);</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span> </div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(traceThresh_ &lt; 0, std::invalid_argument,</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>                       <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: \&quot;Trace Threshold\&quot; must be nonnegative.&quot;</span>);</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span> </div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>  <span class="comment">// Shift threshold - if the residual of an eigenpair is less than this, then shift</span></div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>  shiftTol_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Shift Tolerance&quot;</span>, 0.1);</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span> </div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(shiftTol_ &lt; 0, std::invalid_argument,</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>                       <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: \&quot;Shift Tolerance\&quot; must be nonnegative.&quot;</span>);</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span> </div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>  <span class="comment">// Use relative convergence tolerance - scale by eigenvalue?</span></div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>  relShiftTol_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Relative Shift Tolerance&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span> </div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>  <span class="comment">// Which norm to use in determining whether to shift</span></div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>  shiftNorm_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Shift Norm&quot;</span>, <span class="stringliteral">&quot;2&quot;</span>);</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span> </div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(shiftNorm_ != <span class="stringliteral">&quot;2&quot;</span> &amp;&amp; shiftNorm_ != <span class="stringliteral">&quot;M&quot;</span>, std::invalid_argument,</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>         <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: Invalid value for \&quot;Shift Norm\&quot;; valid options are \&quot;2\&quot; and \&quot;M\&quot;.&quot;</span>);  </div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span> </div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>  noSort_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;No Sorting&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span> </div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>  <span class="comment">// How to choose shift</span></div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;How To Choose Shift&quot;</span>, <span class="stringliteral">&quot;Adjusted Ritz Values&quot;</span>);</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>  </div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>  <span class="keywordflow">if</span>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> == <span class="stringliteral">&quot;Largest Converged&quot;</span>)</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>    howToShift_ = LARGEST_CONVERGED_SHIFT;</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> == <span class="stringliteral">&quot;Adjusted Ritz Values&quot;</span>)</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    howToShift_ = ADJUSTED_RITZ_SHIFT;</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> == <span class="stringliteral">&quot;Ritz Values&quot;</span>)</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>    howToShift_ = RITZ_VALUES_SHIFT;</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> == <span class="stringliteral">&quot;Experimental Shift&quot;</span>)</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>    howToShift_ = EXPERIMENTAL_SHIFT;</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<span class="keyword">true</span>, std::invalid_argument,</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>           <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: Invalid value for \&quot;How To Choose Shift\&quot;; valid options are \&quot;Largest Converged\&quot;, \&quot;Adjusted Ritz Values\&quot;, \&quot;Ritz Values\&quot;.&quot;</span>);</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span> </div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>  <span class="comment">// Consider clusters - if all eigenvalues are in one cluster, it&#39;s not expecially safe to shift</span></div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>  considerClusters_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Consider Clusters&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span> </div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>  <span class="comment">// Use multiple shifts</span></div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>  useMultipleShifts_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Use Multiple Shifts&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span> </div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>  <span class="comment">// Other parameters</span></div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span> </div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>  <span class="comment">// which orthogonalization to use</span></div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>  ortho_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Orthogonalization&quot;</span>, <span class="stringliteral">&quot;SVQB&quot;</span>);</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(ortho_ != <span class="stringliteral">&quot;DGKS&quot;</span> &amp;&amp; ortho_ != <span class="stringliteral">&quot;SVQB&quot;</span> &amp;&amp; ortho_ != <span class="stringliteral">&quot;ICGS&quot;</span>, std::invalid_argument,</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>         <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: Invalid value for \&quot;Orthogonalization\&quot;; valid options are \&quot;DGKS\&quot;, \&quot;SVQB\&quot;, \&quot;ICGS\&quot;.&quot;</span>);  </div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span> </div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Saddle Solver Type&quot;</span>, <span class="stringliteral">&quot;Projected Krylov&quot;</span>);</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>  </div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>  <span class="keywordflow">if</span>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> == <span class="stringliteral">&quot;Projected Krylov&quot;</span>)</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>    saddleSolType_ = PROJECTED_KRYLOV_SOLVER;</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> == <span class="stringliteral">&quot;Schur Complement&quot;</span>)</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>    saddleSolType_ = SCHUR_COMPLEMENT_SOLVER;</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> == <span class="stringliteral">&quot;Block Diagonal Preconditioned Minres&quot;</span>)</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>    saddleSolType_ = BD_PREC_MINRES;</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">strtmp</a> == <span class="stringliteral">&quot;HSS Preconditioned Gmres&quot;</span>)</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>    saddleSolType_ = HSS_PREC_GMRES;</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<span class="keyword">true</span>, std::invalid_argument,</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>           <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: Invalid value for \&quot;Saddle Solver Type\&quot;; valid options are \&quot;Projected Krylov\&quot;, \&quot;Schur Complement\&quot;, and \&quot;Block Diagonal Preconditioned Minres\&quot;.&quot;</span>);</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span> </div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>  projectAllVecs_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Project All Vectors&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>  projectLockedVecs_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Project Locked Vectors&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>  computeAllRes_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Compute All Residuals&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>  useRHSR_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Use Residual as RHS&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>  alpha_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;HSS: alpha&quot;</span>, 1.0);</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span> </div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(projectLockedVecs_ &amp;&amp; ! projectAllVecs_, std::invalid_argument,</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>         <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: If you want to project out the locked vectors, you should really project out ALL the vectors of X.&quot;</span>);</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span> </div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>  <span class="comment">// Maximum number of inner iterations</span></div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>  maxKrylovIter_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Maximum Krylov Iterations&quot;</span>, 200);</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(maxKrylovIter_ &lt; 1, std::invalid_argument,</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>         <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: \&quot;Maximum Krylov Iterations\&quot; must be greater than 0.&quot;</span>);</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>     </div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>  <span class="comment">// Which eigenvalues we want to get</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>  which_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">pl</a>.get(<span class="stringliteral">&quot;Which&quot;</span>, <span class="stringliteral">&quot;SM&quot;</span>);</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(which_ != <span class="stringliteral">&quot;SM&quot;</span> &amp;&amp; which_ != <span class="stringliteral">&quot;LM&quot;</span>, std::invalid_argument,</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>         <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: Invalid value for \&quot;Which\&quot;; valid options are \&quot;SM\&quot; and \&quot;LM\&quot;.&quot;</span>);</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span> </div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>  <span class="comment">// Test whether we are shifting without an operator K</span></div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>  <span class="comment">// This is a really bad idea</span></div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(problem_-&gt;getOperator() == Teuchos::null &amp;&amp; whenToShift_ != NEVER_SHIFT, std::invalid_argument,</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>         <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: It is an exceptionally bad idea to use Ritz shifts when finding the largest eigenpairs of a standard eigenvalue problem.  If we don&#39;t use Ritz shifts, it may take extra iterations to converge, but we NEVER have to solve a single linear system.  Using Ritz shifts forces us to solve systems of the form (I + sigma A)x=f, and it probably doesn&#39;t benefit us enough to outweigh the extra cost.  We may add support for this feature in the future, but for now, please set \&quot;When To Shift\&quot; to \&quot;Never\&quot;.&quot;</span>);</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span> </div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span><span class="preprocessor">#ifdef BELOS_PSEUDO_BLOCK_GMRES_SOLMGR_HPP</span></div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>  <span class="comment">// Test whether we are using a projected preconditioner with multiple Ritz shifts</span></div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>  <span class="comment">// We can&#39;t currently do this for reasons that are complicated and are explained in the user manual</span></div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(problem_-&gt;getPrec() != Teuchos::null &amp;&amp; saddleSolType_ == PROJECTED_KRYLOV_SOLVER &amp;&amp; useMultipleShifts_, std::invalid_argument,</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>         <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: When you use the projected Krylov solver with preconditioning, the preconditioner must be projected as well.  In theory, if the preconditioner is SPD, the projected preconditioner will be SPSD, but in practice, it can have small negative eigenvalues, presumably due to machine arithmetic.  This means we can&#39;t use TraceMin&#39;s built-in MINRES, and we are forced to use Belos for now.  When you use multiple Ritz shifts, you are essentially using a different operator to solve each linear system.  Belos can&#39;t handle this right now, but we&#39;re working on a solution.  For now, please set \&quot;Use Multiple Shifts\&quot; to false.&quot;</span>);</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>  <span class="comment">// Test whether we are using a projected preconditioner without Belos.</span></div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>  <span class="comment">// P Prec P should be positive definite if Prec is positive-definite, </span></div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>  <span class="comment">// but it tends not to be in practice, presumably due to machine arithmetic</span></div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>  <span class="comment">// As a result, we have to use pseudo-block gmres for now.</span></div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>  <span class="comment">// Make sure it&#39;s available.</span></div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(problem_-&gt;getPrec() != Teuchos::null &amp;&amp; saddleSolType_ == PROJECTED_KRYLOV_SOLVER, std::invalid_argument,</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>         <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr: When you use the projected Krylov solver with preconditioning, the preconditioner must be projected as well.  In theory, if the preconditioner is SPD, the projected preconditioner will be SPSD, but in practice, it can have small negative eigenvalues, presumably due to machine arithmetic.  This means we can&#39;t use TraceMin&#39;s built-in MINRES, and we are forced to use Belos for now.  You didn&#39;t install Belos.  You have three options to correct this problem:\n1. Reinstall Trilinos with Belos enabled\n2. Don&#39;t use a preconditioner\n3. Choose a different method for solving the saddle-point problem (Recommended)&quot;</span>);</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span> </div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span> </div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span> </div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>  </div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>}</div>
</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span> </div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span> </div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span><span class="comment">// solve()</span></div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span><span class="keyword">template</span>&lt;<span class="keyword">class</span> ScalarType, <span class="keyword">class</span> MV, <span class="keyword">class</span> OP&gt;</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span><a class="code hl_enumeration" href="namespaceAnasazi.html#a823537bb3d658892d7388be67cf036a6">ReturnType</a> </div>
<div class="foldopen" id="foldopen00541" data-start="{" data-end="}">
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno"><a class="line" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a59c1a503e51b9c8a6bc0fed63a52db1a">  541</a></span><a class="code hl_function" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a59c1a503e51b9c8a6bc0fed63a52db1a">TraceMinBaseSolMgr&lt;ScalarType,MV,OP&gt;::solve</a>() </div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>{</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>  <span class="keyword">typedef</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">SolverUtils&lt;ScalarType,MV,OP&gt;</a> <a class="code hl_class" href="classAnasazi_1_1Operator.html">msutils</a>;</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span> </div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">nev</a> = problem_-&gt;getNEV();</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span> </div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span><span class="preprocessor">#ifdef TEUCHOS_DEBUG</span></div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;Teuchos::FancyOStream&gt;</a></div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>      <a class="code hl_class" href="classAnasazi_1_1Operator.html">out</a> = Teuchos::getFancyOStream(Teuchos::rcpFromRef(printer_-&gt;stream(<a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2e2571549ff094918fb9b368fad7f1f9">Debug</a>)));</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">out</a>-&gt;setShowAllFrontMatter(<span class="keyword">false</span>).setShowProcRank(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>    *<a class="code hl_class" href="classAnasazi_1_1Operator.html">out</a> &lt;&lt; <span class="stringliteral">&quot;Entering Anasazi::TraceMinBaseSolMgr::solve()\n&quot;</span>;</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span> </div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>  <span class="comment">// Sort manager</span></div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;BasicSort&lt;MagnitudeType&gt;</a> &gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">sorter</a> = rcp( <span class="keyword">new</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">BasicSort&lt;MagnitudeType&gt;</a>(<span class="stringliteral">&quot;SM&quot;</span>) );</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span> </div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>  <span class="comment">// Handle the spectral transformation if necessary</span></div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>  <span class="comment">// TODO: Make sure we undo this before returning...</span></div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>  <span class="keywordflow">if</span>(which_ == <span class="stringliteral">&quot;LM&quot;</span>)</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>  {</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;const OP&gt;</a> <a class="code hl_class" href="classAnasazi_1_1Operator.html">swapHelper</a> = problem_-&gt;getOperator();</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>    problem_-&gt;setOperator(problem_-&gt;getM());</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>    problem_-&gt;setM(<a class="code hl_class" href="classAnasazi_1_1Operator.html">swapHelper</a>);</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>    problem_-&gt;setProblem();</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>  } </div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span> </div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>  <span class="comment">// Status tests</span></div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>  <span class="comment">//</span></div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>  <span class="comment">// convergence</span></div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;StatusTest&lt;ScalarType,MV,OP&gt;</a> &gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">convtest</a>;</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>  <span class="keywordflow">if</span> (globalTest_ == Teuchos::null) {</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>    <span class="keywordflow">if</span>(which_ == <span class="stringliteral">&quot;SM&quot;</span>)</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>      <a class="code hl_class" href="classAnasazi_1_1Operator.html">convtest</a> = rcp( <span class="keyword">new</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">StatusTestResNorm&lt;ScalarType,MV,OP&gt;</a>(convTol_,<a class="code hl_class" href="classAnasazi_1_1Operator.html">nev</a>,convNorm_,relConvTol_) );</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>      <a class="code hl_class" href="classAnasazi_1_1Operator.html">convtest</a> = rcp( <span class="keyword">new</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">StatusTestSpecTrans&lt;ScalarType,MV,OP&gt;</a>(convTol_,<a class="code hl_class" href="classAnasazi_1_1Operator.html">nev</a>,convNorm_,relConvTol_,<span class="keyword">true</span>,problem_-&gt;getOperator()) );</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>  }</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">convtest</a> = globalTest_;</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>  }</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;StatusTestWithOrdering&lt;ScalarType,MV,OP&gt;</a> &gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">ordertest</a> </div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>    = rcp( <span class="keyword">new</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">StatusTestWithOrdering&lt;ScalarType,MV,OP&gt;</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">convtest</a>,<a class="code hl_class" href="classAnasazi_1_1Operator.html">sorter</a>,<a class="code hl_class" href="classAnasazi_1_1Operator.html">nev</a>) );</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>  <span class="comment">// locking</span></div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;StatusTest&lt;ScalarType,MV,OP&gt;</a> &gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">locktest</a>;</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>  <span class="keywordflow">if</span> (useLocking_) {</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>    <span class="keywordflow">if</span> (lockingTest_ == Teuchos::null) {</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>      <span class="keywordflow">if</span>(which_ == <span class="stringliteral">&quot;SM&quot;</span>)</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>        <a class="code hl_class" href="classAnasazi_1_1Operator.html">locktest</a> = rcp( <span class="keyword">new</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">StatusTestResNorm&lt;ScalarType,MV,OP&gt;</a>(lockTol_,lockQuorum_,lockNorm_,relLockTol_) );</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>        <a class="code hl_class" href="classAnasazi_1_1Operator.html">locktest</a> = rcp( <span class="keyword">new</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">StatusTestSpecTrans&lt;ScalarType,MV,OP&gt;</a>(lockTol_,lockQuorum_,lockNorm_,relLockTol_,<span class="keyword">true</span>,problem_-&gt;getOperator()) );</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>    }</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>      <a class="code hl_class" href="classAnasazi_1_1Operator.html">locktest</a> = lockingTest_;</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>    }</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>  }</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>  <span class="comment">// for a non-short-circuited OR test, the order doesn&#39;t matter</span></div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>  Teuchos::Array&lt;RCP&lt;StatusTest&lt;ScalarType,MV,OP&gt; &gt; &gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">alltests</a>;</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">alltests</a>.push_back(<a class="code hl_class" href="classAnasazi_1_1Operator.html">ordertest</a>);</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classAnasazi_1_1Operator.html">locktest</a> != Teuchos::null) <a class="code hl_class" href="classAnasazi_1_1Operator.html">alltests</a>.push_back(<a class="code hl_class" href="classAnasazi_1_1Operator.html">locktest</a>);</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>  <span class="keywordflow">if</span> (debugTest_ != Teuchos::null) <a class="code hl_class" href="classAnasazi_1_1Operator.html">alltests</a>.push_back(debugTest_);</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span> </div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;StatusTestCombo&lt;ScalarType,MV,OP&gt;</a> &gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">combotest</a></div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>    = rcp( <span class="keyword">new</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">StatusTestCombo&lt;ScalarType,MV,OP&gt;</a>( <a class="code hl_class" href="classAnasazi_1_1StatusTestCombo.html">StatusTestCombo&lt;ScalarType,MV,OP&gt;::OR</a>, <a class="code hl_class" href="classAnasazi_1_1Operator.html">alltests</a>) );</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>  <span class="comment">// printing StatusTest</span></div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;StatusTestOutput&lt;ScalarType,MV,OP&gt;</a> &gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">outputtest</a>;</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>  <span class="keywordflow">if</span> ( printer_-&gt;isVerbosity(<a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2e2571549ff094918fb9b368fad7f1f9">Debug</a>) ) {</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">outputtest</a> = rcp( <span class="keyword">new</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">StatusTestOutput&lt;ScalarType,MV,OP&gt;</a>( printer_,<a class="code hl_class" href="classAnasazi_1_1Operator.html">combotest</a>,1,<a class="code hl_enumvalue" href="namespaceAnasazi.html#aecc89d0f13b3e478065ad8d8b53788c2a37e4db41c154382c42a280dfb2eebad8">Passed</a>+<a class="code hl_enumvalue" href="namespaceAnasazi.html#aecc89d0f13b3e478065ad8d8b53788c2a9b73a6d49abb67b1edcd2c524b9332e0">Failed</a>+<a class="code hl_enumvalue" href="namespaceAnasazi.html#aecc89d0f13b3e478065ad8d8b53788c2a0e0d7b1d4280c818d697128327e4f534">Undefined</a> ) );</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>  }</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">outputtest</a> = rcp( <span class="keyword">new</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">StatusTestOutput&lt;ScalarType,MV,OP&gt;</a>( printer_,<a class="code hl_class" href="classAnasazi_1_1Operator.html">combotest</a>,1,<a class="code hl_enumvalue" href="namespaceAnasazi.html#aecc89d0f13b3e478065ad8d8b53788c2a37e4db41c154382c42a280dfb2eebad8">Passed</a> ) );</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>  }</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span> </div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>  <span class="comment">// Orthomanager</span></div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;MatOrthoManager&lt;ScalarType,MV,OP&gt;</a> &gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">ortho</a>; </div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>  <span class="keywordflow">if</span> (ortho_==<span class="stringliteral">&quot;SVQB&quot;</span>) {</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">ortho</a> = rcp( <span class="keyword">new</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">SVQBOrthoManager&lt;ScalarType,MV,OP&gt;</a>(problem_-&gt;getM()) );</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ortho_==<span class="stringliteral">&quot;DGKS&quot;</span>) {</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">ortho</a> = rcp( <span class="keyword">new</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">BasicOrthoManager&lt;ScalarType,MV,OP&gt;</a>(problem_-&gt;getM()) );</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ortho_==<span class="stringliteral">&quot;ICGS&quot;</span>) {</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">ortho</a> = rcp( <span class="keyword">new</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">ICGSOrthoManager&lt;ScalarType,MV,OP&gt;</a>(problem_-&gt;getM()) );</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<span class="keyword">true</span>,std::logic_error,<span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr::solve(): Invalid orthogonalization type.&quot;</span>);</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>  }</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span> </div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>  <span class="comment">// Parameter list</span></div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>  Teuchos::ParameterList <a class="code hl_class" href="classAnasazi_1_1Operator.html">plist</a>;</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>  setParameters(<a class="code hl_class" href="classAnasazi_1_1Operator.html">plist</a>);</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span> </div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>  <span class="comment">// TraceMinBase solver</span></div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;TraceMinBase&lt;ScalarType,MV,OP&gt;</a> &gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">tm_solver</a> </div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>    = createSolver(<a class="code hl_class" href="classAnasazi_1_1Operator.html">sorter</a>,<a class="code hl_class" href="classAnasazi_1_1Operator.html">outputtest</a>,<a class="code hl_class" href="classAnasazi_1_1Operator.html">ortho</a>,<a class="code hl_class" href="classAnasazi_1_1Operator.html">plist</a>);</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>  <span class="comment">// set any auxiliary vectors defined in the problem</span></div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>  RCP&lt; const MV &gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">probauxvecs</a> = problem_-&gt;getAuxVecs();</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classAnasazi_1_1Operator.html">probauxvecs</a> != Teuchos::null) {</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">tm_solver</a>-&gt;setAuxVecs( Teuchos::tuple&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;const MV&gt;</a> &gt;(<a class="code hl_class" href="classAnasazi_1_1Operator.html">probauxvecs</a>) );</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>  }</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span> </div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>  <span class="comment">// Storage</span></div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>  <span class="comment">// </span></div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>  <span class="comment">// lockvecs will contain eigenvectors that have been determined &quot;locked&quot; by the status test</span></div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>  <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">curNumLocked</a> = 0;</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;MV&gt;</a> <a class="code hl_class" href="classAnasazi_1_1Operator.html">lockvecs</a>;</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>  <span class="comment">// lockvecs is used to hold the locked eigenvectors, as well as for temporary storage when locking.</span></div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>  <span class="comment">// when locking, we will lock some number of vectors numnew, where numnew &lt;= maxlocked - curlocked</span></div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>  <span class="comment">// we will produce numnew random vectors, which will go into the space with the new basis.</span></div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>  <span class="comment">// we will also need numnew storage for the image of these random vectors under A and M; </span></div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>  <span class="comment">// columns [curlocked+1,curlocked+numnew] will be used for this storage</span></div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>  <span class="keywordflow">if</span> (maxLocked_ &gt; 0) {</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">lockvecs</a> = MVT::Clone(*problem_-&gt;getInitVec(),maxLocked_);</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>  }</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>  std::vector&lt;MagnitudeType&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">lockvals</a>;</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>  <span class="comment">//</span></div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>  <span class="comment">// Restarting occurs under two scenarios: when the basis is full and after locking.</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>  <span class="comment">//</span></div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>  <span class="comment">// For the former, a new basis of size blockSize*numRestartBlocks is generated using the current basis</span></div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>  <span class="comment">// and the most significant primitive Ritz vectors (projected eigenvectors).</span></div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>  <span class="comment">//     [S,L] = eig(KK)</span></div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>  <span class="comment">//     S = [Sr St]   // some for &quot;r&quot;estarting, some are &quot;t&quot;runcated</span></div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>  <span class="comment">//     newV = V*Sr</span></div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>  <span class="comment">//     KK_new = newV&#39;*K*newV = Sr&#39;*V&#39;*K*V*Sr = Sr&#39;*KK*Sr</span></div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>  <span class="comment">//  Therefore, the only multivector operation needed is for the generation of newV.</span></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>  <span class="comment">//</span></div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>  <span class="comment">//  * If the multiplication is explicit, it requires a workspace of blockSize*numRestartBlocks vectors. </span></div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>  <span class="comment">//    This space must be specifically allocated for that task, as we don&#39;t have any space of that size.</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>  <span class="comment">//    It (workMV) will be allocated at the beginning of solve()</span></div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>  <span class="comment">//  * Optionally, the multiplication can be performed implicitly, via a Householder QR factorization of </span></div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>  <span class="comment">//    Sr. This can be done in situ, using the basis multivector contained in the solver. This requires</span></div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>  <span class="comment">//    that we cast away the const on the multivector returned from getState(). Workspace for this approach</span></div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>  <span class="comment">//    is a single vector. the solver&#39;s internal storage must be preserved (X,MX,KX,R), requiring us to </span></div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>  <span class="comment">//    allocate this vector.</span></div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>  <span class="comment">//</span></div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>  <span class="comment">// For the latter (restarting after locking), the new basis is the same size as existing basis. If numnew</span></div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>  <span class="comment">// vectors are locked, they are deflated from the current basis and replaced with randomly generated </span></div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>  <span class="comment">// vectors.</span></div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>  <span class="comment">//     [S,L] = eig(KK)</span></div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>  <span class="comment">//     S = [Sl Su]  // partitioned: &quot;l&quot;ocked and &quot;u&quot;nlocked</span></div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>  <span class="comment">//     newL = V*Sl = X(locked)</span></div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>  <span class="comment">//     defV = V*Su</span></div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>  <span class="comment">//     augV = rand(numnew)  // orthogonal to oldL,newL,defV,auxvecs</span></div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>  <span class="comment">//     newV = [defV augV]</span></div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>  <span class="comment">//     Kknew = newV&#39;*K*newV = [Su&#39;*KK*Su    defV&#39;*K*augV]</span></div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>  <span class="comment">//                            [augV&#39;*K*defV augV&#39;*K*augV]</span></div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>  <span class="comment">//     locked = [oldL newL]</span></div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>  <span class="comment">// Clearly, this operation is more complicated than the previous.</span></div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>  <span class="comment">// Here is a list of the significant computations that need to be performed:</span></div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>  <span class="comment">// - newL will be put into space in lockvecs, but will be copied from getState().X at the end</span></div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>  <span class="comment">// - defV,augV will be stored in workspace the size of the current basis.</span></div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>  <span class="comment">// - M*augV and K*augV are needed; they will be stored in lockvecs. As a result, newL will</span></div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>  <span class="comment">//   not be put into lockvecs until the end.</span></div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>  <span class="comment">//</span></div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>  <span class="comment">// Therefore, we must allocate workMV when ((maxRestarts_ &gt; 0) || (useLocking_ == true)) &amp;&amp; inSituRestart == false</span></div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>  <span class="comment">// It will be allocated to size (numBlocks-1)*blockSize</span></div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>  <span class="comment">//</span></div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span> </div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>  <span class="comment">// some consts and utils</span></div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>  <span class="keyword">const</span> ScalarType ONE = SCT::one();</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>  <span class="keyword">const</span> ScalarType ZERO = SCT::zero();</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span> </div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>  <span class="comment">// go ahead and initialize the solution to nothing in case we throw an exception</span></div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">Eigensolution&lt;ScalarType,MV&gt;</a> <a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>;</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.numVecs = 0;</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>  problem_-&gt;setSolution(<a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>);</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span> </div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>  <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">numRestarts</a> = 0;</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span> </div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>  <span class="comment">// enter solve() iterations</span></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>  {</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span><span class="preprocessor">#ifdef ANASAZI_TEUCHOS_TIME_MONITOR</span></div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>    Teuchos::TimeMonitor <a class="code hl_class" href="classAnasazi_1_1Operator.html">slvtimer</a>(*_timerSolve);</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span> </div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>    <span class="comment">// tell tm_solver to iterate</span></div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>    <span class="keywordflow">while</span> (1) {</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>        <a class="code hl_class" href="classAnasazi_1_1Operator.html">tm_solver</a>-&gt;iterate();</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span> </div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>        <span class="comment">//</span></div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>        <span class="comment">//</span></div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>        <span class="keywordflow">if</span> (debugTest_ != Teuchos::null &amp;&amp; debugTest_-&gt;getStatus() == <a class="code hl_enumvalue" href="namespaceAnasazi.html#aecc89d0f13b3e478065ad8d8b53788c2a37e4db41c154382c42a280dfb2eebad8">Passed</a>) {</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>          <span class="keywordflow">throw</span> <a class="code hl_class" href="classAnasazi_1_1AnasaziError.html">AnasaziError</a>(<span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr::solve(): User-specified debug status test returned Passed.&quot;</span>);</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>        }</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>        <span class="comment">//</span></div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>        <span class="comment">// check convergence next</span></div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>        <span class="comment">//</span></div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="classAnasazi_1_1Operator.html">ordertest</a>-&gt;getStatus() == <a class="code hl_enumvalue" href="namespaceAnasazi.html#aecc89d0f13b3e478065ad8d8b53788c2a37e4db41c154382c42a280dfb2eebad8">Passed</a> ) {</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>          <span class="comment">// we have convergence</span></div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>          <span class="comment">// ordertest-&gt;whichVecs() tells us which vectors from lockvecs and solver state are the ones we want</span></div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>          <span class="comment">// ordertest-&gt;howMany() will tell us how many</span></div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>        }</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>        <span class="comment">//</span></div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>        <span class="comment">// check locking if we didn&#39;t converge or restart</span></div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>        <span class="comment">//</span></div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="classAnasazi_1_1Operator.html">locktest</a> != Teuchos::null &amp;&amp; <a class="code hl_class" href="classAnasazi_1_1Operator.html">locktest</a>-&gt;getStatus() == <a class="code hl_enumvalue" href="namespaceAnasazi.html#aecc89d0f13b3e478065ad8d8b53788c2a37e4db41c154382c42a280dfb2eebad8">Passed</a>) {</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span> </div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span><span class="preprocessor">#ifdef ANASAZI_TEUCHOS_TIME_MONITOR</span></div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>          Teuchos::TimeMonitor <a class="code hl_class" href="classAnasazi_1_1Operator.html">lcktimer</a>(*_timerLocking);</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span> </div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>          <span class="comment">// </span></div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>          <span class="comment">// get current state</span></div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">TraceMinBaseState&lt;ScalarType,MV&gt;</a> <a class="code hl_class" href="classAnasazi_1_1Operator.html">state</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">tm_solver</a>-&gt;getState();</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">curdim</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">state</a>.curDim;</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span> </div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>          <span class="comment">//</span></div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>          <span class="comment">// get number,indices of vectors to be locked</span></div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">locktest</a>-&gt;howMany() &lt;= 0,std::logic_error,</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>              <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr::solve(): status test mistake: howMany() non-positive.&quot;</span>);</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">locktest</a>-&gt;howMany() != (<span class="keywordtype">int</span>)<a class="code hl_class" href="classAnasazi_1_1Operator.html">locktest</a>-&gt;whichVecs().size(),std::logic_error,</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>              <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr::solve(): status test mistake: howMany() not consistent with whichVecs().&quot;</span>);</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>          <span class="comment">// we should have room to lock vectors; otherwise, locking should have been deactivated</span></div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">curNumLocked</a> == maxLocked_,std::logic_error,</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>              <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr::solve(): status test mistake: locking not deactivated.&quot;</span>);</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>          <span class="comment">//</span></div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>          <span class="comment">// don&#39;t lock more than maxLocked_; we didn&#39;t allocate enough space.</span></div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>          std::vector&lt;int&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">tmp_vector_int</a>;</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>          <span class="keywordflow">if</span> (<a class="code hl_class" href="classAnasazi_1_1Operator.html">curNumLocked</a> + <a class="code hl_class" href="classAnasazi_1_1Operator.html">locktest</a>-&gt;howMany() &gt; maxLocked_) {</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>            <span class="comment">// just use the first of them</span></div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;maxLocked_-<a class="code hl_class" href="classAnasazi_1_1Operator.html">curNumLocked</a>; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++)</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>        <a class="code hl_class" href="classAnasazi_1_1Operator.html">tmp_vector_int</a>.push_back(<a class="code hl_class" href="classAnasazi_1_1Operator.html">locktest</a>-&gt;whichVecs()[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>]);</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span><span class="comment">//            tmp_vector_int.insert(tmp_vector_int.begin(),locktest-&gt;whichVecs().begin(),locktest-&gt;whichVecs().begin()+maxLocked_-curNumLocked);</span></div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>          }</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>          <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>            <a class="code hl_class" href="classAnasazi_1_1Operator.html">tmp_vector_int</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">locktest</a>-&gt;whichVecs();</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>          }</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span> </div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>          <span class="keyword">const</span> std::vector&lt;int&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">lockind</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">tmp_vector_int</a>);</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">numNewLocked</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">lockind</a>.size();</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>          <span class="comment">//</span></div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>          <span class="comment">// generate indices of vectors left unlocked</span></div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>          <span class="comment">// curind = [0,...,curdim-1] = UNION( lockind, unlockind )</span></div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">numUnlocked</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">curdim</a>-<a class="code hl_class" href="classAnasazi_1_1Operator.html">numNewLocked</a>;</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">tmp_vector_int</a>.resize(<a class="code hl_class" href="classAnasazi_1_1Operator.html">curdim</a>);</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">curdim</a>; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++) <a class="code hl_class" href="classAnasazi_1_1Operator.html">tmp_vector_int</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] = <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>;</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>          <span class="keyword">const</span> std::vector&lt;int&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">curind</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">tmp_vector_int</a>);       <span class="comment">// curind = [0 ... curdim-1]</span></div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">tmp_vector_int</a>.resize(<a class="code hl_class" href="classAnasazi_1_1Operator.html">numUnlocked</a>); </div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>          std::set_difference(<a class="code hl_class" href="classAnasazi_1_1Operator.html">curind</a>.begin(),<a class="code hl_class" href="classAnasazi_1_1Operator.html">curind</a>.end(),<a class="code hl_class" href="classAnasazi_1_1Operator.html">lockind</a>.begin(),<a class="code hl_class" href="classAnasazi_1_1Operator.html">lockind</a>.end(),<a class="code hl_class" href="classAnasazi_1_1Operator.html">tmp_vector_int</a>.begin());</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>          <span class="keyword">const</span> std::vector&lt;int&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">unlockind</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">tmp_vector_int</a>);    <span class="comment">// unlockind = [0 ... curdim-1] - lockind</span></div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">tmp_vector_int</a>.clear();</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span> </div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>          <span class="comment">//</span></div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>          <span class="comment">// debug printing</span></div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>          <span class="keywordflow">if</span> (printer_-&gt;isVerbosity(<a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2e2571549ff094918fb9b368fad7f1f9">Debug</a>)) {</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>            printer_-&gt;print(<a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2e2571549ff094918fb9b368fad7f1f9">Debug</a>,<span class="stringliteral">&quot;Locking vectors: &quot;</span>);</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">lockind</a>.size(); <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++) {printer_-&gt;stream(<a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2e2571549ff094918fb9b368fad7f1f9">Debug</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">lockind</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>];}</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>            printer_-&gt;print(<a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2e2571549ff094918fb9b368fad7f1f9">Debug</a>,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>            printer_-&gt;print(<a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2e2571549ff094918fb9b368fad7f1f9">Debug</a>,<span class="stringliteral">&quot;Not locking vectors: &quot;</span>);</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">unlockind</a>.size(); <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++) {printer_-&gt;stream(<a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2e2571549ff094918fb9b368fad7f1f9">Debug</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">unlockind</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>];}</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>            printer_-&gt;print(<a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2e2571549ff094918fb9b368fad7f1f9">Debug</a>,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>          }</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span> </div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>          <span class="comment">// Copy eigenvalues we want to lock into lockvals</span></div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>          std::vector&lt;Value&lt;ScalarType&gt; &gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">allvals</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">tm_solver</a>-&gt;getRitzValues();</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">allvals</a>.size(); <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++)</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>            printer_-&gt;stream(<a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2e2571549ff094918fb9b368fad7f1f9">Debug</a>) &lt;&lt; <span class="stringliteral">&quot;Ritz value[&quot;</span> &lt;&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a> &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">allvals</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>].realpart &lt;&lt; std::endl;</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">numNewLocked</a>; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++) {</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>            <a class="code hl_class" href="classAnasazi_1_1Operator.html">lockvals</a>.push_back(<a class="code hl_class" href="classAnasazi_1_1Operator.html">allvals</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">lockind</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>]].realpart);</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>          }</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span> </div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>          <span class="comment">// Copy vectors we want to lock into lockvecs</span></div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;const MV&gt;</a> <a class="code hl_class" href="classAnasazi_1_1Operator.html">newLocked</a> = MVT::CloneView(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">tm_solver</a>-&gt;getRitzVectors(),<a class="code hl_class" href="classAnasazi_1_1Operator.html">lockind</a>);</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>          std::vector&lt;int&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">indlock</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">numNewLocked</a>);</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">numNewLocked</a>; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++) <a class="code hl_class" href="classAnasazi_1_1Operator.html">indlock</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] = <a class="code hl_class" href="classAnasazi_1_1Operator.html">curNumLocked</a>+<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>;</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>          <span class="keywordflow">if</span>(useHarmonic_)</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>          {</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>            <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;MV&gt;</a> <a class="code hl_class" href="classAnasazi_1_1Operator.html">tempMV</a> = MVT::CloneCopy(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">newLocked</a>);</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>            <a class="code hl_class" href="classAnasazi_1_1Operator.html">ortho</a>-&gt;normalizeMat(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">tempMV</a>);</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>            MVT::SetBlock(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">tempMV</a>,<a class="code hl_class" href="classAnasazi_1_1Operator.html">indlock</a>,*<a class="code hl_class" href="classAnasazi_1_1Operator.html">lockvecs</a>);</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>          }</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>          <span class="keywordflow">else</span></div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>          {</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>            MVT::SetBlock(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">newLocked</a>,<a class="code hl_class" href="classAnasazi_1_1Operator.html">indlock</a>,*<a class="code hl_class" href="classAnasazi_1_1Operator.html">lockvecs</a>);</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>          }</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span> </div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>          <span class="comment">// Tell the StatusTestWithOrdering that things have been locked</span></div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>          <span class="comment">// This is VERY important</span></div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>          <span class="comment">// If this set of lines is removed, the code does not terminate correctly</span></div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>          <span class="keywordflow">if</span>(noSort_)</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>          {</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">aliciaInd</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">aliciaInd</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">lockvals</a>.size(); <a class="code hl_class" href="classAnasazi_1_1Operator.html">aliciaInd</a>++)</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>            {</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>              <a class="code hl_class" href="classAnasazi_1_1Operator.html">lockvals</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">aliciaInd</a>] = 0.0;</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>            }</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>          }</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">ordertest</a>-&gt;setAuxVals(<a class="code hl_class" href="classAnasazi_1_1Operator.html">lockvals</a>);</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span> </div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>          <span class="comment">// Set the auxiliary vectors so that we remain orthogonal to the ones we locked</span></div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>          <span class="comment">// Remember to include any aux vecs provided by the user</span></div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">curNumLocked</a> += <a class="code hl_class" href="classAnasazi_1_1Operator.html">numNewLocked</a>;</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span> </div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>          <span class="keywordflow">if</span>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">ordertest</a>-&gt;getStatus() == <a class="code hl_enumvalue" href="namespaceAnasazi.html#aecc89d0f13b3e478065ad8d8b53788c2a37e4db41c154382c42a280dfb2eebad8">Passed</a>)  <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span> </div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>          std::vector&lt;int&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">curlockind</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">curNumLocked</a>);</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">curNumLocked</a>; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++) <a class="code hl_class" href="classAnasazi_1_1Operator.html">curlockind</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] = <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>;</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;const MV&gt;</a> <a class="code hl_class" href="classAnasazi_1_1Operator.html">curlocked</a> = MVT::CloneView(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">lockvecs</a>,<a class="code hl_class" href="classAnasazi_1_1Operator.html">curlockind</a>);</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span> </div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>          Teuchos::Array&lt; RCP&lt;const MV&gt; &gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">aux</a>;</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>          <span class="keywordflow">if</span> (<a class="code hl_class" href="classAnasazi_1_1Operator.html">probauxvecs</a> != Teuchos::null) <a class="code hl_class" href="classAnasazi_1_1Operator.html">aux</a>.push_back(<a class="code hl_class" href="classAnasazi_1_1Operator.html">probauxvecs</a>);</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">aux</a>.push_back(<a class="code hl_class" href="classAnasazi_1_1Operator.html">curlocked</a>);</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">tm_solver</a>-&gt;setAuxVecs(<a class="code hl_class" href="classAnasazi_1_1Operator.html">aux</a>);</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span> </div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>          <span class="comment">// Disable locking if we have locked the maximum number of things</span></div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>          printer_-&gt;stream(<a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2e2571549ff094918fb9b368fad7f1f9">Debug</a>) &lt;&lt; <span class="stringliteral">&quot;curNumLocked: &quot;</span> &lt;&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">curNumLocked</a> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>          printer_-&gt;stream(<a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2e2571549ff094918fb9b368fad7f1f9">Debug</a>) &lt;&lt; <span class="stringliteral">&quot;maxLocked: &quot;</span> &lt;&lt; maxLocked_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>          <span class="keywordflow">if</span> (<a class="code hl_class" href="classAnasazi_1_1Operator.html">curNumLocked</a> == maxLocked_) {</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>            <span class="comment">// disabled locking now</span></div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>            <a class="code hl_class" href="classAnasazi_1_1Operator.html">combotest</a>-&gt;removeTest(<a class="code hl_class" href="classAnasazi_1_1Operator.html">locktest</a>);</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>            <a class="code hl_class" href="classAnasazi_1_1Operator.html">locktest</a> = Teuchos::null;</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>            printer_-&gt;stream(<a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2e2571549ff094918fb9b368fad7f1f9">Debug</a>) &lt;&lt; <span class="stringliteral">&quot;Removed locking test\n&quot;</span>;</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>          }</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span> </div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>          <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">newdim</a> = numRestartBlocks_*blockSize_;</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">TraceMinBaseState&lt;ScalarType,MV&gt;</a> <a class="code hl_class" href="classAnasazi_1_1Operator.html">newstate</a>;</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>          <span class="keywordflow">if</span>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">newdim</a> &lt;= <a class="code hl_class" href="classAnasazi_1_1Operator.html">numUnlocked</a>)</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>          {</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>            <span class="keywordflow">if</span>(useHarmonic_)</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>            {</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>              std::vector&lt;int&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">desiredSubscripts</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">newdim</a>);</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">newdim</a>; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++)</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>              {</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>                <a class="code hl_class" href="classAnasazi_1_1Operator.html">desiredSubscripts</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] = <a class="code hl_class" href="classAnasazi_1_1Operator.html">unlockind</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>];</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>                printer_-&gt;stream(<a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2e2571549ff094918fb9b368fad7f1f9">Debug</a>) &lt;&lt; <span class="stringliteral">&quot;H desiredSubscripts[&quot;</span> &lt;&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a> &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">desiredSubscripts</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] &lt;&lt; std::endl;</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>              }</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>              <a class="code hl_class" href="classAnasazi_1_1Operator.html">newstate</a>.V = MVT::CloneView(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">tm_solver</a>-&gt;getRitzVectors(),<a class="code hl_class" href="classAnasazi_1_1Operator.html">desiredSubscripts</a>);</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>              <a class="code hl_class" href="classAnasazi_1_1Operator.html">newstate</a>.curDim = <a class="code hl_class" href="classAnasazi_1_1Operator.html">newdim</a>;</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>            }</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>            {</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>              std::vector&lt;int&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">desiredSubscripts</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">newdim</a>);</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">newdim</a>; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++)</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>              {</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>                <a class="code hl_class" href="classAnasazi_1_1Operator.html">desiredSubscripts</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] = <a class="code hl_class" href="classAnasazi_1_1Operator.html">unlockind</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>];</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>                printer_-&gt;stream(<a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2e2571549ff094918fb9b368fad7f1f9">Debug</a>) &lt;&lt; <span class="stringliteral">&quot;desiredSubscripts[&quot;</span> &lt;&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a> &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">desiredSubscripts</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] &lt;&lt; std::endl;</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>              }</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span> </div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>              copyPartOfState(<a class="code hl_class" href="classAnasazi_1_1Operator.html">state</a>, <a class="code hl_class" href="classAnasazi_1_1Operator.html">newstate</a>, <a class="code hl_class" href="classAnasazi_1_1Operator.html">desiredSubscripts</a>);</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>            }</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>          }</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>          <span class="keywordflow">else</span></div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>          {</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>            <span class="comment">// TODO: Come back to this and make it more efficient</span></div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span> </div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>            <span class="comment">// Replace the converged eigenvectors with random ones</span></div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>            <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">nrandom</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">newdim</a>-<a class="code hl_class" href="classAnasazi_1_1Operator.html">numUnlocked</a>;</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>  </div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>            <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;const MV&gt;</a> <a class="code hl_class" href="classAnasazi_1_1Operator.html">helperMV</a>;</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>            <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;MV&gt;</a> <a class="code hl_class" href="classAnasazi_1_1Operator.html">totalV</a> = MVT::Clone(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">tm_solver</a>-&gt;getRitzVectors(),<a class="code hl_class" href="classAnasazi_1_1Operator.html">newdim</a>);</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span> </div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>            <span class="comment">// Holds old things that we&#39;re keeping</span></div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>            <a class="code hl_class" href="classAnasazi_1_1Operator.html">tmp_vector_int</a>.resize(<a class="code hl_class" href="classAnasazi_1_1Operator.html">numUnlocked</a>);</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">numUnlocked</a>; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++) <a class="code hl_class" href="classAnasazi_1_1Operator.html">tmp_vector_int</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] = <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>;</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>            <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;MV&gt;</a> <a class="code hl_class" href="classAnasazi_1_1Operator.html">oldV</a> = MVT::CloneViewNonConst(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">totalV</a>,<a class="code hl_class" href="classAnasazi_1_1Operator.html">tmp_vector_int</a>);</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span> </div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>            <span class="comment">// Copy over the old things</span></div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>            <span class="keywordflow">if</span>(useHarmonic_)</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>              <a class="code hl_class" href="classAnasazi_1_1Operator.html">helperMV</a> = MVT::CloneView(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">tm_solver</a>-&gt;getRitzVectors(),<a class="code hl_class" href="classAnasazi_1_1Operator.html">unlockind</a>);</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>              <a class="code hl_class" href="classAnasazi_1_1Operator.html">helperMV</a> = MVT::CloneView(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">state</a>.V,<a class="code hl_class" href="classAnasazi_1_1Operator.html">unlockind</a>);</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>            MVT::Assign(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">helperMV</a>,*<a class="code hl_class" href="classAnasazi_1_1Operator.html">oldV</a>);</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span> </div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>            <span class="comment">// Holds random vectors we&#39;re generating</span></div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>            <a class="code hl_class" href="classAnasazi_1_1Operator.html">tmp_vector_int</a>.resize(<a class="code hl_class" href="classAnasazi_1_1Operator.html">nrandom</a>);</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">nrandom</a>; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++) <a class="code hl_class" href="classAnasazi_1_1Operator.html">tmp_vector_int</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] = <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>+<a class="code hl_class" href="classAnasazi_1_1Operator.html">numUnlocked</a>;</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>            <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;MV&gt;</a> <a class="code hl_class" href="classAnasazi_1_1Operator.html">newV</a> = MVT::CloneViewNonConst(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">totalV</a>,<a class="code hl_class" href="classAnasazi_1_1Operator.html">tmp_vector_int</a>);</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span> </div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>            <span class="comment">// Create random things</span></div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>            MVT::MvRandom(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">newV</a>);</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span> </div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>            <a class="code hl_class" href="classAnasazi_1_1Operator.html">newstate</a>.V = <a class="code hl_class" href="classAnasazi_1_1Operator.html">totalV</a>;</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>            <a class="code hl_class" href="classAnasazi_1_1Operator.html">newstate</a>.curDim = <a class="code hl_class" href="classAnasazi_1_1Operator.html">newdim</a>;</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span> </div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>            <span class="comment">// Copy Ritz shifts</span></div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>            <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt; std::vector&lt;ScalarType&gt;</a> &gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">helperRS</a> = rcp( <span class="keyword">new</span> std::vector&lt;ScalarType&gt;(blockSize_) );</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;(<span class="keywordtype">unsigned</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">int</a>)blockSize_; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++) </div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>            {</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>              <span class="keywordflow">if</span>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a> &lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">unlockind</a>.size() &amp;&amp; <a class="code hl_class" href="classAnasazi_1_1Operator.html">unlockind</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] &lt; blockSize_)</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>                (*<a class="code hl_class" href="classAnasazi_1_1Operator.html">helperRS</a>)[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] = (*<a class="code hl_class" href="classAnasazi_1_1Operator.html">state</a>.ritzShifts)[<a class="code hl_class" href="classAnasazi_1_1Operator.html">unlockind</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>]];</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>              <span class="keywordflow">else</span></div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>                (*<a class="code hl_class" href="classAnasazi_1_1Operator.html">helperRS</a>)[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] = ZERO;</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>            }</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>            <a class="code hl_class" href="classAnasazi_1_1Operator.html">newstate</a>.ritzShifts  = <a class="code hl_class" href="classAnasazi_1_1Operator.html">helperRS</a>;</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>          }</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span> </div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>          <span class="comment">// Determine the largest safe shift</span></div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">newstate</a>.largestSafeShift = std::abs(<a class="code hl_class" href="classAnasazi_1_1Operator.html">lockvals</a>[0]);</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>          <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">lockvals</a>.size(); <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++)</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>            <a class="code hl_class" href="classAnasazi_1_1Operator.html">newstate</a>.largestSafeShift = std::max(std::abs(<a class="code hl_class" href="classAnasazi_1_1Operator.html">lockvals</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>]), <a class="code hl_class" href="classAnasazi_1_1Operator.html">newstate</a>.largestSafeShift);</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span> </div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>          <span class="comment">// Prepare new state, removing converged vectors</span></div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>          <span class="comment">// TODO: Init will perform some unnecessary calculations; look into it</span></div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>          <span class="comment">// TODO: The residual norms should be part of the state</span></div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">newstate</a>.NEV = <a class="code hl_class" href="classAnasazi_1_1Operator.html">state</a>.NEV - <a class="code hl_class" href="classAnasazi_1_1Operator.html">numNewLocked</a>;</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">tm_solver</a>-&gt;initialize(<a class="code hl_class" href="classAnasazi_1_1Operator.html">newstate</a>);</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>        } <span class="comment">// end of locking</span></div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>        <span class="comment">//</span></div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>        <span class="comment">// check for restarting before locking: if we need to lock, it will happen after the restart</span></div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>        <span class="comment">//</span></div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( needToRestart(<a class="code hl_class" href="classAnasazi_1_1Operator.html">tm_solver</a>) ) {</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>          <span class="comment">// if performRestart returns false, we exceeded the maximum number of restarts</span></div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>          <span class="keywordflow">if</span>(performRestart(<a class="code hl_class" href="classAnasazi_1_1Operator.html">numRestarts</a>, <a class="code hl_class" href="classAnasazi_1_1Operator.html">tm_solver</a>) == <span class="keyword">false</span>)</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>        } <span class="comment">// end of restarting</span></div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>        <span class="comment">//</span></div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>        <span class="comment">// we returned from iterate(), but none of our status tests Passed.</span></div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>        <span class="comment">// something is wrong, and it is probably our fault.</span></div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>        <span class="comment">//</span></div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<span class="keyword">true</span>,std::logic_error,<span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr::solve(): Invalid return from tm_solver::iterate().&quot;</span>);</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>        }</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>      }</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>      <span class="keywordflow">catch</span> (<span class="keyword">const</span> <a class="code hl_class" href="classAnasazi_1_1AnasaziError.html">AnasaziError</a> &amp;<a class="code hl_class" href="classAnasazi_1_1Operator.html">err</a>) {</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>        printer_-&gt;stream(<a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2c41d6eeeab5121d3c26c70ac5d18239">Errors</a>) </div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>          &lt;&lt; <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr::solve() caught unexpected exception from Anasazi::TraceMinBase::iterate() at iteration &quot;</span> &lt;&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">tm_solver</a>-&gt;getNumIters() &lt;&lt; std::endl</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>          &lt;&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">err</a>.what() &lt;&lt; std::endl</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>          &lt;&lt; <span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr::solve() returning Unconverged with no solutions.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceAnasazi.html#a823537bb3d658892d7388be67cf036a6a2df84c9ec5ae479b897c1f8153ff2e7e">Unconverged</a>;</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>      }</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>    }</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span> </div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.numVecs = <a class="code hl_class" href="classAnasazi_1_1Operator.html">ordertest</a>-&gt;howMany();</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.numVecs &gt; 0) {</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>      <a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.Evecs = MVT::Clone(*problem_-&gt;getInitVec(),<a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.numVecs);</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>      <a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.Espace = <a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.Evecs;</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>      <a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.Evals.resize(<a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.numVecs);</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>      std::vector&lt;MagnitudeType&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">vals</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.numVecs);</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span> </div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>      <span class="comment">// copy them into the solution</span></div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>      std::vector&lt;int&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">which</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">ordertest</a>-&gt;whichVecs();</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>      <span class="comment">// indices between [0,blockSize) refer to vectors/values in the solver</span></div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>      <span class="comment">// indices between [-curNumLocked,-1] refer to locked vectors/values [0,curNumLocked)</span></div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>      <span class="comment">// everything has already been ordered by the solver; we just have to partition the two references</span></div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>      std::vector&lt;int&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">inlocked</a>(0), <a class="code hl_class" href="classAnasazi_1_1Operator.html">insolver</a>(0);</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">which</a>.size(); <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++) {</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classAnasazi_1_1Operator.html">which</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] &gt;= 0) {</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">which</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] &gt;= blockSize_,std::logic_error,<span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr::solve(): positive indexing mistake from ordertest.&quot;</span>);</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">insolver</a>.push_back(<a class="code hl_class" href="classAnasazi_1_1Operator.html">which</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>]);</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>        }</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>          <span class="comment">// sanity check</span></div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">which</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] &lt; -<a class="code hl_class" href="classAnasazi_1_1Operator.html">curNumLocked</a>,std::logic_error,<span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr::solve(): negative indexing mistake from ordertest.&quot;</span>);</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">inlocked</a>.push_back(<a class="code hl_class" href="classAnasazi_1_1Operator.html">which</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] + <a class="code hl_class" href="classAnasazi_1_1Operator.html">curNumLocked</a>);</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>        }</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>      }</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span> </div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>      <a class="code hl_class" href="classAnasazi_1_1Operator.html">TEUCHOS_TEST_FOR_EXCEPTION</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">insolver</a>.size() + <a class="code hl_class" href="classAnasazi_1_1Operator.html">inlocked</a>.size() != (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)<a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.numVecs,std::logic_error,<span class="stringliteral">&quot;Anasazi::TraceMinBaseSolMgr::solve(): indexing mistake.&quot;</span>);</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span> </div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>      <span class="comment">// set the vecs,vals in the solution</span></div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>      <span class="keywordflow">if</span> (<a class="code hl_class" href="classAnasazi_1_1Operator.html">insolver</a>.size() &gt; 0) {</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>        <span class="comment">// set vecs</span></div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>        <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">lclnum</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">insolver</a>.size();</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>        std::vector&lt;int&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">tosol</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">lclnum</a>);</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">lclnum</a>; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++) <a class="code hl_class" href="classAnasazi_1_1Operator.html">tosol</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] = <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>;</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>        <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;const MV&gt;</a> <a class="code hl_class" href="classAnasazi_1_1Operator.html">v</a> = MVT::CloneView(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">tm_solver</a>-&gt;getRitzVectors(),<a class="code hl_class" href="classAnasazi_1_1Operator.html">insolver</a>);</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>        MVT::SetBlock(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">v</a>,<a class="code hl_class" href="classAnasazi_1_1Operator.html">tosol</a>,*<a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.Evecs);</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>        <span class="comment">// set vals</span></div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>        std::vector&lt;Value&lt;ScalarType&gt; &gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">fromsolver</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">tm_solver</a>-&gt;getRitzValues();</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">insolver</a>.size(); <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++) {</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">vals</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] = <a class="code hl_class" href="classAnasazi_1_1Operator.html">fromsolver</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">insolver</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>]].realpart;</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>        }</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>      }</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span> </div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>      <span class="comment">// get the vecs,vals from locked storage</span></div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>      <span class="keywordflow">if</span> (<a class="code hl_class" href="classAnasazi_1_1Operator.html">inlocked</a>.size() &gt; 0) {</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>        <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">solnum</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">insolver</a>.size();</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>        <span class="comment">// set vecs</span></div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>        <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">lclnum</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">inlocked</a>.size();</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>        std::vector&lt;int&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">tosol</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">lclnum</a>);</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">lclnum</a>; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++) <a class="code hl_class" href="classAnasazi_1_1Operator.html">tosol</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] = <a class="code hl_class" href="classAnasazi_1_1Operator.html">solnum</a> + <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>;</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>        <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt;const MV&gt;</a> <a class="code hl_class" href="classAnasazi_1_1Operator.html">v</a> = MVT::CloneView(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">lockvecs</a>,<a class="code hl_class" href="classAnasazi_1_1Operator.html">inlocked</a>);</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>        MVT::SetBlock(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">v</a>,<a class="code hl_class" href="classAnasazi_1_1Operator.html">tosol</a>,*<a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.Evecs);</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>        <span class="comment">// set vals</span></div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">inlocked</a>.size(); <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++) {</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">vals</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>+<a class="code hl_class" href="classAnasazi_1_1Operator.html">solnum</a>] = <a class="code hl_class" href="classAnasazi_1_1Operator.html">lockvals</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">inlocked</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>]];</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>        }</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>      }</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span> </div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>      <span class="comment">// undo the spectral transformation if necessary</span></div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>      <span class="comment">// if we really passed the solver Bx = \lambda A x, invert the eigenvalues</span></div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>      <span class="keywordflow">if</span>(which_ == <span class="stringliteral">&quot;LM&quot;</span>)</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>      {</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">vals</a>.size(); <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++)</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">vals</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] = ONE/<a class="code hl_class" href="classAnasazi_1_1Operator.html">vals</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>];</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>      }</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span> </div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>      <span class="comment">// sort the eigenvalues and permute the eigenvectors appropriately</span></div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>      {</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>        std::vector&lt;int&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">order</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.numVecs);</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>        <a class="code hl_class" href="classAnasazi_1_1Operator.html">sorter</a>-&gt;sort(<a class="code hl_class" href="classAnasazi_1_1Operator.html">vals</a>,Teuchos::rcpFromRef(<a class="code hl_class" href="classAnasazi_1_1Operator.html">order</a>),<a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.numVecs);</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>        <span class="comment">// store the values in the Eigensolution</span></div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.numVecs; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++) {</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.Evals[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>].realpart = <a class="code hl_class" href="classAnasazi_1_1Operator.html">vals</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>];</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>          <a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.Evals[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>].imagpart = MT::zero();</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>        }</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>        <span class="comment">// now permute the eigenvectors according to order</span></div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>        msutils::permuteVectors(<a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.numVecs,<a class="code hl_class" href="classAnasazi_1_1Operator.html">order</a>,*<a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.Evecs);</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>      }</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span> </div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>      <span class="comment">// setup sol.index, remembering that all eigenvalues are real so that index = {0,...,0}</span></div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>      <a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.index.resize(<a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.numVecs,0);</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>    }</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>  }</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span> </div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>  <span class="comment">// print final summary</span></div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">tm_solver</a>-&gt;currentStatus(printer_-&gt;stream(<a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da8de60b694f69d925e2658c04c92d73dc">FinalSummary</a>));</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span> </div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>  printParameters(printer_-&gt;stream(<a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da8de60b694f69d925e2658c04c92d73dc">FinalSummary</a>));</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span> </div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>  <span class="comment">// print timing information</span></div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span><span class="preprocessor">#ifdef ANASAZI_TEUCHOS_TIME_MONITOR</span></div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>  <span class="keywordflow">if</span> ( printer_-&gt;isVerbosity( <a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507daa04bd73cdc419c447db8771af5d18f83">TimingDetails</a> ) ) {</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>    Teuchos::TimeMonitor::summarize( printer_-&gt;stream( <a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507daa04bd73cdc419c447db8771af5d18f83">TimingDetails</a> ) );</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>  }</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span> </div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>  problem_-&gt;setSolution(<a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>);</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>  printer_-&gt;stream(<a class="code hl_enumvalue" href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2e2571549ff094918fb9b368fad7f1f9">Debug</a>) &lt;&lt; <span class="stringliteral">&quot;Returning &quot;</span> &lt;&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.numVecs &lt;&lt; <span class="stringliteral">&quot; eigenpairs to eigenproblem.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span> </div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>  <span class="comment">// get the number of iterations taken for this call to solve().</span></div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>  numIters_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">tm_solver</a>-&gt;getNumIters();</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span> </div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classAnasazi_1_1Operator.html">sol</a>.numVecs &lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">nev</a>) {</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceAnasazi.html#a823537bb3d658892d7388be67cf036a6a2df84c9ec5ae479b897c1f8153ff2e7e">Unconverged</a>; <span class="comment">// return from TraceMinBaseSolMgr::solve() </span></div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>  }</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceAnasazi.html#a823537bb3d658892d7388be67cf036a6a43d6b459d6ecd3f2d638063a61c58880">Converged</a>; <span class="comment">// return from TraceMinBaseSolMgr::solve() </span></div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>}</div>
</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span> </div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span> </div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> ScalarType, <span class="keyword">class</span> MV, <span class="keyword">class</span> OP&gt;</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span><span class="keywordtype">void</span> </div>
<div class="foldopen" id="foldopen01086" data-start="{" data-end="}">
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"><a class="line" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a7b66c53456be2b709dc8cd98d25f70d8"> 1086</a></span><a class="code hl_function" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a7b66c53456be2b709dc8cd98d25f70d8">TraceMinBaseSolMgr&lt;ScalarType,MV,OP&gt;::setGlobalStatusTest</a>(</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>    <span class="keyword">const</span> RCP&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">StatusTest&lt;ScalarType,MV,OP&gt;</a> &gt; &amp;<a class="code hl_class" href="classAnasazi_1_1Operator.html">global</a>) </div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>{</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>  globalTest_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">global</a>;</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>}</div>
</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span> </div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> ScalarType, <span class="keyword">class</span> MV, <span class="keyword">class</span> OP&gt;</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span><span class="keyword">const</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt; StatusTest&lt;ScalarType,MV,OP&gt;</a> &gt; &amp; </div>
<div class="foldopen" id="foldopen01094" data-start="{" data-end="}">
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"><a class="line" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#ae776246440e7262333dcbc9b48f2a9fb"> 1094</a></span><a class="code hl_function" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#ae776246440e7262333dcbc9b48f2a9fb">TraceMinBaseSolMgr&lt;ScalarType,MV,OP&gt;::getGlobalStatusTest</a>()<span class="keyword"> const </span></div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>  <span class="keywordflow">return</span> globalTest_;</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>}</div>
</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span> </div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> ScalarType, <span class="keyword">class</span> MV, <span class="keyword">class</span> OP&gt;</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span><span class="keywordtype">void</span> </div>
<div class="foldopen" id="foldopen01101" data-start="{" data-end="}">
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"><a class="line" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a7749b35a9722e15ef37a26dc0384b489"> 1101</a></span><a class="code hl_function" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a7749b35a9722e15ef37a26dc0384b489">TraceMinBaseSolMgr&lt;ScalarType,MV,OP&gt;::setDebugStatusTest</a>(</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>    <span class="keyword">const</span> RCP&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">StatusTest&lt;ScalarType,MV,OP&gt;</a> &gt; &amp;<a class="code hl_class" href="classAnasazi_1_1Operator.html">debug</a>)</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>{</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>  debugTest_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">debug</a>;</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>}</div>
</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span> </div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> ScalarType, <span class="keyword">class</span> MV, <span class="keyword">class</span> OP&gt;</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span><span class="keyword">const</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt; StatusTest&lt;ScalarType,MV,OP&gt;</a> &gt; &amp; </div>
<div class="foldopen" id="foldopen01109" data-start="{" data-end="}">
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"><a class="line" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a20f805f76054c9317129603f2469a830"> 1109</a></span><a class="code hl_function" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a20f805f76054c9317129603f2469a830">TraceMinBaseSolMgr&lt;ScalarType,MV,OP&gt;::getDebugStatusTest</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>  <span class="keywordflow">return</span> debugTest_;</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>}</div>
</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span> </div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> ScalarType, <span class="keyword">class</span> MV, <span class="keyword">class</span> OP&gt;</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span><span class="keywordtype">void</span> </div>
<div class="foldopen" id="foldopen01116" data-start="{" data-end="}">
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"><a class="line" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#acdfa5f1703cd4a41f36aa4628e055bf8"> 1116</a></span><a class="code hl_function" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#acdfa5f1703cd4a41f36aa4628e055bf8">TraceMinBaseSolMgr&lt;ScalarType,MV,OP&gt;::setLockingStatusTest</a>(</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>    <span class="keyword">const</span> RCP&lt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">StatusTest&lt;ScalarType,MV,OP&gt;</a> &gt; &amp;<a class="code hl_class" href="classAnasazi_1_1Operator.html">locking</a>) </div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>{</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>  lockingTest_ = <a class="code hl_class" href="classAnasazi_1_1Operator.html">locking</a>;</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>}</div>
</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span> </div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> ScalarType, <span class="keyword">class</span> MV, <span class="keyword">class</span> OP&gt;</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span><span class="keyword">const</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">RCP&lt; StatusTest&lt;ScalarType,MV,OP&gt;</a> &gt; &amp; </div>
<div class="foldopen" id="foldopen01124" data-start="{" data-end="}">
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"><a class="line" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a082bff49e2bda2cb18ad8a026379e13c"> 1124</a></span><a class="code hl_function" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a082bff49e2bda2cb18ad8a026379e13c">TraceMinBaseSolMgr&lt;ScalarType,MV,OP&gt;::getLockingStatusTest</a>()<span class="keyword"> const </span></div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>  <span class="keywordflow">return</span> lockingTest_;</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>}</div>
</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span> </div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> ScalarType, <span class="keyword">class</span> MV, <span class="keyword">class</span> OP&gt;</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span><span class="keywordtype">void</span> <a class="code hl_class" href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html">TraceMinBaseSolMgr&lt;ScalarType,MV,OP&gt;::copyPartOfState</a>(<span class="keyword">const</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">TraceMinBaseState&lt;ScalarType,MV&gt;</a>&amp; <a class="code hl_class" href="classAnasazi_1_1Operator.html">oldState</a>, <a class="code hl_class" href="classAnasazi_1_1Operator.html">TraceMinBaseState&lt;ScalarType,MV&gt;</a>&amp; <a class="code hl_class" href="classAnasazi_1_1Operator.html">newState</a>, <span class="keyword">const</span> std::vector&lt;int&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">indToCopy</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>  <span class="keyword">const</span> ScalarType ONE = Teuchos::ScalarTraits&lt;MagnitudeType&gt;::one();</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>  <span class="keyword">const</span> ScalarType ZERO = Teuchos::ScalarTraits&lt;MagnitudeType&gt;::zero();</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span> </div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>  <a class="code hl_class" href="classAnasazi_1_1Operator.html">newState</a>.curDim = <a class="code hl_class" href="classAnasazi_1_1Operator.html">indToCopy</a>.size();</div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>  std::vector&lt;int&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">fullIndices</a>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">oldState</a>.curDim);</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">oldState</a>.curDim; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++) <a class="code hl_class" href="classAnasazi_1_1Operator.html">fullIndices</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] = <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>;</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span> </div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>  <span class="comment">// Initialize with X.  </span></div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>  <span class="comment">// Note that we didn&#39;t compute enough vectors of X, but we can very easily using the Ritz vectors.</span></div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>  <span class="comment">// That&#39;s why they&#39;re part of the state.</span></div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>  <span class="comment">// Note that there will ALWAYS be enough vectors</span></div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span> </div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>  <span class="comment">// Helpful vectors for computing views and whatnot</span></div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>  std::vector&lt;int&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">oldIndices</a>;</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>  std::vector&lt;int&gt; <a class="code hl_class" href="classAnasazi_1_1Operator.html">newIndices</a>;</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>=0; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>&lt;<a class="code hl_class" href="classAnasazi_1_1Operator.html">newState</a>.curDim; <a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>++)</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>  {</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>    <span class="keywordflow">if</span>(<a class="code hl_class" href="classAnasazi_1_1Operator.html">indToCopy</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>] &lt; blockSize_)</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>      <a class="code hl_class" href="classAnasazi_1_1Operator.html">oldIndices</a>.push_back(<a class="code hl_class" href="classAnasazi_1_1Operator.html">indToCopy</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>]);</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>      <a class="code hl_class" href="classAnasazi_1_1Operator.html">newIndices</a>.push_back(<a class="code hl_class" href="classAnasazi_1_1Operator.html">indToCopy</a>[<a class="code hl_class" href="classAnasazi_1_1Operator.html">i</a>]);</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>  }</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span> </div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>  <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">olddim</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">oldIndices</a>.size();</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>  <span class="keywordtype">int</span> <a class="code hl_class" href="classAnasazi_1_1Operator.html">newdim</a> = <a class="code hl_class" href="classAnasazi_1_1Operator.html">newIndices</a>.size();</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span> </div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>  <span class="comment">// If there are no new vectors being copied</span></div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>  <span class="keywordflow">if</span>(computeAllRes_)</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>  {</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">newState</a>.V  = MVT::CloneView(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">oldState</a>.X, <a class="code hl_class" href="classAnasazi_1_1Operator.html">indToCopy</a>);</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">newState</a>.R  = MVT::CloneView(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">oldState</a>.R, <a class="code hl_class" href="classAnasazi_1_1Operator.html">indToCopy</a>);</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>    <a class="code hl_class" href="classAnasazi_1_1Operator.html">newState</a>.X = <a class="code hl_class" href="classAnasazi_1_1Operator.html">newState</a>.V;</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span> </div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>    <span class="keywordflow">if</span>(problem_-&gt;getOperator() != Teuchos::null)</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>    {</div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>      <a class="code hl_class" href="classAnasazi_1_1Operator.html">newState</a>.KV = MVT::CloneView(*<a class="code hl_class" href="classAnasazi_1_1Operator.html">oldState</a>.KX, <a class="code hl_class" href="classAnasazi_1_1Operator.html">indToCopy</a>);</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>      <a class="code hl_class" href="classAnasazi_1_1Operator.html">newState</a>.KX = <a class="code hl_class" href="classAnasazi_1_1Operator.html">newState</a>.KV;</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>    }</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>    {</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>      newState.KV = Teuchos::null;</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>      newState.KX = Teuchos::null;</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>    }</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span> </div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>    <span class="keywordflow">if</span>(problem_-&gt;getM() != Teuchos::null)</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>    {</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>      newState.MopV = MVT::CloneView(*oldState.MX, indToCopy);</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>      newState.MX = newState.MopV;</div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>    }</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>    {</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>      newState.MopV = Teuchos::null;</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>      newState.MX = Teuchos::null;</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>    }</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>  }</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(newdim == 0)</div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>  {</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>    std::vector&lt;int&gt; blockind(blockSize_);</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;blockSize_; i++)</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>      blockind[i] = i;</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span> </div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>    <span class="comment">// Initialize with X</span></div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>    newState.V  = MVT::CloneView(*oldState.X, blockind);</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>    newState.KV = MVT::CloneView(*oldState.KX, blockind);</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>    newState.R  = MVT::CloneView(*oldState.R, blockind);</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>    newState.X = MVT::CloneView(*newState.V, blockind);</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>    newState.KX = MVT::CloneView(*newState.KV, blockind);</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span> </div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>    <span class="keywordflow">if</span>(problem_-&gt;getM() != Teuchos::null)</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>    {</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>      newState.MopV = MVT::CloneView(*oldState.MX, blockind);</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>      newState.MX = MVT::CloneView(*newState.MopV, blockind);</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>    }</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>    {</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>      newState.MopV = Teuchos::null;</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>      newState.MX = Teuchos::null;</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>    }</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>  }</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>  {</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>    <span class="comment">// More helpful vectors</span></div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>    std::vector&lt;int&gt; oldPart(olddim);</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;olddim; i++) oldPart[i] = i;</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>    std::vector&lt;int&gt; newPart(newdim);</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;newdim; i++) newPart[i] = olddim+i;</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span> </div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>    <span class="comment">// Helpful multivectors for views and whatnot</span></div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>    RCP&lt;MV&gt; helper = MVT::Clone(*oldState.V,newState.curDim);</div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>    RCP&lt;MV&gt; oldHelper = MVT::CloneViewNonConst(*helper,oldPart);</div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>    RCP&lt;MV&gt; newHelper = MVT::CloneViewNonConst(*helper,newPart);</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>    RCP&lt;const MV&gt; viewHelper;</div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span> </div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>    <span class="comment">// Get the parts of the Ritz vectors we are interested in.</span></div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span>    Teuchos::SerialDenseMatrix&lt;int,ScalarType&gt; newRV(oldState.curDim,newdim);</div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> r=0; r&lt;oldState.curDim; r++)</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>    {</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0; c&lt;newdim; c++)</div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>        newRV(r,c) = (*oldState.RV)(r,newIndices[c]);</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>    }</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span> </div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span>    <span class="comment">// We&#39;re going to compute X as V*RitzVecs</span></div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span>    viewHelper = MVT::CloneView(*oldState.V,fullIndices);</div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>    MVT::MvTimesMatAddMv(ONE,*viewHelper,newRV,ZERO,*newHelper);</div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>    viewHelper = MVT::CloneView(*oldState.X,oldIndices);</div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span>    MVT::Assign(*viewHelper,*oldHelper);</div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>    newState.V = MVT::CloneCopy(*helper);</div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span> </div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>    <span class="comment">// Also compute KX as KV*RitzVecs</span></div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>    viewHelper = MVT::CloneView(*oldState.KV,fullIndices);</div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>    MVT::MvTimesMatAddMv(ONE,*viewHelper,newRV,ZERO,*newHelper);</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>    viewHelper = MVT::CloneView(*oldState.KX,oldIndices);</div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>    MVT::Assign(*viewHelper,*oldHelper);</div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>    newState.KV = MVT::CloneCopy(*helper);</div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span> </div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>    <span class="comment">// Do the same with MX if necessary</span></div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>    <span class="keywordflow">if</span>(problem_-&gt;getM() != Teuchos::null)</div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>    {</div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>      viewHelper = MVT::CloneView(*oldState.MopV,fullIndices);</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>      MVT::MvTimesMatAddMv(ONE,*viewHelper,newRV,ZERO,*newHelper);</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>      viewHelper = MVT::CloneView(*oldState.MX,oldIndices);</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>      MVT::Assign(*viewHelper,*oldHelper);</div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>      newState.MopV = MVT::CloneCopy(*helper);</div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>    }</div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>      newState.MopV = newState.V;</div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span> </div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>    <span class="comment">// Get X, MX, KX</span></div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>    std::vector&lt;int&gt; blockVec(blockSize_);</div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;blockSize_; i++) blockVec[i] = i;</div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>    newState.X = MVT::CloneView(*newState.V,blockVec);</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>    newState.KX = MVT::CloneView(*newState.KV,blockVec);</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>    newState.MX = MVT::CloneView(*newState.MopV,blockVec);</div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span> </div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>    <span class="comment">// Update the residuals</span></div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>    <span class="keywordflow">if</span>(blockSize_-oldIndices.size() &gt; 0)</div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>    {</div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>      <span class="comment">// There are vectors we have not computed the residual for yet</span></div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>      newPart.resize(blockSize_-oldIndices.size());</div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>      helper = MVT::Clone(*oldState.V,blockSize_);</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>      oldHelper = MVT::CloneViewNonConst(*helper,oldPart);</div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>      newHelper = MVT::CloneViewNonConst(*helper,newPart);</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span> </div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>      RCP&lt;MV&gt; scaledMV = MVT::CloneCopy(*newState.MX,newPart);</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>      RCP&lt;const MV&gt; localKV = MVT::CloneView(*newState.KX,newPart);</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>      std::vector&lt;ScalarType&gt; scalarVec(blockSize_-oldIndices.size());</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;(<span class="keywordtype">unsigned</span> int)blockSize_-oldIndices.size(); i++) scalarVec[i] = (*oldState.T)[newPart[i]];</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>      MVT::MvScale(*scaledMV,scalarVec);</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>            </div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>      helper = MVT::Clone(*oldState.V,blockSize_);</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>      oldHelper = MVT::CloneViewNonConst(*helper,oldPart);</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>      newHelper = MVT::CloneViewNonConst(*helper,newPart);</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>      MVT::MvAddMv(ONE,*localKV,-ONE,*scaledMV,*newHelper);</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>      viewHelper = MVT::CloneView(*oldState.R,oldIndices);</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>      MVT::Assign(*viewHelper,*oldHelper);</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>      newState.R = MVT::CloneCopy(*helper);</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>    }</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>      newState.R = oldState.R;</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>  }</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span> </div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>  <span class="comment">// Since we are setting V:=X, V is orthonormal</span></div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>  newState.isOrtho = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span> </div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>  <span class="comment">// Get the first eigenvalues</span></div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>  RCP&lt; std::vector&lt;ScalarType&gt; &gt; helperT = rcp( <span class="keyword">new</span> std::vector&lt;ScalarType&gt;(newState.curDim) );</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;newState.curDim; i++) (*helperT)[i] = (*oldState.T)[indToCopy[i]];</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>  newState.T  = helperT;</div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span> </div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>  <span class="comment">// X&#39;KX is diag(T)</span></div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>  RCP&lt; Teuchos::SerialDenseMatrix&lt;int,ScalarType&gt; &gt; newKK = rcp( <span class="keyword">new</span> Teuchos::SerialDenseMatrix&lt;int,ScalarType&gt;(newState.curDim,newState.curDim) );</div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;newState.curDim; i++)</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>    (*newKK)(i,i) = (*newState.T)[i];</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>  newState.KK = newKK;</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span> </div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>  <span class="comment">// The associated Ritz vectors are I</span></div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>  RCP&lt; Teuchos::SerialDenseMatrix&lt;int,ScalarType&gt; &gt; newRV = rcp( <span class="keyword">new</span> Teuchos::SerialDenseMatrix&lt;int,ScalarType&gt;(newState.curDim,newState.curDim) );</div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;newState.curDim; i++)</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span>    (*newRV)(i,i) = ONE;</div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>  newState.RV = newRV;</div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span> </div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>  <span class="comment">// Get the Ritz shifts</span></div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>  RCP&lt; std::vector&lt;ScalarType&gt; &gt; helperRS = rcp( <span class="keyword">new</span> std::vector&lt;ScalarType&gt;(blockSize_) );</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;blockSize_; i++) </div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>  {</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>    <span class="keywordflow">if</span>(indToCopy[i] &lt; blockSize_)</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span>      (*helperRS)[i] = (*oldState.ritzShifts)[indToCopy[i]];</div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>      (*helperRS)[i] = ZERO;</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>  }</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span>  newState.ritzShifts  = helperRS;</div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>}</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span> </div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span> </div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> ScalarType, <span class="keyword">class</span> MV, <span class="keyword">class</span> OP&gt;</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span><span class="keywordtype">void</span> TraceMinBaseSolMgr&lt;ScalarType,MV,OP&gt;::setParameters(Teuchos::ParameterList &amp;pl)<span class="keyword"> const</span></div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>  pl.set(<span class="stringliteral">&quot;Block Size&quot;</span>, blockSize_);</div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>  pl.set(<span class="stringliteral">&quot;Num Blocks&quot;</span>, numBlocks_);</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>  pl.set(<span class="stringliteral">&quot;Num Restart Blocks&quot;</span>, numRestartBlocks_);</div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>  pl.set(<span class="stringliteral">&quot;When To Shift&quot;</span>, whenToShift_);</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span>  pl.set(<span class="stringliteral">&quot;Trace Threshold&quot;</span>, traceThresh_);</div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>  pl.set(<span class="stringliteral">&quot;Shift Tolerance&quot;</span>, shiftTol_);</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>  pl.set(<span class="stringliteral">&quot;Relative Shift Tolerance&quot;</span>, relShiftTol_);</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>  pl.set(<span class="stringliteral">&quot;Shift Norm&quot;</span>, shiftNorm_);</div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>  pl.set(<span class="stringliteral">&quot;How To Choose Shift&quot;</span>, howToShift_);</div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span>  pl.set(<span class="stringliteral">&quot;Consider Clusters&quot;</span>, considerClusters_);</div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>  pl.set(<span class="stringliteral">&quot;Use Multiple Shifts&quot;</span>, useMultipleShifts_);</div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span>  pl.set(<span class="stringliteral">&quot;Saddle Solver Type&quot;</span>, saddleSolType_);</div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span>  pl.set(<span class="stringliteral">&quot;Project All Vectors&quot;</span>, projectAllVecs_);</div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span>  pl.set(<span class="stringliteral">&quot;Project Locked Vectors&quot;</span>, projectLockedVecs_);</div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span>  pl.set(<span class="stringliteral">&quot;Compute All Residuals&quot;</span>, computeAllRes_);</div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span>  pl.set(<span class="stringliteral">&quot;Use Residual as RHS&quot;</span>, useRHSR_);</div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span>  pl.set(<span class="stringliteral">&quot;Use Harmonic Ritz Values&quot;</span>, useHarmonic_);</div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span>  pl.set(<span class="stringliteral">&quot;Maximum Krylov Iterations&quot;</span>, maxKrylovIter_);</div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span>  pl.set(<span class="stringliteral">&quot;HSS: alpha&quot;</span>, alpha_);</div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span>}</div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span> </div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span> </div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> ScalarType, <span class="keyword">class</span> MV, <span class="keyword">class</span> OP&gt;</div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span><span class="keywordtype">void</span> TraceMinBaseSolMgr&lt;ScalarType,MV,OP&gt;::printParameters(std::ostream &amp;os)<span class="keyword"> const</span></div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>  os &lt;&lt; <span class="stringliteral">&quot;\n\n\n&quot;</span>;</div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span>  os &lt;&lt; <span class="stringliteral">&quot;========================================\n&quot;</span>;</div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span>  os &lt;&lt; <span class="stringliteral">&quot;========= TraceMin parameters ==========\n&quot;</span>;</div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span>  os &lt;&lt; <span class="stringliteral">&quot;========================================\n&quot;</span>;</div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span>  os &lt;&lt; <span class="stringliteral">&quot;=========== Block parameters ===========\n&quot;</span>;</div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span>  os &lt;&lt; <span class="stringliteral">&quot;Block Size: &quot;</span> &lt;&lt; blockSize_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span>  os &lt;&lt; <span class="stringliteral">&quot;Num Blocks: &quot;</span> &lt;&lt; numBlocks_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>  os &lt;&lt; <span class="stringliteral">&quot;Num Restart Blocks: &quot;</span> &lt;&lt; numRestartBlocks_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span>  os &lt;&lt; <span class="stringliteral">&quot;======== Convergence parameters ========\n&quot;</span>;</div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span>  os &lt;&lt; <span class="stringliteral">&quot;Convergence Tolerance: &quot;</span> &lt;&lt; convTol_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span>  os &lt;&lt; <span class="stringliteral">&quot;Relative Convergence Tolerance: &quot;</span> &lt;&lt; relConvTol_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span>  os &lt;&lt; <span class="stringliteral">&quot;========== Locking parameters ==========\n&quot;</span>;</div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>  os &lt;&lt; <span class="stringliteral">&quot;Use Locking: &quot;</span> &lt;&lt; useLocking_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>  os &lt;&lt; <span class="stringliteral">&quot;Locking Tolerance: &quot;</span> &lt;&lt; lockTol_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span>  os &lt;&lt; <span class="stringliteral">&quot;Relative Locking Tolerance: &quot;</span> &lt;&lt; relLockTol_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span>  os &lt;&lt; <span class="stringliteral">&quot;Max Locked: &quot;</span> &lt;&lt; maxLocked_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span>  os &lt;&lt; <span class="stringliteral">&quot;Locking Quorum: &quot;</span> &lt;&lt; lockQuorum_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>  os &lt;&lt; <span class="stringliteral">&quot;========== Shifting parameters =========\n&quot;</span>;</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>  os &lt;&lt; <span class="stringliteral">&quot;When To Shift: &quot;</span>;</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span>  <span class="keywordflow">if</span>(whenToShift_ == NEVER_SHIFT) os &lt;&lt; <span class="stringliteral">&quot;Never\n&quot;</span>;</div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(whenToShift_ == SHIFT_WHEN_TRACE_LEVELS) os &lt;&lt; <span class="stringliteral">&quot;After Trace Levels\n&quot;</span>;</div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(whenToShift_ == SHIFT_WHEN_RESID_SMALL) os &lt;&lt; <span class="stringliteral">&quot;Residual Becomes Small\n&quot;</span>;</div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(whenToShift_ == ALWAYS_SHIFT) os &lt;&lt; <span class="stringliteral">&quot;Always\n&quot;</span>;</div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>  os &lt;&lt; <span class="stringliteral">&quot;Consider Clusters: &quot;</span> &lt;&lt; considerClusters_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>  os &lt;&lt; <span class="stringliteral">&quot;Trace Threshohld: &quot;</span> &lt;&lt; traceThresh_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span>  os &lt;&lt; <span class="stringliteral">&quot;Shift Tolerance: &quot;</span> &lt;&lt; shiftTol_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span>  os &lt;&lt; <span class="stringliteral">&quot;Relative Shift Tolerance: &quot;</span> &lt;&lt; relShiftTol_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span>  os &lt;&lt; <span class="stringliteral">&quot;How To Choose Shift: &quot;</span>;</div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>  <span class="keywordflow">if</span>(howToShift_ == LARGEST_CONVERGED_SHIFT) os &lt;&lt; <span class="stringliteral">&quot;Largest Converged\n&quot;</span>;</div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(howToShift_ == ADJUSTED_RITZ_SHIFT) os &lt;&lt; <span class="stringliteral">&quot;Adjusted Ritz Values\n&quot;</span>;</div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(howToShift_ == RITZ_VALUES_SHIFT) os &lt;&lt; <span class="stringliteral">&quot;Ritz Values\n&quot;</span>;</div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>  os &lt;&lt; <span class="stringliteral">&quot;Use Multiple Shifts: &quot;</span> &lt;&lt; useMultipleShifts_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>  os &lt;&lt; <span class="stringliteral">&quot;=========== Other parameters ===========\n&quot;</span>;</div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>  os &lt;&lt; <span class="stringliteral">&quot;Orthogonalization: &quot;</span> &lt;&lt; ortho_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>  os &lt;&lt; <span class="stringliteral">&quot;Saddle Solver Type: &quot;</span>;</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>  <span class="keywordflow">if</span>(saddleSolType_ == PROJECTED_KRYLOV_SOLVER) os &lt;&lt; <span class="stringliteral">&quot;Projected Krylov\n&quot;</span>;</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(saddleSolType_ == SCHUR_COMPLEMENT_SOLVER) os &lt;&lt; <span class="stringliteral">&quot;Schur Complement\n&quot;</span>;</div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span>  os &lt;&lt; <span class="stringliteral">&quot;Project All Vectors: &quot;</span> &lt;&lt; projectAllVecs_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>  os &lt;&lt; <span class="stringliteral">&quot;Project Locked Vectors: &quot;</span> &lt;&lt; projectLockedVecs_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>  os &lt;&lt; <span class="stringliteral">&quot;Compute All Residuals: &quot;</span> &lt;&lt; computeAllRes_ &lt;&lt; std::endl;</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>  os &lt;&lt; <span class="stringliteral">&quot;========================================\n\n\n&quot;</span>;</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>}</div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span> </div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span> </div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>}} <span class="comment">// end Anasazi namespace</span></div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span> </div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span><span class="preprocessor">#endif </span><span class="comment">/* ANASAZI_TraceMinBase_SOLMGR_HPP */</span><span class="preprocessor"></span></div>
<div class="ttc" id="aAnasaziBasicOrthoManager_8hpp_html"><div class="ttname"><a href="AnasaziBasicOrthoManager_8hpp.html">AnasaziBasicOrthoManager.hpp</a></div><div class="ttdoc">Basic implementation of the Anasazi::OrthoManager class.</div></div>
<div class="ttc" id="aAnasaziBasicSort_8hpp_html"><div class="ttname"><a href="AnasaziBasicSort_8hpp.html">AnasaziBasicSort.hpp</a></div><div class="ttdoc">Basic implementation of the Anasazi::SortManager class.</div></div>
<div class="ttc" id="aAnasaziConfigDefs_8hpp_html"><div class="ttname"><a href="AnasaziConfigDefs_8hpp.html">AnasaziConfigDefs.hpp</a></div><div class="ttdoc">Anasazi header file which uses auto-configuration information to include necessary C++ headers.</div></div>
<div class="ttc" id="aAnasaziEigenproblem_8hpp_html"><div class="ttname"><a href="AnasaziEigenproblem_8hpp.html">AnasaziEigenproblem.hpp</a></div><div class="ttdoc">Abstract base class which defines the interface required by an eigensolver and status test class to c...</div></div>
<div class="ttc" id="aAnasaziICGSOrthoManager_8hpp_html"><div class="ttname"><a href="AnasaziICGSOrthoManager_8hpp.html">AnasaziICGSOrthoManager.hpp</a></div><div class="ttdoc">Basic implementation of the Anasazi::OrthoManager class.</div></div>
<div class="ttc" id="aAnasaziOutputManager_8hpp_html"><div class="ttname"><a href="AnasaziOutputManager_8hpp.html">AnasaziOutputManager.hpp</a></div><div class="ttdoc">Abstract class definition for Anasazi Output Managers.</div></div>
<div class="ttc" id="aAnasaziOutputStreamTraits_8hpp_html"><div class="ttname"><a href="AnasaziOutputStreamTraits_8hpp.html">AnasaziOutputStreamTraits.hpp</a></div><div class="ttdoc">Abstract class definition for Anasazi output stream.</div></div>
<div class="ttc" id="aAnasaziSVQBOrthoManager_8hpp_html"><div class="ttname"><a href="AnasaziSVQBOrthoManager_8hpp.html">AnasaziSVQBOrthoManager.hpp</a></div><div class="ttdoc">Orthogonalization manager based on the SVQB technique described in &quot;A Block Orthogonalization Procedu...</div></div>
<div class="ttc" id="aAnasaziSolverManager_8hpp_html"><div class="ttname"><a href="AnasaziSolverManager_8hpp.html">AnasaziSolverManager.hpp</a></div><div class="ttdoc">Pure virtual base class which describes the basic interface for a solver manager.</div></div>
<div class="ttc" id="aAnasaziSolverUtils_8hpp_html"><div class="ttname"><a href="AnasaziSolverUtils_8hpp.html">AnasaziSolverUtils.hpp</a></div><div class="ttdoc">Class which provides internal utilities for the Anasazi solvers.</div></div>
<div class="ttc" id="aAnasaziStatusTestCombo_8hpp_html"><div class="ttname"><a href="AnasaziStatusTestCombo_8hpp.html">AnasaziStatusTestCombo.hpp</a></div><div class="ttdoc">Status test for forming logical combinations of other status tests.</div></div>
<div class="ttc" id="aAnasaziStatusTestOutput_8hpp_html"><div class="ttname"><a href="AnasaziStatusTestOutput_8hpp.html">AnasaziStatusTestOutput.hpp</a></div><div class="ttdoc">Special StatusTest for printing status tests.</div></div>
<div class="ttc" id="aAnasaziStatusTestResNorm_8hpp_html"><div class="ttname"><a href="AnasaziStatusTestResNorm_8hpp.html">AnasaziStatusTestResNorm.hpp</a></div><div class="ttdoc">A status test for testing the norm of the eigenvectors residuals.</div></div>
<div class="ttc" id="aAnasaziStatusTestWithOrdering_8hpp_html"><div class="ttname"><a href="AnasaziStatusTestWithOrdering_8hpp.html">AnasaziStatusTestWithOrdering.hpp</a></div><div class="ttdoc">A status test for testing the norm of the eigenvectors residuals along with a set of auxiliary eigenv...</div></div>
<div class="ttc" id="aAnasaziTraceMinBase_8hpp_html"><div class="ttname"><a href="AnasaziTraceMinBase_8hpp.html">AnasaziTraceMinBase.hpp</a></div><div class="ttdoc">Abstract base class for trace minimization eigensolvers.</div></div>
<div class="ttc" id="aAnasaziTraceMinTypes_8hpp_html"><div class="ttname"><a href="AnasaziTraceMinTypes_8hpp.html">AnasaziTraceMinTypes.hpp</a></div></div>
<div class="ttc" id="aAnasaziTypes_8hpp_html"><div class="ttname"><a href="AnasaziTypes_8hpp.html">AnasaziTypes.hpp</a></div><div class="ttdoc">Types and exceptions used within Anasazi solvers and interfaces.</div></div>
<div class="ttc" id="aclassAnasazi_1_1AnasaziError_html"><div class="ttname"><a href="classAnasazi_1_1AnasaziError.html">Anasazi::AnasaziError</a></div><div class="ttdoc">An exception class parent to all Anasazi exceptions.</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTypes_8hpp_source.html#l00031">AnasaziTypes.hpp:31</a></div></div>
<div class="ttc" id="aclassAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr_html"><div class="ttname"><a href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html">Anasazi::Experimental::TraceMinBaseSolMgr</a></div><div class="ttdoc">The Anasazi::TraceMinBaseSolMgr provides an abstract base class for the TraceMin series of solver man...</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTraceMinBaseSolMgr_8hpp_source.html#l00079">AnasaziTraceMinBaseSolMgr.hpp:79</a></div></div>
<div class="ttc" id="aclassAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr_html_a082bff49e2bda2cb18ad8a026379e13c"><div class="ttname"><a href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a082bff49e2bda2cb18ad8a026379e13c">Anasazi::Experimental::TraceMinBaseSolMgr::getLockingStatusTest</a></div><div class="ttdeci">const RCP&lt; StatusTest&lt; ScalarType, MV, OP &gt; &gt; &amp; getLockingStatusTest() const</div><div class="ttdoc">Get the status test defining locking.</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTraceMinBaseSolMgr_8hpp_source.html#l01124">AnasaziTraceMinBaseSolMgr.hpp:1124</a></div></div>
<div class="ttc" id="aclassAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr_html_a15e7ee4798afaef8e0824283b51147ff"><div class="ttname"><a href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a15e7ee4798afaef8e0824283b51147ff">Anasazi::Experimental::TraceMinBaseSolMgr::getTimers</a></div><div class="ttdeci">Teuchos::Array&lt; RCP&lt; Teuchos::Time &gt; &gt; getTimers() const</div><div class="ttdoc">Return the timers for this object.</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTraceMinBaseSolMgr_8hpp_source.html#l00165">AnasaziTraceMinBaseSolMgr.hpp:165</a></div></div>
<div class="ttc" id="aclassAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr_html_a20f805f76054c9317129603f2469a830"><div class="ttname"><a href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a20f805f76054c9317129603f2469a830">Anasazi::Experimental::TraceMinBaseSolMgr::getDebugStatusTest</a></div><div class="ttdeci">const RCP&lt; StatusTest&lt; ScalarType, MV, OP &gt; &gt; &amp; getDebugStatusTest() const</div><div class="ttdoc">Get the status test for debugging.</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTraceMinBaseSolMgr_8hpp_source.html#l01109">AnasaziTraceMinBaseSolMgr.hpp:1109</a></div></div>
<div class="ttc" id="aclassAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr_html_a59c1a503e51b9c8a6bc0fed63a52db1a"><div class="ttname"><a href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a59c1a503e51b9c8a6bc0fed63a52db1a">Anasazi::Experimental::TraceMinBaseSolMgr::solve</a></div><div class="ttdeci">ReturnType solve()</div><div class="ttdoc">This method performs possibly repeated calls to the underlying eigensolver's iterate() routine until ...</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTraceMinBaseSolMgr_8hpp_source.html#l00541">AnasaziTraceMinBaseSolMgr.hpp:541</a></div></div>
<div class="ttc" id="aclassAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr_html_a7749b35a9722e15ef37a26dc0384b489"><div class="ttname"><a href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a7749b35a9722e15ef37a26dc0384b489">Anasazi::Experimental::TraceMinBaseSolMgr::setDebugStatusTest</a></div><div class="ttdeci">void setDebugStatusTest(const RCP&lt; StatusTest&lt; ScalarType, MV, OP &gt; &gt; &amp;debug)</div><div class="ttdoc">Set the status test for debugging.</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTraceMinBaseSolMgr_8hpp_source.html#l01101">AnasaziTraceMinBaseSolMgr.hpp:1101</a></div></div>
<div class="ttc" id="aclassAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr_html_a7b66c53456be2b709dc8cd98d25f70d8"><div class="ttname"><a href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a7b66c53456be2b709dc8cd98d25f70d8">Anasazi::Experimental::TraceMinBaseSolMgr::setGlobalStatusTest</a></div><div class="ttdeci">void setGlobalStatusTest(const RCP&lt; StatusTest&lt; ScalarType, MV, OP &gt; &gt; &amp;global)</div><div class="ttdoc">Set the status test defining global convergence.</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTraceMinBaseSolMgr_8hpp_source.html#l01086">AnasaziTraceMinBaseSolMgr.hpp:1086</a></div></div>
<div class="ttc" id="aclassAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr_html_a917fc86b5071814867e990bfd16539ed"><div class="ttname"><a href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#a917fc86b5071814867e990bfd16539ed">Anasazi::Experimental::TraceMinBaseSolMgr::~TraceMinBaseSolMgr</a></div><div class="ttdeci">virtual ~TraceMinBaseSolMgr()</div><div class="ttdoc">Destructor.</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTraceMinBaseSolMgr_8hpp_source.html#l00142">AnasaziTraceMinBaseSolMgr.hpp:142</a></div></div>
<div class="ttc" id="aclassAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr_html_aa5737ee98a223af69cfda529a777027e"><div class="ttname"><a href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#aa5737ee98a223af69cfda529a777027e">Anasazi::Experimental::TraceMinBaseSolMgr::TraceMinBaseSolMgr</a></div><div class="ttdeci">TraceMinBaseSolMgr(const RCP&lt; Eigenproblem&lt; ScalarType, MV, OP &gt; &gt; &amp;problem, Teuchos::ParameterList &amp;pl)</div><div class="ttdoc">Basic constructor for TraceMinBaseSolMgr.</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTraceMinBaseSolMgr_8hpp_source.html#l00287">AnasaziTraceMinBaseSolMgr.hpp:287</a></div></div>
<div class="ttc" id="aclassAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr_html_abab897a4e7467c265e9fdf2cbdde4082"><div class="ttname"><a href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#abab897a4e7467c265e9fdf2cbdde4082">Anasazi::Experimental::TraceMinBaseSolMgr::getNumIters</a></div><div class="ttdeci">int getNumIters() const</div><div class="ttdoc">Get the iteration count for the most recent call to solve().</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTraceMinBaseSolMgr_8hpp_source.html#l00154">AnasaziTraceMinBaseSolMgr.hpp:154</a></div></div>
<div class="ttc" id="aclassAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr_html_acdfa5f1703cd4a41f36aa4628e055bf8"><div class="ttname"><a href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#acdfa5f1703cd4a41f36aa4628e055bf8">Anasazi::Experimental::TraceMinBaseSolMgr::setLockingStatusTest</a></div><div class="ttdeci">void setLockingStatusTest(const RCP&lt; StatusTest&lt; ScalarType, MV, OP &gt; &gt; &amp;locking)</div><div class="ttdoc">Set the status test defining locking.</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTraceMinBaseSolMgr_8hpp_source.html#l01116">AnasaziTraceMinBaseSolMgr.hpp:1116</a></div></div>
<div class="ttc" id="aclassAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr_html_ae776246440e7262333dcbc9b48f2a9fb"><div class="ttname"><a href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#ae776246440e7262333dcbc9b48f2a9fb">Anasazi::Experimental::TraceMinBaseSolMgr::getGlobalStatusTest</a></div><div class="ttdeci">const RCP&lt; StatusTest&lt; ScalarType, MV, OP &gt; &gt; &amp; getGlobalStatusTest() const</div><div class="ttdoc">Get the status test defining global convergence.</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTraceMinBaseSolMgr_8hpp_source.html#l01094">AnasaziTraceMinBaseSolMgr.hpp:1094</a></div></div>
<div class="ttc" id="aclassAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr_html_aedafe273b314c89601d0699fb8420e72"><div class="ttname"><a href="classAnasazi_1_1Experimental_1_1TraceMinBaseSolMgr.html#aedafe273b314c89601d0699fb8420e72">Anasazi::Experimental::TraceMinBaseSolMgr::getProblem</a></div><div class="ttdeci">const Eigenproblem&lt; ScalarType, MV, OP &gt; &amp; getProblem() const</div><div class="ttdoc">Return the eigenvalue problem.</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTraceMinBaseSolMgr_8hpp_source.html#l00149">AnasaziTraceMinBaseSolMgr.hpp:149</a></div></div>
<div class="ttc" id="aclassAnasazi_1_1Operator_html"><div class="ttname"><a href="classAnasazi_1_1Operator.html">Anasazi::Operator</a></div><div class="ttdoc">Anasazi's templated virtual class for constructing an operator that can interface with the OperatorTr...</div><div class="ttdef"><b>Definition</b> <a href="AnasaziOperator_8hpp_source.html#l00035">AnasaziOperator.hpp:35</a></div></div>
<div class="ttc" id="aclassAnasazi_1_1SolverManager_html"><div class="ttname"><a href="classAnasazi_1_1SolverManager.html">Anasazi::SolverManager</a></div><div class="ttdoc">The Anasazi::SolverManager is a templated virtual base class that defines the basic interface that an...</div><div class="ttdef"><b>Definition</b> <a href="AnasaziSolverManager_8hpp_source.html#l00034">AnasaziSolverManager.hpp:34</a></div></div>
<div class="ttc" id="aclassAnasazi_1_1SortManager_html"><div class="ttname"><a href="classAnasazi_1_1SortManager.html">Anasazi::SortManager</a></div><div class="ttdoc">Anasazi's templated pure virtual class for managing the sorting of approximate eigenvalues computed b...</div><div class="ttdef"><b>Definition</b> <a href="AnasaziSortManager_8hpp_source.html#l00047">AnasaziSortManager.hpp:47</a></div></div>
<div class="ttc" id="aclassAnasazi_1_1StatusTestCombo_html"><div class="ttname"><a href="classAnasazi_1_1StatusTestCombo.html">Anasazi::StatusTestCombo</a></div><div class="ttdoc">Status test for forming logical combinations of other status tests.</div><div class="ttdef"><b>Definition</b> <a href="AnasaziStatusTestCombo_8hpp_source.html#l00043">AnasaziStatusTestCombo.hpp:43</a></div></div>
<div class="ttc" id="anamespaceAnasazi_html"><div class="ttname"><a href="namespaceAnasazi.html">Anasazi</a></div><div class="ttdoc">Namespace Anasazi contains the classes, structs, enums and utilities used by the Anasazi package.</div></div>
<div class="ttc" id="anamespaceAnasazi_html_a823537bb3d658892d7388be67cf036a6"><div class="ttname"><a href="namespaceAnasazi.html#a823537bb3d658892d7388be67cf036a6">Anasazi::ReturnType</a></div><div class="ttdeci">ReturnType</div><div class="ttdoc">Enumerated type used to pass back information from a solver manager.</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTypes_8hpp_source.html#l00088">AnasaziTypes.hpp:89</a></div></div>
<div class="ttc" id="anamespaceAnasazi_html_a823537bb3d658892d7388be67cf036a6a2df84c9ec5ae479b897c1f8153ff2e7e"><div class="ttname"><a href="namespaceAnasazi.html#a823537bb3d658892d7388be67cf036a6a2df84c9ec5ae479b897c1f8153ff2e7e">Anasazi::Unconverged</a></div><div class="ttdeci">@ Unconverged</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTypes_8hpp_source.html#l00092">AnasaziTypes.hpp:91</a></div></div>
<div class="ttc" id="anamespaceAnasazi_html_a823537bb3d658892d7388be67cf036a6a43d6b459d6ecd3f2d638063a61c58880"><div class="ttname"><a href="namespaceAnasazi.html#a823537bb3d658892d7388be67cf036a6a43d6b459d6ecd3f2d638063a61c58880">Anasazi::Converged</a></div><div class="ttdeci">@ Converged</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTypes_8hpp_source.html#l00090">AnasaziTypes.hpp:90</a></div></div>
<div class="ttc" id="anamespaceAnasazi_html_a842d441a9c0641dc12d8c263180416ef"><div class="ttname"><a href="namespaceAnasazi.html#a842d441a9c0641dc12d8c263180416ef">Anasazi::ResType</a></div><div class="ttdeci">ResType</div><div class="ttdoc">Enumerated type used to specify which residual norm used by residual norm status tests.</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTypes_8hpp_source.html#l00119">AnasaziTypes.hpp:119</a></div></div>
<div class="ttc" id="anamespaceAnasazi_html_ac1cd930ca09987d38fe97bbb8c65507da2c41d6eeeab5121d3c26c70ac5d18239"><div class="ttname"><a href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2c41d6eeeab5121d3c26c70ac5d18239">Anasazi::Errors</a></div><div class="ttdeci">@ Errors</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTypes_8hpp_source.html#l00131">AnasaziTypes.hpp:131</a></div></div>
<div class="ttc" id="anamespaceAnasazi_html_ac1cd930ca09987d38fe97bbb8c65507da2e2571549ff094918fb9b368fad7f1f9"><div class="ttname"><a href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da2e2571549ff094918fb9b368fad7f1f9">Anasazi::Debug</a></div><div class="ttdeci">@ Debug</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTypes_8hpp_source.html#l00139">AnasaziTypes.hpp:138</a></div></div>
<div class="ttc" id="anamespaceAnasazi_html_ac1cd930ca09987d38fe97bbb8c65507da8de60b694f69d925e2658c04c92d73dc"><div class="ttname"><a href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507da8de60b694f69d925e2658c04c92d73dc">Anasazi::FinalSummary</a></div><div class="ttdeci">@ FinalSummary</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTypes_8hpp_source.html#l00135">AnasaziTypes.hpp:135</a></div></div>
<div class="ttc" id="anamespaceAnasazi_html_ac1cd930ca09987d38fe97bbb8c65507daa04bd73cdc419c447db8771af5d18f83"><div class="ttname"><a href="namespaceAnasazi.html#ac1cd930ca09987d38fe97bbb8c65507daa04bd73cdc419c447db8771af5d18f83">Anasazi::TimingDetails</a></div><div class="ttdeci">@ TimingDetails</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTypes_8hpp_source.html#l00136">AnasaziTypes.hpp:136</a></div></div>
<div class="ttc" id="anamespaceAnasazi_html_aecc89d0f13b3e478065ad8d8b53788c2a0e0d7b1d4280c818d697128327e4f534"><div class="ttname"><a href="namespaceAnasazi.html#aecc89d0f13b3e478065ad8d8b53788c2a0e0d7b1d4280c818d697128327e4f534">Anasazi::Undefined</a></div><div class="ttdeci">@ Undefined</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTypes_8hpp_source.html#l00114">AnasaziTypes.hpp:113</a></div></div>
<div class="ttc" id="anamespaceAnasazi_html_aecc89d0f13b3e478065ad8d8b53788c2a37e4db41c154382c42a280dfb2eebad8"><div class="ttname"><a href="namespaceAnasazi.html#aecc89d0f13b3e478065ad8d8b53788c2a37e4db41c154382c42a280dfb2eebad8">Anasazi::Passed</a></div><div class="ttdeci">@ Passed</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTypes_8hpp_source.html#l00111">AnasaziTypes.hpp:111</a></div></div>
<div class="ttc" id="anamespaceAnasazi_html_aecc89d0f13b3e478065ad8d8b53788c2a9b73a6d49abb67b1edcd2c524b9332e0"><div class="ttname"><a href="namespaceAnasazi.html#aecc89d0f13b3e478065ad8d8b53788c2a9b73a6d49abb67b1edcd2c524b9332e0">Anasazi::Failed</a></div><div class="ttdeci">@ Failed</div><div class="ttdef"><b>Definition</b> <a href="AnasaziTypes_8hpp_source.html#l00112">AnasaziTypes.hpp:112</a></div></div>
<div class="ttc" id="anamespaceExperimental_html"><div class="ttname"><a href="namespaceExperimental.html">Experimental</a></div></div>
<div class="ttc" id="astructAnasazi_1_1OutputStreamTraits_html"><div class="ttname"><a href="structAnasazi_1_1OutputStreamTraits.html">Anasazi::OutputStreamTraits</a></div><div class="ttdoc">Output managers remove the need for the eigensolver to know any information about the required output...</div><div class="ttdef"><b>Definition</b> <a href="AnasaziOutputStreamTraits_8hpp_source.html#l00040">AnasaziOutputStreamTraits.hpp:40</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
