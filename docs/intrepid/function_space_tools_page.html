<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Intrepid: Function space tools</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Intrepid
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Function space tools</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>Table of contents </b> </p><ul>
<li><a class="el" href="function_space_tools_page.html#sec_fst_overview">Overview</a> </li>
<li><a class="el" href="function_space_tools_page.html#sec_pullbacks">Pullbacks</a> </li>
<li><a class="el" href="function_space_tools_page.html#sec_measure">Measure</a> </li>
<li><a class="el" href="function_space_tools_page.html#sec_evaluate">Evaluation of finite element fields</a></li>
</ul>
<h1><a class="anchor" id="sec_fst_overview"></a>
Overview</h1>
<p><a class="el" href="classIntrepid_1_1FunctionSpaceTools.html" title="Defines expert-level interfaces for the evaluation of functions and operators in physical space (supp...">Intrepid::FunctionSpaceTools</a> is a stateless class of <em>expert</em> <em>methods</em> for operations on finite element subspaces of <picture><source srcset="form_206_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$H(grad,\Omega)$" src="form_206.png"/></picture>, <picture><source srcset="form_207_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$H(curl,\Omega)$" src="form_207.png"/></picture>, <picture><source srcset="form_208_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$H(div,\Omega)$" src="form_208.png"/></picture> and <picture><source srcset="form_209_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$L^2(\Omega)$" src="form_209.png"/></picture>. In Intrepid these spaces are referred to as <em>HGRAD</em>, <em>HCURL</em>, <em>HDIV</em> and <em>HVOL</em>. There are four basic groups of methods:</p>
<ul>
<li>Transformation methods provide implementation of pullbacks for <em>HGRAD</em>, <em>HCURL</em>, <em>HDIV</em> and <em>HVOL</em> finite element functions. Thease are essentialy the "change of variables rules" needed to transform values of basis functions and their derivatives defined on a reference element <picture><source srcset="form_210_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\widehat{{\mathcal C}}$" src="form_210.png"/></picture> to a physical element <picture><source srcset="form_36_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="${\mathcal C}$" src="form_36.png"/></picture>. See Section <a class="el" href="function_space_tools_page.html#sec_pullbacks">Pullbacks</a> for details</li>
<li>Measure computation methods implement the volume, surface and line measures required for computation of integrals in the physical frame by changing variables to reference frame. See Section <a class="el" href="function_space_tools_page.html#sec_measure">Measure</a> for details.</li>
<li>Integration methods implement the algebraic operations to compute ubiquitous integrals of finite element functions: integrals arising in bilinear forms and linear functionals.</li>
<li>Methods for algebraic and vector-algebraic operations on multi-dimensional arrays with finite element function values. These methods are used to prepare multidimensional arrays with data and finite element function values for the integration routines. They also include evaluation methods to compute finite element function values at some given points in physical frame; see Section <a class="el" href="function_space_tools_page.html#sec_evaluate">Evaluation of finite element fields</a>.</li>
</ul>
<h1><a class="anchor" id="sec_pullbacks"></a>
Pullbacks</h1>
<p>Notation in this section follows the standard definition of a finite element space by Ciarlet; see <em> The Finite Element Method for Elliptic Problems, Classics in Applied Mathematics, SIAM, 2002. </em> Given a reference cell <picture><source srcset="form_211_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\{\widehat{{\mathcal C}},\widehat{P},\widehat{\Lambda}\}$" src="form_211.png"/></picture> with a basis <br  />
 <picture><source srcset="form_212_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\{\widehat{u}_i\}_{i=0}^n$" src="form_212.png"/></picture>, the basis <picture><source srcset="form_213_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\{{u}_i\}_{i=0}^n$" src="form_213.png"/></picture> of <picture><source srcset="form_214_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\{{\mathcal C},P,\Lambda\}$" src="form_214.png"/></picture> is defined as follows:  </p><p class="formulaDsp">
<picture><source srcset="form_215_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
      u_i = \sigma_i \Phi^*(\widehat{u}_i), \qquad i=1,\ldots,n \,.
 \]" src="form_215.png"/></picture>
</p>
<p> In this formula <picture><source srcset="form_216_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\{\sigma_i\}_{i=0}^n$" src="form_216.png"/></picture>, where <picture><source srcset="form_217_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\sigma_i = \pm 1$" src="form_217.png"/></picture>, are the <em>field</em> <em>signs</em>, and <picture><source srcset="form_218_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\Phi^*$" src="form_218.png"/></picture> is the <em>pullback</em> ("change of variables") transformation. For scalar spaces such as <em>HGRAD</em> and <em>HVOL</em> the field signs are always equal to 1 and can be disregarded. For vector field spaces such as <em>HCURL</em> or <em>HDIV</em>, the field sign of a basis function can be +1 or -1, depending on the orientation of the physical edge or face, associated with the basis function.</p>
<p>The actual form of the pullback depends on which one of the four function spaces <em>HGRAD</em>, <em>HCURL</em>, <em>HDIV</em> and <em>HVOL</em> is being approximated and is computed as follows. Let <picture><source srcset="form_219_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$F_{\mathcal C}$" src="form_219.png"/></picture> denote the reference-to-physical map (see Section <a class="el" href="cell_tools_page.html#sec_cell_topology_ref_map">Reference-to-physical cell mapping</a>); <picture><source srcset="form_220_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$DF_{\mathcal C}$" src="form_220.png"/></picture> is its Jacobian (see Section <a class="el" href="cell_tools_page.html#sec_cell_topology_ref_map_DF">Jacobian of the reference-to-physical cell mapping</a>) and <picture><source srcset="form_221_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$J_{\mathcal C} = \det(DF_{\mathcal C})$" src="form_221.png"/></picture>. Then,  </p><p class="formulaDsp">
<picture><source srcset="form_222_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
    \begin{array}{ll}
      \Phi^*_G : HGRAD(\widehat{{\mathcal C}}) \mapsto HGRAD({\mathcal C})&amp;
      \qquad \Phi^*_G(\widehat{u}) = \widehat{u}\circ F^{-1}_{\mathcal C} \\[2ex]
      \Phi^*_C : HCURL(\widehat{{\mathcal C}}) \mapsto HCURL({\mathcal C})&amp;
      \qquad \Phi^*_C(\widehat{\bf u}) = \left((DF_{\mathcal C})^{-{\sf T}}\cdot\widehat{\bf u}\right)\circ F^{-1}_{\mathcal C} \\[2ex]
      \Phi^*_D : HDIV(\widehat{{\mathcal C}}) \mapsto HDIV({\mathcal C})&amp;
      \qquad \Phi^*_D(\widehat{\bf u}) = \left(J^{-1}_{\mathcal C} DF_{\mathcal C}\cdot\widehat{\bf u}\right)\circ F^{-1}_{\mathcal C} 
      \\[2ex]
      \Phi^*_S : HVOL(\widehat{{\mathcal C}}) \mapsto HVOL({\mathcal C})&amp;
      \qquad \Phi^*_S(\widehat{u}) = \left(J^{-1}_{\mathcal C} \widehat{u}\right) \circ F^{-1}_{\mathcal C} \,.
    \end{array}
 \]" src="form_222.png"/></picture>
</p>
<p> Intrepid supports pullbacks only for cell topologies that have reference cells; see <a class="el" href="cell_tools_page.html#cell_topology_ref_cells">Reference cells</a>.</p>
<h1><a class="anchor" id="sec_measure"></a>
Measure</h1>
<p>In Intrepid integrals of finite element functions over cells, 2-subcells (faces) and 1-subcells (edges) are computed by change of variables to reference frame and require three different kinds of measures.</p>
<ol type="1">
<li>The integral of a scalar function over a cell <picture><source srcset="form_36_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="${\mathcal C}$" src="form_36.png"/></picture>  <p class="formulaDsp">
<picture><source srcset="form_223_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
          \int_{{\mathcal C}} f(x) dx = \int_{\widehat{{\mathcal C}}} f(F(\widehat{x})) |J | d\widehat{x}
      \]" src="form_223.png"/></picture>
</p>
 requires the volume measure defined by the determinant of the Jacobian. This measure is computed by <a class="el" href="classIntrepid_1_1FunctionSpaceTools.html#a88aa764489ab4e79cfdd9e4994d1e458" title="Returns the weighted integration measures outVals with dimensions (C,P) used for the computation of c...">Intrepid::FunctionSpaceTools::computeCellMeasure</a></li>
<li>The integral of a scalar function over 2-subcell <picture><source srcset="form_224_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\mathcal{F}$" src="form_224.png"/></picture>  <p class="formulaDsp">
<picture><source srcset="form_225_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
          \int_{\mathcal{F}} f(x) dx = \int_{R} f(\Phi(u,v)) 
          \left\|\frac{\partial\Phi}{\partial u}\times \frac{\partial\Phi}{\partial v}\right\| du\,dv
      \]" src="form_225.png"/></picture>
</p>
 requires the surface measure defined by the norm of the vector product of the surface tangents. This <br  />
 measure is computed by <a class="el" href="classIntrepid_1_1FunctionSpaceTools.html#a01407227e9f58d6432f933e0e4d5f1ec" title="Returns the weighted integration measures outVals with dimensions (C,P) used for the computation of f...">Intrepid::FunctionSpaceTools::computeFaceMeasure</a>. In this formula <em>R</em> is the parametrization domain for the 2-subcell; see Section <a class="el" href="cell_tools_page.html#sec_cell_topology_subcell_map">Parametrization of physical 1- and 2-subcells</a> for details.</li>
<li>The integral of a scalar function over a 1-subcell <picture><source srcset="form_226_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\mathcal{E}$" src="form_226.png"/></picture>  <p class="formulaDsp">
<picture><source srcset="form_227_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
          \int_{\mathcal{E}} f(x) dx = \int_{R} f(\Phi(s)) \|\Phi'\| ds
      \]" src="form_227.png"/></picture>
</p>
 requires the arc measure defined by the norm of the arc tangent vector. This measure is computed by <a class="el" href="classIntrepid_1_1FunctionSpaceTools.html#ae21e68a1d026a67ffd86825b4405835e" title="Returns the weighted integration measures outVals with dimensions (C,P) used for the computation of e...">Intrepid::FunctionSpaceTools::computeEdgeMeasure</a>. In this formula <em>R</em> is the parametrization domain for the 1-subcell; see Section <a class="el" href="cell_tools_page.html#sec_cell_topology_subcell_map">Parametrization of physical 1- and 2-subcells</a> for details.</li>
</ol>
<h1><a class="anchor" id="sec_evaluate"></a>
Evaluation of finite element fields</h1>
<p>To make this example more specific, assume curl-conforming finite element spaces. Suppose that we have a physical cell <picture><source srcset="form_214_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\{{\mathcal C},P,\Lambda\}$" src="form_214.png"/></picture> with a basis <picture><source srcset="form_228_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\{{\bf u}_i\}_{i=0}^n$" src="form_228.png"/></picture>. A finite element function on this cell is defined by a set of <em>n</em> coefficients <picture><source srcset="form_229_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\{c_i\}_{i=0}^n$" src="form_229.png"/></picture>:  </p><p class="formulaDsp">
<picture><source srcset="form_230_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
      {\bf u}^h(x) = \sum_{i=0}^n c_i {\bf u}_i(x) \,.
 \]" src="form_230.png"/></picture>
</p>
<p>From Section <a class="el" href="function_space_tools_page.html#sec_pullbacks">Pullbacks</a> it follows that  </p><p class="formulaDsp">
<picture><source srcset="form_231_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
      {\bf u}^h(x) = \sum_{i=0}^n c_i \sigma_i
               \left((DF_{\mathcal C})^{-{\sf T}}\cdot\widehat{\bf u}_i\right)\circ 
                     F^{-1}_{\mathcal C}(x) 
             = \sum_{i=0}^n c_i \sigma_i 
                    (DF_{\mathcal C}(\widehat{x}))^{-{\sf T}}\cdot\widehat{\bf u}_i(\widehat{x})\,,
 \]" src="form_231.png"/></picture>
</p>
<p> where <picture><source srcset="form_232_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \widehat{x} = F^{-1}_{\mathcal C}(x) \in \widehat{\mathcal C} $" src="form_232.png"/></picture> is the pre-image of <em>x</em> in the reference cell.</p>
<p>Consequently, evaluation of finite element functions at a given set of points <picture><source srcset="form_233_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\{x_p\}_{p=0}^P \subset {\mathcal C}$" src="form_233.png"/></picture> comprises of the following four steps:</p>
<ol type="1">
<li>Application of the inverse map <picture><source srcset="form_234_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$F^{-1}_{\mathcal C}$" src="form_234.png"/></picture> to obtain the pre-images <picture><source srcset="form_235_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\{\widehat{x}_p\}_{p=0}^P$" src="form_235.png"/></picture> of the evaluation points in the reference cell <picture><source srcset="form_236_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\widehat{\mathcal{C}}$" src="form_236.png"/></picture>; see <a class="el" href="classIntrepid_1_1CellTools.html#a9991dbffe8acf4c7d0c5de00bc5c31bd" title="Computes , the inverse of the reference-to-physical frame map using a default initial guess.">Intrepid::CellTools::mapToReferenceFrame</a></li>
<li>Evaluation of the appropriate reference basis set <picture><source srcset="form_237_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\{\widehat{\bf u}_i\}_{i=1}^n$" src="form_237.png"/></picture> at the pre-image set <picture><source srcset="form_235_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\{\widehat{x}_p\}_{p=0}^P$" src="form_235.png"/></picture>; see <a class="el" href="classIntrepid_1_1Basis.html#aa6ed9d88d5b5c7d1b266ebdf483a6cb1" title="Evaluation of a FEM basis on a reference cell.">Intrepid::Basis::getValues</a></li>
<li>Application of the appropriate transformation and field signs. In our example the finite element space is curl-conforming and the appropriate transformation is implemented in <a class="el" href="classIntrepid_1_1FunctionSpaceTools.html#a35c79ab919fe41f9da4b7b7c63d5c867" title="Transformation of a (vector) value field in the H-curl space, defined at points on a reference cell,...">Intrepid::FunctionSpaceTools::HCURLtransformVALUE</a>. Application of the signs to the transformed functions is done by <a class="el" href="classIntrepid_1_1FunctionSpaceTools.html#a9ab7225afd6c6dddeeb9ed21ebbbb6a0" title="Applies field signs, stored in the user-provided container fieldSigns and indexed by (C,...">Intrepid::FunctionSpaceTools::applyFieldSigns</a>.</li>
<li>The final step is to compute the sum of the transformed and signed basis function values multiplied by the coefficients of the finite element function using <a class="el" href="classIntrepid_1_1FunctionSpaceTools.html#a5418b9f70affa9a9d3bacb9343ba94b2" title="Computes point values outPointVals of a discrete function specified by the basis inFields and coeffic...">Intrepid::FunctionSpaceTools::evaluate</a>.</li>
</ol>
<p>Evaluation of adimssible derivatives of finite element functions is completely analogous and follows the same four steps. Evaluation of scalar finite element functions is simpler because application of the signes can be skipped for these functions.</p>
<h1><a class="anchor" id="sec_ops"></a>
Evaluation of finite element operators and functionals</h1>
<p>Assume the same setting as in Section <a class="el" href="function_space_tools_page.html#sec_evaluate">Evaluation of finite element fields</a>. A finite element operator defined by the finite element basis on the physical cell <picture><source srcset="form_10_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\mathcal{C}$" src="form_10.png"/></picture> is a matrix  </p><p class="formulaDsp">
<picture><source srcset="form_238_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
      \mathbf{K}^{\mathcal{C}}_{i,j} = \int_{\mathcal C} {\mathcal L}_L {\bf u}_i(x)\, {\mathcal L}_R {\bf u}_j(x) \, dx \,.
 \]" src="form_238.png"/></picture>
</p>
<p> where <picture><source srcset="form_239_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="${\mathcal L}_L$" src="form_239.png"/></picture> and <picture><source srcset="form_240_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="${\mathcal L}_R $" src="form_240.png"/></picture> are <em>left</em> and <em>right</em> operators acting on the basis functions. Typically, when the left and the right basis functions are from the same finite element basis (as in this example), the left and right operators are the same. If they are set to <em>VALUE</em> we get a mass matrix; if they are set to an admissible differential operator we get a stiffnesss matrix. Assume again that the basis is curl-conforming and the operators are set to <em>VALUE</em>. Using the basis definition from Section <a class="el" href="function_space_tools_page.html#sec_pullbacks">Pullbacks</a> we have that  </p><p class="formulaDsp">
<picture><source srcset="form_241_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
     \mathbf{K}^{\mathcal{C}}_{i,j} = \int_{\widehat{\mathcal C}} \sigma_i \sigma_j
     (DF_{\mathcal C}(\widehat{x}))^{-{\sf T}}\cdot\widehat{\bf u}_i(\widehat{x})\cdot
     (DF_{\mathcal C}(\widehat{x}))^{-{\sf T}}\cdot\widehat{\bf u}_i(\widehat{x})\,d\widehat{x}
 \]" src="form_241.png"/></picture>
</p>
<p> It follows that  </p><p class="formulaDsp">
<picture><source srcset="form_242_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
   \mathbf{K}^{\mathcal{C}}_{i,j} = 
   \mbox{diag}(\sigma_0,\ldots,\sigma_n)\widehat{\mathbf{K}}^{\mathcal{C}}\mbox{diag}(\sigma_0,\ldots,\sigma_n)
 \]" src="form_242.png"/></picture>
</p>
<p> where  </p><p class="formulaDsp">
<picture><source srcset="form_243_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[ 
   \widehat{\mathbf{K}}^{\mathcal{C}}_{i,j} = \int_{\widehat{\mathcal C}}
   (DF_{\mathcal C}(\widehat{x}))^{-{\sf T}}\cdot\widehat{\bf u}_i(\widehat{x})\cdot
   (DF_{\mathcal C}(\widehat{x}))^{-{\sf T}}\cdot\widehat{\bf u}_i(\widehat{x})\,d\widehat{x}
 \]" src="form_243.png"/></picture>
</p>
<p> is the raw cell operator matrix. The methods <a class="el" href="classIntrepid_1_1FunctionSpaceTools.html#a7091e8f6fc0bf4cd9e621ce888dfc7a7" title="Applies left (row) signs, stored in the user-provided container fieldSigns and indexed by (C,...">Intrepid::FunctionSpaceTools::applyLeftFieldSigns</a> and <a class="el" href="classIntrepid_1_1FunctionSpaceTools.html#a448a2aacc500464013bccab75276981b" title="Applies right (column) signs, stored in the user-provided container fieldSigns and indexed by (C,...">Intrepid::FunctionSpaceTools::applyRightFieldSigns</a> apply the left and right diagonal sign matrices to the raw cell operator.</p>
<p>A finite element operator defined by the finite element basis on the physical cell is a vector  </p><p class="formulaDsp">
<picture><source srcset="form_244_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
   \mathbf{f}^{\mathcal{C}}_{i} = \int_{\mathcal C} f(x) {\mathcal L}_R u_i(x) \, dx \,.
 \]" src="form_244.png"/></picture>
</p>
<p> Assuming again operator <em>VALUE</em> and using the same arguments as above, we see that  </p><p class="formulaDsp">
<picture><source srcset="form_245_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
   \mathbf{f}^{\mathcal{C}} = 
      \mbox{diag}(\sigma_0,\ldots,\sigma_n)\widehat{\mathbf{f}}^{\mathcal{C}}\,,
 \]" src="form_245.png"/></picture>
</p>
<p> where  </p><p class="formulaDsp">
<picture><source srcset="form_246_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
   \widehat{\mathbf{f}}^{\mathcal{C}} = \int_{\widehat{\mathcal C}}
         \mathbf{f}\circ F_{\mathcal C}(\widehat{x}) 
         (DF_{\mathcal C}(\widehat{x}))^{-{\sf T}}\cdot\widehat{\bf u}_i(\widehat{x})\,d\widehat{x}
 \]" src="form_246.png"/></picture>
</p>
<p> is the raw cell functional. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
