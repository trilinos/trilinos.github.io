<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Stratimikos: test_single_stratimikos_solver.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Stratimikos<span id="projectnumber">&#160;Version of the Day</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">test_single_stratimikos_solver.cpp</div></div>
</div><!--header-->
<div class="contents">
<p>The bottom of this page shows a simple test program for how the <code>Stratimikos::DefaultLinearSolverBuilder</code> class is used to take a parameter list (e.g. read from a file) and use it to build <code>Thyra::LinearOpWithSolveFactory</code> and <code>Thyra::PreconditionerFactoryBase</code> objects.</p>
<p>The arguments that the testing program driver that calls this example are:</p>
<pre class="fragment">Teuchos::GlobalMPISession::GlobalMPISession(): started serial run

Echoing the command-line:

/home/rabartl/PROJECTS/Trilinos.base/BUILDS/CMAKE/SERIAL_DEBUG/packages/stratimikos/test/Stratimikos_test_single_stratimikos_solver_driver.exe --echo-command-line --help 

Usage: /home/rabartl/PROJECTS/Trilinos.base/BUILDS/CMAKE/SERIAL_DEBUG/packages/stratimikos/test/Stratimikos_test_single_stratimikos_solver_driver.exe [options]
  options:
  --help                         Prints this help message
  --pause-for-debugging          Pauses for user input to allow attaching a debugger
  --echo-command-line            Echo the command-line but continue as normal
  --input-file           string  Input file [Required].
                                 (default: --input-file="")
  --extra-params         string  Extra parameters overriding the parameters read in from --input-file
                                 (default: --extra-params="")

DETAILED DOCUMENTATION:

Testing program for Trilinos (and non-Trilinos) linear solvers access through Thyra.

</pre><p>Sample output looks like:</p>
<pre class="fragment">Teuchos::GlobalMPISession::GlobalMPISession(): started serial run

Echoing the command-line:

/home/rabartl/PROJECTS/Trilinos.base/BUILDS/CMAKE/SERIAL_DEBUG/packages/stratimikos/test/Stratimikos_test_single_stratimikos_solver_driver.exe --echo-command-line --input-file=../test/FourByFour.belos.ifpack.xml 


Reading parameters from XML file "../test/FourByFour.belos.ifpack.xml" ...

Echoing input parameters ...
 Matrix File : string = FourByFour.mtx
 Linear Solver Builder -&gt; 
  Linear Solver Type : string = Belos
  Preconditioner Type : string = Ifpack
 LinearOpWithSolveTester -&gt; 
  [empty list]

Validating top-level input parameters ...

Reading in an epetra matrix A from the file 'FourByFour.mtx' ...

Creating a Stratimikos::DefaultLinearSolverBuilder object ...

Valid parameters for DefaultLinearSolverBuilder ...
 Enable Delayed Solver Construction : bool = 0
 Linear Solver Type : string = Amesos
 Preconditioner Type : string = Ifpack
 Linear Solver Types -&gt; 
  Amesos -&gt; 
   Refactorization Policy : string = RepivotOnRefactorization
   Solver Type : string = Klu
   Throw on Preconditioner Input : bool = 1
   Amesos Settings -&gt; 
    AddToDiag : double = 0
    AddZeroToDiag : bool = 0
    ComputeTrueResidual : bool = 0
    ComputeVectorNorms : bool = 0
    DebugLevel : int = 0
    MatrixProperty : string = general
    MaxProcs : int = -1
    NoDestroy : bool = 0
    OutputLevel : int = 1
    PrintTiming : bool = 0
    RcondThreshold : double = 1e-12
    Redistribute : bool = 0
    Refactorize : bool = 0
    Reindex : bool = 0
    ScaleMethod : int = 0
    TrustMe : bool = 0
    Lapack -&gt; 
     Equilibrate : bool = 1
    Mumps -&gt; 
     ColScaling : double* = 0
     Equilibrate : bool = 1
     RowScaling : double* = 0
    Pardiso -&gt; 
     IPARM(1) : int = 0
     IPARM(10) : int = 0
     IPARM(11) : int = 0
     IPARM(18) : int = 0
     IPARM(19) : int = 0
     IPARM(2) : int = 0
     IPARM(21) : int = 0
     IPARM(3) : int = 0
     IPARM(4) : int = 0
     IPARM(8) : int = 0
     MSGLVL : int = 0
    Scalapack -&gt; 
     2D distribution : bool = 1
     grid_nb : int = 32
    Superludist -&gt; 
     ColPerm : string = NOT SET
     Equil : bool = 0
     Fact : string = SamePattern
     IterRefine : string = NOT SET
     PrintNonzeros : bool = 0
     ReplaceTinyPivot : bool = 1
     ReuseSymbolic : bool = 0
     RowPerm : string = NOT SET
     perm_c : int* = 0
     perm_r : int* = 0
   VerboseObject -&gt; 
    Output File : string = none
    Verbosity Level : string = default
  AztecOO -&gt; 
   Output Every RHS : bool = 0
   Adjoint Solve -&gt; 
    Max Iterations : int = 400
    Tolerance : double = 1e-06
    AztecOO Settings -&gt; 
     Aztec Preconditioner : string = ilu
     Aztec Solver : string = GMRES
     Convergence Test : string = r0
     Drop Tolerance : double = 0
     Fill Factor : double = 1
     Graph Fill : int = 0
     Ill-Conditioning Threshold : double = 1e+11
     Orthogonalization : string = Classical
     Output Frequency : int = 0
     Overlap : int = 0
     Polynomial Order : int = 3
     RCM Reordering : string = Disabled
     Size of Krylov Subspace : int = 300
     Steps : int = 3
   Forward Solve -&gt; 
    Max Iterations : int = 400
    Tolerance : double = 1e-06
    AztecOO Settings -&gt; 
     Aztec Preconditioner : string = ilu
     Aztec Solver : string = GMRES
     Convergence Test : string = r0
     Drop Tolerance : double = 0
     Fill Factor : double = 1
     Graph Fill : int = 0
     Ill-Conditioning Threshold : double = 1e+11
     Orthogonalization : string = Classical
     Output Frequency : int = 0
     Overlap : int = 0
     Polynomial Order : int = 3
     RCM Reordering : string = Disabled
     Size of Krylov Subspace : int = 300
     Steps : int = 3
   VerboseObject -&gt; 
    Output File : string = none
    Verbosity Level : string = default
  Belos -&gt; 
   Solver Type : string = Block GMRES
   Solver Types -&gt; 
    Block CG -&gt; 
     Adaptive Block Size : bool = 1
     Block Size : int = 1
     Convergence Tolerance : double = 1e-08
     Maximum Iterations : int = 1000
     Orthogonalization : string = DGKS
     Orthogonalization Constant : double = -1
     Output Frequency : int = -1
     Output Stream : Teuchos::RCP&lt;std::ostream&gt; = Teuchos::RCP&lt;std::ostream&gt;{ptr=0x5d8a60,node=0x5e2990,count=4}
     Show Maximum Residual Norm Only : bool = 0
     Timer Label : string = Belos
     Verbosity : int = 0
    Block GMRES -&gt; 
     Adaptive Block Size : bool = 1
     Block Size : int = 1
     Convergence Tolerance : double = 1e-08
     Explicit Residual Scaling : string = Norm of Initial Residual
     Explicit Residual Test : bool = 0
     Flexible Gmres : bool = 0
     Implicit Residual Scaling : string = Norm of Preconditioned Initial Residual
     Maximum Iterations : int = 1000
     Maximum Restarts : int = 20
     Num Blocks : int = 300
     Orthogonalization : string = DGKS
     Orthogonalization Constant : double = -1
     Output Frequency : int = -1
     Output Stream : Teuchos::RCP&lt;std::ostream&gt; = Teuchos::RCP&lt;std::ostream&gt;{ptr=0x5d8a60,node=0x5e2730,count=4}
     Show Maximum Residual Norm Only : bool = 0
     Timer Label : string = Belos
     Verbosity : int = 0
    Pseudo Block GMRES -&gt; 
     Adaptive Block Size : bool = 1
     Block Size : int = 1
     Convergence Tolerance : double = 1e-08
     Deflation Quorum : int = 1
     Explicit Residual Scaling : string = Norm of Initial Residual
     Implicit Residual Scaling : string = Norm of Preconditioned Initial Residual
     Maximum Iterations : int = 1000
     Maximum Restarts : int = 20
     Num Blocks : int = 300
     Orthogonalization : string = DGKS
     Orthogonalization Constant : double = -1
     Output Frequency : int = -1
     Output Stream : Teuchos::RCP&lt;std::ostream&gt; = Teuchos::RCP&lt;std::ostream&gt;{ptr=0x5d8a60,node=0x5e2860,count=4}
     Show Maximum Residual Norm Only : bool = 0
     Timer Label : string = Belos
     Verbosity : int = 0
   VerboseObject -&gt; 
    Output File : string = none
    Verbosity Level : string = default
 Preconditioner Types -&gt; 
  Ifpack -&gt; 
   Overlap : int = 0
   Prec Type : string = ILU
   Ifpack Settings -&gt; 
    amesos: solver type : string = Amesos_Klu
    fact: absolute threshold : double = 0
    fact: drop tolerance : double = 0
    fact: ict level-of-fill : double = 1
    fact: ilut level-of-fill : double = 1
    fact: level-of-fill : int = 0
    fact: relative threshold : double = 1
    fact: relax value : double = 0
    fact: sparskit: alph : double = 0
    fact: sparskit: droptol : double = 0
    fact: sparskit: lfil : int = 0
    fact: sparskit: mbloc : int = -1
    fact: sparskit: permtol : double = 0.1
    fact: sparskit: tol : double = 0
    fact: sparskit: type : string = ILUT
    partitioner: local parts : int = 1
    partitioner: overlap : int = 0
    partitioner: print level : int = 0
    partitioner: type : string = greedy
    partitioner: use symmetric graph : bool = 1
    relaxation: damping factor : double = 1
    relaxation: min diagonal value : double = 1
    relaxation: sweeps : int = 1
    relaxation: type : string = Jacobi
    relaxation: zero starting solution : bool = 1
    schwarz: combine mode : string = Zero
    schwarz: compute condest : bool = 1
    schwarz: filter singletons : bool = 0
    schwarz: reordering type : string = none
   VerboseObject -&gt; 
    Output File : string = none
    Verbosity Level : string = default
  ML -&gt; 
   Base Method Defaults : string = DD
   ML Settings -&gt; 
    aggregation: damping factor : double = 1.333
    aggregation: edge prolongator drop threshold : double = 0
    aggregation: local aggregates : int = 1
    aggregation: next-level aggregates per process : int = 128
    aggregation: nodes per aggregate : int = 512
    aggregation: type : string = Uncoupled-MIS
    coarse: max size : int = 128
    coarse: pre or post : string = post
    coarse: sweeps : int = 1
    coarse: type : string = Amesos-KLU
    default values : string = maxwell
    eigen-analysis: iterations : int = 10
    eigen-analysis: type : string = cg
    increasing or decreasing : string = decreasing
    max levels : int = 10
    prec type : string = MGV
    smoother: Aztec as solver : bool = 0
    smoother: Aztec options : Teuchos::RCP&lt;__gnu_debug_def::vector&lt;int, std::allocator&lt;int&gt; &gt; &gt; = Teuchos::RCP&lt;__gnu_debug_def::vector&lt;int, std::allocator&lt;int&gt; &gt; &gt;{ptr=0x5f95e0,node=0x5fd8a0,count=2}
    smoother: Aztec params : Teuchos::RCP&lt;__gnu_debug_def::vector&lt;double, std::allocator&lt;double&gt; &gt; &gt; = Teuchos::RCP&lt;__gnu_debug_def::vector&lt;double, std::allocator&lt;double&gt; &gt; &gt;{ptr=0x5fd320,node=0x5fdfa0,count=2}
    smoother: Hiptmair efficient symmetric : bool = 1
    smoother: damping factor : double = 1
    smoother: pre or post : string = both
    smoother: sweeps : int = 1
    smoother: type : string = Hiptmair
    subsmoother: Chebyshev alpha : double = 20
    subsmoother: edge sweeps : int = 4
    subsmoother: node sweeps : int = 4
    subsmoother: type : string = Chebyshev

Creating the LinearOpWithSolveFactoryBase object lowsFactory ...

lowsFactory described as:
 Thyra::BelosLinearOpWithSolveFactory


Running example use cases for not externally preconditioned ...
 
 Running example use cases for a LinearOpWithSolveFactoryBase object ...
  
  Performing a single linear solve ...
  
  Solve status:
   solveStatus = SOLVE_STATUS_CONVERGED
   achievedTol = 1e-08
   message:
    The Belos solver of type "Belos::BlockGmresSolMgr&lt;...,double&gt;{Ortho Type='DGKS', Block Size=1, Num Blocks=300, Max Restarts=20}" returned a solve status of "SOLVE_STATUS_CONVERGED with total CPU time of 0.032548 sec
   extraParameters: NONE
  
  Performing a solve, changing the operator, then performing another solve ...
  
  Performing a solve, changing the operator in a very small way, then performing another solve ...
  
  Performing a solve, changing the operator in a major way, then performing another solve ...

Checking the LOWSB interface ...
 
 *** Entering LinearOpWithSolveTester&lt;double&gt;::check(op,...) ...
 
 describe op: Thyra::BelosLinearOpWithSolve&lt;double&gt;{iterativeSolver='Belos::BlockGmresSolMgr&lt;...,double&gt;{Ortho Type='DGKS', Block Size=1, Num Blocks=300, Max Restarts=20}',fwdOp='Thyra::EpetraLinearOp{op='Epetra_CrsMatrix',rangeDim=4,domainDim=4}',rightPrecOp='Thyra::EpetraLinearOp{op='Ifpack_AdditiveSchwarz&lt;Ifpack_ILU&gt;',rangeDim=4,domainDim=4}'}
 
 this-&gt;check_forward_default()==true: Checking the default forward solve ... passed!
 
 this-&gt;check_forward_residual()==true: Checking the forward solve with a tolerance on the residual ... passed!
 
 this-&gt;check_adjoint_default()==false: Skipping the check of the adjoint solve with a default tolerance!
 
 this-&gt;check_adjoint_residual()==false: Skipping the check of the adjoint solve with a tolerance on the residual!
 
 Congratulations, this LinearOpWithSolveBase object seems to check out!
 
 *** Leaving LinearOpWithSolveTester&lt;double&gt;::check(...)

Printing the parameter list (showing what was used) ...
 Matrix File : string = FourByFour.mtx
 Solve Adjoint : bool = 0   [default]
 Linear Solver Builder -&gt; 
  Enable Delayed Solver Construction : bool = 0   [default]
  Linear Solver Type : string = Belos
  Preconditioner Type : string = Ifpack
  Linear Solver Types -&gt; 
   Belos -&gt; 
    Solver Type : string = Block GMRES   [default]
    Solver Types -&gt; 
     Block CG -&gt; 
      Adaptive Block Size : bool = 1   [unused]
      Block Size : int = 1   [unused]
      Convergence Tolerance : double = 1e-08   [unused]
      Maximum Iterations : int = 1000   [unused]
      Orthogonalization : string = DGKS   [unused]
      Orthogonalization Constant : double = -1   [unused]
      Output Frequency : int = -1   [unused]
      Output Stream : Teuchos::RCP&lt;std::ostream&gt; = Teuchos::RCP&lt;std::ostream&gt;{ptr=0x5d8a60,node=0x5e2990,count=6}   [unused]
      Show Maximum Residual Norm Only : bool = 0   [unused]
      Timer Label : string = Belos   [unused]
      Verbosity : int = 0   [unused]
     Block GMRES -&gt; 
      Adaptive Block Size : bool = 1   [unused]
      Block Size : int = 1
      Convergence Tolerance : double = 1e-08
      Explicit Residual Scaling : string = Norm of Initial Residual
      Explicit Residual Test : bool = 0
      Flexible Gmres : bool = 0
      Implicit Residual Scaling : string = Norm of Preconditioned Initial Residual
      Maximum Iterations : int = 1000
      Maximum Restarts : int = 20
      Num Blocks : int = 300
      Orthogonalization : string = DGKS
      Orthogonalization Constant : double = -1
      Output Frequency : int = -1   [unused]
      Output Stream : Teuchos::RCP&lt;std::ostream&gt; = Teuchos::RCP&lt;std::ostream&gt;{ptr=0x5d8a60,node=0x5e2730,count=6}
      Show Maximum Residual Norm Only : bool = 0
      Timer Label : string = Belos
      Verbosity : int = 0
     Pseudo Block GMRES -&gt; 
      Adaptive Block Size : bool = 1   [unused]
      Block Size : int = 1   [unused]
      Convergence Tolerance : double = 1e-08   [unused]
      Deflation Quorum : int = 1   [unused]
      Explicit Residual Scaling : string = Norm of Initial Residual   [unused]
      Implicit Residual Scaling : string = Norm of Preconditioned Initial Residual   [unused]
      Maximum Iterations : int = 1000   [unused]
      Maximum Restarts : int = 20   [unused]
      Num Blocks : int = 300   [unused]
      Orthogonalization : string = DGKS   [unused]
      Orthogonalization Constant : double = -1   [unused]
      Output Frequency : int = -1   [unused]
      Output Stream : Teuchos::RCP&lt;std::ostream&gt; = Teuchos::RCP&lt;std::ostream&gt;{ptr=0x5d8a60,node=0x5e2860,count=6}   [unused]
      Show Maximum Residual Norm Only : bool = 0   [unused]
      Timer Label : string = Belos   [unused]
      Verbosity : int = 0   [unused]
    VerboseObject -&gt; 
     Output File : string = none
     Verbosity Level : string = default
  Preconditioner Types -&gt; 
   Ifpack -&gt; 
    Overlap : int = 0   [default]
    Prec Type : string = ILU   [default]
    Ifpack Settings -&gt; 
     schwarz: combine mode : string = Zero   [default]
     schwarz: compute condest : bool = 1   [default]
     schwarz: filter singletons : bool = 0   [default]
     schwarz: reordering type : string = none   [default]
    VerboseObject -&gt; 
     Output File : string = none   [default]
     Verbosity Level : string = default   [default]
 LinearOpWithSolveTester -&gt; 
  All Slack Error Tol : double = 1e-05   [default]
  All Slack Warning Tol : double = 1e-06   [default]
  All Solve Tol : double = 1e-05   [default]
  Dump All : bool = 0   [default]
  Show All Tests : bool = 0   [default]

Congratulations! All of the tests checked out!
</pre><p>Here is the main driver itself:</p>
<div class="fragment"></div><!-- fragment --> </div><!-- contents -->

<!-- Assumes Doxygen adds the jquery script. Otherwise, uncomment following
     line:
<script type="text/javascript" 
        src="common/parameterList/js/jquery.js"></script> 
-->
<script type="text/javascript" 
        src="common/parameterList/js/iframeResizer.min.js"></script> 
<script type="text/javascript">
iFrameResize({
  log                 : true,   // Enable console logging
  enablePublicMethods : true,   // Enable methods within iframe hosted page
  sizeHeight:true,
  interval: -1,
  resizedCallback     : function(messageData){ // Callback fn when msg recd
    $('p#callback').html(
        '<b>Frame ID:</b> '    + messageData.iframe.id +
        ' <b>Height:</b> '     + messageData.height +
        ' <b>Width:</b> '      + messageData.width +
        ' <b>Event type:</b> ' + messageData.type
     );
  }
});
</script>
<hr size="1"><address style="align: right;"><small>
Generated for Stratimikos by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.9.8</small></address>
</body>
</html>
