<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Amesos: am_compare</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Amesos<span id="projectnumber">&#160;Development</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">am_compare</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="fragment"><div class="line"><span class="comment">// @HEADER</span></div>
<div class="line"><span class="comment">// ***********************************************************************</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//                Amesos: An Interface to Direct Solvers</span></div>
<div class="line"><span class="comment">//                 Copyright (2004) Sandia Corporation</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Under terms of Contract DE-AC04-94AL85000, there is a non-exclusive</span></div>
<div class="line"><span class="comment">// license for use of this work by or on behalf of the U.S. Government.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// This library is free software; you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment">// it under the terms of the GNU Lesser General Public License as</span></div>
<div class="line"><span class="comment">// published by the Free Software Foundation; either version 2.1 of the</span></div>
<div class="line"><span class="comment">// License, or (at your option) any later version.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// This library is distributed in the hope that it will be useful, but</span></div>
<div class="line"><span class="comment">// WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><span class="comment">// Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><span class="comment">// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><span class="comment">// Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301</span></div>
<div class="line"><span class="comment">// USA</span></div>
<div class="line"><span class="comment">// Questions? Contact Michael A. Heroux (maherou@sandia.gov)</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// ***********************************************************************</span></div>
<div class="line"><span class="comment">// @HEADER</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;Amesos_ConfigDefs.h&quot;</span></div>
<div class="line"><span class="comment">// This example needs Galeri to generate the linear system.</span></div>
<div class="line"><span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><span class="preprocessor">#include &quot;mpi.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Epetra_MpiComm.h&quot;</span></div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor">#include &quot;Epetra_SerialComm.h&quot;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor">#include &quot;Epetra_Vector.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Epetra_Time.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Epetra_RowMatrix.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Epetra_CrsMatrix.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Amesos.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="Amesos__BaseSolver_8h.html">Amesos_BaseSolver.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Teuchos_ParameterList.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Galeri_Maps.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Galeri_CrsMatrices.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>Teuchos;</div>
<div class="line"><span class="keyword">using namespace </span>Galeri;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;Trilinos_Util.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Trilinos_Util_ReadMatrixMarket2Epetra.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;CrsMatrixTranspose.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Teuchos_RCP.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Epetra_Export.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> MyCreateCrsMatrix( <span class="keyword">const</span> <span class="keywordtype">char</span> *in_filename, <span class="keyword">const</span> Epetra_Comm &amp;Comm,</div>
<div class="line">                     Epetra_Map *&amp; readMap,</div>
<div class="line">                     <span class="keyword">const</span> <span class="keywordtype">bool</span> transpose, <span class="keyword">const</span> <span class="keywordtype">bool</span> distribute,</div>
<div class="line">                     <span class="keywordtype">bool</span>&amp; symmetric, Epetra_CrsMatrix *&amp; Matrix ) {</div>
<div class="line"> </div>
<div class="line">  Epetra_CrsMatrix * readA = 0;</div>
<div class="line">  Epetra_Vector * readx = 0;</div>
<div class="line">  Epetra_Vector * readb = 0;</div>
<div class="line">  Epetra_Vector * readxexact = 0;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  This hack allows TestOptions to be run from either the test/TestOptions/ directory or from</span></div>
<div class="line">  <span class="comment">//  the test/ directory (as it is in nightly testing and in make &quot;run-tests&quot;)</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  FILE *in_file = fopen( in_filename, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *filename;</div>
<div class="line">  <span class="keywordflow">if</span> (in_file == NULL )</div>
<div class="line">    filename = &amp;in_filename[1] ; <span class="comment">//  Strip off ithe &quot;.&quot; from</span></div>
<div class="line">                                 <span class="comment">//  &quot;../&quot; and try again</span></div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    filename = in_filename ;</div>
<div class="line">    fclose( in_file );</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  symmetric = false ;</div>
<div class="line">  std::string FileName (filename);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> FN_Size = FileName.size() ;</div>
<div class="line">  std::string LastFiveBytes = FileName.substr( EPETRA_MAX(0,FN_Size-5), FN_Size );</div>
<div class="line">  std::string LastFourBytes = FileName.substr( EPETRA_MAX(0,FN_Size-4), FN_Size );</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> ( LastFiveBytes == <span class="stringliteral">&quot;.TimD&quot;</span> ) {</div>
<div class="line">    <span class="comment">// Call routine to read in a file in a Zero Based File in Tim Davis format</span></div>
<div class="line">    EPETRA_CHK_ERR( Trilinos_Util_ReadTriples2Epetra( filename, <span class="keyword">false</span>, Comm, readMap, readA, readx,</div>
<div class="line">                                                      readb, readxexact, <span class="keyword">false</span>, <span class="keyword">true</span>, <span class="keyword">true</span> ) );</div>
<div class="line">    symmetric = <span class="keyword">false</span>;</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="keywordflow">if</span> ( LastFiveBytes == <span class="stringliteral">&quot;.triU&quot;</span> ) {</div>
<div class="line">      <span class="comment">// Call routine to read in unsymmetric Triplet matrix</span></div>
<div class="line">      EPETRA_CHK_ERR( Trilinos_Util_ReadTriples2Epetra( filename, <span class="keyword">false</span>, Comm, readMap, readA, readx,</div>
<div class="line">                                                        readb, readxexact) );</div>
<div class="line">      symmetric = <span class="keyword">false</span>;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">if</span> ( LastFiveBytes == <span class="stringliteral">&quot;.triS&quot;</span> ) {</div>
<div class="line">        <span class="comment">// Call routine to read in symmetric Triplet matrix</span></div>
<div class="line">        EPETRA_CHK_ERR( Trilinos_Util_ReadTriples2Epetra( filename, <span class="keyword">true</span>, Comm, readMap, readA, readx,</div>
<div class="line">                                                          readb, readxexact) );</div>
<div class="line">        symmetric = <span class="keyword">true</span>;</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">if</span> (  LastFourBytes == <span class="stringliteral">&quot;.mtx&quot;</span> ) {</div>
<div class="line">          EPETRA_CHK_ERR( Trilinos_Util_ReadMatrixMarket2Epetra( filename, Comm, readMap,</div>
<div class="line">                                                                 readA, readx, readb, readxexact) );</div>
<div class="line">          FILE* in_file = fopen( filename, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line">          assert (in_file != NULL) ;  <span class="comment">// Checked in Trilinos_Util_CountMatrixMarket()</span></div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">int</span> BUFSIZE = 800 ;</div>
<div class="line">          <span class="keywordtype">char</span> buffer[BUFSIZE] ;</div>
<div class="line">          fgets( buffer, BUFSIZE, in_file ) ;  <span class="comment">// Pick symmetry info off of this string</span></div>
<div class="line">          std::string headerline1 = buffer;</div>
<div class="line"><span class="preprocessor">#ifdef TFLOP</span></div>
<div class="line">          <span class="keywordflow">if</span> ( headerline1.find(<span class="stringliteral">&quot;symmetric&quot;</span>) &lt; BUFSIZE ) symmetric = <span class="keyword">true</span>;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">          <span class="keywordflow">if</span> ( headerline1.find(<span class="stringliteral">&quot;symmetric&quot;</span>) != std::string::npos) symmetric = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">          fclose(in_file);</div>
<div class="line"> </div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">          <span class="comment">// Call routine to read in HB problem</span></div>
<div class="line">          Trilinos_Util_ReadHb2Epetra( filename, Comm, readMap, readA, readx,</div>
<div class="line">                                       readb, readxexact) ;</div>
<div class="line">          <span class="keywordflow">if</span> (  LastFourBytes == <span class="stringliteral">&quot;.rsa&quot;</span> ) symmetric = true ;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> ( readb )  <span class="keyword">delete</span> readb;</div>
<div class="line">  <span class="keywordflow">if</span> ( readx ) <span class="keyword">delete</span> readx;</div>
<div class="line">  <span class="keywordflow">if</span> ( readxexact ) <span class="keyword">delete</span> readxexact;</div>
<div class="line"> </div>
<div class="line">  Epetra_CrsMatrix *serialA ;</div>
<div class="line">  Epetra_CrsMatrix *transposeA;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> ( transpose ) {</div>
<div class="line">    transposeA = <span class="keyword">new</span> Epetra_CrsMatrix( Copy, *readMap, 0 );</div>
<div class="line">    assert( CrsMatrixTranspose( readA, transposeA ) == 0 );</div>
<div class="line">    serialA = transposeA ;</div>
<div class="line">    <span class="keyword">delete</span> readA;</div>
<div class="line">    readA = 0 ;</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    serialA = readA ;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  assert( (<span class="keywordtype">void</span> *) &amp;serialA-&gt;Graph() ) ;</div>
<div class="line">  assert( (<span class="keywordtype">void</span> *) &amp;serialA-&gt;RowMap() ) ;</div>
<div class="line">  assert( serialA-&gt;RowMap().SameAs(*readMap) ) ;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> ( distribute ) {</div>
<div class="line">    <span class="comment">// Create uniform distributed map</span></div>
<div class="line">    Epetra_Map DistMap(readMap-&gt;NumGlobalElements(), 0, Comm);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create Exporter to distribute read-in matrix and vectors</span></div>
<div class="line">    Epetra_Export exporter( *readMap, DistMap );</div>
<div class="line"> </div>
<div class="line">    Epetra_CrsMatrix *Amat = <span class="keyword">new</span> Epetra_CrsMatrix( Copy, DistMap, 0 );</div>
<div class="line">    Amat-&gt;Export(*serialA, exporter, Add);</div>
<div class="line">    assert(Amat-&gt;FillComplete()==0);</div>
<div class="line"> </div>
<div class="line">    Matrix = Amat;</div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">//  Make sure that deleting Amat-&gt;RowMap() will delete map</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">//  Bug:  We can&#39;t manage to delete map his way anyway,</span></div>
<div class="line">    <span class="comment">//        and this fails on tranposes, so for now I just accept</span></div>
<div class="line">    <span class="comment">//        the memory loss.</span></div>
<div class="line">    <span class="comment">//    assert( &amp;(Amat-&gt;RowMap()) == map ) ;</span></div>
<div class="line">    <span class="keyword">delete</span> readMap;</div>
<div class="line">    readMap = 0 ;</div>
<div class="line">    <span class="keyword">delete</span> serialA;</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line"> </div>
<div class="line">    Matrix = serialA;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// ===================== //</span></div>
<div class="line"><span class="comment">// M A I N   D R I V E R //</span></div>
<div class="line"><span class="comment">// ===================== //</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// This example compares all the available Amesos solvers</span></div>
<div class="line"><span class="comment">// for the solution of the same linear system.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The example can be run in serial and in parallel.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Author: Marzio Sala, SNL 9214</span></div>
<div class="line"><span class="comment">// Last modified: Oct-05.</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line"><span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line">  MPI_Init(&amp;argc, &amp;argv);</div>
<div class="line">  Epetra_MpiComm Comm(MPI_COMM_WORLD);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">  Epetra_SerialComm Comm;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">bool</span> verbose = (Comm.MyPID() == 0);</div>
<div class="line">  <span class="keywordtype">double</span> TotalResidual = 0.0;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create the Map, defined as a grid, of size nx x ny x nz,</span></div>
<div class="line">  <span class="comment">// subdivided into mx x my x mz cubes, each assigned to a</span></div>
<div class="line">  <span class="comment">// different processor.</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef FILENAME_SPECIFIED_ON_COMMAND_LINE</span></div>
<div class="line">  ParameterList GaleriList;</div>
<div class="line">  GaleriList.set(<span class="stringliteral">&quot;nx&quot;</span>, 4);</div>
<div class="line">  GaleriList.set(<span class="stringliteral">&quot;ny&quot;</span>, 4);</div>
<div class="line">  GaleriList.set(<span class="stringliteral">&quot;nz&quot;</span>, 4 * Comm.NumProc());</div>
<div class="line">  GaleriList.set(<span class="stringliteral">&quot;mx&quot;</span>, 1);</div>
<div class="line">  GaleriList.set(<span class="stringliteral">&quot;my&quot;</span>, 1);</div>
<div class="line">  GaleriList.set(<span class="stringliteral">&quot;mz&quot;</span>, Comm.NumProc());</div>
<div class="line">  Epetra_Map* Map = CreateMap(<span class="stringliteral">&quot;Cartesian3D&quot;</span>, Comm, GaleriList);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create a matrix, in this case corresponding to a 3D Laplacian</span></div>
<div class="line">  <span class="comment">// discretized using a classical 7-point stencil. Please refer to</span></div>
<div class="line">  <span class="comment">// the Galeri documentation for an overview of available matrices.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// NOTE: matrix must be symmetric if DSCPACK is used.</span></div>
<div class="line"> </div>
<div class="line">  Epetra_CrsMatrix* Matrix = CreateCrsMatrix(<span class="stringliteral">&quot;Laplace3D&quot;</span>, Map, GaleriList);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">  <span class="keywordtype">bool</span> transpose = false ;</div>
<div class="line">  <span class="keywordtype">bool</span> distribute = false ;</div>
<div class="line">  <span class="keywordtype">bool</span> symmetric ;</div>
<div class="line">  Epetra_CrsMatrix *Matrix = 0 ;</div>
<div class="line">  Epetra_Map *Map = 0 ;</div>
<div class="line">  MyCreateCrsMatrix( argv[1], Comm, Map, transpose, distribute, symmetric, Matrix ) ;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// build vectors, in this case with 1 vector</span></div>
<div class="line">  Epetra_MultiVector LHS(*Map, 1);</div>
<div class="line">  Epetra_MultiVector RHS(*Map, 1);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// create a linear problem object</span></div>
<div class="line">  Epetra_LinearProblem Problem(Matrix, &amp;LHS, &amp;RHS);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// use this list to set up parameters, now it is required</span></div>
<div class="line">  <span class="comment">// to use all the available processes (if supported by the</span></div>
<div class="line">  <span class="comment">// underlying solver). Uncomment the following two lines</span></div>
<div class="line">  <span class="comment">// to let Amesos print out some timing and status information.</span></div>
<div class="line">  ParameterList List;</div>
<div class="line">  List.set(<span class="stringliteral">&quot;PrintTiming&quot;</span>,<span class="keyword">true</span>);</div>
<div class="line">  List.set(<span class="stringliteral">&quot;PrintStatus&quot;</span>,<span class="keyword">true</span>);</div>
<div class="line">  List.set(<span class="stringliteral">&quot;MaxProcs&quot;</span>,Comm.NumProc());</div>
<div class="line"> </div>
<div class="line">  std::vector&lt;std::string&gt; SolverType;</div>
<div class="line">  SolverType.push_back(<span class="stringliteral">&quot;Amesos_Paraklete&quot;</span>);</div>
<div class="line">  SolverType.push_back(<span class="stringliteral">&quot;Amesos_Klu&quot;</span>);</div>
<div class="line">  Comm.Barrier() ;</div>
<div class="line"><span class="preprocessor">#if 1</span></div>
<div class="line">  SolverType.push_back(<span class="stringliteral">&quot;Amesos_Lapack&quot;</span>);</div>
<div class="line">  SolverType.push_back(<span class="stringliteral">&quot;Amesos_Umfpack&quot;</span>);</div>
<div class="line">  SolverType.push_back(<span class="stringliteral">&quot;Amesos_Pardiso&quot;</span>);</div>
<div class="line">  SolverType.push_back(<span class="stringliteral">&quot;Amesos_Taucs&quot;</span>);</div>
<div class="line">  SolverType.push_back(<span class="stringliteral">&quot;Amesos_Superlu&quot;</span>);</div>
<div class="line">  SolverType.push_back(<span class="stringliteral">&quot;Amesos_Superludist&quot;</span>);</div>
<div class="line">  SolverType.push_back(<span class="stringliteral">&quot;Amesos_Mumps&quot;</span>);</div>
<div class="line">  SolverType.push_back(<span class="stringliteral">&quot;Amesos_Dscpack&quot;</span>);</div>
<div class="line">  SolverType.push_back(<span class="stringliteral">&quot;Amesos_Scalapack&quot;</span>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  Epetra_Time Time(Comm);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// this is the Amesos factory object that will create</span></div>
<div class="line">  <span class="comment">// a specific Amesos solver.</span></div>
<div class="line">  <a class="code hl_class" href="classAmesos.html">Amesos</a> Factory;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Cycle over all solvers.</span></div>
<div class="line">  <span class="comment">// Only installed solvers will be tested.</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0 ; i &lt; SolverType.size() ; ++i)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// Check whether the solver is available or not</span></div>
<div class="line">    <span class="keywordflow">if</span> (Factory.<a class="code hl_function" href="classAmesos.html#a9929aa33f9b760a4a3a04dba8f9a75b1">Query</a>(SolverType[i]))</div>
<div class="line">    {</div>
<div class="line">      <span class="comment">// 1.- set exact solution (constant vector)</span></div>
<div class="line">      LHS.PutScalar(1.0);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// 2.- create corresponding rhs</span></div>
<div class="line">      Matrix-&gt;Multiply(<span class="keyword">false</span>, LHS, RHS);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// 3.- randomize solution vector</span></div>
<div class="line">      LHS.Random();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// 4.- create the amesos solver object</span></div>
<div class="line">      <a class="code hl_class" href="classAmesos__BaseSolver.html">Amesos_BaseSolver</a>* Solver = Factory.<a class="code hl_function" href="classAmesos.html#a57272d41cf59138dd51b530eb9fd90c9">Create</a>(SolverType[i], Problem);</div>
<div class="line">      assert (Solver != 0);</div>
<div class="line"> </div>
<div class="line">      Solver-&gt;<a class="code hl_function" href="classAmesos__BaseSolver.html#ace346398dfa98755ccefc1e42ed8c5e3">SetParameters</a>(List);</div>
<div class="line">      Solver-&gt;<a class="code hl_function" href="classAmesos__BaseSolver.html#a8d15300a27598a698d2d489a785babf3">SetUseTranspose</a>( <span class="keyword">true</span>) ;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// 5.- factorize and solve</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">      Comm.Barrier() ;</div>
<div class="line">      <span class="keywordflow">if</span> (verbose)</div>
<div class="line">        std::cout &lt;&lt; std::endl</div>
<div class="line">             &lt;&lt; <span class="stringliteral">&quot;Solver &quot;</span> &lt;&lt; SolverType[i]</div>
<div class="line">             &lt;&lt; <span class="stringliteral">&quot;, verbose = &quot;</span> &lt;&lt; verbose &lt;&lt; std::endl ;</div>
<div class="line">      Comm.Barrier() ;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">      Time.ResetStartTime();</div>
<div class="line">      AMESOS_CHK_ERR(Solver-&gt;<a class="code hl_function" href="classAmesos__BaseSolver.html#a8c7d37f010f456e73fecff141362cd6f">SymbolicFactorization</a>());</div>
<div class="line">      <span class="keywordflow">if</span> (verbose)</div>
<div class="line">        std::cout &lt;&lt; std::endl</div>
<div class="line">             &lt;&lt; <span class="stringliteral">&quot;Solver &quot;</span> &lt;&lt; SolverType[i]</div>
<div class="line">             &lt;&lt; <span class="stringliteral">&quot;, symbolic factorization time = &quot;</span></div>
<div class="line">             &lt;&lt; Time.ElapsedTime() &lt;&lt; std::endl;</div>
<div class="line">      Comm.Barrier() ;</div>
<div class="line"> </div>
<div class="line">      AMESOS_CHK_ERR(Solver-&gt;<a class="code hl_function" href="classAmesos__BaseSolver.html#a889d3a41a25a09d5ab22bcdcaf188bd4">NumericFactorization</a>());</div>
<div class="line">      <span class="keywordflow">if</span> (verbose)</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Solver &quot;</span> &lt;&lt; SolverType[i]</div>
<div class="line">             &lt;&lt; <span class="stringliteral">&quot;, numeric factorization time = &quot;</span></div>
<div class="line">             &lt;&lt; Time.ElapsedTime() &lt;&lt; std::endl;</div>
<div class="line">      Comm.Barrier() ;</div>
<div class="line"> </div>
<div class="line">      AMESOS_CHK_ERR(Solver-&gt;<a class="code hl_function" href="classAmesos__BaseSolver.html#a26d1a31bac2d1a734d00ba239c259c39">Solve</a>());</div>
<div class="line">      <span class="keywordflow">if</span> (verbose)</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Solver &quot;</span> &lt;&lt; SolverType[i]</div>
<div class="line">             &lt;&lt; <span class="stringliteral">&quot;, solve time = &quot;</span></div>
<div class="line">             &lt;&lt; Time.ElapsedTime() &lt;&lt; std::endl;</div>
<div class="line">      Comm.Barrier() ;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// 6.- compute difference between exact solution and Amesos one</span></div>
<div class="line">      <span class="comment">//     (there are other ways of doing this in Epetra, but let&#39;s</span></div>
<div class="line">      <span class="comment">//     keep it simple)</span></div>
<div class="line">      <span class="keywordtype">double</span> d = 0.0, d_tot = 0.0;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0 ; j&lt; LHS.Map().NumMyElements() ; ++j)</div>
<div class="line">        d += (LHS[0][j] - 1.0) * (LHS[0][j] - 1.0);</div>
<div class="line"> </div>
<div class="line">      Comm.SumAll(&amp;d,&amp;d_tot,1);</div>
<div class="line">      <span class="keywordflow">if</span> (verbose)</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Solver &quot;</span> &lt;&lt; SolverType[i] &lt;&lt; <span class="stringliteral">&quot;, ||x - x_exact||_2 = &quot;</span></div>
<div class="line">             &lt;&lt; sqrt(d_tot) &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// 7.- delete the object</span></div>
<div class="line">      <span class="keyword">delete</span> Solver;</div>
<div class="line"> </div>
<div class="line">      TotalResidual += d_tot;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">delete</span> Matrix;</div>
<div class="line">  <span class="keyword">delete</span> Map;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (TotalResidual &gt; 1e-9)</div>
<div class="line">    exit(EXIT_FAILURE);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line">  MPI_Finalize();</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span>(EXIT_SUCCESS);</div>
<div class="line">} <span class="comment">// end of main()</span></div>
<div class="ttc" id="aAmesos__BaseSolver_8h_html"><div class="ttname"><a href="Amesos__BaseSolver_8h.html">Amesos_BaseSolver.h</a></div></div>
<div class="ttc" id="aclassAmesos__BaseSolver_html"><div class="ttname"><a href="classAmesos__BaseSolver.html">Amesos_BaseSolver</a></div><div class="ttdoc">Amesos_BaseSolver: A pure virtual class for direct solution of real-valued double-precision operators...</div><div class="ttdef"><b>Definition</b> Amesos_BaseSolver.h:231</div></div>
<div class="ttc" id="aclassAmesos__BaseSolver_html_a26d1a31bac2d1a734d00ba239c259c39"><div class="ttname"><a href="classAmesos__BaseSolver.html#a26d1a31bac2d1a734d00ba239c259c39">Amesos_BaseSolver::Solve</a></div><div class="ttdeci">virtual int Solve()=0</div><div class="ttdoc">Solves A X = B (or AT x = B)</div></div>
<div class="ttc" id="aclassAmesos__BaseSolver_html_a889d3a41a25a09d5ab22bcdcaf188bd4"><div class="ttname"><a href="classAmesos__BaseSolver.html#a889d3a41a25a09d5ab22bcdcaf188bd4">Amesos_BaseSolver::NumericFactorization</a></div><div class="ttdeci">virtual int NumericFactorization()=0</div><div class="ttdoc">Performs NumericFactorization on the matrix A.</div></div>
<div class="ttc" id="aclassAmesos__BaseSolver_html_a8c7d37f010f456e73fecff141362cd6f"><div class="ttname"><a href="classAmesos__BaseSolver.html#a8c7d37f010f456e73fecff141362cd6f">Amesos_BaseSolver::SymbolicFactorization</a></div><div class="ttdeci">virtual int SymbolicFactorization()=0</div><div class="ttdoc">Performs SymbolicFactorization on the matrix A.</div></div>
<div class="ttc" id="aclassAmesos__BaseSolver_html_a8d15300a27598a698d2d489a785babf3"><div class="ttname"><a href="classAmesos__BaseSolver.html#a8d15300a27598a698d2d489a785babf3">Amesos_BaseSolver::SetUseTranspose</a></div><div class="ttdeci">virtual int SetUseTranspose(bool UseTranspose)=0</div><div class="ttdoc">If set true, X will be set to the solution of AT X = B (not A X = B)</div></div>
<div class="ttc" id="aclassAmesos__BaseSolver_html_ace346398dfa98755ccefc1e42ed8c5e3"><div class="ttname"><a href="classAmesos__BaseSolver.html#ace346398dfa98755ccefc1e42ed8c5e3">Amesos_BaseSolver::SetParameters</a></div><div class="ttdeci">virtual int SetParameters(Teuchos::ParameterList &amp;ParameterList)=0</div><div class="ttdoc">Updates internal variables.</div></div>
<div class="ttc" id="aclassAmesos_html"><div class="ttname"><a href="classAmesos.html">Amesos</a></div><div class="ttdoc">Factory for binding a third party direct solver to an Epetra_LinearProblem.</div><div class="ttdef"><b>Definition</b> Amesos.h:50</div></div>
<div class="ttc" id="aclassAmesos_html_a57272d41cf59138dd51b530eb9fd90c9"><div class="ttname"><a href="classAmesos.html#a57272d41cf59138dd51b530eb9fd90c9">Amesos::Create</a></div><div class="ttdeci">Amesos_BaseSolver * Create(const char *ClassType, const Epetra_LinearProblem &amp;LinearProblem)</div><div class="ttdoc">Amesos Create method.</div><div class="ttdef"><b>Definition</b> Amesos.cpp:72</div></div>
<div class="ttc" id="aclassAmesos_html_a9929aa33f9b760a4a3a04dba8f9a75b1"><div class="ttname"><a href="classAmesos.html#a9929aa33f9b760a4a3a04dba8f9a75b1">Amesos::Query</a></div><div class="ttdeci">bool Query(const char *ClassType)</div><div class="ttdoc">Queries whether a given interface is available or not.</div><div class="ttdef"><b>Definition</b> Amesos.cpp:205</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
