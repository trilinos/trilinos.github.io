<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Galeri: Creating an Epetra_CrsMatrix</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Galeri<span id="projectnumber">&#160;Development</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Creating an Epetra_CrsMatrix</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This file first gives an example of how to create an Epetra_CrsMatrix object, then it details the supported matrices and gives a list of required parameters.</p>
<p>Given an already created Epetra_Map, Galeri can construct an Epetra_CrsMatrix object that has this Map as RowMatrixRowMap(). A simple example is as follows. Let <code>Map</code> be an already created <code>Epetra_Map*</code> object; then, a diagonal matrix with <picture><source srcset="form_1_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$a = 2.0$" src="form_1.png" width="39" height="9"/></picture> on the diagonal can be created using the instructions</p>
<pre class="fragment">#include "Galeri_CrsMatrices.h"
using namespace Galeri;
...
string MatrixType = "Diag";
List.set("a", 2.0);
Epetra_CrsMatrix* Matrix = CreateCrsMatrix(MatrixType, Map, List);
</pre><p>More interesting matrices can be easily created. For example, a 2D biharmonic operator can be created like this:</p>
<pre class="fragment">List.set("nx", 10);
List.set("ny", 10);
Epetra_CrsMatrix* Matrix = Galeri.Create("Biharmonic2D", Map, List);
</pre><p>For matrices arising from 2D discretizations on Cartesian grids, it is possible to visualize the computational stencil at a given grid point by using function PrintStencil2D, defined in the Galeri namespace:</p>
<pre class="fragment">#include "Galeri_Utils.h"
using namespace Galeri;
...
// Matrix is an already created Epetra_CrsMatrix* object
// and nx and ny the number of nodes along the X-axis and Y-axis, 
// respectively.
PrintStencil2D(Matrix, nx, ny);
</pre><p>The output is:</p>
<pre class="fragment">2D computational stencil at GID 12 (grid is 5 x 5)

        0          0          1          0          0
        0          2         -8          2          0
        1         -8         20         -8          1
        0          2         -8          2          0
        0          0          1          0          0
</pre><p>To present the list of supported matrices we adopt the following symbols:</p><ul>
<li>MATLAB: please refer to the MATLAB documentation for more details on the properties of this matrix;</li>
<li>DENSE: the matrix is dense (but still stored as Epetra_CrsMatrix);</li>
<li>MAP: the number of elements and its distribution are determined from the input map;</li>
<li>MAP2D: the input map has been created by CreateMap(), using MapType = <code>Cartesian2D</code>. The values of <code>nx</code> and <code>ny</code> are still available in the input list;</li>
<li>MAP3D: the input map has been created by CreateMap(), using MapType = <code>Cartesian3D</code>. The values of <code>nx</code>, <code>ny</code> and <code>nz</code> are still available in the input list;</li>
<li>SER: the matrix can be obtained in serial environments only;</li>
<li>PAR: the matrix can be obtained in parallel (and serial) environments.</li>
<li>The symbol <picture><source srcset="form_2_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$A_{i,j}$" src="form_2.png" width="21" height="14"/></picture> indicates the <picture><source srcset="form_3_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$(i,j)$" src="form_3.png" width="24" height="14"/></picture> matrix of the element in MATLAB notation (that is, starting from 1).</li>
</ul>
<p>The list of supported matrices is now reported in alphabetical order.</p>
<ul>
<li><code>BentPipe2D</code> (MAP2D, PAR): Returns a matrix corresponding to the finite-difference discretization of the problem  <p class="formulaDsp">
<picture><source srcset="form_4_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
- \epsilon \Delta u + (v_x,v_y) \cdot \nabla u = f
\]" src="form_4.png" width="138" height="14"/></picture>
</p>
 on the unit square, with homogeneous Dirichlet boundary conditions. A standard 5-pt stencil is used to discretize the diffusive term, and a simple upwind stencil is used for the convective term. Here,  <p class="formulaDsp">
<picture><source srcset="form_5_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  v_x = 2 conv x (x/2 - 1) (1 - 2y), \quad \quad \quad 
  v_y =-4 conv y (y - 1) (1 - x)
  \]" src="form_5.png" width="358" height="14"/></picture>
</p>
 The value of <picture><source srcset="form_6_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\epsilon$" src="form_6.png" width="5" height="6"/></picture> can be specified using <code>diff</code>, and that of <picture><source srcset="form_7_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$V$" src="form_7.png" width="10" height="10"/></picture> using <code>conv</code>. The default values are <code>diff=1e-5</code>, <code>conv=1</code>.</li>
<li><code>BigCross2D</code> (MAP2D, PAR): Creates a matrix corresponding to the following stencil:  <p class="formulaDsp">
<picture><source srcset="form_8_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  \left[
  \begin{tabular}{ccccc}
    &amp;     &amp; ee  &amp;     &amp;   \\
    &amp;     &amp;  e  &amp;     &amp;   \\
 bb &amp;  b  &amp;  a  &amp;  c  &amp; cc \\
    &amp;     &amp;  d  &amp;     &amp;   \\
    &amp;     &amp; dd  &amp;     &amp;   \\
  \end{tabular}
  \right] .
  \]" src="form_8.png" width="144" height="76"/></picture>
</p>
 The default values are those given by <code>Laplace2DFourthOrder</code>. A non-default value must be set in the input parameter list before creating the matrix. For example, to specify the value of <picture><source srcset="form_9_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ee$" src="form_9.png" width="11" height="6"/></picture>, one should do <pre class="fragment">  List.set("ee", 12.0);
  Matrix = Galeri.Create("BigCross2D", Map, List);</pre></li>
<li><code>BigStar2D</code> (MAP2D, PAR): Creates a matrix corresponding to the stencil  <p class="formulaDsp">
<picture><source srcset="form_10_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  \left[
  \begin{tabular}{ccccc}
    &amp;     &amp; ee  &amp;     &amp;   \\
    &amp; z3  &amp;  e  &amp; z4  &amp;   \\
 bb &amp;  b  &amp;  a  &amp;  c  &amp; cc \\
    &amp; z1  &amp;  d  &amp; z2  &amp;   \\
    &amp;     &amp; dd  &amp;     &amp;   \\
  \end{tabular}
  \right] .
  \]" src="form_10.png" width="155" height="76"/></picture>
</p>
 The default values are those given by <code>Biharmonic2D</code>.</li>
<li><code>Biharmonic2D</code> (MAP2D, PAR): Creates a matrix corresponding to the discrete biharmonic operator,  <p class="formulaDsp">
<picture><source srcset="form_11_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  \frac{1}{h^4} \;
  \left[
  \begin{tabular}{ccccc}
    &amp;     &amp;  1  &amp;     &amp;   \\
    &amp;  2  &amp; -8  &amp;  2  &amp;   \\
  1 &amp; -8  &amp; 20  &amp; -8  &amp; 1  \\
    &amp;  2  &amp; -8  &amp;  2  &amp;   \\
    &amp;     &amp;  1  &amp;     &amp;   \\
  \end{tabular}
  \right] .
  \]" src="form_11.png" width="163" height="76"/></picture>
</p>
 The formula does not include the <picture><source srcset="form_12_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\frac{1}{h^4}$" src="form_12.png" width="13" height="16"/></picture> scaling.</li>
<li><code>Cauchy</code> (MAP, MATLAB, DENSE, PAR): Creates a particular instance of a Cauchy matrix with elements <picture><source srcset="form_13_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$A_{i,j} = 1/(i+j)$" src="form_13.png" width="85" height="14"/></picture>. Explicit formulas are known for the inverse and determinant of a Cauchy matrix. For this particular Cauchy matrix, the determinant is nonzero and the matrix is totally positive.</li>
<li><p class="startli"><code>Cross2D</code> (MAP2D, PAR): Creates a matrix with the same stencil of <code>Laplace2D}</code>, but with arbitrary values. The computational stencil is  </p><p class="formulaDsp">
<picture><source srcset="form_14_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  \left[
  \begin{tabular}{ccc}
  &amp; e &amp;  \\
  b &amp; a &amp; c \\
  &amp; d &amp;   \\
  \end{tabular}
  \right] .
  \]" src="form_14.png" width="83" height="46"/></picture>
</p>
<p> The default values are </p><pre class="fragment">  List.set("a", 4.0);
  List.set("b", -1.0);
  List.set("c", -1.0);
  List.set("d", -1.0);
  List.set("e", -1.0);</pre><p class="startli">For example, to approximate the 2D Helmhotlz equation  </p><p class="formulaDsp">
<picture><source srcset="form_15_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  - \nabla u - \sigma u = f \quad \quad (\sigma \geq 0)
  \]" src="form_15.png" width="145" height="14"/></picture>
</p>
<p> with the standard 5-pt discretization stencil  </p><p class="formulaDsp">
<picture><source srcset="form_16_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  \frac{1}{h^2} \;
  \left[
  \begin{tabular}{ccc}
  &amp; -1 &amp;  \\
  -1 &amp; $4 -\sigma h^2$ &amp; -1 \\
  &amp; -1 &amp;   \\
  \end{tabular}
  \right] 
  \]" src="form_16.png" width="141" height="46"/></picture>
</p>
<p> and <picture><source srcset="form_17_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\sigma = 0.1, h = 1/nx$" src="form_17.png" width="96" height="14"/></picture>, one can set </p><pre class="fragment">  List.set("a", 4 - 0.1 * h * h);
  List.set("b", -1.0);
  List.set("c", -1.0);
  List.set("d", -1.0);
  List.set("e", -1.0);</pre><p> The factor <picture><source srcset="form_18_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\frac{1}{h^2}$" src="form_18.png" width="13" height="16"/></picture> can be considered by scaling the input parameters.</p>
</li>
<li><code>Cross3D</code> (MAP3D, PAR): Similar to the Cross2D case. The matrix stencil correspond to that of a 3D Laplace operator on a structured 3D grid. On a given x-y plane, the stencil is as in <code>Laplace2D</code>. The value on the plane below is set using <code>f</code>, the value on the plane above with <code>g</code>.</li>
<li><code>Diag</code> (MAP, PAR): Creates <picture><source srcset="form_19_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ a I$" src="form_19.png" width="13" height="10"/></picture>, where <picture><source srcset="form_20_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$I$" src="form_20.png" width="8" height="10"/></picture> is the identity matrix of size <code>n</code>. The default value is <pre class="fragment">  List.set("a", 1.0);</pre></li>
<li><code>Fiedler</code> (MAP, MATLAB, DENSE, PAR): Creates a matrix whose element are <picture><source srcset="form_21_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$A_{i,j} = | i - j |$" src="form_21.png" width="70" height="14"/></picture>. The matrix is symmetric, and has a dominant positive eigenvalue, and all the other eigenvalues are negative.</li>
<li><code>Hanowa</code> (MAP, MATLAB, PAR): Creates a matrix whose eigenvalues lie on a vertical line in the complex plane. The matrix has the 2x2 block structure (in MATLAB's notation)  <p class="formulaDsp">
<picture><source srcset="form_22_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
A = \left[
\begin{tabular}{cc} a * eye(n/2) &amp; -diag(1:m) \\
  diag(1:m) &amp;     a * eye(n/2) \\
  \end{tabular}
  \right].
\]" src="form_22.png" width="209" height="31"/></picture>
</p>
 The complex eigenvalues are of the form a <picture><source srcset="form_23_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$k \sqrt{-1}$" src="form_23.png" width="34" height="14"/></picture> and <picture><source srcset="form_24_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$-k \sqrt{-1}$" src="form_24.png" width="44" height="14"/></picture>, for <picture><source srcset="form_25_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$1 \leq k \leq n/2$" src="form_25.png" width="66" height="14"/></picture>. The default value is <pre class="fragment">List.set("a", -1.0);
</pre></li>
<li><code>Hilbert</code> (MAP, MATLAB, DENSE, PAR): This is a famous example of a badly conditioned matrix. The elements are defined in MATLAB notation as <picture><source srcset="form_13_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$A_{i,j} = 1/(i+j)$" src="form_13.png" width="85" height="14"/></picture>.</li>
<li><code>JordanBlock</code> (MAP, MATLAB, PAR): Creates a Jordan block with eigenvalue <code>lambda</code>. The default value is <code>lambda=0.1</code>;</li>
<li><code>KMS</code> (MAP, MATLAB, DENSE, PAR): Create the <picture><source srcset="form_26_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$n \times n$" src="form_26.png" width="31" height="8"/></picture> Kac-Murdock-Szego Toepliz matrix such that <picture><source srcset="form_27_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$A_{i,j} = \rho^{|i-j|}$" src="form_27.png" width="66" height="16"/></picture> (for real <picture><source srcset="form_28_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\rho$" src="form_28.png" width="8" height="9"/></picture> only). Default value is <picture><source srcset="form_29_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\rho= 0.5$" src="form_29.png" width="40" height="11"/></picture>, or can be using <code>rho</code>. The inverse of this matrix is tridiagonal, and the matrix is positive definite if and only if <picture><source srcset="form_30_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$0 &lt; |\rho| &lt; 1$" src="form_30.png" width="60" height="14"/></picture>. The default value is <code>rho=-0.5</code>;</li>
<li><code>Laplace1D</code> (MAP, PAR): Creates the classical tridiagonal matrix with stencil <picture><source srcset="form_31_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ [-1, 2, -1] $" src="form_31.png" width="55" height="14"/></picture>.</li>
<li><code>Laplace1DNeumann</code> (MAP, PAR): As for <code>Laplace1D</code>, but with Neumann boundary conditioners. The matrix is singular.</li>
<li><code>Laplace2D</code> (MAP2D, PAR): Creates a matrix corresponding to the stencil of a 2D Laplacian operator on a structured Cartesian grid. The matrix stencil is:  <p class="formulaDsp">
<picture><source srcset="form_32_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  \frac{1}{h^2} \;
  \left[
  \begin{tabular}{ccc}
  &amp; -1 &amp;  \\
  -1 &amp; 4 &amp; -1 \\
  &amp; -1 &amp;   \\
  \end{tabular}
  \right] .
  \]" src="form_32.png" width="118" height="46"/></picture>
</p>
 The formula does not include the <picture><source srcset="form_18_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\frac{1}{h^2}$" src="form_18.png" width="13" height="16"/></picture> scaling.</li>
<li><code>Laplace2DFourthOrder</code> (MAP2D, PAR): Creates a matrix corresponding to the stencil of a 2D Laplacian operator on a structured Cartesian grid. The matrix stencil is:  <p class="formulaDsp">
<picture><source srcset="form_33_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  \frac{1}{12 h^2} \;
  \left[
  \begin{tabular}{ccccc}
    &amp;     &amp;   1 &amp;     &amp;   \\
    &amp;     &amp; -16 &amp;     &amp;   \\
  1 &amp; -16 &amp;  60 &amp; -16 &amp; 1  \\
    &amp;     &amp; -16 &amp;     &amp;   \\
    &amp;     &amp;   1 &amp;     &amp;   \\
  \end{tabular}
  \right] .
  \]" src="form_33.png" width="191" height="76"/></picture>
</p>
 The formula does not include the <picture><source srcset="form_34_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\frac{1}{12h^2}$" src="form_34.png" width="23" height="16"/></picture> scaling.</li>
<li><code>Laplace3D</code> (MAP3D, PAR): Creates a matrix corresponding to the stencil of a 3D Laplacian operator on a structured Cartesian grid.</li>
<li><code>Lehmer</code> (MAP, MATLAB, DENSE, PAR): Returns a symmetric positive definite matrix, such that  <p class="formulaDsp">
<picture><source srcset="form_35_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  A_{i,j} = 
  \left\{
  \begin{array}{ll}
  \frac{i}{j} &amp; \mbox{ if } j \ge i \\
  \frac{j}{i} &amp; \mbox{ otherwise } \\
  \end{array}
  \right. .
  \]" src="form_35.png" width="146" height="34"/></picture>
</p>
 This matrix has three properties: is totally nonnegative, the inverse is tridiagonal and explicitly known, The condition number is bounded as <picture><source srcset="form_36_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ n \le cond(A) \le 4*n.$" src="form_36.png" width="115" height="14"/></picture></li>
<li><code>Minij</code> (MAP, MATLAB, DENSE, PAR): Returns the symmetric positive definite matrix defined as <picture><source srcset="form_37_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$A_{i,j} = \min(i,j)$" src="form_37.png" width="84" height="14"/></picture>.</li>
<li><code>Ones</code> (MAP, PAR): Returns a matrix with <picture><source srcset="form_38_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$A_{i,j} = a$" src="form_38.png" width="45" height="14"/></picture>. The default value is <code>a=1</code>;</li>
<li><code>Parter</code> (MAP, MATLAB, DENSE, PAR): Creates a matrix <picture><source srcset="form_39_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$A_{i,j} = 1/(i-j+0.5)$" src="form_39.png" width="116" height="14"/></picture>. This matrix is a Cauchy and a Toepliz matrix. Most of the singular values of A are very close to <picture><source srcset="form_40_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\pi$" src="form_40.png" width="9" height="6"/></picture>.</li>
<li><code>Pei</code> (MAP, MATLAB, DENSE, PAR): Creates the matrix  <p class="formulaDsp">
<picture><source srcset="form_41_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
A_{i,j} = \left\{ \begin{array}{cc}
\alpha + 1 &amp; \mbox{ if } i \neq j \\
  1  &amp; \mbox{ if } i = j.
  \end{array}
  \right. .
\]" src="form_41.png" width="154" height="31"/></picture>
</p>
 This matrix is singular for <picture><source srcset="form_42_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\alpha = 0$" src="form_42.png" width="30" height="9"/></picture> or <picture><source srcset="form_43_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$-n$" src="form_43.png" width="18" height="6"/></picture>. The default value for <picture><source srcset="form_44_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\alpha$" src="form_44.png" width="8" height="6"/></picture> is 1.0.</li>
<li><code>Recirc2D</code> (MAP2D, PAR): Returns a matrix corresponding to the finite-difference discretization of the problem  <p class="formulaDsp">
<picture><source srcset="form_4_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
- \epsilon \Delta u + (v_x,v_y) \cdot \nabla u = f
\]" src="form_4.png" width="138" height="14"/></picture>
</p>
 on the unit square, with homogeneous Dirichlet boundary conditions. A standard 5-pt stencil is used to discretize the diffusive term, and a simple upwind stencil is used for the convective term. Here,  <p class="formulaDsp">
<picture><source srcset="form_45_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  v_x = conv \cdot 4 x (x - 1) (1 - 2y), \quad \quad \quad 
  v_y = -conv \cdot 4 y (y - 1) (1 - 2x)
  \]" src="form_45.png" width="369" height="14"/></picture>
</p>
 The value of <picture><source srcset="form_6_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\epsilon$" src="form_6.png" width="5" height="6"/></picture> can be specified using <code>diff</code>, and that of <picture><source srcset="form_7_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$V$" src="form_7.png" width="10" height="10"/></picture> using <code>conv</code>. The default values are <code>diff=1e-5</code>, <code>conv=1</code>.</li>
<li><code>Ris</code> (MAP, MATLAB, PAR): Returns a symmetric Hankel matrix with elements <picture><source srcset="form_46_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$A_{i,j} = 0.5/(n-i-j+1.5)$" src="form_46.png" width="149" height="14"/></picture>, where <picture><source srcset="form_47_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$n$" src="form_47.png" width="9" height="6"/></picture> is problem size. The eigenvalues of A cluster around <picture><source srcset="form_48_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$-\pi/2$" src="form_48.png" width="30" height="14"/></picture> and <picture><source srcset="form_49_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\pi/2$" src="form_49.png" width="21" height="14"/></picture>.</li>
<li><code>Star2D</code> (MAP2D, PAR): Creates a matrix with the 9-point stencil:  <p class="formulaDsp">
<picture><source srcset="form_50_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
   \left[
  \begin{tabular}{ccc}
  z3 &amp; e &amp; z4 \\
  b &amp; a &amp; c \\
  z1 &amp; d &amp; z2  \\
  \end{tabular}
  \right] .
  \]" src="form_50.png" width="94" height="46"/></picture>
</p>
 The default values are <pre class="fragment">  List.set("a", 8.0);
  List.set("b", -1.0);
  List.set("c", -1.0);
  List.set("d", -1.0);
  List.set("e", -1.0);
  List.set("z1", -1.0);
  List.set("z2", -1.0);
  List.set("z3", -1.0);
  List.set("z4", -1.0);</pre></li>
<li><code>Stretched2D</code> (MAP2D, PAR): Creates a matrix corresponding to the following stencil:  <p class="formulaDsp">
<picture><source srcset="form_51_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  \left[
  \begin{tabular}{ccc}
  -1.0           &amp; $-4.0 + \epsilon$ &amp; -1.0 \\
  $2.0 - \epsilon$ &amp; 8.0            &amp; $2.0 - \epsilon$ \\
  -1.0           &amp; $-4.0 + \epsilon$ &amp; -1.0 \\
  \end{tabular}
  \right] .
  \]" src="form_51.png" width="181" height="46"/></picture>
</p>
 This matrix corresponds to a 2D discretization of a Laplace operator using bilinear elements on a stretched grid. The default value is <code>epsilon=0.1</code>;</li>
<li><code>Tridiag</code> (MAP, PAR): Creates a tridiagonal matrix with stencil  <p class="formulaDsp">
<picture><source srcset="form_52_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  \left[
  \begin{tabular}{ccc}
  b &amp; a &amp; c \\ 
  \end{tabular}
  \right] .
  \]" src="form_52.png" width="78" height="16"/></picture>
</p>
 The default values are <pre class="fragment">  List.set("a", 2.0);
  List.set("b", -1.0);
  List.set("c", -1.0);</pre></li>
<li><code>UniFlow2D</code> (MAP2D, PAR): Returns a matrix corresponding to the finite-difference discretization of the problem  <p class="formulaDsp">
<picture><source srcset="form_53_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
    - \epsilon \Delta u + (v_x,v_y) \cdot \nabla u = f
    \]" src="form_53.png" width="138" height="14"/></picture>
</p>
 on the unit square, with homogeneous Dirichlet boundary conditions. A standard 5-pt stencil is used to discretize the diffusive term, and a simple upwind stencil is used for the convective term. Here,  <p class="formulaDsp">
<picture><source srcset="form_54_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
    v_x = cos(\alpha) V, \quad \quad \quad v_y =  sin(\alpha) V 
    \]" src="form_54.png" width="189" height="14"/></picture>
</p>
 that corresponds to an unidirectional 2D flow. The default values are <pre class="fragment">    List.set("alpha", .0);
    List.set("diff", 1e-5);
    List.set("conv", 1.0);</pre> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
