<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Zoltan2: Developers&#39; Notes</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Zoltan2
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Developers' Notes</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="z2_developer_contents"></a>
Contents</h1>
<ul>
<li>
<a class="el" href="z2_developer.html#z2_developer_organization">Organization of an algorithm</a> </li>
<li>
<a class="el" href="z2_developer.html#z2_developer_environment">The Environment</a> </li>
<li>
<a class="el" href="z2_developer.html#z2_developer_ids">Global identifiers and data types</a> </li>
<li>
<a class="el" href="z2_developer.html#z2_developer_naming">Naming</a> </li>
<li>
<a class="el" href="z2_developer.html#z2_developer_exceptions">Error handling</a> </li>
<li>
<a class="el" href="z2_developer.html#z2_developer_status_info">Status and debugging output</a> </li>
<li>
<a class="el" href="z2_developer.html#z2_developer_profiling">Profiling</a> </li>
<li>
<a class="el" href="z2_developer.html#z2_developer_rcp">Use of Teuchos smart pointers</a> </li>
<li>
<a class="el" href="z2_developer.html#z2_developer_parameters">How to add a parameter</a> </li>
<li>
<a class="el" href="z2_developer.html#z2_developer_documentation">Documenting an algorithm</a> </li>
<li>
<a class="el" href="z2_developer.html#z2_developer_example">Example</a> </li>
</ul>
<hr  />
<h1><a class="anchor" id="z2_developer_organization"></a>
Organization of an algorithm</h1>
<p>Algorithms in <a class="el" href="namespaceZoltan2.html" title="Created by mbenlioglu on Aug 31, 2020.">Zoltan2</a> are namespace methods. They are called by a <a class="el" href="classZoltan2_1_1Problem.html" title="Problem base class from which other classes (PartitioningProblem, ColoringProblem,...">Zoltan2::Problem</a>. The Problem passes the following information to the algorithm:</p>
<ul>
<li>A <a class="el" href="classZoltan2_1_1Environment.html" title="The user parameters, debug, timing and memory profiling output objects, and error checking methods.">Zoltan2::Environment</a>, described below.</li>
<li>A Teuchos::Comm, a wrapper for the MPI communicator for the problem.</li>
<li>A <a class="el" href="classZoltan2_1_1Model.html" title="The base class for all model classes.">Zoltan2::Model</a>, the computational model derived from the user's input data.</li>
<li>A <a class="el" href="classZoltan2_1_1Solution.html" title="Just a placeholder for now.">Zoltan2::Solution</a>.</li>
</ul>
<p>The <a class="el" href="classZoltan2_1_1Environment.html" title="The user parameters, debug, timing and memory profiling output objects, and error checking methods.">Zoltan2::Environment</a> contains the user's parameter settings, and methods for handling exceptions, profiling and status messages.</p>
<p>Parallel communication is performed with the Teuchos::Comm object. Probably the easiest way to do this is by using the helper functions in <a class="el" href="z2_developer_teuchos_comm.html">Teuchos_CommHelpers.hpp</a>.</p>
<p>The Environment also has a communicator, which is the communicator for the entire application. The communicator passed in as the 2nd argument of the algorithm is the communicator for the problem, which may be different if the problem is being solved over a subset of the entire application.</p>
<p>The <a class="el" href="classZoltan2_1_1Model.html" title="The base class for all model classes.">Zoltan2::Model</a> is created by the Problem based on the type of input provided by the user and information in the user's parameters. The Model may represent one of the following objects:</p>
<ul>
<li>A <a class="el" href="classZoltan2_1_1IdentifierModel.html" title="IdentifierModel defines the interface for all identifier models.">Zoltan2::IdentifierModel</a> is simply a collection of global identifiers.</li>
<li>A <a class="el" href="classZoltan2_1_1CoordinateModel.html" title="This class provides geometric coordinates with optional weights to the Zoltan2 algorithm.">Zoltan2::CoordinateModel</a> is a collection of geometric coordinates of arbitrary dimension.</li>
<li>A <a class="el" href="classZoltan2_1_1GraphModel.html" title="GraphModel defines the interface required for graph models.">Zoltan2::GraphModel</a> is an undirected graph.</li>
</ul>
<p>A hypergraph model will be added eventually.</p>
<p>The <a class="el" href="classZoltan2_1_1Solution.html" title="Just a placeholder for now.">Zoltan2::Solution</a> is created by the Problem. When passed to the algorithm, it may already contain some information about the type of solution desired. In particular, in the case of partitioning, the subclass <a class="el" href="classZoltan2_1_1PartitioningSolution.html" title="A PartitioningSolution is a solution to a partitioning problem.">Zoltan2::PartitioningSolution</a> contains the global number of parts to be created, the number of parts to be created for each process, and the relative part sizes. <br  />
</p>
<p>The algorithm writes the computed answer back to the Solution object. In particular, a partitioning algorithm writes back the assignment of part numbers to global identifiers. The user can obtain the solution by way of the method <a class="el" href="classZoltan2_1_1PartitioningProblem.html#a4dd5d631101f6f1371d5d0020d50aeaf" title="Get the solution to the problem.">Zoltan2::PartitioningProblem::getSolution()</a>.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Adapter&gt;</div>
<div class="line"><span class="keywordtype">void</span> myAlgorithm(</div>
<div class="line">  <span class="keyword">const</span> RCP&lt;const Environment&gt; &amp;env,</div>
<div class="line">  <span class="keyword">const</span> RCP&lt;Comm&lt;int&gt; &gt; &amp;problemComm,</div>
<div class="line">  <span class="keyword">const</span> RCP&lt;<span class="keyword">const</span> GraphModel&lt;typename Adapter::base_adapter_t&gt; &gt; &amp;graph,</div>
<div class="line">  RCP&lt;PartitioningSolution&lt;Adapter&gt; &gt; &amp;solution</div>
<div class="line">)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">typedef</span> <span class="keyword">typename</span> Adapter::lno_t <a class="code hl_typedef" href="mapRemotes_8cpp.html#a78e717933cd41c3f26b52bc5966ec1e6">lno_t</a>;     <span class="comment">// local ids</span></div>
<div class="line">  <span class="keyword">typedef</span> <span class="keyword">typename</span> Adapter::gno_t <a class="code hl_typedef" href="mapRemotes_8cpp.html#ae82f112ec3e63100c4a833ff6343e0ac">gno_t</a>;     <span class="comment">// global ids</span></div>
<div class="line">  <span class="keyword">typedef</span> <span class="keyword">typename</span> Adapter::scalar_t scalar_t;   <span class="comment">// scalars</span></div>
<div class="line"> </div>
<div class="line">  env-&gt;debug(DETAILED_STATUS, <span class="keywordtype">string</span>(<span class="stringliteral">&quot;Entering myAlgorithm&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> Teuchos::ParameterList &amp;pl = env-&gt;getParameters();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">size_t</span> numGlobalParts = solution-&gt;getTargetGlobalNumberOfParts();</div>
<div class="line">  <span class="keywordtype">size_t</span> numLocalParts = solution-&gt;getLocalNumberOfParts();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">size_t</span> numGlobalVtx = graph-&gt;getGlobalNumVertices();</div>
<div class="line">  <span class="keywordtype">size_t</span> numLocalVtx = graph-&gt;getLocalNumVertices();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="mapRemotes_8cpp.html#ae82f112ec3e63100c4a833ff6343e0ac">gno_t</a> *globalNumbers=NULL;</div>
<div class="line">  partId_t *partNumbers=NULL;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// ... (Allocate storage for solution, and solve the problem.)</span></div>
<div class="line"> </div>
<div class="line">  ArrayRCP&lt;const gno_t&gt; gnos = arcp(globalNumbers, 0, numGnos, <span class="keyword">true</span>);</div>
<div class="line">  ArrayRCP&lt;const partId_t&gt; gnoPart = arcp(partNumbers, 0, numGnos, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  solution-&gt;setParts(gnos, gnoPart);</div>
<div class="line"> </div>
<div class="line">  env-&gt;debug(DETAILED_STATUS, <span class="keywordtype">string</span>(<span class="stringliteral">&quot;Exiting myAlgorithm&quot;</span>);</div>
<div class="line">}</div>
<div class="ttc" id="amapRemotes_8cpp_html_a78e717933cd41c3f26b52bc5966ec1e6"><div class="ttname"><a href="mapRemotes_8cpp.html#a78e717933cd41c3f26b52bc5966ec1e6">lno_t</a></div><div class="ttdeci">map_t::local_ordinal_type lno_t</div><div class="ttdef"><b>Definition</b> <a href="mapRemotes_8cpp_source.html#l00026">mapRemotes.cpp:26</a></div></div>
<div class="ttc" id="amapRemotes_8cpp_html_ae82f112ec3e63100c4a833ff6343e0ac"><div class="ttname"><a href="mapRemotes_8cpp.html#ae82f112ec3e63100c4a833ff6343e0ac">gno_t</a></div><div class="ttdeci">map_t::global_ordinal_type gno_t</div><div class="ttdef"><b>Definition</b> <a href="mapRemotes_8cpp_source.html#l00027">mapRemotes.cpp:27</a></div></div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="z2_developer_environment"></a>
The Environment</h1>
<p>The <a class="el" href="classZoltan2_1_1Environment.html" title="The user parameters, debug, timing and memory profiling output objects, and error checking methods.">Zoltan2::Environment</a> object is created by the <a class="el" href="classZoltan2_1_1Problem.html" title="Problem base class from which other classes (PartitioningProblem, ColoringProblem,...">Zoltan2::Problem</a>. It is passed to almost every method in the library. It serves the following roles:</p>
<ul>
<li>It has the Teuchos::ParameterList that was set by the user, which has been processed by running the parameter list validators.</li>
<li>It enables the library behavior that was requested by the user via parameters such as:<ul>
<li>debug_level</li>
<li>debug_output_stream</li>
<li>error_check_level</li>
<li>memory_output_stream</li>
<li>timer_type</li>
</ul>
</li>
</ul>
<p>The algorithm uses the Environment to obtain algorithm-specific parameters that may have been set by the user. It also uses Environment methods to print out warnings and status information, handle exceptions, time algorithm steps, and display information about the amount of memory in use.</p>
<hr  />
 <h1><a class="anchor" id="z2_developer_ids"></a>
Global identifiers and data types</h1>
<p><a class="el" href="namespaceZoltan2.html" title="Created by mbenlioglu on Aug 31, 2020.">Zoltan2</a> is a package in the <a href="http://trilinos.org/">Trilinos</a> framework and it uses the linear algebra classes in the templated Tpetra package. The data types permitted for global identifiers in Tpetra are those for which specializations of the Teuchos::OrdinalTraits exist. In particular we use <code>int</code> or <code>long</code> internally for the global identifiers of linear algebra objects.</p>
<p>For historical reasons, <a class="el" href="namespaceZoltan2.html" title="Created by mbenlioglu on Aug 31, 2020.">Zoltan2</a> allows the user a broader range of data types for their identifiers. In particular, any data type for which a specialization of Zoltan2::IdentifierTraits is defined is allowed. For example, a global identifier could be a std::pair&lt;int, int&gt; to represent matrix non-zeros <em> (i, j) </em>. Or the global identifier could be an arbitrary string.</p>
<p>If the user's global identifiers are not <a class="el" href="namespaceTeuchos.html">Teuchos</a> Ordinals, the <a class="el" href="classZoltan2_1_1Model.html" title="The base class for all model classes.">Zoltan2::Model</a> maps them to new global identifiers which <em>are</em> <a class="el" href="namespaceTeuchos.html">Teuchos</a> Ordinals.</p>
<p>By convention we use these typedef names:</p>
<ul>
<li><b>gid_t</b> (global id) the data type of the user's global identifiers </li>
<li><b>gno_t</b> (global number) our internal global identifier</li>
</ul>
<p>It is obviously more efficient if <a class="el" href="namespaceZoltan2.html" title="Created by mbenlioglu on Aug 31, 2020.">Zoltan2</a> can use the user's global identifiers without having to map them. We have to map them only if:</p>
<ul>
<li>the <code>gid_t</code> is not a <a class="el" href="namespaceTeuchos.html">Teuchos</a> Ordinal or,</li>
<li>the algorithm requires consecutive global ids and the user did not provide consecutive ids</li>
</ul>
<p>The <a class="el" href="classZoltan2_1_1Solution.html" title="Just a placeholder for now.">Zoltan2::Solution</a> object uses mapping information in the <a class="el" href="classZoltan2_1_1Model.html" title="The base class for all model classes.">Zoltan2::Model</a> to map the internal <code>gno_t</code> ids back to the user's <code>gid_t</code> ids if necessary. In this way, the algorithm can work with <code>gno_t</code> ids and supply these to the Solution, but the user can retrieve <code>gid_t</code> ids.</p>
<p>The complexity of mapping between user global identifiers and internal global identifiers is encapsulated in the <a class="el" href="classZoltan2_1_1Model.html" title="The base class for all model classes.">Zoltan2::Model</a>.</p>
<hr  />
 <h1><a class="anchor" id="z2_developer_naming"></a>
Naming</h1>
<p>All <a class="el" href="namespaceZoltan2.html" title="Created by mbenlioglu on Aug 31, 2020.">Zoltan2</a> symbols are in the namespace <b><a class="el" href="namespaceZoltan2.html" title="Created by mbenlioglu on Aug 31, 2020.">Zoltan2</a></b>.</p>
<p>We follow the Trilinos naming conventions. They are detailed in a document in directory Trilinos/doc/TrilinosCodingDocGuidelines.</p>
<p>Templated code is in <b></b>.hpp files and non-templated code is in <b></b>.cpp files.</p>
<hr  />
 <h1><a class="anchor" id="z2_developer_exceptions"></a>
Error handling</h1>
<p>We check for three types of errors:</p>
<ul>
<li><b>bug</b> which is an event that would not occur if the code had been written correctly (throws a std::logic_error) </li>
<li><b>input</b> which is an error is due to bad user data or parameter values (throws a std::runtime_error) </li>
<li><b>memory</b> which is when we are unable to allocate the needed memory (throws a std::bad_alloc)</li>
</ul>
<p>In addition, a check can be local or global. In a global check, all processes report an error if any process has an error. Local checks are non-synchronizing.</p>
<p>Each check also has a level of complexity. Some can be done with one or two comparisons and some require more work. Also, there are some checks we only want to do in a special <em>debug</em> mode.</p>
<p>The user specifies the level of error checking to do with the <code>error_check_level</code> parameter. It can be set to one of these strings:</p>
<ul>
<li><code>no_assertions</code> </li>
<li><code>basic_assertions</code> </li>
<li><code>complex_assertions</code> </li>
<li><code>debug_mode_assertions</code> </li>
</ul>
<p>The default is <code>basic_assertions</code>. If the user requests <code>complex_assertions</code>, the lengthier checks will be done as well. If the users requests <code>debug_mode_assertions</code> , all checking will be done.</p>
<p>If the user sets <code>error_check_level</code> to <code>no_assertions</code> then none of the checks will be done. In addition, if <a class="el" href="namespaceZoltan2.html" title="Created by mbenlioglu on Aug 31, 2020.">Zoltan2</a> is compiled with the Z2_OMIT_ALL_ERROR_CHECKING flag, the error check methods do nothing. So in this case there is not even a comparison of the check level to the requested check level.</p>
<p>The methods that perform the tests are in the <a class="el" href="classZoltan2_1_1Environment.html" title="The user parameters, debug, timing and memory profiling output objects, and error checking methods.">Zoltan2::Environment</a>. They are:</p>
<ul>
<li><a class="el" href="classZoltan2_1_1Environment.html#a346382bec68257830cccb1eb9fab73b8" title="Test for valid user input on local process only.">Zoltan2::Environment::localInputAssertion()</a></li>
<li><a class="el" href="classZoltan2_1_1Environment.html#aa3f6ae2523ea1a717a05e8c5d0ff9182" title="Test globally for valid user input.">Zoltan2::Environment::globalInputAssertion()</a></li>
<li><a class="el" href="classZoltan2_1_1Environment.html#aa81247dff503659d9efe358084cd112e" title="Test for valid library behavior on local process only.">Zoltan2::Environment::localBugAssertion()</a></li>
<li><a class="el" href="classZoltan2_1_1Environment.html#adbb0038eb5e0877a028ee88b1d77e3cd" title="Test for valid library behavior on every process.">Zoltan2::Environment::globalBugAssertion()</a></li>
<li><a class="el" href="classZoltan2_1_1Environment.html#ac436445ae7d7454996460244f9e5dba2" title="Test for successful memory allocation on local process only.">Zoltan2::Environment::localMemoryAssertion()</a></li>
<li><a class="el" href="classZoltan2_1_1Environment.html#ae07281601c19788e8fd301ae1da67219" title="Test for successful memory allocation on every process.">Zoltan2::Environment::globalMemoryAssertion()</a></li>
</ul>
<p>The <a class="el" href="namespaceZoltan2.html#aa5647ff710d93088b7a1d04d16dbb28b" title="Level of error checking or assertions desired.">Zoltan2::AssertionLevel</a> enumerator defines the levels that are provided in the calls. <br  />
</p>
<hr  />
 <h1><a class="anchor" id="z2_developer_status_info"></a>
Status and debugging output</h1>
<p>The following parameters govern behavior of messages from <a class="el" href="namespaceZoltan2.html" title="Created by mbenlioglu on Aug 31, 2020.">Zoltan2</a>:</p>
<ul>
<li>debug_level which is the amount of verbosity</li>
<li>debug_procs which specifies the processes that will print output</li>
<li>debug_output_file which is the name of a file to receive the output (the rank of the process doing the output is appended to the file name)</li>
<li>debug_output_stream which can be <code>cout</code> or <code>cerr</code> </li>
</ul>
<p>The <a class="el" href="classZoltan2_1_1Environment.html#a522aac8101d631bcf4141ac72bb0c1c6" title="Send a message to the debug output manager.">Zoltan2::Environment::debug()</a> message is used for printing out debug and status information and warnings. The call should specify the <a class="el" href="namespaceZoltan2.html#a6cae7ee10d21c7dada0507a5fec0fea4" title="The amount of debugging or status output to print.">Zoltan2::MessageOutputLevel</a> (the verbosity of the message).</p>
<p>The <a class="el" href="classZoltan2_1_1Environment.html#a9a5d1c52b4a0f51c4880b99d2b21cafa">Zoltan2::Environment::getDebugLevel()</a> call should be checked before creating a lengthy message. This will ensure that work is not done for a detailed message if the users <code>debug_level</code> parameter did not request it.</p>
<hr  />
 <h1><a class="anchor" id="z2_developer_profiling"></a>
Profiling</h1>
<p>The <a class="el" href="classZoltan2_1_1Environment.html" title="The user parameters, debug, timing and memory profiling output objects, and error checking methods.">Zoltan2::Environment</a> object which is passed to almost every function has methods that can be used to time sections of code and (on Linux systems) to print out the memory in use by the process. The behavior of these methods depends on the how the user set these parameters:</p>
<ul>
<li>memory_output_file</li>
<li>memory_output_stream</li>
<li>memory_procs</li>
<li>timer_output_file</li>
<li>timer_output_stream</li>
<li>timer_type</li>
</ul>
<p>The memory count is read from <code> /proc/{pid}/statm </code> and output to the designated file or stream while the application is running. The timers are managed by a Teuchos::TimeMonitor object in the Problem. The timer summary is output to the designated file or stream and timers are reset to zero when the application calls <a class="el" href="classZoltan2_1_1Problem.html#a9eefe7e2cf59f6cb1927d858e1001eca" title="Return the communicator passed to the problem.">Zoltan2::Problem::printTimers()</a>.</p>
<p>For timers, the concept of timer_type refers to the concept of <code> macro_timers </code> and <code> micro_timers </code>. In general, the micro timers time subsets of actions that are timed by the macro timers. At run-time you can choose which timers to activate. For developers, there are also <code> test_timers </code> These are timers you may add while doing development or doing performance studies. The expectation is that you will remove them when done.</p>
<hr  />
 <h1><a class="anchor" id="z2_developer_rcp"></a>
Use of Teuchos smart pointers</h1>
<p>Smart pointers remove the need for the programmer to keep track of when memory must be freed. Teucho smart pointers in addition can do array bounds checking when compiled with the cmake configuration flag <b>Teuchos_ENABLE_ABC</b> (automatic bounds check).</p>
<p>We use the following <a class="el" href="namespaceTeuchos.html">Teuchos</a> memory management classes in <a class="el" href="namespaceZoltan2.html" title="Created by mbenlioglu on Aug 31, 2020.">Zoltan2</a>:</p>
<ul>
<li>Teuchos::RCP and Teuchos::ArrayRCP for pointers to a single object or an array that persists outside of a function. We use these for class data. They have reference counters that keep track of how many pointers to the memory exist. When the reference counter returns to 0, the memory is automatically freed.</li>
</ul>
<ul>
<li>Teuchos::Ptr and Teuchos::Array wrap pointers to a single object or to an array, but without reference counting. The reason to use them is to be able to do bounds checking. They are used for data that does not persist outside fo the scope in which it is created. An <b>Array</b> is dynamic in size and implements much of the <b>std::vector</b> interface.</li>
</ul>
<p>Teuchos::RCP and Teuchos::ArrayRCP can also be used for non-persisting data if you want an easy way to ensure that the memory will be freed upon leaving the scope in which the memory was allocated.</p>
<p>In addition, Teuchos::Tuple can be used for small fixed size arrays. Teuchos::ArrayView is used for function arguments that were passed as Teuchos::ArrayRCP (and will not be <em>saved</em> by the function) or Teuchos::Array. (If the function is a class method that will hold on to the array in the class instance, then the function argument should be a reference to a Teuchos::ArrayRCP so it will be counted.)</p>
<p>Using <a class="el" href="namespaceTeuchos.html">Teuchos</a> memory management classes can increase the time to write code, and make code a little harder to read, but once the code compiles it is very unlikely that a memory error will be found later on.</p>
<p>A detailed report on <a class="el" href="namespaceTeuchos.html">Teuchos</a> memory management classes can be found in the directory Trilinos/doc/TeuchosMemoryManagementSAND.</p>
<hr  />
 <h1><a class="anchor" id="z2_developer_parameters"></a>
How to add a parameter</h1>
<p><a class="el" href="namespaceZoltan2.html" title="Created by mbenlioglu on Aug 31, 2020.">Zoltan2</a> uses Teuchos::ParameterList and Teuchos::ParameterEntryValidator. To add another parameter you add it to XML definition of the ParameterList in zoltan2/data/parameters.xml. <br  />
</p>
<p>At compile time, the program zoltan2/util/xmlToHeaderDefinition.cpp creates the header file <code>{zoltan2_binary_directory}/src/Zoltan2_XML_Parameters.hpp</code>. <br  />
 This header file contains a macro that has the XML string defining the parameters. It is used at run-time in the namespace method <a class="el" href="namespaceZoltan2.html#ac126cde096a09a8a03d79489e085bb55" title="Create a list of all Zoltan2 parameters and validators.">Zoltan2::createAllParameters()</a>.</p>
<p>When building the <a class="el" href="namespaceZoltan2.html" title="Created by mbenlioglu on Aug 31, 2020.">Zoltan2</a> documentation with zoltan2/doc/build_docs, the script zoltan2/scripts/xml2dox.py creates the Doxygen page in zoltan2/doc/parameters.dox. A link appears at the <em>Related Pages</em> tab.</p>
<p>The XML formats for the validator are documented here:</p>
<ul>
<li>Teuchos::StringToIntegralValidatorXMLConverter</li>
<li>Teuchos::AnyNumberValidatorXMLConverter</li>
<li>Teuchos::EnhancedNumberValidatorXMLConverter</li>
<li>Teuchos::FileNameValidatorXMLConverter</li>
<li>Teuchos::StringValidatorXMLConverter</li>
<li><a class="el" href="classZoltan2_1_1IntegerRangeListValidatorXMLConverter.html" title="XML conversion code for IntegerRangeListValidator.">Zoltan2::IntegerRangeListValidatorXMLConverter</a></li>
</ul>
<p>The XML format for the parameter is:</p>
<div class="fragment"><div class="line">&lt;Parameter</div>
<div class="line">  <span class="keywordtype">id</span>=<span class="stringliteral">&quot;unique number for this parameter&quot;</span> </div>
<div class="line">  name=<span class="stringliteral">&quot;name of this parameter&quot;</span> </div>
<div class="line">  type=<span class="stringliteral">&quot;data type of value used to set parameter&quot;</span> </div>
<div class="line">  validatorId=<span class="stringliteral">&quot;id number for validator for this parameter&quot;</span> </div>
<div class="line">  value=<span class="stringliteral">&quot;any valid value for this parameter&quot;</span></div>
<div class="line">  docString=<span class="stringliteral">&quot;description of parameter that will appear in documentation&quot;</span></div>
<div class="line">  /&gt;</div>
</div><!-- fragment --><p>The <code>docString</code> in the <code>Parameter</code> element does not need to include information (like a list of valid strings) that is included in the <code>Validator</code> element. When parameter documentation is generated, either by <a class="el" href="namespaceTeuchos.html">Teuchos</a> at run-time or by a script in <code>doc/build_docs</code>, it includes the validator information.</p>
<hr  />
 <h1><a class="anchor" id="z2_developer_documentation"></a>
Documenting an algorithm</h1>
<p>Each algorithm that can be chosen by a user with the <a class="el" href="dir_f5d87214c5ea5bee98699e4fc9f2122d.html">algorithm</a> parameter should be completely documented for users with a file in zoltan2/doc/algorithms. Follow the pattern of the other documentation files in that directory. Then add a link to your page on the introductory page at <a class="el" href="index_8dox.html">zoltan2/doc/index.dox</a>.</p>
<hr  />
 <h1><a class="anchor" id="z2_developer_example"></a>
Example</h1>
<p>The block algorithm in <a class="el" href="Zoltan2__AlgBlock_8hpp.html" title="The algorithm for block partitioning.">Zoltan2_AlgBlock.hpp</a> is a simple example of a <a class="el" href="namespaceZoltan2.html" title="Created by mbenlioglu on Aug 31, 2020.">Zoltan2</a> algorithm. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
