<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Phalanx: PHX::MemoryManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Phalanx<span id="projectnumber">&#160;Development</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>PHX</b></li><li class="navelem"><a class="el" href="classPHX_1_1MemoryManager.html">MemoryManager</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classPHX_1_1MemoryManager-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">PHX::MemoryManager Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This object is siimilar to a memory pool in that allows for reuse of view allocations across the DAG and in other DataContainers and FieldManagers.  
 <a href="classPHX_1_1MemoryManager.html#details">More...</a></p>

<p><code>#include &lt;Phalanx_MemoryManager.hpp&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a84d4de99b8b7b9b999299edc1ce05286" id="r_a84d4de99b8b7b9b999299edc1ce05286"><td class="memItemLeft" align="right" valign="top"><a id="a84d4de99b8b7b9b999299edc1ce05286" name="a84d4de99b8b7b9b999299edc1ce05286"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MemoryManager</b> (const <a class="el" href="classPHX_1_1MemoryManager.html">MemoryManager</a> &amp;mp)</td></tr>
<tr class="memdesc:a84d4de99b8b7b9b999299edc1ce05286"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a new memory pool re-using allocations from other linked MemoryManagers. <br /></td></tr>
<tr class="separator:a84d4de99b8b7b9b999299edc1ce05286"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad5288bd8a388209257d92c49e564662" id="r_aad5288bd8a388209257d92c49e564662"><td class="memItemLeft" align="right" valign="top"><a id="aad5288bd8a388209257d92c49e564662" name="aad5288bd8a388209257d92c49e564662"></a>
std::shared_ptr&lt; <a class="el" href="classPHX_1_1MemoryManager.html">PHX::MemoryManager</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>clone</b> () const</td></tr>
<tr class="memdesc:aad5288bd8a388209257d92c49e564662"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clones <a class="el" href="classPHX_1_1MemoryManager.html" title="This object is siimilar to a memory pool in that allows for reuse of view allocations across the DAG ...">MemoryManager</a> to reuse tracker allocations with a separate <a class="el" href="classPHX_1_1FieldManager.html">FieldManager</a>. <br /></td></tr>
<tr class="separator:aad5288bd8a388209257d92c49e564662"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b4bb4cfa16ca2e875cf40550c0c4311" id="r_a4b4bb4cfa16ca2e875cf40550c0c4311"><td class="memTemplParams" colspan="2"><a id="a4b4bb4cfa16ca2e875cf40550c0c4311" name="a4b4bb4cfa16ca2e875cf40550c0c4311"></a>
template&lt;typename EvaluationType &gt; </td></tr>
<tr class="memitem:a4b4bb4cfa16ca2e875cf40550c0c4311"><td class="memTemplItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memTemplItemRight" valign="bottom"><b>getAllocationSize</b> (const <a class="el" href="classPHX_1_1FieldTag.html">PHX::FieldTag</a> &amp;tag, const std::vector&lt; PHX::index_size_type &gt; extended_dimensions)</td></tr>
<tr class="memdesc:a4b4bb4cfa16ca2e875cf40550c0c4311"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the size required for the allocated view. This includes padding if relevant. <br /></td></tr>
<tr class="separator:a4b4bb4cfa16ca2e875cf40550c0c4311"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b7fcebe32134d986be9e54b314eff4b" id="r_a7b7fcebe32134d986be9e54b314eff4b"><td class="memTemplParams" colspan="2">template&lt;class EvaluationType &gt; </td></tr>
<tr class="memitem:a7b7fcebe32134d986be9e54b314eff4b"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classPHX_1_1MemoryManager.html#a7b7fcebe32134d986be9e54b314eff4b">createView</a> (std::any &amp;field, Kokkos::Impl::SharedAllocationTracker &amp;tracker, const std::size_t &amp;allocation_size_in_bytes, const <a class="el" href="classPHX_1_1FieldTag.html">PHX::FieldTag</a> &amp;tag, const std::vector&lt; PHX::index_size_type &gt; &amp;extended_dimensions)</td></tr>
<tr class="memdesc:a7b7fcebe32134d986be9e54b314eff4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assigns memory to a view, allocates new memory if needed.  <br /></td></tr>
<tr class="separator:a7b7fcebe32134d986be9e54b314eff4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3d81b571ceb8b0bba886ea867e827c8" id="r_ab3d81b571ceb8b0bba886ea867e827c8"><td class="memTemplParams" colspan="2">template&lt;class EvaluationType &gt; </td></tr>
<tr class="memitem:ab3d81b571ceb8b0bba886ea867e827c8"><td class="memTemplItemLeft" align="right" valign="top">std::any&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classPHX_1_1MemoryManager.html#ab3d81b571ceb8b0bba886ea867e827c8">createViewFromAllocationTracker</a> (const <a class="el" href="classPHX_1_1FieldTag.html">PHX::FieldTag</a> &amp;tag, const std::vector&lt; PHX::index_size_type &gt; &amp;extended_dimensions, Kokkos::Impl::SharedAllocationTracker &amp;tracker)</td></tr>
<tr class="memdesc:ab3d81b571ceb8b0bba886ea867e827c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Created a kokkos view using a supplied tracker.  <br /></td></tr>
<tr class="separator:ab3d81b571ceb8b0bba886ea867e827c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1e33dceaa601ddfe0c48dfc06190368" id="r_af1e33dceaa601ddfe0c48dfc06190368"><td class="memItemLeft" align="right" valign="top"><a id="af1e33dceaa601ddfe0c48dfc06190368" name="af1e33dceaa601ddfe0c48dfc06190368"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>insertTracker</b> (Kokkos::Impl::SharedAllocationTracker &amp;t)</td></tr>
<tr class="memdesc:af1e33dceaa601ddfe0c48dfc06190368"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inserts tracker. <br /></td></tr>
<tr class="separator:af1e33dceaa601ddfe0c48dfc06190368"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This object is siimilar to a memory pool in that allows for reuse of view allocations across the DAG and in other DataContainers and FieldManagers. </p>
<p>A field may only be used in a small section of the DAG. After topological sorting, we can find the span of evaluators in the sorted list that the field must exist over. Outside of this range, the view memory can be reused by other views that don't overlap within the same DAG.</p>
<p>An additional feature is that since only one evaluation type of one <a class="el" href="classPHX_1_1FieldManager.html">FieldManager</a> is run at a time, phalanx can also reuse view allocations for different evaluation types in the same <a class="el" href="classPHX_1_1FieldManager.html">FieldManager</a> and over all evaluation types in other FieldManagers. A special clone method exists that creates a new <a class="el" href="classPHX_1_1MemoryManager.html" title="This object is siimilar to a memory pool in that allows for reuse of view allocations across the DAG ...">MemoryManager</a>, pointing to the same allocations, but resetting the tracker objects for a new <a class="el" href="classPHX_1_1FieldManager.html">FieldManager</a> or DataContainer. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a7b7fcebe32134d986be9e54b314eff4b" name="a7b7fcebe32134d986be9e54b314eff4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b7fcebe32134d986be9e54b314eff4b">&#9670;&#160;</a></span>createView()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class EvaluationType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PHX::MemoryManager::createView </td>
          <td>(</td>
          <td class="paramtype">std::any &amp;&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Kokkos::Impl::SharedAllocationTracker &amp;&#160;</td>
          <td class="paramname"><em>tracker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::size_t &amp;&#160;</td>
          <td class="paramname"><em>allocation_size_in_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classPHX_1_1FieldTag.html">PHX::FieldTag</a> &amp;&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; PHX::index_size_type &gt; &amp;&#160;</td>
          <td class="paramname"><em>extended_dimensions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Assigns memory to a view, allocates new memory if needed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">field</td><td>A newly created <a class="el" href="classKokkos_1_1View.html">Kokkos::View</a> wrapped in an any object. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tracker</td><td>The SharedAllocatoinTracker for the created view's memory. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">allocation_size_in_bytes</td><td>Required size of the allocation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tag</td><td><a class="el" href="classPHX_1_1FieldTag.html">FieldTag</a> with information for creating the new view. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">extended_dimensions</td><td>Size of any hidden dimensions for the scalar type. This can be empty for types that don't have hidden dimensions. </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="classPHX_1_1FieldTag.html#a55cd95e5669fd62388ef9a012b4da205">PHX::FieldTag::identifier()</a>.</p>

</div>
</div>
<a id="ab3d81b571ceb8b0bba886ea867e827c8" name="ab3d81b571ceb8b0bba886ea867e827c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3d81b571ceb8b0bba886ea867e827c8">&#9670;&#160;</a></span>createViewFromAllocationTracker()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class EvaluationType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::any PHX::MemoryManager::createViewFromAllocationTracker </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classPHX_1_1FieldTag.html">PHX::FieldTag</a> &amp;&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; PHX::index_size_type &gt; &amp;&#160;</td>
          <td class="paramname"><em>extended_dimensions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Kokkos::Impl::SharedAllocationTracker &amp;&#160;</td>
          <td class="paramname"><em>tracker</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Created a kokkos view using a supplied tracker. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tag</td><td>A <a class="el" href="classPHX_1_1FieldTag.html">FieldTag</a> with information for creating the new view. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">extended_dimensions</td><td>Size of any hidden dimensions for the scalar type. This can be empty for types that don't have hidden dimensions. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tracker</td><td>The SharedAllocatoinTracker for the created view's memory.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Newly created view wrapped in an any object. </dd></dl>

<p class="reference">References <a class="el" href="classPHX_1_1FieldTag.html#a55cd95e5669fd62388ef9a012b4da205">PHX::FieldTag::identifier()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><b>Phalanx_MemoryManager.hpp</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
