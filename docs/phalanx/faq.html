<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Phalanx: Frequently Asked Questions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Phalanx<span id="projectnumber">&#160;Development</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Frequently Asked Questions</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Questions"></a>
Questions</h1>
<p><a class="el" href="faq.html#faq1">1. Why name it Phalanx? <br  />
</a></p>
<p><a class="el" href="faq.html#faq2">2. Why does the evaluation type exist?</a></p>
<p><a class="el" href="faq.html#faq3">3. Why do evaluation types have arbitrary data types. Shouldn't all fields of an evaluation type require the same scalar type?</a></p>
<p><a class="el" href="faq.html#faq4">4. Why are the evaluators templated on the evaluation type?</a></p>
<p><a class="el" href="faq.html#faq5">5. Why is the MDALayout object not templated on the ArrayOrder type?</a></p>
<p><a class="el" href="faq.html#faq6">6. My code seems to be running slow. How can I speed it up?</a></p>
<p><a class="el" href="faq.html#faq7">7. Compilation take a long time when minor changes are made to an evaluator. How can I speed this up?</a></p>
<p><a class="el" href="faq.html#faq8">8. Valgrind gives a memory leak error in all evaluators when using the PHX::ContiguousAllocator with Sacado::DFad based fields. What is the problem?</a></p>
<p><a class="el" href="faq.html#faq9">9. The evaluators contain boilerplate. Is there an easy way to automate creating the evaluators?</a></p>
<h1><a class="anchor" id="faq1"></a>
1. Why name it Phalanx?  &lt;br&gt;</h1>
<p>The phalanx was one of the most dominant military formations of the Greek armies in the classical period. It was a strictly ordered formation. The Phalanx software library figures out ordered dependencies of field evaluators. A second more obscure reference relates to the US Navy. The Phalanx software package was designed to provide nonlinear functionality for the <a href="http://trilinos.sandia.gov/packages/intrepid">Intrepid</a> itegration library. Intrepid was the name of an aircraft carrier during in WW II. Modern US aircraft carriers are protected by a Close-In Weapons System (CIWS) named the Phalanx. Finally, the PI of this project is an avid strategy warfare gamer and leans towards military references.</p>
<h1><a class="anchor" id="faq2"></a>
2. Why does the evaluation type exist?</h1>
<p>This allows for multiple evaluations that used the same Scalar type, but different evaluators specific to the CalculationType. For example, evaluating the Jacobian (derivative of the residual with respect to the degrees of freedom) and the parameter sensitivities (derivative of the residual with respect to the parameters) both use the same Sacado data type. They both want derivatives but with respect to a different set of entities.</p>
<h1><a class="anchor" id="faq3"></a>
3. Why do evaluation types have arbitrary data types.  Shouldn't all fields of an evaluation type require the same scalar type?</h1>
<p>In 99% of the use cases, the answer is yes! By changing the scalar type for a specific type of computation, you can break the dependency chain and get incorrect answers. For example, if computing a Jacobian, you would use a FAD scalar type instead of a double scalar type for the evaluation. By mixing FAD and double fields in an evaluation type, you will lose derivative components and get incorrect sensitivities. But there are some use cases where one might want to use different data types. If the user knows that certain evaluation routines have no derivative components, they can bypass the AD chain by switching to doubles for that part of the computation. The is an expert only user mode, but we allow for it.</p>
<h1><a class="anchor" id="faq4"></a>
4. Why are the evaluators templated on the evaluation type?</h1>
<p>Each evaluator must be templated on the evaluation type to be able to (1) allow for the expert use mode described in FAQ <a class="el" href="faq.html#faq3">3. Why do evaluation types have arbitrary data types. Shouldn't all fields of an evaluation type require the same scalar type?</a>; (2) use the automated factory class (<a class="el" href="classPHX_1_1EvaluatorFactory.html">PHX::EvaluatorFactory</a>) to build the evaluator for each evalution type. <br  />
</p>
<h1><a class="anchor" id="faq5"></a>
5. Why is the MDALayout object not templated on the ArrayOrder type?</h1>
<p>This introduces many complications in the comparison operator (operator==) during a comparison of a reverse and natural data layout with the same (but reversed index types). Should these objects be the same? Probably, but this might introduce some confusion. So in an effort to keep things as clean as possible, there is no differentiation based on forward or reverse (Fortran) array ordering. If we were to introduce this, then we would have to add another method to the DataLayout base class to allow for checking the ordering. If mixing natural and reverse ordering becomes common, we may revisit this decision.</p>
<h1><a class="anchor" id="faq6"></a>
6. My code seems to be running slow.  How can I speed it up?</h1>
<p>See the section on <a class="el" href="user_guide.html#performance">Performance</a> in the Users Guide that gives recomendations on how to maximize the efficiency of your code.</p>
<h1><a class="anchor" id="faq7"></a>
7. Compilation take a long time when minor changes are made to an evaluator.  How can I speed this up?</h1>
<p>Explicit template instantiation can be used to speed up evaluator development builds. See the section on <a class="el" href="user_guide.html#performance">Performance</a> in the Users Guide. <br  />
</p>
<h1><a class="anchor" id="faq8"></a>
8. Valgrind gives a memory leak error in all evaluators when using the PHX::ContiguousAllocator with Sacado::DFad based fields.  What is the problem?</h1>
<p>The contiguous allocator is allocating space for all variables in an evaluation type in a single contiguous chunk of memory. We allow for multiple scalar types in an evaluation type so the array is allocated using the type char and then based on scalar type sizes (using sizeof method) along with proper alignment, pointers to blocks of memory are handed to the fields using a reinterpret_cast. DFad uses new to allocate the derivative arrays, so this memory is not contiguous. The problem is that the field array memory is deleted as a char instead of it's various data types, so all DFad derivative arrays are leaked during the destruction. There are two ways to alleviate this: (1) write a special Allocator to call the destructor of the field type for each field. (2) Have Sacado implement a version of DFad that allows the user to allocate the DFad array and pass in the pointer during construction. This will also require a new allocator. Choice (2) will be handed in Phalanx in a later release. Our current suggestion is that one should use DFad only if using the PHX::NewAllocator and use SFad if using the PHX::ContiguousAllocator.</p>
<h1><a class="anchor" id="faq9"></a>
9. The evaluators contain boilerplate.  Is there an easy way to automate creating the evaluators?</h1>
<p>YES! There is a python script that will automatically generate the skeleton for evaluators. It is found in the "scripts" directory of phalanx and is called "phalanx_create_evaluator.py". It will be install in the "bin" directory when trilinos is installed. Example use can be found at the end of section <a class="el" href="user_guide.html#user_guide_step5">Step 5: Write your Evaluators</a> of the <a class="el" href="user_guide.html">Users Guide</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
