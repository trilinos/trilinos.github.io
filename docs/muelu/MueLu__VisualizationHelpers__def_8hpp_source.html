<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MueLu: MueLu_VisualizationHelpers_def.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MueLu<span id="projectnumber">&#160;Version of the Day</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('MueLu__VisualizationHelpers__def_8hpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">MueLu_VisualizationHelpers_def.hpp</div></div>
</div><!--header-->
<div class="contents">
<a href="MueLu__VisualizationHelpers__def_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// @HEADER</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">// *****************************************************************************</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">//        MueLu: A package for multigrid based preconditioning</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">//</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">// Copyright 2012 NTESS and the MueLu contributors.</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">// SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">// *****************************************************************************</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">// @HEADER</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span> </div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#ifndef MUELU_VISUALIZATIONHELPERS_DEF_HPP_</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#define MUELU_VISUALIZATIONHELPERS_DEF_HPP_</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span> </div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &lt;Xpetra_Matrix.hpp&gt;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &lt;Xpetra_CrsMatrixWrap.hpp&gt;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &lt;Xpetra_ImportFactory.hpp&gt;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;Xpetra_MultiVectorFactory.hpp&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &quot;<a class="code" href="MueLu__VisualizationHelpers__decl_8hpp.html">MueLu_VisualizationHelpers_decl.hpp</a>&quot;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &quot;<a class="code" href="MueLu__Level_8hpp.html">MueLu_Level.hpp</a>&quot;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;list&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span> </div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespaceMueLu.html">MueLu</a> {</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span> </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00028" data-start="{" data-end="}">
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#ac7167aaaddd98ebebc0df2519ffb5b4a">   28</a></span>RCP&lt;ParameterList&gt; <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#ac7167aaaddd98ebebc0df2519ffb5b4a">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::GetValidParameterList</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>  RCP&lt;ParameterList&gt; validParamList = rcp(<span class="keyword">new</span> ParameterList());</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span> </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>  validParamList-&gt;set&lt;std::string&gt;(<span class="stringliteral">&quot;visualization: output filename&quot;</span>, <span class="stringliteral">&quot;viz%LEVELID&quot;</span>, <span class="stringliteral">&quot;filename for VTK-style visualization output&quot;</span>);</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>  validParamList-&gt;set&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;visualization: output file: time step&quot;</span>, 0, <span class="stringliteral">&quot;time step variable for output file name&quot;</span>);       <span class="comment">// Remove me?</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>  validParamList-&gt;set&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;visualization: output file: iter&quot;</span>, 0, <span class="stringliteral">&quot;nonlinear iteration variable for output file name&quot;</span>);  <span class="comment">// Remove me?</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>  validParamList-&gt;set&lt;std::string&gt;(<span class="stringliteral">&quot;visualization: style&quot;</span>, <span class="stringliteral">&quot;Point Cloud&quot;</span>, <span class="stringliteral">&quot;style of aggregate visualization for VTK output. Can be &#39;Point Cloud&#39;, &#39;Jacks&#39;, &#39;Convex Hulls&#39;&quot;</span>);</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>  validParamList-&gt;set&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;visualization: build colormap&quot;</span>, <span class="keyword">false</span>, <span class="stringliteral">&quot;Whether to build a random color map in a separate xml file.&quot;</span>);</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>  validParamList-&gt;set&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;visualization: fine graph edges&quot;</span>, <span class="keyword">false</span>, <span class="stringliteral">&quot;Whether to draw all fine node connections along with the aggregates.&quot;</span>);</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span> </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>  <span class="keywordflow">return</span> validParamList;</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>}</div>
</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span> </div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00042" data-start="{" data-end="}">
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#abe7a55f57c0c4da7f1e3729dad6ced04">   42</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#abe7a55f57c0c4da7f1e3729dad6ced04">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::doPointCloud</a>(std::vector&lt;int&gt;&amp; vertices, std::vector&lt;int&gt;&amp; geomSizes, LO <span class="comment">/* numLocalAggs */</span>, LO numFineNodes) {</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>  vertices.reserve(numFineNodes);</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>  geomSizes.reserve(numFineNodes);</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="MueLu__UseDefaultTypes_8hpp.html#a226b8cca25ba3f3d741bc52854fe8601">LocalOrdinal</a> i = 0; i &lt; numFineNodes; i++) {</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>    vertices.push_back(i);</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    geomSizes.push_back(1);</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>  }</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>}</div>
</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span> </div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00052" data-start="{" data-end="}">
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#aee1120cdadcbd2a44d9ce81e98b4f002">   52</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#aee1120cdadcbd2a44d9ce81e98b4f002">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::doJacks</a>(std::vector&lt;int&gt;&amp; vertices, std::vector&lt;int&gt;&amp; geomSizes, LO numLocalAggs, LO numFineNodes, <span class="keyword">const</span> std::vector&lt;bool&gt;&amp; isRoot, <span class="keyword">const</span> ArrayRCP&lt;LO&gt;&amp; vertex2AggId) {</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>  <span class="comment">// For each aggregate, find the root node then connect it with the other nodes in the aggregate</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>  <span class="comment">// Doesn&#39;t matter the order, as long as all edges are found.</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>  vertices.reserve(vertices.size() + 3 * (numFineNodes - numLocalAggs));</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>  geomSizes.reserve(vertices.size() + 2 * (numFineNodes - numLocalAggs));</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>  <span class="keywordtype">int</span> root = 0;</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numLocalAggs; i++)  <span class="comment">// TODO: Replace this O(n^2) with a better way</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>  {</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    <span class="keywordflow">while</span> (!isRoot[root])</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>      root++;</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>    <span class="keywordtype">int</span> numInAggFound = 0;</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; numFineNodes; j++) {</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>      <span class="keywordflow">if</span> (j == root)  <span class="comment">// don&#39;t make a connection from the root to itself</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>      {</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>        numInAggFound++;</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>      }</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>      <span class="keywordflow">if</span> (vertex2AggId[root] == vertex2AggId[j]) {</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>        vertices.push_back(root);</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>        vertices.push_back(j);</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>        geomSizes.push_back(2);</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>        <span class="comment">// Also draw the free endpoint explicitly for the current line</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>        vertices.push_back(j);</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>        geomSizes.push_back(1);</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>        numInAggFound++;</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>        <span class="comment">// if(numInAggFound == aggSizes_[vertex2AggId_[root]]) //don&#39;t spend more time looking if done with that root</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>        <span class="comment">//   break;</span></div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>      }</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    }</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>    root++;  <span class="comment">// get set up to look for the next root</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>  }</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>}</div>
</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span> </div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00086" data-start="{" data-end="}">
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a749c8be66b363042fcf09d4e17aa266e">   86</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a749c8be66b363042fcf09d4e17aa266e">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::doConvexHulls2D</a>(std::vector&lt;int&gt;&amp; vertices, std::vector&lt;int&gt;&amp; geomSizes, LO numLocalAggs, LO numFineNodes, <span class="keyword">const</span> std::vector&lt;bool&gt;&amp; <span class="comment">/* isRoot */</span>, <span class="keyword">const</span> ArrayRCP&lt;LO&gt;&amp; vertex2AggId, <span class="keyword">const</span> Teuchos::ArrayRCP&lt;<span class="keyword">const</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::coordinateType&gt;&amp; xCoords, <span class="keyword">const</span> Teuchos::ArrayRCP&lt;<span class="keyword">const</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::coordinateType&gt;&amp; yCoords) {</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>  <span class="comment">// This algorithm is based on Andrew&#39;s Monotone Chain variant of the Graham Scan for Convex Hulls.  It adds</span></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>  <span class="comment">// a colinearity check which we&#39;ll need for our viz.</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> agg = 0; agg &lt; numLocalAggs; agg++) {</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>    std::vector&lt;int&gt; aggNodes;</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numFineNodes; i++) {</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>      <span class="keywordflow">if</span> (vertex2AggId[i] == agg)</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>        aggNodes.push_back(i);</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>    }</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span> </div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>    <span class="comment">// have a list of nodes in the aggregate</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    TEUCHOS_TEST_FOR_EXCEPTION(aggNodes.size() == 0, <a class="code hl_class" href="classMueLu_1_1Exceptions_1_1RuntimeError.html">Exceptions::RuntimeError</a>,</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>                               <span class="stringliteral">&quot;CoarseningVisualization::doConvexHulls2D: aggregate contains zero nodes!&quot;</span>);</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>    <span class="keywordflow">if</span> (aggNodes.size() == 1) {</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>      vertices.push_back(aggNodes.front());</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>      geomSizes.push_back(1);</div>
<div class="foldopen" id="foldopen00102" data-start="{" data-end="}">
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#ac7167aaaddd98ebebc0df2519ffb5b4a">  102</a></span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    }</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>    <span class="keywordflow">if</span> (aggNodes.size() == 2) {</div>
<div class="foldopen" id="foldopen00105" data-start="{" data-end="}">
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a614a9a5d3abfcb7e01b92ee9a31aff7e">  105</a></span>      vertices.push_back(aggNodes.front());</div>
<div class="foldopen" id="foldopen00106" data-start="{" data-end="}">
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#af643681fda381b93f142dc8de93809ca">  106</a></span>      vertices.push_back(aggNodes.back());</div>
<div class="foldopen" id="foldopen00107" data-start="{" data-end="}">
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a06890a103de7f8c7cd8fc198fceb933d">  107</a></span>      geomSizes.push_back(2);</div>
<div class="foldopen" id="foldopen00108" data-start="{" data-end="}">
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a9cddcf7f695d8374a40cf4f4185762d2">  108</a></span>      <span class="keywordflow">continue</span>;</div>
<div class="foldopen" id="foldopen00109" data-start="{" data-end="}">
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#ab3bb8cb67c03c36e213ae76bc1dcf892">  109</a></span>    } <span class="keywordflow">else</span> {</div>
<div class="foldopen" id="foldopen00110" data-start="{" data-end="}">
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a1b72a3e9b288cf17c78cbbfe07c0ace6">  110</a></span>      <span class="keywordtype">int</span> N        = (int)aggNodes.size();</div>
<div class="foldopen" id="foldopen00111" data-start="{" data-end="}">
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#ad3821c5e41b7c29f50b7b6927794a6da">  111</a></span>      <span class="keyword">using </span>MyPair = std::pair&lt;myVec2, int&gt;;</div>
<div class="foldopen" id="foldopen00112" data-start="{" data-end="}">
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#ad24f6fc139566c73cbcfdf00ba25a84d">  112</a></span>      std::vector&lt;MyPair&gt; pointsAndIndex(N);</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; N; i++) {</div>
<div class="foldopen" id="foldopen00114" data-start="{" data-end="}">
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a3c5008b862e28cb4daf1309c75e29124">  114</a></span>        pointsAndIndex[i] = std::make_pair(<a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a>(xCoords[aggNodes[i]], yCoords[aggNodes[i]]), i);</div>
<div class="foldopen" id="foldopen00115" data-start="{" data-end="}">
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a35b5a1326f3d02574b65150c5fe3b95e">  115</a></span>      }</div>
<div class="foldopen" id="foldopen00116" data-start="{" data-end="}">
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a3e4a5f15cc69a611889e8bbe9729dca4">  116</a></span> </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>      <span class="comment">// Sort by x coordinate</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>      std::sort(pointsAndIndex.begin(), pointsAndIndex.end(), [](<span class="keyword">const</span> MyPair&amp; a, <span class="keyword">const</span> MyPair&amp; b) {</div>
<div class="foldopen" id="foldopen00119" data-start="{" data-end="}">
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#abe7a55f57c0c4da7f1e3729dad6ced04">  119</a></span>        return a.first.x &lt; b.first.x || (a.first.x == b.first.x &amp;&amp; a.first.y &lt; b.first.y);</div>
<div class="foldopen" id="foldopen00120" data-start="{" data-end="}">
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#aee1120cdadcbd2a44d9ce81e98b4f002">  120</a></span>      });</div>
<div class="foldopen" id="foldopen00121" data-start="{" data-end="}">
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a749c8be66b363042fcf09d4e17aa266e">  121</a></span> </div>
<div class="foldopen" id="foldopen00122" data-start="{" data-end="}">
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a89e429706e2669e10204a05121550a05">  122</a></span>      <span class="comment">// Colinearity check</span></div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>      <span class="keywordtype">bool</span> colinear = <span class="keyword">true</span>;</div>
<div class="foldopen" id="foldopen00124" data-start="{" data-end="}">
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a192c05e474ef69155a661b86e5a8d24c">  124</a></span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; N; i++) {</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>        <span class="keywordflow">if</span> (ccw(pointsAndIndex[i].first, pointsAndIndex[(i + 1) % N].first, pointsAndIndex[(i + 2) % N].first) != 0) {</div>
<div class="foldopen" id="foldopen00126" data-start="{" data-end="}">
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a10347089a222a6066228c9b64702c545">  126</a></span>          colinear = <span class="keyword">false</span>;</div>
<div class="foldopen" id="foldopen00127" data-start="{" data-end="}">
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a1f99a21d65237d176a64da0671b64537">  127</a></span>          <span class="keywordflow">break</span>;</div>
<div class="foldopen" id="foldopen00128" data-start="{" data-end="}">
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a73f5a8c3b6130d875992c8e75f7ad9c8">  128</a></span>        }</div>
<div class="foldopen" id="foldopen00129" data-start="{" data-end="}">
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#ace40d754e83bf9b54ef3c8e04477576b">  129</a></span>      }</div>
<div class="foldopen" id="foldopen00130" data-start="{" data-end="}">
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a9d30041d95d18534247461c11b25d907">  130</a></span> </div>
<div class="foldopen" id="foldopen00131" data-start="{" data-end="}">
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#ad01fcb8ebfdc239041f654504a2708ab">  131</a></span>      <span class="keywordflow">if</span> (colinear) {</div>
<div class="foldopen" id="foldopen00132" data-start="{" data-end="}">
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#ab65dbd0b4e14c2eed5e948c61dfab6d8">  132</a></span>        vertices.push_back(aggNodes[pointsAndIndex.front().second]);</div>
<div class="foldopen" id="foldopen00133" data-start="{" data-end="}">
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#aa82a51f16cd6497ae05d9b626baab8e3">  133</a></span>        vertices.push_back(aggNodes[pointsAndIndex.back().second]);</div>
<div class="foldopen" id="foldopen00134" data-start="{" data-end="}">
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a17e18781913f0137b7a678b1b52715ca">  134</a></span>        geomSizes.push_back(2);</div>
<div class="foldopen" id="foldopen00135" data-start="{" data-end="}">
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a2ffa22b5576e8526ce8d3eec1bd75bfa">  135</a></span>      } <span class="keywordflow">else</span> {</div>
<div class="foldopen" id="foldopen00136" data-start="{" data-end="}">
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a292be04c73c2bc2f0b62a7e5f26ec698">  136</a></span>        std::vector&lt;int&gt; hull(2 * N);</div>
<div class="foldopen" id="foldopen00137" data-start="{" data-end="}">
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a649a937a650bc64654b221144e57cf66">  137</a></span>        <span class="keywordtype">int</span> count = 0;</div>
<div class="foldopen" id="foldopen00138" data-start="{" data-end="}">
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a6744077579fc3c3d31e9cc72b29b92b3">  138</a></span> </div>
<div class="foldopen" id="foldopen00139" data-start="{" data-end="}">
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a10fe92776ff5f710039ee87e4dff7620">  139</a></span>        <span class="comment">// Build lower hull</span></div>
<div class="foldopen" id="foldopen00140" data-start="{" data-end="}">
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a883065a027aebbf0711f7a0003961e91">  140</a></span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; N; i++) {</div>
<div class="foldopen" id="foldopen00141" data-start="{" data-end="}">
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#aedc7389d41263a63ea380476d657896c">  141</a></span>          <span class="keywordflow">while</span> (count &gt;= 2 &amp;&amp; ccw(pointsAndIndex[hull[count - 2]].first, pointsAndIndex[hull[count - 1]].first, pointsAndIndex[i].first) &lt;= 0) {</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>            count--;</div>
<div class="foldopen" id="foldopen00143" data-start="{" data-end="}">
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a28307e67db3212aabcdc80f3aea74605">  143</a></span>          }</div>
<div class="foldopen" id="foldopen00144" data-start="{" data-end="}">
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a643e1adfaa8bf12e477173883255f580">  144</a></span>          hull[count++] = i;</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>        }</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span> </div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>        <span class="comment">// Build the upper hull</span></div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>        <span class="keywordtype">int</span> t = count + 1;</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = N - 1; i &gt; 0; i--) {</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>          <span class="keywordflow">while</span> (count &gt;= t &amp;&amp; ccw(pointsAndIndex[hull[count - 2]].first, pointsAndIndex[hull[count - 1]].first, pointsAndIndex[i - 1].first) &lt;= 0) {</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>            count--;</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>          }</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>          hull[count++] = i - 1;</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>        }</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span> </div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>        <span class="comment">// Remove the duplicated point</span></div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>        hull.resize(count - 1);</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span> </div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>        <span class="comment">// Verify: Check that hull retains CCW order</span></div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; (int)hull.size(); i++) {</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>          TEUCHOS_TEST_FOR_EXCEPTION(ccw(pointsAndIndex[hull[i]].first, pointsAndIndex[hull[(i + 1) % hull.size()]].first, pointsAndIndex[hull[(i + 1) % hull.size()]].first) == 1, Exceptions::RuntimeError, <span class="stringliteral">&quot;CoarseningVisualization::doConvexHulls2D: counter-clockwise verification fails&quot;</span>);</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>        }</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span> </div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>        <span class="comment">// We now need to undo the indices from the sorting</span></div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; (int)hull.size(); i++) {</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>          hull[i] = aggNodes[pointsAndIndex[hull[i]].second];</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>        }</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span> </div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>        vertices.reserve(vertices.size() + hull.size());</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; hull.size(); i++) {</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>          vertices.push_back(hull[i]);</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>        }</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>        geomSizes.push_back(hull.size());</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>      }  <span class="comment">// else colinear</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>    }    <span class="comment">// else 3 + nodes</span></div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>  }</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>}</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span> </div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00180" data-start="{" data-end="}">
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a89e429706e2669e10204a05121550a05">  180</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a89e429706e2669e10204a05121550a05">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::doConvexHulls3D</a>(std::vector&lt;int&gt;&amp; vertices, std::vector&lt;int&gt;&amp; geomSizes, LO numLocalAggs, LO numFineNodes, <span class="keyword">const</span> std::vector&lt;bool&gt;&amp; <span class="comment">/* isRoot */</span>, <span class="keyword">const</span> ArrayRCP&lt;LO&gt;&amp; vertex2AggId, <span class="keyword">const</span> Teuchos::ArrayRCP&lt;<span class="keyword">const</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::coordinateType&gt;&amp; xCoords, <span class="keyword">const</span> Teuchos::ArrayRCP&lt;<span class="keyword">const</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::coordinateType&gt;&amp; yCoords, <span class="keyword">const</span> Teuchos::ArrayRCP&lt;<span class="keyword">const</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::coordinateType&gt;&amp; zCoords) {</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>  <span class="comment">// Use 3D quickhull algo.</span></div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>  <span class="comment">// Vector of node indices representing triangle vertices</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>  <span class="comment">// Note: Calculate the hulls first since will only include point data for points in the hulls</span></div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>  <span class="comment">// Effectively the size() of vertIndices after each hull is added to it</span></div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>  <span class="keyword">typedef</span> std::list&lt;int&gt;::iterator Iter;</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> agg = 0; agg &lt; numLocalAggs; agg++) {</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    std::list&lt;int&gt; aggNodes;  <span class="comment">// At first, list of all nodes in the aggregate. As nodes are enclosed or included by/in hull, remove them</span></div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numFineNodes; i++) {</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>      <span class="keywordflow">if</span> (vertex2AggId[i] == agg)</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>        aggNodes.push_back(i);</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    }</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>    <span class="comment">// First, check anomalous cases</span></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    TEUCHOS_TEST_FOR_EXCEPTION(aggNodes.size() == 0, <a class="code hl_class" href="classMueLu_1_1Exceptions_1_1RuntimeError.html">Exceptions::RuntimeError</a>,</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>                               <span class="stringliteral">&quot;CoarseningVisualization::doConvexHulls3D: aggregate contains zero nodes!&quot;</span>);</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>    <span class="keywordflow">if</span> (aggNodes.size() == 1) {</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>      vertices.push_back(aggNodes.front());</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>      geomSizes.push_back(1);</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (aggNodes.size() == 2) {</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>      vertices.push_back(aggNodes.front());</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>      vertices.push_back(aggNodes.back());</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>      geomSizes.push_back(2);</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>    }</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    <span class="comment">// check for collinearity</span></div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>    <span class="keywordtype">bool</span> areCollinear = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>    {</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>      Iter it = aggNodes.begin();</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>      <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> firstVec(xCoords[*it], yCoords[*it], zCoords[*it]);</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>      <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> comp;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>      {</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>        it++;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>        <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> secondVec(xCoords[*it], yCoords[*it], zCoords[*it]);  <span class="comment">// cross this with other vectors to compare</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>        comp = vecSubtract(secondVec, firstVec);</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>        it++;</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>      }</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>      <span class="keywordflow">for</span> (; it != aggNodes.end(); it++) {</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>        <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> thisVec(xCoords[*it], yCoords[*it], zCoords[*it]);</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>        <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> cross = crossProduct(vecSubtract(thisVec, firstVec), comp);</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>        <span class="keywordflow">if</span> (mymagnitude(cross) &gt; 1e-10) {</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>          areCollinear = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>        }</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>      }</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    }</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    <span class="keywordflow">if</span> (areCollinear) {</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>      <span class="comment">// find the endpoints of segment describing all the points</span></div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>      <span class="comment">// compare x, if tie compare y, if tie compare z</span></div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>      Iter min = aggNodes.begin();</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>      Iter max = aggNodes.begin();</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>      Iter it  = ++aggNodes.begin();</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>      <span class="keywordflow">for</span> (; it != aggNodes.end(); it++) {</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>        <span class="keywordflow">if</span> (xCoords[*it] &lt; xCoords[*min])</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>          min = it;</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (xCoords[*it] == xCoords[*min]) {</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>          <span class="keywordflow">if</span> (yCoords[*it] &lt; yCoords[*min])</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>            min = it;</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (yCoords[*it] == yCoords[*min]) {</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>            <span class="keywordflow">if</span> (zCoords[*it] &lt; zCoords[*min]) min = it;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>          }</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>        }</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>        <span class="keywordflow">if</span> (xCoords[*it] &gt; xCoords[*max])</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>          max = it;</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (xCoords[*it] == xCoords[*max]) {</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>          <span class="keywordflow">if</span> (yCoords[*it] &gt; yCoords[*max])</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>            max = it;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (yCoords[*it] == yCoords[*max]) {</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>            <span class="keywordflow">if</span> (zCoords[*it] &gt; zCoords[*max])</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>              max = it;</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>          }</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>        }</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>      }</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>      vertices.push_back(*min);</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>      vertices.push_back(*max);</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>      geomSizes.push_back(2);</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>    }</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>    <span class="keywordtype">bool</span> areCoplanar = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>    {</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>      <span class="comment">// number of points is known to be &gt;= 3</span></div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>      Iter vert = aggNodes.begin();</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>      <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> v1(xCoords[*vert], yCoords[*vert], zCoords[*vert]);</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>      vert++;</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>      <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> v2(xCoords[*vert], yCoords[*vert], zCoords[*vert]);</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>      vert++;</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>      <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> v3(xCoords[*vert], yCoords[*vert], zCoords[*vert]);</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>      vert++;</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>      <span class="comment">// Make sure the first three points aren&#39;t also collinear (need a non-degenerate triangle to get a normal)</span></div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>      <span class="keywordflow">while</span> (mymagnitude(crossProduct(vecSubtract(v1, v2), vecSubtract(v1, v3))) &lt; 1e-10) {</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>        <span class="comment">// Replace the third point with the next point</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>        v3 = <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a>(xCoords[*vert], yCoords[*vert], zCoords[*vert]);</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>        vert++;</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>      }</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>      <span class="keywordflow">for</span> (; vert != aggNodes.end(); vert++) {</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>        <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> pt(xCoords[*vert], yCoords[*vert], zCoords[*vert]);</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>        <span class="keywordflow">if</span> (fabs(pointDistFromTri(pt, v1, v2, v3)) &gt; 1e-12) {</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>          areCoplanar = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>        }</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>      }</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>      <span class="keywordflow">if</span> (areCoplanar) {</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>        <span class="comment">// do 2D convex hull</span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>        <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> planeNorm = getNorm(v1, v2, v3);</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>        planeNorm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a>      = fabs(planeNorm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a>);</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>        planeNorm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a>      = fabs(planeNorm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a>);</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>        planeNorm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a>      = fabs(planeNorm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a>);</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>        std::vector&lt;myVec2&gt; points;</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>        std::vector&lt;int&gt; nodes;</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>        <span class="keywordflow">if</span> (planeNorm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a> &gt;= planeNorm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a> &amp;&amp; planeNorm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a> &gt;= planeNorm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a>) {</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>          <span class="comment">// project points to yz plane to make hull</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>          <span class="keywordflow">for</span> (Iter it = aggNodes.begin(); it != aggNodes.end(); it++) {</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>            nodes.push_back(*it);</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>            points.push_back(<a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a>(yCoords[*it], zCoords[*it]));</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>          }</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>        }</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>        <span class="keywordflow">if</span> (planeNorm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a> &gt;= planeNorm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a> &amp;&amp; planeNorm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a> &gt;= planeNorm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a>) {</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>          <span class="comment">// use xz</span></div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>          <span class="keywordflow">for</span> (Iter it = aggNodes.begin(); it != aggNodes.end(); it++) {</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>            nodes.push_back(*it);</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>            points.push_back(<a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a>(xCoords[*it], zCoords[*it]));</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>          }</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>        }</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>        <span class="keywordflow">if</span> (planeNorm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a> &gt;= planeNorm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a> &amp;&amp; planeNorm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a> &gt;= planeNorm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a>) {</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>          <span class="keywordflow">for</span> (Iter it = aggNodes.begin(); it != aggNodes.end(); it++) {</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>            nodes.push_back(*it);</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>            points.push_back(<a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a>(xCoords[*it], yCoords[*it]));</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>          }</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>        }</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>        std::vector&lt;int&gt; convhull2d = giftWrap(points, nodes, xCoords, yCoords);</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>        geomSizes.push_back(convhull2d.size());</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>        vertices.reserve(vertices.size() + convhull2d.size());</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; convhull2d.size(); i++)</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>          vertices.push_back(convhull2d[i]);</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>      }</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>    }</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>    Iter exIt        = aggNodes.begin();                            <span class="comment">// iterator to be used for searching for min/max x/y/z</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>    <span class="keywordtype">int</span> extremeSix[] = {*exIt, *exIt, *exIt, *exIt, *exIt, *exIt};  <span class="comment">// nodes with minimumX, maxX, minY ...</span></div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>    exIt++;</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>    <span class="keywordflow">for</span> (; exIt != aggNodes.end(); exIt++) {</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>      Iter it = exIt;</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>      <span class="keywordflow">if</span> (xCoords[*it] &lt; xCoords[extremeSix[0]] ||</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>          (xCoords[*it] == xCoords[extremeSix[0]] &amp;&amp; yCoords[*it] &lt; yCoords[extremeSix[0]]) ||</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>          (xCoords[*it] == xCoords[extremeSix[0]] &amp;&amp; yCoords[*it] == yCoords[extremeSix[0]] &amp;&amp; zCoords[*it] &lt; zCoords[extremeSix[0]]))</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>        extremeSix[0] = *it;</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>      <span class="keywordflow">if</span> (xCoords[*it] &gt; xCoords[extremeSix[1]] ||</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>          (xCoords[*it] == xCoords[extremeSix[1]] &amp;&amp; yCoords[*it] &gt; yCoords[extremeSix[1]]) ||</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>          (xCoords[*it] == xCoords[extremeSix[1]] &amp;&amp; yCoords[*it] == yCoords[extremeSix[1]] &amp;&amp; zCoords[*it] &gt; zCoords[extremeSix[1]]))</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>        extremeSix[1] = *it;</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>      <span class="keywordflow">if</span> (yCoords[*it] &lt; yCoords[extremeSix[2]] ||</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>          (yCoords[*it] == yCoords[extremeSix[2]] &amp;&amp; zCoords[*it] &lt; zCoords[extremeSix[2]]) ||</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>          (yCoords[*it] == yCoords[extremeSix[2]] &amp;&amp; zCoords[*it] == zCoords[extremeSix[2]] &amp;&amp; xCoords[*it] &lt; xCoords[extremeSix[2]]))</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>        extremeSix[2] = *it;</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>      <span class="keywordflow">if</span> (yCoords[*it] &gt; yCoords[extremeSix[3]] ||</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>          (yCoords[*it] == yCoords[extremeSix[3]] &amp;&amp; zCoords[*it] &gt; zCoords[extremeSix[3]]) ||</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>          (yCoords[*it] == yCoords[extremeSix[3]] &amp;&amp; zCoords[*it] == zCoords[extremeSix[3]] &amp;&amp; xCoords[*it] &gt; xCoords[extremeSix[3]]))</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>        extremeSix[3] = *it;</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>      <span class="keywordflow">if</span> (zCoords[*it] &lt; zCoords[extremeSix[4]] ||</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>          (zCoords[*it] == zCoords[extremeSix[4]] &amp;&amp; xCoords[*it] &lt; xCoords[extremeSix[4]]) ||</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>          (zCoords[*it] == zCoords[extremeSix[4]] &amp;&amp; xCoords[*it] == xCoords[extremeSix[4]] &amp;&amp; yCoords[*it] &lt; yCoords[extremeSix[4]]))</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>        extremeSix[4] = *it;</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>      <span class="keywordflow">if</span> (zCoords[*it] &gt; zCoords[extremeSix[5]] ||</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>          (zCoords[*it] == zCoords[extremeSix[5]] &amp;&amp; xCoords[*it] &gt; xCoords[extremeSix[5]]) ||</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>          (zCoords[*it] == zCoords[extremeSix[5]] &amp;&amp; xCoords[*it] == xCoords[extremeSix[5]] &amp;&amp; yCoords[*it] &gt; zCoords[extremeSix[5]]))</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>        extremeSix[5] = *it;</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>    }</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>    <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> extremeVectors[6];</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6; i++) {</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>      <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> thisExtremeVec(xCoords[extremeSix[i]], yCoords[extremeSix[i]], zCoords[extremeSix[i]]);</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>      extremeVectors[i] = thisExtremeVec;</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    }</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>    <span class="keywordtype">double</span> maxDist = 0;</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>    <span class="keywordtype">int</span> base1      = 0;  <span class="comment">// ints from 0-5: which pair out of the 6 extreme points are the most distant? (indices in extremeSix and extremeVectors)</span></div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>    <span class="keywordtype">int</span> base2      = 0;</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 5; i++) {</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = i + 1; j &lt; 6; j++) {</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>        <span class="keywordtype">double</span> thisDist = distance(extremeVectors[i], extremeVectors[j]);</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>        <span class="comment">// Want to make sure thisDist is significantly larger than maxDist to prevent roundoff errors from impacting node choice.</span></div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>        <span class="keywordflow">if</span> (thisDist &gt; maxDist &amp;&amp; thisDist - maxDist &gt; 1e-12) {</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>          maxDist = thisDist;</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>          base1   = i;</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>          base2   = j;</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>        }</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>      }</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>    }</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>    std::list&lt;myTriangle&gt; hullBuilding;  <span class="comment">// each Triangle is a triplet of nodes (int IDs) that form a triangle</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>    <span class="comment">// remove base1 and base2 iters from aggNodes, they are known to be in the hull</span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>    aggNodes.remove(extremeSix[base1]);</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>    aggNodes.remove(extremeSix[base2]);</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>    <span class="comment">// extremeSix[base1] and [base2] still have the myVec3 representation</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>    <a class="code hl_class" href="classMueLu_1_1myTriangle.html">myTriangle</a> tri;</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>    tri.<a class="code hl_variable" href="classMueLu_1_1myTriangle.html#ae354eeb0a7b130c100e2ba4d9069e794">v1</a> = extremeSix[base1];</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>    tri.<a class="code hl_variable" href="classMueLu_1_1myTriangle.html#a467a19b7f4de655fb26db5f12a68cd48">v2</a> = extremeSix[base2];</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>    <span class="comment">// Now find the point that is furthest away from the line between base1 and base2</span></div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>    maxDist = 0;</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>    <span class="comment">// need the vectors to do &quot;quadruple product&quot; formula</span></div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>    <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> b1 = extremeVectors[base1];</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>    <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> b2 = extremeVectors[base2];</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>    Iter thirdNode;</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>    <span class="keywordflow">for</span> (Iter node = aggNodes.begin(); node != aggNodes.end(); node++) {</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>      <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> nodePos(xCoords[*node], yCoords[*node], zCoords[*node]);</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>      <span class="keywordtype">double</span> dist = mymagnitude(crossProduct(vecSubtract(nodePos, b1), vecSubtract(nodePos, b2))) / mymagnitude(vecSubtract(b2, b1));</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>      <span class="comment">// Want to make sure dist is significantly larger than maxDist to prevent roundoff errors from impacting node choice.</span></div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>      <span class="keywordflow">if</span> (dist &gt; maxDist &amp;&amp; dist - maxDist &gt; 1e-12) {</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>        maxDist   = dist;</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>        thirdNode = node;</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>      }</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>    }</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>    <span class="comment">// Now know the last node in the first triangle</span></div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>    tri.<a class="code hl_variable" href="classMueLu_1_1myTriangle.html#a1eda0fb1797d6a23abf3824e71c8d762">v3</a> = *thirdNode;</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>    hullBuilding.push_back(tri);</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>    <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> b3(xCoords[*thirdNode], yCoords[*thirdNode], zCoords[*thirdNode]);</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>    aggNodes.erase(thirdNode);</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>    <span class="comment">// Find the fourth node (most distant from triangle) to form tetrahedron</span></div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>    maxDist          = 0;</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>    <span class="keywordtype">int</span> fourthVertex = -1;</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>    <span class="keywordflow">for</span> (Iter node = aggNodes.begin(); node != aggNodes.end(); node++) {</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>      <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> thisNode(xCoords[*node], yCoords[*node], zCoords[*node]);</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>      <span class="keywordtype">double</span> nodeDist = pointDistFromTri(thisNode, b1, b2, b3);</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>      <span class="comment">// Want to make sure nodeDist is significantly larger than maxDist to prevent roundoff errors from impacting node choice.</span></div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>      <span class="keywordflow">if</span> (nodeDist &gt; maxDist &amp;&amp; nodeDist - maxDist &gt; 1e-12) {</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>        maxDist      = nodeDist;</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>        fourthVertex = *node;</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>      }</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>    }</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>    aggNodes.remove(fourthVertex);</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>    <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> b4(xCoords[fourthVertex], yCoords[fourthVertex], zCoords[fourthVertex]);</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>    <span class="comment">// Add three new triangles to hullBuilding to form the first tetrahedron</span></div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>    <span class="comment">// use tri to hold the triangle info temporarily before being added to list</span></div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>    tri    = hullBuilding.front();</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>    tri.<a class="code hl_variable" href="classMueLu_1_1myTriangle.html#ae354eeb0a7b130c100e2ba4d9069e794">v1</a> = fourthVertex;</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>    hullBuilding.push_back(tri);</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>    tri    = hullBuilding.front();</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>    tri.<a class="code hl_variable" href="classMueLu_1_1myTriangle.html#a467a19b7f4de655fb26db5f12a68cd48">v2</a> = fourthVertex;</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    hullBuilding.push_back(tri);</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>    tri    = hullBuilding.front();</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>    tri.<a class="code hl_variable" href="classMueLu_1_1myTriangle.html#a1eda0fb1797d6a23abf3824e71c8d762">v3</a> = fourthVertex;</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>    hullBuilding.push_back(tri);</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>    <span class="comment">// now orient all four triangles so that the vertices are oriented clockwise (so getNorm_ points outward for each)</span></div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>    <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> barycenter((b1.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a> + b2.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a> + b3.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a> + b4.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a>) / 4.0, (b1.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a> + b2.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a> + b3.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a> + b4.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a>) / 4.0, (b1.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a> + b2.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a> + b3.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a> + b4.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a>) / 4.0);</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>    <span class="keywordflow">for</span> (std::list&lt;myTriangle&gt;::iterator tetTri = hullBuilding.begin(); tetTri != hullBuilding.end(); tetTri++) {</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>      <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> triVert1(xCoords[tetTri-&gt;v1], yCoords[tetTri-&gt;v1], zCoords[tetTri-&gt;v1]);</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>      <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> triVert2(xCoords[tetTri-&gt;v2], yCoords[tetTri-&gt;v2], zCoords[tetTri-&gt;v2]);</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>      <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> triVert3(xCoords[tetTri-&gt;v3], yCoords[tetTri-&gt;v3], zCoords[tetTri-&gt;v3]);</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>      <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> trinorm   = getNorm(triVert1, triVert2, triVert3);</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>      <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> ptInPlane = tetTri == hullBuilding.begin() ? b1 : b4;  <span class="comment">// first triangle definitely has b1 in it, other three definitely have b4</span></div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>      <span class="keywordflow">if</span> (isInFront(barycenter, ptInPlane, trinorm)) {</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>        <span class="comment">// don&#39;t want the faces of the tetrahedron to face inwards (towards barycenter) so reverse orientation</span></div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>        <span class="comment">// by swapping two vertices</span></div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>        <span class="keywordtype">int</span> temp   = tetTri-&gt;v1;</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>        tetTri-&gt;v1 = tetTri-&gt;v2;</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>        tetTri-&gt;v2 = temp;</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>      }</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>    }</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>    <span class="comment">// now, have starting polyhedron in hullBuilding (all faces are facing outwards according to getNorm_) and remaining nodes to process are in aggNodes</span></div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>    <span class="comment">// recursively, for each triangle, make a list of the points that are &#39;in front&#39; of the triangle. Find the point with the maximum distance from the triangle.</span></div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>    <span class="comment">// Add three new triangles, each sharing one edge with the original triangle but now with the most distant point as a vertex. Remove the most distant point from</span></div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>    <span class="comment">// the list of all points that need to be processed. Also from that list remove all points that are in front of the original triangle but not in front of all three</span></div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>    <span class="comment">// new triangles, since they are now enclosed in the hull.</span></div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    <span class="comment">// Construct point lists for each face of the tetrahedron individually.</span></div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> trinorms[4];  <span class="comment">// normals to the four tetrahedron faces, now oriented outwards</span></div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>    <span class="keywordtype">int</span> index = 0;</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    <span class="keywordflow">for</span> (std::list&lt;myTriangle&gt;::iterator tetTri = hullBuilding.begin(); tetTri != hullBuilding.end(); tetTri++) {</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>      <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> triVert1(xCoords[tetTri-&gt;v1], yCoords[tetTri-&gt;v1], zCoords[tetTri-&gt;v1]);</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>      <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> triVert2(xCoords[tetTri-&gt;v2], yCoords[tetTri-&gt;v2], zCoords[tetTri-&gt;v2]);</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>      <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> triVert3(xCoords[tetTri-&gt;v3], yCoords[tetTri-&gt;v3], zCoords[tetTri-&gt;v3]);</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>      trinorms[index] = getNorm(triVert1, triVert2, triVert3);</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>      index++;</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>    }</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>    std::list&lt;int&gt; startPoints1;</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    std::list&lt;int&gt; startPoints2;</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>    std::list&lt;int&gt; startPoints3;</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>    std::list&lt;int&gt; startPoints4;</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    <span class="comment">// scope this so that &#39;point&#39; is not in function scope</span></div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>    {</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>      Iter point = aggNodes.begin();</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>      <span class="keywordflow">while</span> (!aggNodes.empty())  <span class="comment">// this removes points one at a time as they are put in startPointsN or are already done</span></div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>      {</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>        <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> pointVec(xCoords[*point], yCoords[*point], zCoords[*point]);</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>        <span class="comment">// Note: Because of the way the tetrahedron faces are constructed above,</span></div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>        <span class="comment">// face 1 definitely contains b1 and faces 2-4 definitely contain b4.</span></div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>        <span class="keywordflow">if</span> (isInFront(pointVec, b1, trinorms[0])) {</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>          startPoints1.push_back(*point);</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>          point = aggNodes.erase(point);</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isInFront(pointVec, b4, trinorms[1])) {</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>          startPoints2.push_back(*point);</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>          point = aggNodes.erase(point);</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isInFront(pointVec, b4, trinorms[2])) {</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>          startPoints3.push_back(*point);</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>          point = aggNodes.erase(point);</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isInFront(pointVec, b4, trinorms[3])) {</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>          startPoints4.push_back(*point);</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>          point = aggNodes.erase(point);</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>          point = aggNodes.erase(point);  <span class="comment">// points here are already inside tetrahedron.</span></div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>        }</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>      }</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>      <span class="comment">// Call processTriangle for each triangle in the initial tetrahedron, one at a time.</span></div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>    }</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>    <span class="keyword">typedef</span> std::list&lt;myTriangle&gt;::iterator TriIter;</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>    TriIter firstTri  = hullBuilding.begin();</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>    <a class="code hl_class" href="classMueLu_1_1myTriangle.html">myTriangle</a> start1 = *firstTri;</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>    firstTri++;</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>    <a class="code hl_class" href="classMueLu_1_1myTriangle.html">myTriangle</a> start2 = *firstTri;</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>    firstTri++;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>    <a class="code hl_class" href="classMueLu_1_1myTriangle.html">myTriangle</a> start3 = *firstTri;</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>    firstTri++;</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>    <a class="code hl_class" href="classMueLu_1_1myTriangle.html">myTriangle</a> start4 = *firstTri;</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>    <span class="comment">// kick off depth-first recursive filling of hullBuilding list with all triangles in the convex hull</span></div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>    <span class="keywordflow">if</span> (!startPoints1.empty())</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>      processTriangle(hullBuilding, start1, startPoints1, barycenter, xCoords, yCoords, zCoords);</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>    <span class="keywordflow">if</span> (!startPoints2.empty())</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>      processTriangle(hullBuilding, start2, startPoints2, barycenter, xCoords, yCoords, zCoords);</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>    <span class="keywordflow">if</span> (!startPoints3.empty())</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>      processTriangle(hullBuilding, start3, startPoints3, barycenter, xCoords, yCoords, zCoords);</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>    <span class="keywordflow">if</span> (!startPoints4.empty())</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>      processTriangle(hullBuilding, start4, startPoints4, barycenter, xCoords, yCoords, zCoords);</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>    <span class="comment">// hullBuilding now has all triangles that make up this hull.</span></div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>    <span class="comment">// Dump hullBuilding info into the list of all triangles for the scene.</span></div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>    vertices.reserve(vertices.size() + 3 * hullBuilding.size());</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>    <span class="keywordflow">for</span> (TriIter hullTri = hullBuilding.begin(); hullTri != hullBuilding.end(); hullTri++) {</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>      vertices.push_back(hullTri-&gt;v1);</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>      vertices.push_back(hullTri-&gt;v2);</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>      vertices.push_back(hullTri-&gt;v3);</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>      geomSizes.push_back(3);</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>    }</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>  }</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>}</div>
</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span> </div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00511" data-start="{" data-end="}">
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a192c05e474ef69155a661b86e5a8d24c">  511</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a192c05e474ef69155a661b86e5a8d24c">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::doGraphEdges</a>(std::vector&lt;int&gt;&amp; vertices, std::vector&lt;int&gt;&amp; geomSizes, Teuchos::RCP&lt;LWGraph&gt;&amp; G, Teuchos::ArrayRCP&lt;<span class="keyword">const</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::coordinateType&gt;&amp; <span class="comment">/* fx */</span>, Teuchos::ArrayRCP&lt;<span class="keyword">const</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::coordinateType&gt;&amp; <span class="comment">/* fy */</span>, Teuchos::ArrayRCP&lt;<span class="keyword">const</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::coordinateType&gt;&amp; <span class="comment">/* fz */</span>) {</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>  ArrayView&lt;const Scalar&gt; values;</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span> </div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>  std::vector&lt;std::pair&lt;int, int&gt; &gt; vert1;  <span class="comment">// vertices (node indices)</span></div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span> </div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>  ArrayView&lt;const LocalOrdinal&gt; indices;</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="MueLu__UseDefaultTypes_8hpp.html#a226b8cca25ba3f3d741bc52854fe8601">LocalOrdinal</a> locRow = 0; locRow &lt; <a class="code hl_typedef" href="MueLu__UseDefaultTypes_8hpp.html#a226b8cca25ba3f3d741bc52854fe8601">LocalOrdinal</a>(G-&gt;GetNodeNumVertices()); locRow++) {</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>    <span class="keyword">auto</span> neighbors = G-&gt;getNeighborVertices(locRow);</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>    <span class="comment">// Add those local indices (columns) to the list of connections (which are pairs of the form (localM, localN))</span></div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gEdge = 0; gEdge &lt; int(neighbors.length); ++gEdge) {</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>      vert1.push_back(std::pair&lt;int, int&gt;(locRow, neighbors(gEdge)));</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>    }</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>  }</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; vert1.size(); i++) {</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>    <span class="keywordflow">if</span> (vert1[i].first &gt; vert1[i].second) {</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>      <span class="keywordtype">int</span> temp        = vert1[i].first;</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>      vert1[i].first  = vert1[i].second;</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>      vert1[i].second = temp;</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>    }</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>  }</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>  std::sort(vert1.begin(), vert1.end());</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>  std::vector&lt;std::pair&lt;int, int&gt; &gt;::iterator newEnd = unique(vert1.begin(), vert1.end());  <span class="comment">// remove duplicate edges</span></div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>  vert1.erase(newEnd, vert1.end());</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>  <span class="comment">// std::vector&lt;int&gt; points1;</span></div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>  vertices.reserve(2 * vert1.size());</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>  geomSizes.reserve(vert1.size());</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; vert1.size(); i++) {</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>    vertices.push_back(vert1[i].first);</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>    vertices.push_back(vert1[i].second);</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>    geomSizes.push_back(2);</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>  }</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>}</div>
</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span> </div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00545" data-start="{" data-end="}">
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a10347089a222a6066228c9b64702c545">  545</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a10347089a222a6066228c9b64702c545">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::ccw</a>(<span class="keyword">const</span> <a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a>&amp; a, <span class="keyword">const</span> <a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a>&amp; b, <span class="keyword">const</span> <a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a>&amp; c) {</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> ccw_zero_threshold = 1e-8;</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>  <span class="keywordtype">double</span> val                      = (b.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae39886f516ec2a16a0012b85856bebf6">x</a> - a.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae39886f516ec2a16a0012b85856bebf6">x</a>) * (c.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae6306959963c02bd68f6d82be9a20992">y</a> - a.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae6306959963c02bd68f6d82be9a20992">y</a>) - (b.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae6306959963c02bd68f6d82be9a20992">y</a> - a.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae6306959963c02bd68f6d82be9a20992">y</a>) * (c.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae39886f516ec2a16a0012b85856bebf6">x</a> - a.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae39886f516ec2a16a0012b85856bebf6">x</a>);</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>  <span class="keywordflow">return</span> (val &gt; ccw_zero_threshold) ? 1 : ((val &lt; -ccw_zero_threshold) ? -1 : 0);</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>}</div>
</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span> </div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00552" data-start="{" data-end="}">
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a1f99a21d65237d176a64da0671b64537">  552</a></span><a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a1f99a21d65237d176a64da0671b64537">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::crossProduct</a>(<a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> v1, <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> v2) {</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>  <span class="keywordflow">return</span> <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a>(v1.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a> * v2.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a> - v1.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a> * v2.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a>, v1.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a> * v2.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a> - v1.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a> * v2.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a>, v1.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a> * v2.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a> - v1.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a> * v2.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a>);</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>}</div>
</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span> </div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00557" data-start="{" data-end="}">
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a73f5a8c3b6130d875992c8e75f7ad9c8">  557</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a73f5a8c3b6130d875992c8e75f7ad9c8">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::dotProduct</a>(<a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a> v1, <a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a> v2) {</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>  <span class="keywordflow">return</span> v1.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae39886f516ec2a16a0012b85856bebf6">x</a> * v2.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae39886f516ec2a16a0012b85856bebf6">x</a> + v1.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae6306959963c02bd68f6d82be9a20992">y</a> * v2.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae6306959963c02bd68f6d82be9a20992">y</a>;</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>}</div>
</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span> </div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00562" data-start="{" data-end="}">
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#ace40d754e83bf9b54ef3c8e04477576b">  562</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a73f5a8c3b6130d875992c8e75f7ad9c8">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::dotProduct</a>(<a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> v1, <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> v2) {</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>  <span class="keywordflow">return</span> v1.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a> * v2.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a> + v1.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a> * v2.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a> + v1.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a> * v2.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a>;</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>}</div>
</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span> </div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00567" data-start="{" data-end="}">
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a9d30041d95d18534247461c11b25d907">  567</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a9d30041d95d18534247461c11b25d907">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::isInFront</a>(<a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> point, <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> inPlane, <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> n) {</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>  <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> rel(point.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a> - inPlane.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a>, point.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a> - inPlane.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a>, point.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a> - inPlane.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a>);  <span class="comment">// position of the point relative to the plane</span></div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>  <span class="keywordflow">return</span> dotProduct(rel, n) &gt; 1e-12 ? true : <span class="keyword">false</span>;</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>}</div>
</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span> </div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00573" data-start="{" data-end="}">
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#ad01fcb8ebfdc239041f654504a2708ab">  573</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#ad01fcb8ebfdc239041f654504a2708ab">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::mymagnitude</a>(<a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a> vec) {</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>  <span class="keywordflow">return</span> sqrt(dotProduct(vec, vec));</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>}</div>
</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span> </div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00578" data-start="{" data-end="}">
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#ab65dbd0b4e14c2eed5e948c61dfab6d8">  578</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#ad01fcb8ebfdc239041f654504a2708ab">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::mymagnitude</a>(<a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> vec) {</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>  <span class="keywordflow">return</span> sqrt(dotProduct(vec, vec));</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>}</div>
</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span> </div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00583" data-start="{" data-end="}">
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#aa82a51f16cd6497ae05d9b626baab8e3">  583</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#aa82a51f16cd6497ae05d9b626baab8e3">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::distance</a>(<a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a> p1, <a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a> p2) {</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>  <span class="keywordflow">return</span> mymagnitude(vecSubtract(p1, p2));</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>}</div>
</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span> </div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00588" data-start="{" data-end="}">
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a17e18781913f0137b7a678b1b52715ca">  588</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#aa82a51f16cd6497ae05d9b626baab8e3">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::distance</a>(<a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> p1, <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> p2) {</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>  <span class="keywordflow">return</span> mymagnitude(vecSubtract(p1, p2));</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>}</div>
</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span> </div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00593" data-start="{" data-end="}">
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a2ffa22b5576e8526ce8d3eec1bd75bfa">  593</a></span><a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a2ffa22b5576e8526ce8d3eec1bd75bfa">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::vecSubtract</a>(<a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a> v1, <a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a> v2) {</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>  <span class="keywordflow">return</span> <a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a>(v1.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae39886f516ec2a16a0012b85856bebf6">x</a> - v2.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae39886f516ec2a16a0012b85856bebf6">x</a>, v1.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae6306959963c02bd68f6d82be9a20992">y</a> - v2.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae6306959963c02bd68f6d82be9a20992">y</a>);</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>}</div>
</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span> </div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00598" data-start="{" data-end="}">
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a292be04c73c2bc2f0b62a7e5f26ec698">  598</a></span><a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a2ffa22b5576e8526ce8d3eec1bd75bfa">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::vecSubtract</a>(<a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> v1, <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> v2) {</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>  <span class="keywordflow">return</span> <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a>(v1.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a> - v2.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a>, v1.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a> - v2.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a>, v1.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a> - v2.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a>);</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>}</div>
</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span> </div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00603" data-start="{" data-end="}">
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a649a937a650bc64654b221144e57cf66">  603</a></span><a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a649a937a650bc64654b221144e57cf66">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::getNorm</a>(<a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a> v)  <span class="comment">//&quot;normal&quot; to a 2D vector - just rotate 90 degrees to left</span></div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>{</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>  <span class="keywordflow">return</span> <a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a>(v.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae6306959963c02bd68f6d82be9a20992">y</a>, -v.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae39886f516ec2a16a0012b85856bebf6">x</a>);</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>}</div>
</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span> </div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00609" data-start="{" data-end="}">
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a6744077579fc3c3d31e9cc72b29b92b3">  609</a></span><a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a649a937a650bc64654b221144e57cf66">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::getNorm</a>(<a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> v1, <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> v2, <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> v3)  <span class="comment">// normal to face of triangle (will be outward rel. to polyhedron) (v1, v2, v3 are in CCW order when normal is toward viewpoint)</span></div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>{</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>  <span class="keywordflow">return</span> crossProduct(vecSubtract(v2, v1), vecSubtract(v3, v1));</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>}</div>
</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span> </div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span><span class="comment">// get minimum distance from &#39;point&#39; to plane containing v1, v2, v3 (or the triangle with v1, v2, v3 as vertices)</span></div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00616" data-start="{" data-end="}">
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a10fe92776ff5f710039ee87e4dff7620">  616</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a10fe92776ff5f710039ee87e4dff7620">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::pointDistFromTri</a>(<a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> point, <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> v1, <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> v2, <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> v3) {</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>  <span class="keyword">using namespace </span>std;</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>  <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> norm = getNorm(v1, v2, v3);</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>  <span class="comment">// must normalize the normal vector</span></div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>  <span class="keywordtype">double</span> normScl = mymagnitude(norm);</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>  <span class="keywordtype">double</span> rv      = 0.0;</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>  <span class="keywordflow">if</span> (normScl &gt; 1e-8) {</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>    norm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a> /= normScl;</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>    norm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a> /= normScl;</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>    norm.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a> /= normScl;</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>    rv = fabs(dotProduct(norm, vecSubtract(point, v1)));</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>    <span class="comment">// triangle is degenerated</span></div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>    <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> test1  = vecSubtract(v3, v1);</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>    <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> test2  = vecSubtract(v2, v1);</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>    <span class="keywordtype">bool</span> useTest1 = mymagnitude(test1) &gt; 0.0 ? true : <span class="keyword">false</span>;</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>    <span class="keywordtype">bool</span> useTest2 = mymagnitude(test2) &gt; 0.0 ? true : <span class="keyword">false</span>;</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>    <span class="keywordflow">if</span> (useTest1 == <span class="keyword">true</span>) {</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>      <span class="keywordtype">double</span> normScl1 = mymagnitude(test1);</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>      test1.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a> /= normScl1;</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>      test1.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a> /= normScl1;</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>      test1.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a> /= normScl1;</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>      rv = fabs(dotProduct(test1, vecSubtract(point, v1)));</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (useTest2 == <span class="keyword">true</span>) {</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>      <span class="keywordtype">double</span> normScl2 = mymagnitude(test2);</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>      test2.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">x</a> /= normScl2;</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>      test2.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">y</a> /= normScl2;</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>      test2.<a class="code hl_variable" href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">z</a> /= normScl2;</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>      rv = fabs(dotProduct(test2, vecSubtract(point, v1)));</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>      TEUCHOS_TEST_FOR_EXCEPTION(<span class="keyword">true</span>, <a class="code hl_class" href="classMueLu_1_1Exceptions_1_1RuntimeError.html">Exceptions::RuntimeError</a>,</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>                                 <span class="stringliteral">&quot;VisualizationHelpers::pointDistFromTri: Could not determine the distance of a point to a triangle.&quot;</span>);</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>    }</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>  }</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>}</div>
</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span> </div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00654" data-start="{" data-end="}">
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a883065a027aebbf0711f7a0003961e91">  654</a></span>std::vector&lt;myTriangle&gt; <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a883065a027aebbf0711f7a0003961e91">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::processTriangle</a>(std::list&lt;myTriangle&gt;&amp; tris, <a class="code hl_class" href="classMueLu_1_1myTriangle.html">myTriangle</a> tri, std::list&lt;int&gt;&amp; pointsInFront, <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a>&amp; barycenter, <span class="keyword">const</span> Teuchos::ArrayRCP&lt;<span class="keyword">const</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::coordinateType&gt;&amp; xCoords, <span class="keyword">const</span> Teuchos::ArrayRCP&lt;<span class="keyword">const</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::coordinateType&gt;&amp; yCoords, <span class="keyword">const</span> Teuchos::ArrayRCP&lt;<span class="keyword">const</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::coordinateType&gt;&amp; zCoords) {</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>  <span class="comment">//*tri is in the tris list, and is the triangle to process here. tris is a complete list of all triangles in the hull so far. pointsInFront is only a list of the nodes in front of tri. Need coords also.</span></div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>  <span class="comment">// precondition: each triangle is already oriented so that getNorm_(v1, v2, v3) points outward (away from interior of hull)</span></div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>  <span class="comment">// First find the point furthest from triangle.</span></div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>  <span class="keyword">using namespace </span>std;</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>  <span class="keyword">typedef</span> std::list&lt;int&gt;::iterator Iter;</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>  <span class="keyword">typedef</span> std::list&lt;myTriangle&gt;::iterator TriIter;</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>  <span class="keyword">typedef</span> list&lt;pair&lt;int, int&gt; &gt;::iterator EdgeIter;</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>  <span class="keywordtype">double</span> maxDist = 0;</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>  <span class="comment">// Need vector representations of triangle&#39;s vertices</span></div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>  <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> v1(xCoords[tri.<a class="code hl_variable" href="classMueLu_1_1myTriangle.html#ae354eeb0a7b130c100e2ba4d9069e794">v1</a>], yCoords[tri.<a class="code hl_variable" href="classMueLu_1_1myTriangle.html#ae354eeb0a7b130c100e2ba4d9069e794">v1</a>], zCoords[tri.<a class="code hl_variable" href="classMueLu_1_1myTriangle.html#ae354eeb0a7b130c100e2ba4d9069e794">v1</a>]);</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>  <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> v2(xCoords[tri.<a class="code hl_variable" href="classMueLu_1_1myTriangle.html#a467a19b7f4de655fb26db5f12a68cd48">v2</a>], yCoords[tri.<a class="code hl_variable" href="classMueLu_1_1myTriangle.html#a467a19b7f4de655fb26db5f12a68cd48">v2</a>], zCoords[tri.<a class="code hl_variable" href="classMueLu_1_1myTriangle.html#a467a19b7f4de655fb26db5f12a68cd48">v2</a>]);</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>  <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> v3(xCoords[tri.<a class="code hl_variable" href="classMueLu_1_1myTriangle.html#a1eda0fb1797d6a23abf3824e71c8d762">v3</a>], yCoords[tri.<a class="code hl_variable" href="classMueLu_1_1myTriangle.html#a1eda0fb1797d6a23abf3824e71c8d762">v3</a>], zCoords[tri.<a class="code hl_variable" href="classMueLu_1_1myTriangle.html#a1eda0fb1797d6a23abf3824e71c8d762">v3</a>]);</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>  <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> farPointVec;  <span class="comment">// useful to have both the point&#39;s coordinates and it&#39;s position in the list</span></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>  Iter farPoint = pointsInFront.begin();</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>  <span class="keywordflow">for</span> (Iter point = pointsInFront.begin(); point != pointsInFront.end(); point++) {</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>    <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> pointVec(xCoords[*point], yCoords[*point], zCoords[*point]);</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>    <span class="keywordtype">double</span> dist = pointDistFromTri(pointVec, v1, v2, v3);</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>    <span class="comment">// Want to make sure nodeDist is significantly larger than maxDist to prevent roundoff errors from impacting node choice.</span></div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>    <span class="keywordflow">if</span> (dist &gt; maxDist &amp;&amp; dist - maxDist &gt; 1e-12) {</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>      dist        = maxDist;</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>      farPointVec = pointVec;</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>      farPoint    = point;</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>    }</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>  }</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>  <span class="comment">// Find all the triangles that the point is in front of (can be more than 1)</span></div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>  <span class="comment">// At the same time, remove them from tris, as every one will be replaced later</span></div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>  vector&lt;myTriangle&gt; visible;  <span class="comment">// use a list of iterators so that the underlying object is still in tris</span></div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>  <span class="keywordflow">for</span> (TriIter it = tris.begin(); it != tris.end();) {</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>    <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> vec1(xCoords[it-&gt;v1], yCoords[it-&gt;v1], zCoords[it-&gt;v1]);</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>    <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> vec2(xCoords[it-&gt;v2], yCoords[it-&gt;v2], zCoords[it-&gt;v2]);</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>    <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> vec3(xCoords[it-&gt;v3], yCoords[it-&gt;v3], zCoords[it-&gt;v3]);</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>    <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> norm = getNorm(vec1, vec2, vec3);</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>    <span class="keywordflow">if</span> (isInFront(farPointVec, vec1, norm)) {</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>      visible.push_back(*it);</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>      it = tris.erase(it);</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>    } <span class="keywordflow">else</span></div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>      it++;</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>  }</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>  <span class="comment">// Figure out what triangles need to be destroyed/created</span></div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>  <span class="comment">// First create a list of edges (as std::pair&lt;int, int&gt;, where the two ints are the node endpoints)</span></div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>  list&lt;pair&lt;int, int&gt; &gt; horizon;</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>  <span class="comment">// For each triangle, add edges to the list iff the edge only appears once in the set of all</span></div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>  <span class="comment">// Have members of horizon have the lower node # first, and the higher one second</span></div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>  <span class="keywordflow">for</span> (vector&lt;myTriangle&gt;::iterator it = visible.begin(); it != visible.end(); it++) {</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>    pair&lt;int, int&gt; e1(it-&gt;v1, it-&gt;v2);</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>    pair&lt;int, int&gt; e2(it-&gt;v2, it-&gt;v3);</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>    pair&lt;int, int&gt; e3(it-&gt;v1, it-&gt;v3);</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>    <span class="comment">//&quot;sort&quot; the pair values</span></div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>    <span class="keywordflow">if</span> (e1.first &gt; e1.second) {</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>      <span class="keywordtype">int</span> temp  = e1.first;</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>      e1.first  = e1.second;</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>      e1.second = temp;</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>    }</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>    <span class="keywordflow">if</span> (e2.first &gt; e2.second) {</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>      <span class="keywordtype">int</span> temp  = e2.first;</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>      e2.first  = e2.second;</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>      e2.second = temp;</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>    }</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>    <span class="keywordflow">if</span> (e3.first &gt; e3.second) {</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>      <span class="keywordtype">int</span> temp  = e3.first;</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>      e3.first  = e3.second;</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>      e3.second = temp;</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>    }</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>    horizon.push_back(e1);</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>    horizon.push_back(e2);</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>    horizon.push_back(e3);</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>  }</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>  <span class="comment">// sort based on lower node first, then higher node (lexicographical ordering built in to pair)</span></div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>  horizon.sort();</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>  <span class="comment">// Remove all edges from horizon, except those that appear exactly once</span></div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>  {</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>    EdgeIter it = horizon.begin();</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>    <span class="keywordflow">while</span> (it != horizon.end()) {</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>      <span class="keywordtype">int</span> occur = count(horizon.begin(), horizon.end(), *it);</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>      <span class="keywordflow">if</span> (occur &gt; 1) {</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>        pair&lt;int, int&gt; removeVal = *it;</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>        <span class="keywordflow">while</span> (removeVal == *it &amp;&amp; !(it == horizon.end()))</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>          it = horizon.erase(it);</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>      } <span class="keywordflow">else</span></div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>        it++;</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>    }</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>  }</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>  <span class="comment">// Now make a list of new triangles being created, each of which take 2 vertices from an edge and one from farPoint</span></div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>  list&lt;myTriangle&gt; newTris;</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>  <span class="keywordflow">for</span> (EdgeIter it = horizon.begin(); it != horizon.end(); it++) {</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>    <a class="code hl_class" href="classMueLu_1_1myTriangle.html">myTriangle</a> t(it-&gt;first, it-&gt;second, *farPoint);</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>    newTris.push_back(t);</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>  }</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>  <span class="comment">// Ensure every new triangle is oriented outwards, using the barycenter of the initial tetrahedron</span></div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>  vector&lt;myTriangle&gt; trisToProcess;</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>  vector&lt;list&lt;int&gt; &gt; newFrontPoints;</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>  <span class="keywordflow">for</span> (TriIter it = newTris.begin(); it != newTris.end(); it++) {</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>    <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> t1(xCoords[it-&gt;v1], yCoords[it-&gt;v1], zCoords[it-&gt;v1]);</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>    <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> t2(xCoords[it-&gt;v2], yCoords[it-&gt;v2], zCoords[it-&gt;v2]);</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>    <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> t3(xCoords[it-&gt;v3], yCoords[it-&gt;v3], zCoords[it-&gt;v3]);</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>    <span class="keywordflow">if</span> (isInFront(barycenter, t1, getNorm(t1, t2, t3))) {</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>      <span class="comment">// need to swap two vertices to flip orientation of triangle</span></div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>      <span class="keywordtype">int</span> temp       = it-&gt;v1;</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>      <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> tempVec = t1;</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>      it-&gt;v1         = it-&gt;v2;</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>      t1             = t2;</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>      it-&gt;v2         = temp;</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>      t2             = tempVec;</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>    }</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>    <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> outwardNorm = getNorm(t1, t2, t3);  <span class="comment">// now definitely points outwards</span></div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>    <span class="comment">// Add the triangle to tris</span></div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>    tris.push_back(*it);</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>    trisToProcess.push_back(tris.back());</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>    <span class="comment">// Make a list of the points that are in front of nextToProcess, to be passed in for processing</span></div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>    list&lt;int&gt; newInFront;</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>    <span class="keywordflow">for</span> (Iter point = pointsInFront.begin(); point != pointsInFront.end();) {</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>      <a class="code hl_class" href="classMueLu_1_1myVec3.html">myVec3</a> pointVec(xCoords[*point], yCoords[*point], zCoords[*point]);</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>      <span class="keywordflow">if</span> (isInFront(pointVec, t1, outwardNorm)) {</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>        newInFront.push_back(*point);</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>        point = pointsInFront.erase(point);</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>      } <span class="keywordflow">else</span></div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>        point++;</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>    }</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>    newFrontPoints.push_back(newInFront);</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>  }</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>  vector&lt;myTriangle&gt; allRemoved;  <span class="comment">// list of all invalid iterators that were erased by calls to processmyTriangle below</span></div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; int(trisToProcess.size()); i++) {</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>    <span class="keywordflow">if</span> (!newFrontPoints[i].empty()) {</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>      <span class="comment">// Comparing the &#39;triangle to process&#39; to the one for this call prevents infinite recursion/stack overflow.</span></div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>      <span class="comment">// TODO: Why was it doing that? Rounding error? Make more robust fix. But this does work for the time being.</span></div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>      <span class="keywordflow">if</span> (find(allRemoved.begin(), allRemoved.end(), trisToProcess[i]) == allRemoved.end() &amp;&amp; !(trisToProcess[i] == tri)) {</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>        vector&lt;myTriangle&gt; removedList = processTriangle(tris, trisToProcess[i], newFrontPoints[i], barycenter, xCoords, yCoords, zCoords);</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; int(removedList.size()); j++)</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>          allRemoved.push_back(removedList[j]);</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>      }</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>    }</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>  }</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>  <span class="keywordflow">return</span> visible;</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>}</div>
</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span> </div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00791" data-start="{" data-end="}">
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#aedc7389d41263a63ea380476d657896c">  791</a></span>std::vector&lt;int&gt; <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#aedc7389d41263a63ea380476d657896c">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::giftWrap</a>(std::vector&lt;myVec2&gt;&amp; points, std::vector&lt;int&gt;&amp; nodes, <span class="keyword">const</span> Teuchos::ArrayRCP&lt;<span class="keyword">const</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::coordinateType&gt;&amp; xCoords, <span class="keyword">const</span> Teuchos::ArrayRCP&lt;<span class="keyword">const</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::coordinateType&gt;&amp; yCoords) {</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>  TEUCHOS_TEST_FOR_EXCEPTION(points.size() &lt; 3, <a class="code hl_class" href="classMueLu_1_1Exceptions_1_1RuntimeError.html">Exceptions::RuntimeError</a>,</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>                             <span class="stringliteral">&quot;CoarseningVisualization::giftWrap: Gift wrap algorithm input has to have at least 3 points!&quot;</span>);</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span> </div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span><span class="preprocessor">#if 1  </span><span class="comment">// TAW&#39;s version to determine &quot;minimal&quot; node</span></div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>  <span class="comment">// determine minimal x and y coordinates</span></div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>  <span class="keywordtype">double</span> min_x = points[0].x;</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>  <span class="keywordtype">double</span> min_y = points[0].y;</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>  <span class="keywordflow">for</span> (std::vector&lt;int&gt;::iterator it = nodes.begin(); it != nodes.end(); it++) {</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>    <span class="keywordtype">int</span> i = it - nodes.begin();</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>    <span class="keywordflow">if</span> (points[i].x &lt; min_x) min_x = points[i].x;</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>    <span class="keywordflow">if</span> (points[i].y &lt; min_y) min_y = points[i].y;</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>  }</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>  <span class="comment">// create dummy min coordinates</span></div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>  min_x -= 1.0;</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>  min_y -= 1.0;</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>  <a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a> dummy_min(min_x, min_y);</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span> </div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>  <span class="comment">// loop over all nodes and determine nodes with minimal distance to (min_x, min_y)</span></div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>  std::vector&lt;int&gt; hull;</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>  <a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a> min                         = points[0];</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>  <span class="keywordtype">double</span> mindist                     = distance(min, dummy_min);</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>  std::vector&lt;int&gt;::iterator minNode = nodes.begin();</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>  <span class="keywordflow">for</span> (std::vector&lt;int&gt;::iterator it = nodes.begin(); it != nodes.end(); it++) {</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>    <span class="keywordtype">int</span> i = it - nodes.begin();</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>    <span class="keywordflow">if</span> (distance(points[i], dummy_min) &lt; mindist) {</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>      mindist = distance(points[i], dummy_min);</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>      min     = points[i];</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>      minNode = it;</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>    }</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>  }</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>  hull.push_back(*minNode);</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span><span class="preprocessor">#else  </span><span class="comment">// Brian&#39;s code</span></div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>  std::vector&lt;int&gt; hull;</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>  std::vector&lt;int&gt;::iterator minNode = nodes.begin();</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>  <a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a> min                         = points[0];</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>  <span class="keywordflow">for</span> (std::vector&lt;int&gt;::iterator it = nodes.begin(); it != nodes.end(); it++) {</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>    <span class="keywordtype">int</span> i = it - nodes.begin();</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>    <span class="keywordflow">if</span> (points[i].x &lt; min.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae39886f516ec2a16a0012b85856bebf6">x</a> || (fabs(points[i].x - min.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae39886f516ec2a16a0012b85856bebf6">x</a>) &lt; 1e-10 &amp;&amp; points[i].y &lt; min.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae6306959963c02bd68f6d82be9a20992">y</a>)) {</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>      min     = points[i];</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>      minNode = it;</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>    }</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>  }</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>  hull.push_back(*minNode);</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span> </div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>  <span class="keywordtype">bool</span> includeMin = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>  <span class="comment">// int debug_it = 0;</span></div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>  <span class="keywordflow">while</span> (1) {</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>    std::vector&lt;int&gt;::iterator leftMost = nodes.begin();</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>    <span class="keywordflow">if</span> (!includeMin &amp;&amp; leftMost == minNode) {</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>      leftMost++;</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>    }</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>    std::vector&lt;int&gt;::iterator it = leftMost;</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>    it++;</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>    <span class="keywordflow">for</span> (; it != nodes.end(); it++) {</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>      <span class="keywordflow">if</span> (it == minNode &amp;&amp; !includeMin)  <span class="comment">// don&#39;t compare to min on very first sweep</span></div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>      <span class="keywordflow">if</span> (*it == hull.back())</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>      <span class="comment">// see if it is in front of line containing nodes thisHull.back() and leftMost</span></div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>      <span class="comment">// first get the left normal of leftMost - thisHull.back() (&lt;dy, -dx&gt;)</span></div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>      <a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a> leftMostVec = points[leftMost - nodes.begin()];</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>      <a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a> lastVec(xCoords[hull.back()], yCoords[hull.back()]);</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>      <a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a> testNorm = getNorm(vecSubtract(leftMostVec, lastVec));</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>      <span class="comment">// now dot testNorm with *it - leftMost. If dot is positive, leftMost becomes it. If dot is zero, take one further from thisHull.back().</span></div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>      <a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a> itVec(xCoords[*it], yCoords[*it]);</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>      <span class="keywordtype">double</span> dotProd = dotProduct(testNorm, vecSubtract(itVec, lastVec));</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>      <span class="keywordflow">if</span> (-1e-8 &lt; dotProd &amp;&amp; dotProd &lt; 1e-8) {</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>        <span class="comment">// thisHull.back(), it and leftMost are collinear.</span></div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>        <span class="comment">// Just sum the differences in x and differences in y for each and compare to get further one, don&#39;t need distance formula</span></div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>        <a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a> itDist       = vecSubtract(itVec, lastVec);</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>        <a class="code hl_class" href="classMueLu_1_1myVec2.html">myVec2</a> leftMostDist = vecSubtract(leftMostVec, lastVec);</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>        <span class="keywordflow">if</span> (fabs(itDist.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae39886f516ec2a16a0012b85856bebf6">x</a>) + fabs(itDist.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae6306959963c02bd68f6d82be9a20992">y</a>) &gt; fabs(leftMostDist.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae39886f516ec2a16a0012b85856bebf6">x</a>) + fabs(leftMostDist.<a class="code hl_variable" href="classMueLu_1_1myVec2.html#ae6306959963c02bd68f6d82be9a20992">y</a>)) {</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>          leftMost = it;</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>        }</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dotProd &gt; 0) {</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>        leftMost = it;</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>      }</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>    }</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>    <span class="comment">// if leftMost is min, then the loop is complete.</span></div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>    <span class="keywordflow">if</span> (*leftMost == *minNode)</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>    hull.push_back(*leftMost);</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>    includeMin = <span class="keyword">true</span>;  <span class="comment">// have found second point (the one after min) so now include min in the searches</span></div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>    <span class="comment">// debug_it ++;</span></div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>    <span class="comment">// if(debug_it &gt; 100) exit(0); //break;</span></div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>  }</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>  <span class="keywordflow">return</span> hull;</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>}</div>
</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span> </div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00883" data-start="{" data-end="}">
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a643e1adfaa8bf12e477173883255f580">  883</a></span>std::vector&lt;int&gt; <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a643e1adfaa8bf12e477173883255f580">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::makeUnique</a>(std::vector&lt;int&gt;&amp; vertices)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>  <span class="keyword">using namespace </span>std;</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>  vector&lt;int&gt; uniqueNodes = vertices;</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>  sort(uniqueNodes.begin(), uniqueNodes.end());</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>  vector&lt;int&gt;::iterator newUniqueFineEnd = unique(uniqueNodes.begin(), uniqueNodes.end());</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>  uniqueNodes.erase(newUniqueFineEnd, uniqueNodes.end());</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>  <span class="comment">// uniqueNodes is now a sorted list of the nodes whose info actually goes in file</span></div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>  <span class="comment">// Now replace values in vertices with locations of the old values in uniqueFine</span></div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; int(vertices.size()); i++) {</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>    <span class="keywordtype">int</span> lo     = 0;</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>    <span class="keywordtype">int</span> hi     = uniqueNodes.size() - 1;</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>    <span class="keywordtype">int</span> mid    = 0;</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>    <span class="keywordtype">int</span> search = vertices[i];</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>    <span class="keywordflow">while</span> (lo &lt;= hi) {</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>      mid = lo + (hi - lo) / 2;</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>      <span class="keywordflow">if</span> (uniqueNodes[mid] == search)</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (uniqueNodes[mid] &gt; search)</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>        hi = mid - 1;</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>        lo = mid + 1;</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>    }</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>    <span class="keywordflow">if</span> (uniqueNodes[mid] != search)</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>      <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;Issue in makeUnique_() - a point wasn&#39;t found in list.&quot;</span>);</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>    vertices[i] = mid;</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>  }</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>  <span class="keywordflow">return</span> uniqueNodes;</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>}</div>
</div>
</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span> </div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00913" data-start="{" data-end="}">
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a28307e67db3212aabcdc80f3aea74605">  913</a></span>std::string <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a28307e67db3212aabcdc80f3aea74605">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::replaceAll</a>(std::string result, <span class="keyword">const</span> std::string&amp; replaceWhat, <span class="keyword">const</span> std::string&amp; replaceWithWhat)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>  <span class="keywordflow">while</span> (1) {</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> pos = result.find(replaceWhat);</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>    <span class="keywordflow">if</span> (pos == -1)</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>    result.replace(pos, replaceWhat.size(), replaceWithWhat);</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>  }</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>  <span class="keywordflow">return</span> result;</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>}</div>
</div>
</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span> </div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00924" data-start="{" data-end="}">
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a3c5008b862e28cb4daf1309c75e29124">  924</a></span>std::string <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a3c5008b862e28cb4daf1309c75e29124">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::getFileName</a>(<span class="keywordtype">int</span> numProcs, <span class="keywordtype">int</span> myRank, <span class="keywordtype">int</span> level, <span class="keyword">const</span> Teuchos::ParameterList&amp; pL)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>  std::string filenameToWrite = getBaseFileName(numProcs, level, pL);</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>  filenameToWrite             = this-&gt;<a class="code hl_function" href="namespaceMueLu.html#a28cc2d953f9e734910c598332da53b80">replaceAll</a>(filenameToWrite, <span class="stringliteral">&quot;%PROCID&quot;</span>, <a class="code hl_function" href="namespaceMueLu.html#adffcd9a4c5dd0a4b2cbf6c8e77f27e6b">toString</a>(myRank));</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>  <span class="keywordflow">return</span> filenameToWrite;</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>}</div>
</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span> </div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00931" data-start="{" data-end="}">
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a35b5a1326f3d02574b65150c5fe3b95e">  931</a></span>std::string <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a35b5a1326f3d02574b65150c5fe3b95e">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::getBaseFileName</a>(<span class="keywordtype">int</span> numProcs, <span class="keywordtype">int</span> level, <span class="keyword">const</span> Teuchos::ParameterList&amp; pL)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>  std::string filenameToWrite = pL.get&lt;std::string&gt;(<span class="stringliteral">&quot;visualization: output filename&quot;</span>);</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>  <span class="keywordtype">int</span> timeStep                = pL.get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;visualization: output file: time step&quot;</span>);</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>  <span class="keywordtype">int</span> iter                    = pL.get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;visualization: output file: iter&quot;</span>);</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span> </div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>  <span class="keywordflow">if</span> (filenameToWrite.rfind(<span class="stringliteral">&quot;.vtu&quot;</span>) == std::string::npos)</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>    filenameToWrite.append(<span class="stringliteral">&quot;.vtu&quot;</span>);</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>  <span class="keywordflow">if</span> (numProcs &gt; 1 &amp;&amp; filenameToWrite.rfind(<span class="stringliteral">&quot;%PROCID&quot;</span>) == std::string::npos)  <span class="comment">// filename can&#39;t be identical between processsors in parallel problem</span></div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>    filenameToWrite.insert(filenameToWrite.rfind(<span class="stringliteral">&quot;.vtu&quot;</span>), <span class="stringliteral">&quot;-proc%PROCID&quot;</span>);</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span> </div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>  filenameToWrite = this-&gt;<a class="code hl_function" href="namespaceMueLu.html#a28cc2d953f9e734910c598332da53b80">replaceAll</a>(filenameToWrite, <span class="stringliteral">&quot;%LEVELID&quot;</span>, <a class="code hl_function" href="namespaceMueLu.html#adffcd9a4c5dd0a4b2cbf6c8e77f27e6b">toString</a>(level));</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>  filenameToWrite = this-&gt;<a class="code hl_function" href="namespaceMueLu.html#a28cc2d953f9e734910c598332da53b80">replaceAll</a>(filenameToWrite, <span class="stringliteral">&quot;%TIMESTEP&quot;</span>, <a class="code hl_function" href="namespaceMueLu.html#adffcd9a4c5dd0a4b2cbf6c8e77f27e6b">toString</a>(timeStep));</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>  filenameToWrite = this-&gt;<a class="code hl_function" href="namespaceMueLu.html#a28cc2d953f9e734910c598332da53b80">replaceAll</a>(filenameToWrite, <span class="stringliteral">&quot;%ITER&quot;</span>, <a class="code hl_function" href="namespaceMueLu.html#adffcd9a4c5dd0a4b2cbf6c8e77f27e6b">toString</a>(iter));</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>  <span class="keywordflow">return</span> filenameToWrite;</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>}</div>
</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span> </div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00948" data-start="{" data-end="}">
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a3e4a5f15cc69a611889e8bbe9729dca4">  948</a></span>std::string <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a3e4a5f15cc69a611889e8bbe9729dca4">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::getPVTUFileName</a>(<span class="keywordtype">int</span> numProcs, <span class="keywordtype">int</span> <span class="comment">/* myRank */</span>, <span class="keywordtype">int</span> level, <span class="keyword">const</span> Teuchos::ParameterList&amp; pL)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>  std::string filenameToWrite = getBaseFileName(numProcs, level, pL);</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>  std::string masterStem      = filenameToWrite.substr(0, filenameToWrite.rfind(<span class="stringliteral">&quot;.vtu&quot;</span>));</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>  masterStem                  = this-&gt;<a class="code hl_function" href="namespaceMueLu.html#a28cc2d953f9e734910c598332da53b80">replaceAll</a>(masterStem, <span class="stringliteral">&quot;%PROCID&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>  std::string pvtuFilename    = masterStem + <span class="stringliteral">&quot;-master.pvtu&quot;</span>;</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>  <span class="keywordflow">return</span> pvtuFilename;</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>}</div>
</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span> </div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00957" data-start="{" data-end="}">
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a614a9a5d3abfcb7e01b92ee9a31aff7e">  957</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a614a9a5d3abfcb7e01b92ee9a31aff7e">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::writeFileVTKOpening</a>(std::ofstream&amp; fout, std::vector&lt;int&gt;&amp; uniqueFine, std::vector&lt;int&gt;&amp; geomSizesFine)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>  std::string styleName = <span class="stringliteral">&quot;PointCloud&quot;</span>;  <span class="comment">// TODO adapt this</span></div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span> </div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>  std::string indent = <span class="stringliteral">&quot;      &quot;</span>;</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>  fout &lt;&lt; <span class="stringliteral">&quot;&lt;!--&quot;</span> &lt;&lt; styleName &lt;&lt; <span class="stringliteral">&quot; Aggregates Visualization--&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>  fout &lt;&lt; <span class="stringliteral">&quot;&lt;VTKFile type=\&quot;UnstructuredGrid\&quot; byte_order=\&quot;LittleEndian\&quot;&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>  fout &lt;&lt; <span class="stringliteral">&quot;  &lt;UnstructuredGrid&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>  fout &lt;&lt; <span class="stringliteral">&quot;    &lt;Piece NumberOfPoints=\&quot;&quot;</span> &lt;&lt; uniqueFine.size() &lt;&lt; <span class="stringliteral">&quot;\&quot; NumberOfCells=\&quot;&quot;</span> &lt;&lt; geomSizesFine.size() &lt;&lt; <span class="stringliteral">&quot;\&quot;&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>  fout &lt;&lt; <span class="stringliteral">&quot;      &lt;PointData Scalars=\&quot;Node Aggregate Processor\&quot;&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>}</div>
</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span> </div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00969" data-start="{" data-end="}">
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#af643681fda381b93f142dc8de93809ca">  969</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#af643681fda381b93f142dc8de93809ca">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::writeFileVTKNodes</a>(std::ofstream&amp; fout, std::vector&lt;int&gt;&amp; uniqueFine, Teuchos::RCP&lt;const Map&gt;&amp; nodeMap)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>  std::string indent = <span class="stringliteral">&quot;      &quot;</span>;</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>  fout &lt;&lt; <span class="stringliteral">&quot;        &lt;DataArray type=\&quot;Int32\&quot; Name=\&quot;Node\&quot; format=\&quot;ascii\&quot;&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>  indent             = <span class="stringliteral">&quot;          &quot;</span>;</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>  <span class="keywordtype">bool</span> localIsGlobal = <a class="code hl_typedef" href="MueLu__UseDefaultTypes_8hpp.html#a4730156daf25e1b41a9e14299c5d8f72">GlobalOrdinal</a>(nodeMap-&gt;getGlobalNumElements()) == <a class="code hl_typedef" href="MueLu__UseDefaultTypes_8hpp.html#a4730156daf25e1b41a9e14299c5d8f72">GlobalOrdinal</a>(nodeMap-&gt;getLocalNumElements());</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; uniqueFine.size(); i++) {</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>    <span class="keywordflow">if</span> (localIsGlobal) {</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>      fout &lt;&lt; uniqueFine[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;  <span class="comment">// if all nodes are on this processor, do not map from local to global</span></div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>    } <span class="keywordflow">else</span></div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>      fout &lt;&lt; nodeMap-&gt;getGlobalElement(uniqueFine[i]) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>    <span class="keywordflow">if</span> (i % 10 == 9)</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>      fout &lt;&lt; std::endl</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>           &lt;&lt; indent;</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>  }</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>  fout &lt;&lt; std::endl;</div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>  fout &lt;&lt; <span class="stringliteral">&quot;        &lt;/DataArray&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>}</div>
</div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span> </div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen00988" data-start="{" data-end="}">
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a06890a103de7f8c7cd8fc198fceb933d">  988</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a06890a103de7f8c7cd8fc198fceb933d">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::writeFileVTKData</a>(std::ofstream&amp; fout, std::vector&lt;int&gt;&amp; uniqueFine, <a class="code hl_typedef" href="MueLu__UseDefaultTypes_8hpp.html#a226b8cca25ba3f3d741bc52854fe8601">LocalOrdinal</a> myAggOffset, ArrayRCP&lt;LocalOrdinal&gt;&amp; vertex2AggId, <span class="keywordtype">int</span> myRank)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>  std::string indent = <span class="stringliteral">&quot;          &quot;</span>;</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>  fout &lt;&lt; <span class="stringliteral">&quot;        &lt;DataArray type=\&quot;Int32\&quot; Name=\&quot;Aggregate\&quot; format=\&quot;ascii\&quot;&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>  fout &lt;&lt; indent;</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; int(uniqueFine.size()); i++) {</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>    fout &lt;&lt; myAggOffset + vertex2AggId[uniqueFine[i]] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>    <span class="keywordflow">if</span> (i % 10 == 9)</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>      fout &lt;&lt; std::endl</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>           &lt;&lt; indent;</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>  }</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>  fout &lt;&lt; std::endl;</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>  fout &lt;&lt; <span class="stringliteral">&quot;        &lt;/DataArray&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>  fout &lt;&lt; <span class="stringliteral">&quot;        &lt;DataArray type=\&quot;Int32\&quot; Name=\&quot;Processor\&quot; format=\&quot;ascii\&quot;&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>  fout &lt;&lt; indent;</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; int(uniqueFine.size()); i++) {</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>    fout &lt;&lt; myRank &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>    <span class="keywordflow">if</span> (i % 20 == 19)</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>      fout &lt;&lt; std::endl</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>           &lt;&lt; indent;</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>  }</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>  fout &lt;&lt; std::endl;</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>  fout &lt;&lt; <span class="stringliteral">&quot;        &lt;/DataArray&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>  fout &lt;&lt; <span class="stringliteral">&quot;      &lt;/PointData&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>}</div>
</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span> </div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen01014" data-start="{" data-end="}">
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a9cddcf7f695d8374a40cf4f4185762d2"> 1014</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a9cddcf7f695d8374a40cf4f4185762d2">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::writeFileVTKCoordinates</a>(std::ofstream&amp; fout, std::vector&lt;int&gt;&amp; uniqueFine, Teuchos::ArrayRCP&lt;<span class="keyword">const</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::coordinateType&gt;&amp; fx, Teuchos::ArrayRCP&lt;<span class="keyword">const</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::coordinateType&gt;&amp; fy, Teuchos::ArrayRCP&lt;<span class="keyword">const</span> <span class="keyword">typename</span> Teuchos::ScalarTraits&lt;Scalar&gt;::coordinateType&gt;&amp; fz, <span class="keywordtype">int</span> dim)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>  std::string indent = <span class="stringliteral">&quot;      &quot;</span>;</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>  fout &lt;&lt; <span class="stringliteral">&quot;      &lt;Points&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>  fout &lt;&lt; <span class="stringliteral">&quot;        &lt;DataArray type=\&quot;Float64\&quot; NumberOfComponents=\&quot;3\&quot; format=\&quot;ascii\&quot;&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>  fout &lt;&lt; indent;</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; int(uniqueFine.size()); i++) {</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>    fout &lt;&lt; fx[uniqueFine[i]] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; fy[uniqueFine[i]] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>    <span class="keywordflow">if</span> (dim == 2)</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>      fout &lt;&lt; <span class="stringliteral">&quot;0 &quot;</span>;</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>      fout &lt;&lt; fz[uniqueFine[i]] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>    <span class="keywordflow">if</span> (i % 3 == 2)</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>      fout &lt;&lt; std::endl</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>           &lt;&lt; indent;</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>  }</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>  fout &lt;&lt; std::endl;</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>  fout &lt;&lt; <span class="stringliteral">&quot;        &lt;/DataArray&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>  fout &lt;&lt; <span class="stringliteral">&quot;      &lt;/Points&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>}</div>
</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span> </div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen01035" data-start="{" data-end="}">
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#ab3bb8cb67c03c36e213ae76bc1dcf892"> 1035</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#ab3bb8cb67c03c36e213ae76bc1dcf892">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::writeFileVTKCells</a>(std::ofstream&amp; fout, std::vector&lt;int&gt;&amp; <span class="comment">/* uniqueFine */</span>, std::vector&lt;LocalOrdinal&gt;&amp; vertices, std::vector&lt;LocalOrdinal&gt;&amp; geomSize)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>  std::string indent = <span class="stringliteral">&quot;      &quot;</span>;</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>  fout &lt;&lt; <span class="stringliteral">&quot;      &lt;Cells&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>  fout &lt;&lt; <span class="stringliteral">&quot;        &lt;DataArray type=\&quot;Int32\&quot; Name=\&quot;connectivity\&quot; format=\&quot;ascii\&quot;&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>  fout &lt;&lt; indent;</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; int(vertices.size()); i++) {</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>    fout &lt;&lt; vertices[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>    <span class="keywordflow">if</span> (i % 10 == 9)</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>      fout &lt;&lt; std::endl</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>           &lt;&lt; indent;</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>  }</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>  fout &lt;&lt; std::endl;</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>  fout &lt;&lt; <span class="stringliteral">&quot;        &lt;/DataArray&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>  fout &lt;&lt; <span class="stringliteral">&quot;        &lt;DataArray type=\&quot;Int32\&quot; Name=\&quot;offsets\&quot; format=\&quot;ascii\&quot;&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>  fout &lt;&lt; indent;</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>  <span class="keywordtype">int</span> accum = 0;</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; int(geomSize.size()); i++) {</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>    accum += geomSize[i];</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>    fout &lt;&lt; accum &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>    <span class="keywordflow">if</span> (i % 10 == 9)</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>      fout &lt;&lt; std::endl</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>           &lt;&lt; indent;</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>  }</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>  fout &lt;&lt; std::endl;</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>  fout &lt;&lt; <span class="stringliteral">&quot;        &lt;/DataArray&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>  fout &lt;&lt; <span class="stringliteral">&quot;        &lt;DataArray type=\&quot;Int32\&quot; Name=\&quot;types\&quot; format=\&quot;ascii\&quot;&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>  fout &lt;&lt; indent;</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; int(geomSize.size()); i++) {</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>    <span class="keywordflow">switch</span> (geomSize[i]) {</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>      <span class="keywordflow">case</span> 1:</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>        fout &lt;&lt; <span class="stringliteral">&quot;1 &quot;</span>;  <span class="comment">// Point</span></div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>      <span class="keywordflow">case</span> 2:</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>        fout &lt;&lt; <span class="stringliteral">&quot;3 &quot;</span>;  <span class="comment">// Line</span></div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>      <span class="keywordflow">case</span> 3:</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>        fout &lt;&lt; <span class="stringliteral">&quot;5 &quot;</span>;  <span class="comment">// Triangle</span></div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>        fout &lt;&lt; <span class="stringliteral">&quot;7 &quot;</span>;  <span class="comment">// Polygon</span></div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>    }</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>    <span class="keywordflow">if</span> (i % 30 == 29)</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>      fout &lt;&lt; std::endl</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>           &lt;&lt; indent;</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>  }</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>  fout &lt;&lt; std::endl;</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>  fout &lt;&lt; <span class="stringliteral">&quot;        &lt;/DataArray&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>  fout &lt;&lt; <span class="stringliteral">&quot;      &lt;/Cells&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>}</div>
</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span> </div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen01086" data-start="{" data-end="}">
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#a1b72a3e9b288cf17c78cbbfe07c0ace6"> 1086</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#a1b72a3e9b288cf17c78cbbfe07c0ace6">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::writeFileVTKClosing</a>(std::ofstream&amp; fout)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>  fout &lt;&lt; <span class="stringliteral">&quot;    &lt;/Piece&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>  fout &lt;&lt; <span class="stringliteral">&quot;  &lt;/UnstructuredGrid&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>  fout &lt;&lt; <span class="stringliteral">&quot;&lt;/VTKFile&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>}</div>
</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span> </div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen01093" data-start="{" data-end="}">
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#ad3821c5e41b7c29f50b7b6927794a6da"> 1093</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#ad3821c5e41b7c29f50b7b6927794a6da">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::writePVTU</a>(std::ofstream&amp; pvtu, std::string baseFname, <span class="keywordtype">int</span> numProcs, <span class="keywordtype">bool</span> bFineEdges, <span class="keywordtype">bool</span> <span class="comment">/* bCoarseEdges */</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>  <span class="comment">// If using vtk, filenameToWrite now contains final, correct ***.vtu filename (for the current proc)</span></div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>  <span class="comment">// So the root proc will need to use its own filenameToWrite to make a list of the filenames of all other procs to put in</span></div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>  <span class="comment">// pvtu file.</span></div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>  pvtu &lt;&lt; <span class="stringliteral">&quot;&lt;VTKFile type=\&quot;PUnstructuredGrid\&quot; byte_order=\&quot;LittleEndian\&quot;&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>  pvtu &lt;&lt; <span class="stringliteral">&quot;  &lt;PUnstructuredGrid GhostLevel=\&quot;0\&quot;&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>  pvtu &lt;&lt; <span class="stringliteral">&quot;    &lt;PPointData Scalars=\&quot;Node Aggregate Processor\&quot;&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>  pvtu &lt;&lt; <span class="stringliteral">&quot;      &lt;PDataArray type=\&quot;Int32\&quot; Name=\&quot;Node\&quot;/&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>  pvtu &lt;&lt; <span class="stringliteral">&quot;      &lt;PDataArray type=\&quot;Int32\&quot; Name=\&quot;Aggregate\&quot;/&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>  pvtu &lt;&lt; <span class="stringliteral">&quot;      &lt;PDataArray type=\&quot;Int32\&quot; Name=\&quot;Processor\&quot;/&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>  pvtu &lt;&lt; <span class="stringliteral">&quot;    &lt;/PPointData&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>  pvtu &lt;&lt; <span class="stringliteral">&quot;    &lt;PPoints&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>  pvtu &lt;&lt; <span class="stringliteral">&quot;      &lt;PDataArray type=\&quot;Float64\&quot; NumberOfComponents=\&quot;3\&quot;/&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>  pvtu &lt;&lt; <span class="stringliteral">&quot;    &lt;/PPoints&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numProcs; i++) {</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>    <span class="comment">// specify the piece for each proc (the replaceAll expression matches what the filenames will be on other procs)</span></div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>    pvtu &lt;&lt; <span class="stringliteral">&quot;    &lt;Piece Source=\&quot;&quot;</span> &lt;&lt; <a class="code hl_function" href="namespaceMueLu.html#a28cc2d953f9e734910c598332da53b80">replaceAll</a>(baseFname, <span class="stringliteral">&quot;%PROCID&quot;</span>, <a class="code hl_function" href="namespaceMueLu.html#adffcd9a4c5dd0a4b2cbf6c8e77f27e6b">toString</a>(i)) &lt;&lt; <span class="stringliteral">&quot;\&quot;/&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>  }</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>  <span class="comment">// reference files with graph pieces, if applicable</span></div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>  <span class="keywordflow">if</span> (bFineEdges) {</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numProcs; i++) {</div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>      std::string fn = <a class="code hl_function" href="namespaceMueLu.html#a28cc2d953f9e734910c598332da53b80">replaceAll</a>(baseFname, <span class="stringliteral">&quot;%PROCID&quot;</span>, <a class="code hl_function" href="namespaceMueLu.html#adffcd9a4c5dd0a4b2cbf6c8e77f27e6b">toString</a>(i));</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>      pvtu &lt;&lt; <span class="stringliteral">&quot;    &lt;Piece Source=\&quot;&quot;</span> &lt;&lt; fn.insert(fn.rfind(<span class="stringliteral">&quot;.vtu&quot;</span>), <span class="stringliteral">&quot;-finegraph&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\&quot;/&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>    }</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>  }</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>  <span class="comment">/*if(doCoarseGraphEdges_)</span></div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span><span class="comment">  {</span></div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span><span class="comment">    for(int i = 0; i &lt; numProcs; i++)</span></div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span><span class="comment">    {</span></div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span><span class="comment">      std::string fn = replaceAll(baseFname, &quot;%PROCID&quot;, toString(i));</span></div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span><span class="comment">      pvtu &lt;&lt; &quot;    &lt;Piece Source=\&quot;&quot; &lt;&lt; fn.insert(fn.rfind(&quot;.vtu&quot;), &quot;-coarsegraph&quot;) &lt;&lt; &quot;\&quot;/&gt;&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span><span class="comment">    }</span></div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span><span class="comment">  }*/</span></div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>  pvtu &lt;&lt; <span class="stringliteral">&quot;  &lt;/PUnstructuredGrid&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>  pvtu &lt;&lt; <span class="stringliteral">&quot;&lt;/VTKFile&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>  pvtu.close();</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>}</div>
</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span> </div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> Scalar, <span class="keyword">class</span> LocalOrdinal, <span class="keyword">class</span> GlobalOrdinal, <span class="keyword">class</span> Node&gt;</div>
<div class="foldopen" id="foldopen01132" data-start="{" data-end="}">
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"><a class="line" href="classMueLu_1_1VisualizationHelpers.html#ad24f6fc139566c73cbcfdf00ba25a84d"> 1132</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMueLu_1_1VisualizationHelpers.html#ad24f6fc139566c73cbcfdf00ba25a84d">VisualizationHelpers&lt;Scalar, LocalOrdinal, GlobalOrdinal, Node&gt;::buildColormap</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>  <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>    std::ofstream color(<span class="stringliteral">&quot;random-colormap.xml&quot;</span>);</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>    color &lt;&lt; <span class="stringliteral">&quot;&lt;ColorMap name=\&quot;MueLu-Random\&quot; space=\&quot;RGB\&quot;&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>    <span class="comment">// Give -1, -2, -3 distinctive colors (so that the style functions can have constrasted geometry types)</span></div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>    <span class="comment">// Do red, orange, yellow to constrast with cool color spectrum for other types</span></div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>    color &lt;&lt; <span class="stringliteral">&quot;  &lt;Point x=\&quot;&quot;</span> &lt;&lt; -1 &lt;&lt; <span class="stringliteral">&quot;\&quot; o=\&quot;1\&quot; r=\&quot;1\&quot; g=\&quot;0\&quot; b=\&quot;0\&quot;/&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>    color &lt;&lt; <span class="stringliteral">&quot;  &lt;Point x=\&quot;&quot;</span> &lt;&lt; -2 &lt;&lt; <span class="stringliteral">&quot;\&quot; o=\&quot;1\&quot; r=\&quot;1\&quot; g=\&quot;0.6\&quot; b=\&quot;0\&quot;/&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>    color &lt;&lt; <span class="stringliteral">&quot;  &lt;Point x=\&quot;&quot;</span> &lt;&lt; -3 &lt;&lt; <span class="stringliteral">&quot;\&quot; o=\&quot;1\&quot; r=\&quot;1\&quot; g=\&quot;1\&quot; b=\&quot;0\&quot;/&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>    srand(time(NULL));</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 5000; i += 4) {</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>      color &lt;&lt; <span class="stringliteral">&quot;  &lt;Point x=\&quot;&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\&quot; o=\&quot;1\&quot; r=\&quot;&quot;</span> &lt;&lt; (rand() % 50) / 256.0 &lt;&lt; <span class="stringliteral">&quot;\&quot; g=\&quot;&quot;</span> &lt;&lt; (rand() % 256) / 256.0 &lt;&lt; <span class="stringliteral">&quot;\&quot; b=\&quot;&quot;</span> &lt;&lt; (rand() % 256) / 256.0 &lt;&lt; <span class="stringliteral">&quot;\&quot;/&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>    }</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>    color &lt;&lt; <span class="stringliteral">&quot;&lt;/ColorMap&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>    color.close();</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>  } <span class="keywordflow">catch</span> (std::exception&amp; e) {</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>    TEUCHOS_TEST_FOR_EXCEPTION(<span class="keyword">true</span>, <a class="code hl_class" href="classMueLu_1_1Exceptions_1_1RuntimeError.html">Exceptions::RuntimeError</a>,</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>                               <span class="stringliteral">&quot;VisualizationHelpers::buildColormap: Error while building colormap file: &quot;</span> &lt;&lt; e.what());</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>  }</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>}</div>
</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span> </div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>}  <span class="comment">// namespace MueLu</span></div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span> </div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span><span class="preprocessor">#endif </span><span class="comment">/* MUELU_VISUALIZATIONHELPERS_DEF_HPP_ */</span><span class="preprocessor"></span></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="ttc" id="aMueLu__Level_8hpp_html"><div class="ttname"><a href="MueLu__Level_8hpp.html">MueLu_Level.hpp</a></div></div>
<div class="ttc" id="aMueLu__UseDefaultTypes_8hpp_html_a226b8cca25ba3f3d741bc52854fe8601"><div class="ttname"><a href="MueLu__UseDefaultTypes_8hpp.html#a226b8cca25ba3f3d741bc52854fe8601">LocalOrdinal</a></div><div class="ttdeci">MueLu::DefaultLocalOrdinal LocalOrdinal</div><div class="ttdef"><b>Definition</b> <a href="MueLu__UseDefaultTypes_8hpp_source.html#l00013">MueLu_UseDefaultTypes.hpp:13</a></div></div>
<div class="ttc" id="aMueLu__UseDefaultTypes_8hpp_html_a4730156daf25e1b41a9e14299c5d8f72"><div class="ttname"><a href="MueLu__UseDefaultTypes_8hpp.html#a4730156daf25e1b41a9e14299c5d8f72">GlobalOrdinal</a></div><div class="ttdeci">MueLu::DefaultGlobalOrdinal GlobalOrdinal</div><div class="ttdef"><b>Definition</b> <a href="MueLu__UseDefaultTypes_8hpp_source.html#l00014">MueLu_UseDefaultTypes.hpp:14</a></div></div>
<div class="ttc" id="aMueLu__VisualizationHelpers__decl_8hpp_html"><div class="ttname"><a href="MueLu__VisualizationHelpers__decl_8hpp.html">MueLu_VisualizationHelpers_decl.hpp</a></div></div>
<div class="ttc" id="aclassMueLu_1_1Exceptions_1_1RuntimeError_html"><div class="ttname"><a href="classMueLu_1_1Exceptions_1_1RuntimeError.html">MueLu::Exceptions::RuntimeError</a></div><div class="ttdoc">Exception throws to report errors in the internal logical of the program.</div><div class="ttdef"><b>Definition</b> <a href="MueLu__Exceptions_8hpp_source.html#l00036">MueLu_Exceptions.hpp:36</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a06890a103de7f8c7cd8fc198fceb933d"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a06890a103de7f8c7cd8fc198fceb933d">MueLu::VisualizationHelpers::writeFileVTKData</a></div><div class="ttdeci">void writeFileVTKData(std::ofstream &amp;fout, std::vector&lt; int &gt; &amp;uniqueFine, LocalOrdinal myAggOffset, ArrayRCP&lt; LocalOrdinal &gt; &amp;vertex2AggId, int myRank) const</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00988">MueLu_VisualizationHelpers_def.hpp:988</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a10347089a222a6066228c9b64702c545"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a10347089a222a6066228c9b64702c545">MueLu::VisualizationHelpers::ccw</a></div><div class="ttdeci">static int ccw(const myVec2 &amp;a, const myVec2 &amp;b, const myVec2 &amp;c)</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00545">MueLu_VisualizationHelpers_def.hpp:545</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a10fe92776ff5f710039ee87e4dff7620"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a10fe92776ff5f710039ee87e4dff7620">MueLu::VisualizationHelpers::pointDistFromTri</a></div><div class="ttdeci">static double pointDistFromTri(myVec3 point, myVec3 v1, myVec3 v2, myVec3 v3)</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00616">MueLu_VisualizationHelpers_def.hpp:616</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a192c05e474ef69155a661b86e5a8d24c"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a192c05e474ef69155a661b86e5a8d24c">MueLu::VisualizationHelpers::doGraphEdges</a></div><div class="ttdeci">static void doGraphEdges(std::vector&lt; int &gt; &amp;vertices, std::vector&lt; int &gt; &amp;geomSizes, Teuchos::RCP&lt; LWGraph &gt; &amp;G, Teuchos::ArrayRCP&lt; const typename Teuchos::ScalarTraits&lt; Scalar &gt;::coordinateType &gt; &amp;fx, Teuchos::ArrayRCP&lt; const typename Teuchos::ScalarTraits&lt; Scalar &gt;::coordinateType &gt; &amp;fy, Teuchos::ArrayRCP&lt; const typename Teuchos::ScalarTraits&lt; Scalar &gt;::coordinateType &gt; &amp;fz)</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00511">MueLu_VisualizationHelpers_def.hpp:511</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a1b72a3e9b288cf17c78cbbfe07c0ace6"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a1b72a3e9b288cf17c78cbbfe07c0ace6">MueLu::VisualizationHelpers::writeFileVTKClosing</a></div><div class="ttdeci">void writeFileVTKClosing(std::ofstream &amp;fout) const</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l01086">MueLu_VisualizationHelpers_def.hpp:1086</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a1f99a21d65237d176a64da0671b64537"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a1f99a21d65237d176a64da0671b64537">MueLu::VisualizationHelpers::crossProduct</a></div><div class="ttdeci">static myVec3 crossProduct(myVec3 v1, myVec3 v2)</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00552">MueLu_VisualizationHelpers_def.hpp:552</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a28307e67db3212aabcdc80f3aea74605"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a28307e67db3212aabcdc80f3aea74605">MueLu::VisualizationHelpers::replaceAll</a></div><div class="ttdeci">std::string replaceAll(std::string result, const std::string &amp;replaceWhat, const std::string &amp;replaceWithWhat) const</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00913">MueLu_VisualizationHelpers_def.hpp:913</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a2ffa22b5576e8526ce8d3eec1bd75bfa"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a2ffa22b5576e8526ce8d3eec1bd75bfa">MueLu::VisualizationHelpers::vecSubtract</a></div><div class="ttdeci">static myVec2 vecSubtract(myVec2 v1, myVec2 v2)</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00593">MueLu_VisualizationHelpers_def.hpp:593</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a35b5a1326f3d02574b65150c5fe3b95e"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a35b5a1326f3d02574b65150c5fe3b95e">MueLu::VisualizationHelpers::getBaseFileName</a></div><div class="ttdeci">std::string getBaseFileName(int numProcs, int level, const Teuchos::ParameterList &amp;pL) const</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00931">MueLu_VisualizationHelpers_def.hpp:931</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a3c5008b862e28cb4daf1309c75e29124"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a3c5008b862e28cb4daf1309c75e29124">MueLu::VisualizationHelpers::getFileName</a></div><div class="ttdeci">std::string getFileName(int numProcs, int myRank, int level, const Teuchos::ParameterList &amp;pL) const</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00924">MueLu_VisualizationHelpers_def.hpp:924</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a3e4a5f15cc69a611889e8bbe9729dca4"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a3e4a5f15cc69a611889e8bbe9729dca4">MueLu::VisualizationHelpers::getPVTUFileName</a></div><div class="ttdeci">std::string getPVTUFileName(int numProcs, int myRank, int level, const Teuchos::ParameterList &amp;pL) const</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00948">MueLu_VisualizationHelpers_def.hpp:948</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a614a9a5d3abfcb7e01b92ee9a31aff7e"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a614a9a5d3abfcb7e01b92ee9a31aff7e">MueLu::VisualizationHelpers::writeFileVTKOpening</a></div><div class="ttdeci">void writeFileVTKOpening(std::ofstream &amp;fout, std::vector&lt; int &gt; &amp;uniqueFine, std::vector&lt; int &gt; &amp;geomSizesFine) const</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00957">MueLu_VisualizationHelpers_def.hpp:957</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a643e1adfaa8bf12e477173883255f580"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a643e1adfaa8bf12e477173883255f580">MueLu::VisualizationHelpers::makeUnique</a></div><div class="ttdeci">std::vector&lt; int &gt; makeUnique(std::vector&lt; int &gt; &amp;vertices) const</div><div class="ttdoc">replaces node indices in vertices with compressed unique indices, and returns list of unique points</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00883">MueLu_VisualizationHelpers_def.hpp:883</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a649a937a650bc64654b221144e57cf66"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a649a937a650bc64654b221144e57cf66">MueLu::VisualizationHelpers::getNorm</a></div><div class="ttdeci">static myVec2 getNorm(myVec2 v)</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00603">MueLu_VisualizationHelpers_def.hpp:603</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a73f5a8c3b6130d875992c8e75f7ad9c8"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a73f5a8c3b6130d875992c8e75f7ad9c8">MueLu::VisualizationHelpers::dotProduct</a></div><div class="ttdeci">static double dotProduct(myVec2 v1, myVec2 v2)</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00557">MueLu_VisualizationHelpers_def.hpp:557</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a749c8be66b363042fcf09d4e17aa266e"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a749c8be66b363042fcf09d4e17aa266e">MueLu::VisualizationHelpers::doConvexHulls2D</a></div><div class="ttdeci">static void doConvexHulls2D(std::vector&lt; int &gt; &amp;vertices, std::vector&lt; int &gt; &amp;geomSizes, LO numLocalAggs, LO numFineNodes, const std::vector&lt; bool &gt; &amp;isRoot, const ArrayRCP&lt; LO &gt; &amp;vertex2AggId, const Teuchos::ArrayRCP&lt; const typename Teuchos::ScalarTraits&lt; Scalar &gt;::coordinateType &gt; &amp;xCoords, const Teuchos::ArrayRCP&lt; const typename Teuchos::ScalarTraits&lt; Scalar &gt;::coordinateType &gt; &amp;yCoords)</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00086">MueLu_VisualizationHelpers_def.hpp:86</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a883065a027aebbf0711f7a0003961e91"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a883065a027aebbf0711f7a0003961e91">MueLu::VisualizationHelpers::processTriangle</a></div><div class="ttdeci">static std::vector&lt; myTriangle &gt; processTriangle(std::list&lt; myTriangle &gt; &amp;tris, myTriangle tri, std::list&lt; int &gt; &amp;pointsInFront, myVec3 &amp;barycenter, const Teuchos::ArrayRCP&lt; const typename Teuchos::ScalarTraits&lt; Scalar &gt;::coordinateType &gt; &amp;xCoords, const Teuchos::ArrayRCP&lt; const typename Teuchos::ScalarTraits&lt; Scalar &gt;::coordinateType &gt; &amp;yCoords, const Teuchos::ArrayRCP&lt; const typename Teuchos::ScalarTraits&lt; Scalar &gt;::coordinateType &gt; &amp;zCoords)</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00654">MueLu_VisualizationHelpers_def.hpp:654</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a89e429706e2669e10204a05121550a05"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a89e429706e2669e10204a05121550a05">MueLu::VisualizationHelpers::doConvexHulls3D</a></div><div class="ttdeci">static void doConvexHulls3D(std::vector&lt; int &gt; &amp;vertices, std::vector&lt; int &gt; &amp;geomSizes, LO numLocalAggs, LO numFineNodes, const std::vector&lt; bool &gt; &amp;isRoot, const ArrayRCP&lt; LO &gt; &amp;vertex2AggId, const Teuchos::ArrayRCP&lt; const typename Teuchos::ScalarTraits&lt; Scalar &gt;::coordinateType &gt; &amp;xCoords, const Teuchos::ArrayRCP&lt; const typename Teuchos::ScalarTraits&lt; Scalar &gt;::coordinateType &gt; &amp;yCoords, const Teuchos::ArrayRCP&lt; const typename Teuchos::ScalarTraits&lt; Scalar &gt;::coordinateType &gt; &amp;zCoords)</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00180">MueLu_VisualizationHelpers_def.hpp:180</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a9cddcf7f695d8374a40cf4f4185762d2"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a9cddcf7f695d8374a40cf4f4185762d2">MueLu::VisualizationHelpers::writeFileVTKCoordinates</a></div><div class="ttdeci">void writeFileVTKCoordinates(std::ofstream &amp;fout, std::vector&lt; int &gt; &amp;uniqueFine, Teuchos::ArrayRCP&lt; const typename Teuchos::ScalarTraits&lt; Scalar &gt;::coordinateType &gt; &amp;fx, Teuchos::ArrayRCP&lt; const typename Teuchos::ScalarTraits&lt; Scalar &gt;::coordinateType &gt; &amp;fy, Teuchos::ArrayRCP&lt; const typename Teuchos::ScalarTraits&lt; Scalar &gt;::coordinateType &gt; &amp;fz, int dim) const</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l01014">MueLu_VisualizationHelpers_def.hpp:1014</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_a9d30041d95d18534247461c11b25d907"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#a9d30041d95d18534247461c11b25d907">MueLu::VisualizationHelpers::isInFront</a></div><div class="ttdeci">static bool isInFront(myVec3 point, myVec3 inPlane, myVec3 n)</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00567">MueLu_VisualizationHelpers_def.hpp:567</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_aa82a51f16cd6497ae05d9b626baab8e3"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#aa82a51f16cd6497ae05d9b626baab8e3">MueLu::VisualizationHelpers::distance</a></div><div class="ttdeci">static double distance(myVec2 p1, myVec2 p2)</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00583">MueLu_VisualizationHelpers_def.hpp:583</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_ab3bb8cb67c03c36e213ae76bc1dcf892"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#ab3bb8cb67c03c36e213ae76bc1dcf892">MueLu::VisualizationHelpers::writeFileVTKCells</a></div><div class="ttdeci">void writeFileVTKCells(std::ofstream &amp;fout, std::vector&lt; int &gt; &amp;uniqueFine, std::vector&lt; LocalOrdinal &gt; &amp;vertices, std::vector&lt; LocalOrdinal &gt; &amp;geomSize) const</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l01035">MueLu_VisualizationHelpers_def.hpp:1035</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_abe7a55f57c0c4da7f1e3729dad6ced04"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#abe7a55f57c0c4da7f1e3729dad6ced04">MueLu::VisualizationHelpers::doPointCloud</a></div><div class="ttdeci">static void doPointCloud(std::vector&lt; int &gt; &amp;vertices, std::vector&lt; int &gt; &amp;geomSizes, LO numLocalAggs, LO numFineNodes)</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00042">MueLu_VisualizationHelpers_def.hpp:42</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_ac7167aaaddd98ebebc0df2519ffb5b4a"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#ac7167aaaddd98ebebc0df2519ffb5b4a">MueLu::VisualizationHelpers::GetValidParameterList</a></div><div class="ttdeci">RCP&lt; ParameterList &gt; GetValidParameterList() const</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00028">MueLu_VisualizationHelpers_def.hpp:28</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_ad01fcb8ebfdc239041f654504a2708ab"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#ad01fcb8ebfdc239041f654504a2708ab">MueLu::VisualizationHelpers::mymagnitude</a></div><div class="ttdeci">static double mymagnitude(myVec2 vec)</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00573">MueLu_VisualizationHelpers_def.hpp:573</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_ad24f6fc139566c73cbcfdf00ba25a84d"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#ad24f6fc139566c73cbcfdf00ba25a84d">MueLu::VisualizationHelpers::buildColormap</a></div><div class="ttdeci">void buildColormap() const</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l01132">MueLu_VisualizationHelpers_def.hpp:1132</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_ad3821c5e41b7c29f50b7b6927794a6da"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#ad3821c5e41b7c29f50b7b6927794a6da">MueLu::VisualizationHelpers::writePVTU</a></div><div class="ttdeci">void writePVTU(std::ofstream &amp;pvtu, std::string baseFname, int numProcs, bool bFineEdges=false, bool bCoarseEdges=false) const</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l01093">MueLu_VisualizationHelpers_def.hpp:1093</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_aedc7389d41263a63ea380476d657896c"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#aedc7389d41263a63ea380476d657896c">MueLu::VisualizationHelpers::giftWrap</a></div><div class="ttdeci">static std::vector&lt; int &gt; giftWrap(std::vector&lt; myVec2 &gt; &amp;points, std::vector&lt; int &gt; &amp;nodes, const Teuchos::ArrayRCP&lt; const typename Teuchos::ScalarTraits&lt; Scalar &gt;::coordinateType &gt; &amp;xCoords, const Teuchos::ArrayRCP&lt; const typename Teuchos::ScalarTraits&lt; Scalar &gt;::coordinateType &gt; &amp;yCoords)</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00791">MueLu_VisualizationHelpers_def.hpp:791</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_aee1120cdadcbd2a44d9ce81e98b4f002"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#aee1120cdadcbd2a44d9ce81e98b4f002">MueLu::VisualizationHelpers::doJacks</a></div><div class="ttdeci">static void doJacks(std::vector&lt; int &gt; &amp;vertices, std::vector&lt; int &gt; &amp;geomSizes, LO numLocalAggs, LO numFineNodes, const std::vector&lt; bool &gt; &amp;isRoot, const ArrayRCP&lt; LO &gt; &amp;vertex2AggId)</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00052">MueLu_VisualizationHelpers_def.hpp:52</a></div></div>
<div class="ttc" id="aclassMueLu_1_1VisualizationHelpers_html_af643681fda381b93f142dc8de93809ca"><div class="ttname"><a href="classMueLu_1_1VisualizationHelpers.html#af643681fda381b93f142dc8de93809ca">MueLu::VisualizationHelpers::writeFileVTKNodes</a></div><div class="ttdeci">void writeFileVTKNodes(std::ofstream &amp;fout, std::vector&lt; int &gt; &amp;uniqueFine, Teuchos::RCP&lt; const Map &gt; &amp;nodeMap) const</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__def_8hpp_source.html#l00969">MueLu_VisualizationHelpers_def.hpp:969</a></div></div>
<div class="ttc" id="aclassMueLu_1_1myTriangle_html"><div class="ttname"><a href="classMueLu_1_1myTriangle.html">MueLu::myTriangle</a></div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__decl_8hpp_source.html#l00024">MueLu_VisualizationHelpers_decl.hpp:24</a></div></div>
<div class="ttc" id="aclassMueLu_1_1myTriangle_html_a1eda0fb1797d6a23abf3824e71c8d762"><div class="ttname"><a href="classMueLu_1_1myTriangle.html#a1eda0fb1797d6a23abf3824e71c8d762">MueLu::myTriangle::v3</a></div><div class="ttdeci">int v3</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__decl_8hpp_source.html#l00042">MueLu_VisualizationHelpers_decl.hpp:42</a></div></div>
<div class="ttc" id="aclassMueLu_1_1myTriangle_html_a467a19b7f4de655fb26db5f12a68cd48"><div class="ttname"><a href="classMueLu_1_1myTriangle.html#a467a19b7f4de655fb26db5f12a68cd48">MueLu::myTriangle::v2</a></div><div class="ttdeci">int v2</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__decl_8hpp_source.html#l00041">MueLu_VisualizationHelpers_decl.hpp:41</a></div></div>
<div class="ttc" id="aclassMueLu_1_1myTriangle_html_ae354eeb0a7b130c100e2ba4d9069e794"><div class="ttname"><a href="classMueLu_1_1myTriangle.html#ae354eeb0a7b130c100e2ba4d9069e794">MueLu::myTriangle::v1</a></div><div class="ttdeci">int v1</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__decl_8hpp_source.html#l00040">MueLu_VisualizationHelpers_decl.hpp:40</a></div></div>
<div class="ttc" id="aclassMueLu_1_1myVec2_html"><div class="ttname"><a href="classMueLu_1_1myVec2.html">MueLu::myVec2</a></div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__decl_8hpp_source.html#l00061">MueLu_VisualizationHelpers_decl.hpp:61</a></div></div>
<div class="ttc" id="aclassMueLu_1_1myVec2_html_ae39886f516ec2a16a0012b85856bebf6"><div class="ttname"><a href="classMueLu_1_1myVec2.html#ae39886f516ec2a16a0012b85856bebf6">MueLu::myVec2::x</a></div><div class="ttdeci">double x</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__decl_8hpp_source.html#l00070">MueLu_VisualizationHelpers_decl.hpp:70</a></div></div>
<div class="ttc" id="aclassMueLu_1_1myVec2_html_ae6306959963c02bd68f6d82be9a20992"><div class="ttname"><a href="classMueLu_1_1myVec2.html#ae6306959963c02bd68f6d82be9a20992">MueLu::myVec2::y</a></div><div class="ttdeci">double y</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__decl_8hpp_source.html#l00071">MueLu_VisualizationHelpers_decl.hpp:71</a></div></div>
<div class="ttc" id="aclassMueLu_1_1myVec3_html"><div class="ttname"><a href="classMueLu_1_1myVec3.html">MueLu::myVec3</a></div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__decl_8hpp_source.html#l00045">MueLu_VisualizationHelpers_decl.hpp:45</a></div></div>
<div class="ttc" id="aclassMueLu_1_1myVec3_html_a1f2f1c397279a9b70ab333bba3848a6f"><div class="ttname"><a href="classMueLu_1_1myVec3.html#a1f2f1c397279a9b70ab333bba3848a6f">MueLu::myVec3::x</a></div><div class="ttdeci">double x</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__decl_8hpp_source.html#l00056">MueLu_VisualizationHelpers_decl.hpp:56</a></div></div>
<div class="ttc" id="aclassMueLu_1_1myVec3_html_a9a8b94a742592f944361e1d9e19ac919"><div class="ttname"><a href="classMueLu_1_1myVec3.html#a9a8b94a742592f944361e1d9e19ac919">MueLu::myVec3::z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__decl_8hpp_source.html#l00058">MueLu_VisualizationHelpers_decl.hpp:58</a></div></div>
<div class="ttc" id="aclassMueLu_1_1myVec3_html_a9e53927108a11c2673a9357963d75e4f"><div class="ttname"><a href="classMueLu_1_1myVec3.html#a9e53927108a11c2673a9357963d75e4f">MueLu::myVec3::y</a></div><div class="ttdeci">double y</div><div class="ttdef"><b>Definition</b> <a href="MueLu__VisualizationHelpers__decl_8hpp_source.html#l00057">MueLu_VisualizationHelpers_decl.hpp:57</a></div></div>
<div class="ttc" id="anamespaceMueLu_html"><div class="ttname"><a href="namespaceMueLu.html">MueLu</a></div><div class="ttdoc">Namespace for MueLu classes and methods.</div><div class="ttdef"><b>Definition</b> <a href="MueLu__BrickAggregationFactory__decl_8hpp_source.html#l00042">MueLu_BrickAggregationFactory_decl.hpp:42</a></div></div>
<div class="ttc" id="anamespaceMueLu_html_a28cc2d953f9e734910c598332da53b80"><div class="ttname"><a href="namespaceMueLu.html#a28cc2d953f9e734910c598332da53b80">MueLu::replaceAll</a></div><div class="ttdeci">void replaceAll(std::string &amp;str, const std::string &amp;from, const std::string &amp;to)</div><div class="ttdef"><b>Definition</b> <a href="MueLu__ParameterListUtils_8cpp_source.html#l00134">MueLu_ParameterListUtils.cpp:134</a></div></div>
<div class="ttc" id="anamespaceMueLu_html_adffcd9a4c5dd0a4b2cbf6c8e77f27e6b"><div class="ttname"><a href="namespaceMueLu.html#adffcd9a4c5dd0a4b2cbf6c8e77f27e6b">MueLu::toString</a></div><div class="ttdeci">std::string toString(const T &amp;what)</div><div class="ttdoc">Little helper function to convert non-string types to strings.</div><div class="ttdef"><b>Definition</b> <a href="MueLu__Utilities__decl_8hpp_source.html#l00599">MueLu_Utilities_decl.hpp:599</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_a7363e98f9e0bdd87618633653859815.html">Utils</a></li><li class="navelem"><a class="el" href="MueLu__VisualizationHelpers__def_8hpp.html">MueLu_VisualizationHelpers_def.hpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
