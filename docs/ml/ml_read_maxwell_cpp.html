<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ML: ml_read_maxwell.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ML<span id="projectnumber">&#160;Version of the Day</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">ml_read_maxwell.cpp</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="fragment"><div class="line"><span class="comment">/* ******************************************************************** */</span></div>
<div class="line"><span class="comment">/* See the file COPYRIGHT for a complete copyright notice, contact      */</span></div>
<div class="line"><span class="comment">/* person and disclaimer.                                               */</span></div>
<div class="line"><span class="comment">/* ******************************************************************** */</span></div>
<div class="line"><span class="comment">//@HEADER</span></div>
<div class="line"><span class="comment">/*#############################################################################</span></div>
<div class="line"><span class="comment"># CVS File Information</span></div>
<div class="line"><span class="comment">#    Current revision: $Revision$</span></div>
<div class="line"><span class="comment">#    Branch:           $Branch$</span></div>
<div class="line"><span class="comment">#    Last modified:    $Date$</span></div>
<div class="line"><span class="comment">#    Modified by:      $Author$</span></div>
<div class="line"><span class="comment">#############################################################################*/</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//#define CurlCurlAndMassAreSeparate</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">   Sample driver for Maxwell equation AMG solver (Reitzinger/Schoeberl version)</span></div>
<div class="line"><span class="comment">   in the ML package. This example reads in data from a file.  All data must be in</span></div>
<div class="line"><span class="comment">   the MatrixMarket format.  (The EpetraExt documentation describes the format for</span></div>
<div class="line"><span class="comment">   maps.)  This example can be compiled and used in two different ways:</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   -----------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">   USAGE CASE 1 (default): curl,curl and mass are provided as one matrix</span></div>
<div class="line"><span class="comment">   -----------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   By default, it&#39;s assumed that the edge FE input matrix is curl,curl + mass.</span></div>
<div class="line"><span class="comment">   In this case, invoke the example as follows:</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">      ml_read_maxwell.exe Ke T Kn [rhs] [xml deck] [edge map] [node map]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   where</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">      Ke is the edge FE matrix (curlcurl + mass)</span></div>
<div class="line"><span class="comment">      T is the topological gradient matrix</span></div>
<div class="line"><span class="comment">      Kn is the nodal FE matrix</span></div>
<div class="line"><span class="comment">      rhs is the rhs vector (optional)</span></div>
<div class="line"><span class="comment">      xml deck for ML options (optional)</span></div>
<div class="line"><span class="comment">      edge map (optional)</span></div>
<div class="line"><span class="comment">      node map (optional)</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   -----------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">   USAGE CASE 2:  curl,curl and mass matrices are separate</span></div>
<div class="line"><span class="comment">   -----------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   If the macro CurlCurlAndMassAreSeparate is defined, then the edge FE</span></div>
<div class="line"><span class="comment">   (curl,curl) and mass matrices are read in separately.  In this case, invoke</span></div>
<div class="line"><span class="comment">   the example as follows:</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">      ml_read_maxwell.exe S M T Kn [rhs] [xml deck] [edge map] [node map]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   where</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">      S is the curl curl matrix</span></div>
<div class="line"><span class="comment">      M is the mass matrix</span></div>
<div class="line"><span class="comment">      T is the discrete gradient matrix</span></div>
<div class="line"><span class="comment">      Kn is the nodal FE matrix</span></div>
<div class="line"><span class="comment">      rhs is the rhs vector (optional)</span></div>
<div class="line"><span class="comment">      xml deck for ML options (optional)</span></div>
<div class="line"><span class="comment">      edge map (optional)</span></div>
<div class="line"><span class="comment">      node map (optional)</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   Matrices are read from file via the local function</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">     int MatrixMarketFileToCrsMatrix(const char *filename,</span></div>
<div class="line"><span class="comment">                                  const Epetra_Map &amp; rowMap,</span></div>
<div class="line"><span class="comment">                                  const Epetra_Map&amp; rangeMap,</span></div>
<div class="line"><span class="comment">                                  const Epetra_Map&amp; domainMap,</span></div>
<div class="line"><span class="comment">                                  Epetra_CrsMatrix * &amp; A)</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   and the row maps with</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">       EpetraExt::MatrixMarketFileToMap(datafile, Comm, nodeMap).</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   In this function the domainMap is calculated on the fly in order to ensure</span></div>
<div class="line"><span class="comment">   the same number of non zeros independent of the number of processors used.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;ml_include.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#if defined(HAVE_ML_EPETRA) &amp;&amp; defined(HAVE_ML_TEUCHOS) &amp;&amp; defined(HAVE_ML_EPETRAEXT) &amp;&amp; defined(HAVE_ML_AZTECOO)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><span class="preprocessor">#include &quot;mpi.h&quot;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor">#include &quot;Epetra_Map.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Epetra_Vector.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Epetra_CrsMatrix.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Epetra_LinearProblem.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Epetra_Export.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;AztecOO.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ml__epetra__utils_8h.html">ml_epetra_utils.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;ml_epetra.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ml__MultiLevelPreconditioner_8h.html">ml_MultiLevelPreconditioner.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Teuchos_ParameterList.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Teuchos_DefaultComm.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Teuchos_XMLParameterListHelpers.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;EpetraExt_RowMatrixOut.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;EpetraExt_VectorOut.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;EpetraExt_BlockMapOut.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;EpetraExt_BlockMapIn.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;EpetraExt_CrsMatrixIn.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;EpetraExt_VectorIn.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//read in Crs Matrix and calculate domainMap on the fly</span></div>
<div class="line"><span class="keywordtype">int</span> MatrixMarketFileToCrsMatrix(<span class="keyword">const</span> <span class="keywordtype">char</span> *filename,</div>
<div class="line">                                <span class="keyword">const</span> <a class="code hl_classRef" href="../../../epetra/doc/html/classEpetra__Map.html">Epetra_Map</a> &amp; rowMap,</div>
<div class="line">                                <span class="keyword">const</span> <a class="code hl_classRef" href="../../../epetra/doc/html/classEpetra__Map.html">Epetra_Map</a>&amp; rangeMap,</div>
<div class="line">                                <span class="keyword">const</span> <a class="code hl_classRef" href="../../../epetra/doc/html/classEpetra__Map.html">Epetra_Map</a>&amp; domainMap,</div>
<div class="line">                                <a class="code hl_classRef" href="../../../epetra/doc/html/classEpetra__CrsMatrix.html">Epetra_CrsMatrix</a> *&amp; A)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">return</span>(EpetraExt::MatrixMarketFileToCrsMatrixHandle(filename, rowMap.<a class="code hl_functionRef" href="../../../epetra/doc/html/classEpetra__BlockMap.html#abd9d6c774319c3bb5e79039058416a92">Comm</a>(), A,</div>
<div class="line">                                                      &amp;rowMap,NULL,</div>
<div class="line">                                                      &amp;rangeMap, &amp;domainMap));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> MatrixMarketFileToVector(<span class="keyword">const</span> <span class="keywordtype">char</span> *filename, <span class="keyword">const</span> <a class="code hl_classRef" href="../../../epetra/doc/html/classEpetra__Map.html">Epetra_Map</a> &amp; map, <a class="code hl_classRef" href="../../../epetra/doc/html/classEpetra__Vector.html">Epetra_Vector</a> *&amp; v) {</div>
<div class="line">  <span class="keywordflow">return</span> EpetraExt::MatrixMarketFileToVector(filename,map,v);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">ML_Comm *mlcomm;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ML_MPI</span></div>
<div class="line">  MPI_Init(&amp;argc,&amp;argv);</div>
<div class="line">  <span class="comment">// This next bit of code drops a middle rank out of the calculation. This tests</span></div>
<div class="line">  <span class="comment">// that the Hiptmair smoother does not hang in its apply.  Hiptmair creates</span></div>
<div class="line">  <span class="comment">// two separate ML objects, one for edge and one for nodes.  By default, the ML</span></div>
<div class="line">  <span class="comment">// objects use MPI_COMM_WORLD, whereas the matrix that Hiptmair is being applied to</span></div>
<div class="line">  <span class="comment">// may have an MPI subcommunicator.</span></div>
<div class="line">  <span class="keywordtype">int</span> commWorldSize;</div>
<div class="line">  MPI_Comm_size(MPI_COMM_WORLD,&amp;commWorldSize);</div>
<div class="line">  std::vector&lt;int&gt; splitKey;</div>
<div class="line">  <span class="keywordtype">int</span> rankToDrop = 1;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;commWorldSize; ++i)</div>
<div class="line">    splitKey.push_back(0);</div>
<div class="line">  splitKey[rankToDrop] = MPI_UNDEFINED; <span class="comment">//drop the last process from subcommunicator</span></div>
<div class="line">  <span class="keywordtype">int</span> myrank;</div>
<div class="line">  MPI_Comm_rank(MPI_COMM_WORLD, &amp;myrank);</div>
<div class="line">  MPI_Comm subcomm;</div>
<div class="line">  MPI_Comm_split(MPI_COMM_WORLD, splitKey[myrank], myrank, &amp;subcomm);</div>
<div class="line">  <span class="keywordflow">if</span> (myrank == rankToDrop) <span class="keywordflow">goto</span> droppedRankLabel;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">{ <span class="comment">//scoping to avoid compiler error about goto jumping over initialization</span></div>
<div class="line"><span class="preprocessor">#ifdef ML_MPI</span></div>
<div class="line">  <a class="code hl_classRef" href="../../../epetra/doc/html/classEpetra__MpiComm.html">Epetra_MpiComm</a> Comm(subcomm);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">  <a class="code hl_classRef" href="../../../epetra/doc/html/classEpetra__SerialComm.html">Epetra_SerialComm</a> Comm;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  ML_Comm_Create(&amp;mlcomm);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">char</span> *datafile;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef CurlCurlAndMassAreSeparate</span></div>
<div class="line">  <span class="keywordflow">if</span> (argc &lt; 5 &amp;&amp; argc &gt; 9) {</div>
<div class="line">    <span class="keywordflow">if</span> (Comm.<a class="code hl_functionRef" href="../../../epetra/doc/html/classEpetra__SerialComm.html#a237a6407573dea22f0366936d158486d">MyPID</a>() == 0) {</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;usage: ml_maxwell.exe &lt;S&gt; &lt;M&gt; &lt;T&gt; &lt;Kn&gt; [rhs] [xml file] [edge map] [node map]&quot;</span></div>
<div class="line">           &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;        S = edge stiffness matrix file&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;        M = edge mass matrix file&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;        T = discrete gradient file&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;       Kn = auxiliary nodal FE matrix file&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;      rhs = rhs vector&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot; xml file = xml solver options&quot;</span> &lt;&lt;std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot; edge map = edge distribution over processors&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot; node map = node distribution over processors&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; argc &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"><span class="preprocessor">#else </span><span class="comment">//ifdef CurlCurlAndMassAreSeparate</span></div>
<div class="line"> <span class="keywordflow">if</span> (argc &lt; 4 &amp;&amp; argc &gt; 8) {</div>
<div class="line">    <span class="keywordflow">if</span> (Comm.<a class="code hl_functionRef" href="../../../epetra/doc/html/classEpetra__SerialComm.html#a237a6407573dea22f0366936d158486d">MyPID</a>() == 0) {</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;usage: ml_maxwell.exe &lt;A&gt; &lt;T&gt; &lt;Kn&gt; [rhs] [xml file] [edge map] [node map]&quot;</span> &lt;&lt;std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;        A = edge element matrix file&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;        T = discrete gradient file&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;       Kn = auxiliary nodal FE matrix file&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;      rhs = rhs vector&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot; xml file = xml solver options&quot;</span> &lt;&lt;std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot; edge map = edge distribution over processors&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot; node map = node distribution over processors&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; argc &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">//ifdef CurlCurlAndMassAreSeparate</span></div>
<div class="line"><span class="preprocessor">#ifdef ML_MPI</span></div>
<div class="line">    MPI_Finalize();</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">    exit(1);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_classRef" href="../../../epetra/doc/html/classEpetra__Map.html">Epetra_Map</a> *edgeMap, *nodeMap;</div>
<div class="line">  <a class="code hl_classRef" href="../../../epetra/doc/html/classEpetra__CrsMatrix.html">Epetra_CrsMatrix</a> *CCplusM=NULL, *CurlCurl=NULL, *Mass=NULL, *T=NULL, *Kn=NULL;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// ================================================= //</span></div>
<div class="line">  <span class="comment">// READ IN MAPS FROM FILE                            //</span></div>
<div class="line">  <span class="comment">// ================================================= //</span></div>
<div class="line">  <span class="comment">// every processor reads this in</span></div>
<div class="line"><span class="preprocessor">#ifdef CurlCurlAndMassAreSeparate</span></div>
<div class="line">  <span class="keywordflow">if</span> (argc &gt; 7)</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">  <span class="keywordflow">if</span> (argc &gt; 6)</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  {</div>
<div class="line">    datafile = argv[7];</div>
<div class="line">    <span class="keywordflow">if</span> (Comm.<a class="code hl_functionRef" href="../../../epetra/doc/html/classEpetra__SerialComm.html#a237a6407573dea22f0366936d158486d">MyPID</a>() == 0) {</div>
<div class="line">      printf(<span class="stringliteral">&quot;Reading in edge map from %s ...\n&quot;</span>,datafile);</div>
<div class="line">      fflush(stdout);</div>
<div class="line">    }</div>
<div class="line">    EpetraExt::MatrixMarketFileToMap(datafile, Comm, edgeMap);</div>
<div class="line">    datafile = argv[6];</div>
<div class="line">    <span class="keywordflow">if</span> (Comm.<a class="code hl_functionRef" href="../../../epetra/doc/html/classEpetra__SerialComm.html#a237a6407573dea22f0366936d158486d">MyPID</a>() == 0) {</div>
<div class="line">      printf(<span class="stringliteral">&quot;Reading in node map from %s ...\n&quot;</span>,datafile);</div>
<div class="line">      fflush(stdout);</div>
<div class="line">    }</div>
<div class="line">    EpetraExt::MatrixMarketFileToMap(datafile, Comm, nodeMap);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> { <span class="comment">// linear maps</span></div>
<div class="line">         <span class="comment">// Read the T matrix to determine the map sizes</span></div>
<div class="line">         <span class="comment">// and then construct linear maps</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (Comm.<a class="code hl_functionRef" href="../../../epetra/doc/html/classEpetra__SerialComm.html#a237a6407573dea22f0366936d158486d">MyPID</a>() == 0)</div>
<div class="line">      printf(<span class="stringliteral">&quot;Using linear edge and node maps ...\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> lineLength = 1025;</div>
<div class="line">    <span class="keywordtype">char</span> line[lineLength];</div>
<div class="line">    FILE *handle;</div>
<div class="line">    <span class="keywordtype">int</span> M,N,NZ;</div>
<div class="line"><span class="preprocessor">#ifdef CurlCurlAndMassAreSeparate</span></div>
<div class="line">     handle = fopen(argv[3],<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">     handle = fopen(argv[2],<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">    <span class="keywordflow">if</span> (handle == 0) EPETRA_CHK_ERR(-1); <span class="comment">// file not found</span></div>
<div class="line">    <span class="comment">// Strip off header lines (which start with &quot;%&quot;)</span></div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">       <span class="keywordflow">if</span>(fgets(line, lineLength, handle)==0) {<span class="keywordflow">if</span> (handle!=0) fclose(handle);}</div>
<div class="line">    } <span class="keywordflow">while</span> (line[0] == <span class="charliteral">&#39;%&#39;</span>);</div>
<div class="line">    <span class="comment">// Get problem dimensions: M, N, NZ</span></div>
<div class="line">    <span class="keywordflow">if</span>(sscanf(line,<span class="stringliteral">&quot;%d %d %d&quot;</span>, &amp;M, &amp;N, &amp;NZ)==0) {<span class="keywordflow">if</span> (handle!=0) fclose(handle);}</div>
<div class="line">    fclose(handle);</div>
<div class="line">    edgeMap = <span class="keyword">new</span> <a class="code hl_classRef" href="../../../epetra/doc/html/classEpetra__Map.html">Epetra_Map</a>(M,0,Comm);</div>
<div class="line">    nodeMap = <span class="keyword">new</span> <a class="code hl_classRef" href="../../../epetra/doc/html/classEpetra__Map.html">Epetra_Map</a>(N,0,Comm);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// ===================================================== //</span></div>
<div class="line">  <span class="comment">// PARAMETER LISTS                                       //</span></div>
<div class="line">  <span class="comment">// ===================================================== //</span></div>
<div class="line"> </div>
<div class="line">  Teuchos::ParameterList MLList;</div>
<div class="line">  <span class="keywordtype">int</span> *options    = <span class="keyword">new</span> <span class="keywordtype">int</span>[AZ_OPTIONS_SIZE];</div>
<div class="line">  <span class="keywordtype">double</span> *params  = <span class="keyword">new</span> <span class="keywordtype">double</span>[AZ_PARAMS_SIZE];</div>
<div class="line">  <a class="code hl_function" href="namespaceML__Epetra.html#a56d4ce3baee9b349ed2333326e0ec2b6">ML_Epetra::SetDefaults</a>(<span class="stringliteral">&quot;maxwell&quot;</span>, MLList, options, params);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef CurlCurlAndMassAreSeparate</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> xml_idx = 6;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> xml_idx = 5;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">    <span class="keywordflow">if</span> (argc &gt; xml_idx) {</div>
<div class="line">    Teuchos::updateParametersFromXmlFileAndBroadcast(argv[xml_idx],Teuchos::Ptr&lt;Teuchos::ParameterList&gt;(&amp;MLList),*Teuchos::DefaultComm&lt;int&gt;::getComm());</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    MLList.set(<span class="stringliteral">&quot;ML output&quot;</span>, 10);</div>
<div class="line">    MLList.set(<span class="stringliteral">&quot;aggregation: type&quot;</span>, <span class="stringliteral">&quot;Uncoupled&quot;</span>);</div>
<div class="line">    MLList.set(<span class="stringliteral">&quot;coarse: max size&quot;</span>, 128);  </div>
<div class="line">    MLList.set(<span class="stringliteral">&quot;aggregation: threshold&quot;</span>, 0.0);</div>
<div class="line">    <span class="comment">//MLList.set(&quot;negative conductivity&quot;,true);</span></div>
<div class="line">    <span class="comment">//MLList.set(&quot;smoother: type&quot;, &quot;Jacobi&quot;);</span></div>
<div class="line">    MLList.set(<span class="stringliteral">&quot;subsmoother: type&quot;</span>, <span class="stringliteral">&quot;symmetric Gauss-Seidel&quot;</span>);</div>
<div class="line">    MLList.set(<span class="stringliteral">&quot;max levels&quot;</span>, 2);</div>
<div class="line">    MLList.set(<span class="stringliteral">&quot;aggregation: damping factor&quot;</span>,0.0);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// coarse level solve</span></div>
<div class="line">    MLList.set(<span class="stringliteral">&quot;coarse: type&quot;</span>, <span class="stringliteral">&quot;Amesos-KLU&quot;</span>);</div>
<div class="line">    <span class="comment">//MLList.set(&quot;coarse: type&quot;, &quot;Hiptmair&quot;);</span></div>
<div class="line">    <span class="comment">//MLList.set(&quot;coarse: type&quot;, &quot;Jacobi&quot;);</span></div>
<div class="line">    MLList.set(<span class="stringliteral">&quot;aggregation: do qr&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line">    </div>
<div class="line">    MLList.set(<span class="stringliteral">&quot;smoother: sweeps&quot;</span>,1);</div>
<div class="line">    MLList.set(<span class="stringliteral">&quot;subsmoother: edge sweeps&quot;</span>,1);</div>
<div class="line">    MLList.set(<span class="stringliteral">&quot;subsmoother: node sweeps&quot;</span>,1);</div>
<div class="line">    MLList.set(<span class="stringliteral">&quot;smoother: Hiptmair efficient symmetric&quot;</span>,<span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">//MLList.set(&quot;dump matrix: enable&quot;, true);   </span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// ===================================================== //</span></div>
<div class="line">  <span class="comment">// READ IN MATRICES FROM FILE                            //</span></div>
<div class="line">  <span class="comment">// ===================================================== //</span></div>
<div class="line">  <a class="code hl_classRef" href="../../../epetra/doc/html/classEpetra__Vector.html">Epetra_Vector</a> *rhs=0;</div>
<div class="line"><span class="preprocessor">#ifdef CurlCurlAndMassAreSeparate</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;6; i++) {</div>
<div class="line">    datafile = argv[i];</div>
<div class="line">    <span class="keywordflow">if</span> (Comm.<a class="code hl_functionRef" href="../../../epetra/doc/html/classEpetra__SerialComm.html#a237a6407573dea22f0366936d158486d">MyPID</a>() == 0) {</div>
<div class="line">      printf(<span class="stringliteral">&quot;reading %s ....\n&quot;</span>,datafile); fflush(stdout);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">switch</span> (i) {</div>
<div class="line">    <span class="keywordflow">case</span> 1: <span class="comment">//Curl</span></div>
<div class="line">      MatrixMarketFileToCrsMatrix(datafile,*edgeMap,*edgeMap,*edgeMap,CurlCurl);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> 2: <span class="comment">//Mass</span></div>
<div class="line">      MatrixMarketFileToCrsMatrix(datafile, *edgeMap, *edgeMap, *edgeMap, Mass);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> 3: <span class="comment">//Gradient</span></div>
<div class="line">      MatrixMarketFileToCrsMatrix(datafile, *edgeMap, *edgeMap,*nodeMap, T);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> 4: <span class="comment">//Auxiliary nodal matrix</span></div>
<div class="line">      MatrixMarketFileToCrsMatrix(datafile, *nodeMap,*nodeMap, *nodeMap, Kn);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> 5: <span class="comment">// RHS</span></div>
<div class="line">      MatrixMarketFileToVector(datafile, *edgeMap,rhs);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    } <span class="comment">//switch</span></div>
<div class="line">  } <span class="comment">//for (int i = 1; i &lt;6; i++)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;5; i++) {</div>
<div class="line">    datafile = argv[i];</div>
<div class="line">    <span class="keywordflow">if</span> (Comm.<a class="code hl_functionRef" href="../../../epetra/doc/html/classEpetra__SerialComm.html#a237a6407573dea22f0366936d158486d">MyPID</a>() == 0) {</div>
<div class="line">      printf(<span class="stringliteral">&quot;reading %s ....\n&quot;</span>,datafile); fflush(stdout);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">switch</span> (i) {</div>
<div class="line">    <span class="keywordflow">case</span> 1: <span class="comment">//Edge element matrix</span></div>
<div class="line">      MatrixMarketFileToCrsMatrix(datafile,*edgeMap,*edgeMap,*edgeMap,CCplusM);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> 2: <span class="comment">//Gradient</span></div>
<div class="line">      MatrixMarketFileToCrsMatrix(datafile, *edgeMap, *edgeMap, *nodeMap, T);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> 3: <span class="comment">//Auxiliary nodal matrix</span></div>
<div class="line">      MatrixMarketFileToCrsMatrix(datafile, *nodeMap, *nodeMap, *nodeMap, Kn);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> 4: <span class="comment">// RHS</span></div>
<div class="line">      MatrixMarketFileToVector(datafile, *edgeMap,rhs);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    } <span class="comment">//switch</span></div>
<div class="line">  } <span class="comment">//for (int i = 1; i &lt;5; i++)</span></div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">//ifdef CurlCurlAndMassAreSeparate</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// ==================================================== //</span></div>
<div class="line">  <span class="comment">// S E T U P   O F    M L   P R E C O N D I T I O N E R //</span></div>
<div class="line">  <span class="comment">// ==================================================== //</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span>(Comm.<a class="code hl_functionRef" href="../../../epetra/doc/html/classEpetra__SerialComm.html#a237a6407573dea22f0366936d158486d">MyPID</a>()==0) </div>
<div class="line">    std::cout&lt;&lt;<span class="stringliteral">&quot;*** ML Parameters ***\n&quot;</span>&lt;&lt;MLList&lt;&lt;std::endl;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef CurlCurlAndMassAreSeparate</span></div>
<div class="line">  <span class="comment">//Create the matrix of interest.</span></div>
<div class="line">  CCplusM = <a class="code hl_function" href="ml__epetra__utils_8h.html#abd736026b1cdf8c4a875ef2285f0f438">Epetra_MatrixAdd</a>(CurlCurl,Mass,1.0);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef CurlCurlAndMassAreSeparate</span></div>
<div class="line">  <a class="code hl_class" href="classML__Epetra_1_1MultiLevelPreconditioner.html">ML_Epetra::MultiLevelPreconditioner</a> * MLPrec =</div>
<div class="line">    <span class="keyword">new</span> <a class="code hl_class" href="classML__Epetra_1_1MultiLevelPreconditioner.html">ML_Epetra::MultiLevelPreconditioner</a>(*CurlCurl, *Mass, *T, *Kn, MLList);</div>
<div class="line">  <span class="comment">// Comment out the line above and uncomment the next one if you have</span></div>
<div class="line">  <span class="comment">// mass and curl separately but want to precondition as if they are added</span></div>
<div class="line">  <span class="comment">// together.</span></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">  ML_Epetra::MultiLevelPreconditioner * MLPrec =</span></div>
<div class="line"><span class="comment">    new ML_Epetra::MultiLevelPreconditioner(*CCplusM, *T, *Kn, MLList);</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">  <a class="code hl_class" href="classML__Epetra_1_1MultiLevelPreconditioner.html">ML_Epetra::MultiLevelPreconditioner</a> * MLPrec =</div>
<div class="line">    <span class="keyword">new</span> <a class="code hl_class" href="classML__Epetra_1_1MultiLevelPreconditioner.html">ML_Epetra::MultiLevelPreconditioner</a>(*CCplusM, *T, *Kn, MLList);</div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">//ifdef CurlCurlAndMassAreSeparate</span></div>
<div class="line"> </div>
<div class="line">  MLPrec-&gt;<a class="code hl_function" href="classML__Epetra_1_1MultiLevelPreconditioner.html#a16598f2eb932306426aebd561af4dc15">PrintUnused</a>(0);</div>
<div class="line"> </div>
<div class="line">  MLPrec-&gt;<a class="code hl_function" href="classML__Epetra_1_1MultiLevelPreconditioner.html#a9303867b4ffe267f3962ab66f36d21e1">Print</a>(-1);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// ========================================================= //</span></div>
<div class="line">  <span class="comment">// D E F I N I T I O N   O F   A Z T E C O O   P R O B L E M //</span></div>
<div class="line">  <span class="comment">// ========================================================= //</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// create left-hand side and right-hand side, and populate them with</span></div>
<div class="line">  <span class="comment">// data from file. Both vectors are defined on the domain map of the</span></div>
<div class="line">  <span class="comment">// edge matrix.</span></div>
<div class="line">  <span class="comment">// Epetra_Vectors can be created in View mode, to accept pointers to</span></div>
<div class="line">  <span class="comment">// double vectors.</span></div>
<div class="line"> </div>
<div class="line">  <a class="code hl_classRef" href="../../../epetra/doc/html/classEpetra__Vector.html">Epetra_Vector</a> x(CCplusM-&gt;<a class="code hl_functionRef" href="../../../epetra/doc/html/classEpetra__CrsMatrix.html#ac8c6024783cb8f9a333f16b9ea5aa40c">DomainMap</a>());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// If we don&#39;t have a user rhs, get one in the range</span></div>
<div class="line">  <span class="keywordflow">if</span>(!rhs) {</div>
<div class="line">    <span class="keywordflow">if</span> (Comm.<a class="code hl_functionRef" href="../../../epetra/doc/html/classEpetra__SerialComm.html#a237a6407573dea22f0366936d158486d">MyPID</a>() == 0)</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Putting in a zero initial guess and random rhs (in the range of S+M)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    x.Random();</div>
<div class="line">    rhs = <span class="keyword">new</span> <a class="code hl_classRef" href="../../../epetra/doc/html/classEpetra__Vector.html">Epetra_Vector</a>(CCplusM-&gt;<a class="code hl_functionRef" href="../../../epetra/doc/html/classEpetra__CrsMatrix.html#ac8c6024783cb8f9a333f16b9ea5aa40c">DomainMap</a>());</div>
<div class="line">    CCplusM-&gt;<a class="code hl_functionRef" href="../../../epetra/doc/html/classEpetra__CrsMatrix.html#ad028fbe37c3d2ce3f43e2acf2cbb29de">Multiply</a>(<span class="keyword">false</span>,x,*rhs);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="keywordflow">if</span> (Comm.<a class="code hl_functionRef" href="../../../epetra/doc/html/classEpetra__SerialComm.html#a237a6407573dea22f0366936d158486d">MyPID</a>() == 0)</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Using user rhs&quot;</span>&lt;&lt;std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  x.PutScalar(0.0);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> vecnorm;</div>
<div class="line">  rhs-&gt;<a class="code hl_functionRef" href="../../../epetra/doc/html/classEpetra__MultiVector.html#abf0a5f99517354b60527cef62dc9be61">Norm2</a>(&amp;vecnorm);</div>
<div class="line">  <span class="keywordflow">if</span> (Comm.<a class="code hl_functionRef" href="../../../epetra/doc/html/classEpetra__SerialComm.html#a237a6407573dea22f0366936d158486d">MyPID</a>() == 0) std::cout &lt;&lt; <span class="stringliteral">&quot;||rhs|| = &quot;</span> &lt;&lt; vecnorm &lt;&lt; std::endl;</div>
<div class="line">  x.Norm2(&amp;vecnorm);</div>
<div class="line">  <span class="keywordflow">if</span> (Comm.<a class="code hl_functionRef" href="../../../epetra/doc/html/classEpetra__SerialComm.html#a237a6407573dea22f0366936d158486d">MyPID</a>() == 0) std::cout &lt;&lt; <span class="stringliteral">&quot;||x|| = &quot;</span> &lt;&lt; vecnorm &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// for AztecOO, we need an Epetra_LinearProblem</span></div>
<div class="line">  <a class="code hl_classRef" href="../../../epetra/doc/html/classEpetra__LinearProblem.html">Epetra_LinearProblem</a> Problem(CCplusM,&amp;x,rhs);</div>
<div class="line">  <span class="comment">// AztecOO Linear problem</span></div>
<div class="line">  AztecOO solver(Problem);</div>
<div class="line">  <span class="comment">// set MLPrec as precondititoning operator for AztecOO linear problem</span></div>
<div class="line">  <span class="comment">//std::cout &lt;&lt; &quot;no ml preconditioner!!!&quot; &lt;&lt; std::endl;</span></div>
<div class="line">  solver.SetPrecOperator(MLPrec);</div>
<div class="line">  <span class="comment">//solver.SetAztecOption(AZ_precond, AZ_Jacobi);</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// a few options for AztecOO</span></div>
<div class="line">  solver.SetAztecOption(AZ_solver, AZ_cg);</div>
<div class="line">  solver.SetAztecOption(AZ_output, 1);</div>
<div class="line"> </div>
<div class="line">  solver.Iterate(15, 1e-10);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// =============== //</span></div>
<div class="line">  <span class="comment">// C L E A N   U P //</span></div>
<div class="line">  <span class="comment">// =============== //</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">delete</span> MLPrec;    <span class="comment">// destroy phase prints out some information</span></div>
<div class="line">  <span class="keyword">delete</span> CurlCurl;</div>
<div class="line">  <span class="keyword">delete</span> CCplusM;</div>
<div class="line">  <span class="keyword">delete</span> Mass;</div>
<div class="line">  <span class="keyword">delete</span> T;</div>
<div class="line">  <span class="keyword">delete</span> Kn;</div>
<div class="line">  <span class="keyword">delete</span> rhs;</div>
<div class="line">  <span class="keyword">delete</span> nodeMap;</div>
<div class="line">  <span class="keyword">delete</span> edgeMap;</div>
<div class="line">  <span class="keyword">delete</span> [] params;</div>
<div class="line">  <span class="keyword">delete</span> [] options;</div>
<div class="line"> </div>
<div class="line">  ML_Comm_Destroy(&amp;mlcomm);</div>
<div class="line">} <span class="comment">//avoids compiler error about jumping over initialization</span></div>
<div class="line">  droppedRankLabel:</div>
<div class="line"><span class="preprocessor">#ifdef ML_MPI</span></div>
<div class="line">  MPI_Finalize();</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">} <span class="comment">//main</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><span class="preprocessor">#include &quot;mpi.h&quot;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line"><span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line">  MPI_Init(&amp;argc,&amp;argv);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  puts(<span class="stringliteral">&quot;Please configure ML with:&quot;</span>);</div>
<div class="line"><span class="preprocessor">#if !defined(HAVE_ML_EPETRA)</span></div>
<div class="line">  puts(<span class="stringliteral">&quot;--enable-epetra&quot;</span>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor">#if !defined(HAVE_ML_TEUCHOS)</span></div>
<div class="line">  puts(<span class="stringliteral">&quot;--enable-teuchos&quot;</span>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor">#if !defined(HAVE_ML_EPETRAEXT)</span></div>
<div class="line">  puts(<span class="stringliteral">&quot;--enable-epetraext&quot;</span>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor">#if !defined(HAVE_ML_AZTECOO)</span></div>
<div class="line">  puts(<span class="stringliteral">&quot;--enable-aztecoo&quot;</span>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line">  MPI_Finalize();</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="ttc" id="aclassEpetra__BlockMap_html_abd9d6c774319c3bb5e79039058416a92"><div class="ttname"><a href="../../../epetra/doc/html/classEpetra__BlockMap.html#abd9d6c774319c3bb5e79039058416a92">Epetra_BlockMap::Comm</a></div><div class="ttdeci">const Epetra_Comm &amp; Comm() const</div></div>
<div class="ttc" id="aclassEpetra__CrsMatrix_html"><div class="ttname"><a href="../../../epetra/doc/html/classEpetra__CrsMatrix.html">Epetra_CrsMatrix</a></div></div>
<div class="ttc" id="aclassEpetra__CrsMatrix_html_ac8c6024783cb8f9a333f16b9ea5aa40c"><div class="ttname"><a href="../../../epetra/doc/html/classEpetra__CrsMatrix.html#ac8c6024783cb8f9a333f16b9ea5aa40c">Epetra_CrsMatrix::DomainMap</a></div><div class="ttdeci">const Epetra_Map &amp; DomainMap() const</div></div>
<div class="ttc" id="aclassEpetra__CrsMatrix_html_ad028fbe37c3d2ce3f43e2acf2cbb29de"><div class="ttname"><a href="../../../epetra/doc/html/classEpetra__CrsMatrix.html#ad028fbe37c3d2ce3f43e2acf2cbb29de">Epetra_CrsMatrix::Multiply</a></div><div class="ttdeci">int Multiply(bool TransA, const Epetra_Vector &amp;x, Epetra_Vector &amp;y) const</div></div>
<div class="ttc" id="aclassEpetra__LinearProblem_html"><div class="ttname"><a href="../../../epetra/doc/html/classEpetra__LinearProblem.html">Epetra_LinearProblem</a></div></div>
<div class="ttc" id="aclassEpetra__Map_html"><div class="ttname"><a href="../../../epetra/doc/html/classEpetra__Map.html">Epetra_Map</a></div></div>
<div class="ttc" id="aclassEpetra__MpiComm_html"><div class="ttname"><a href="../../../epetra/doc/html/classEpetra__MpiComm.html">Epetra_MpiComm</a></div></div>
<div class="ttc" id="aclassEpetra__MultiVector_html_abf0a5f99517354b60527cef62dc9be61"><div class="ttname"><a href="../../../epetra/doc/html/classEpetra__MultiVector.html#abf0a5f99517354b60527cef62dc9be61">Epetra_MultiVector::Norm2</a></div><div class="ttdeci">int Norm2(double *Result) const</div></div>
<div class="ttc" id="aclassEpetra__SerialComm_html"><div class="ttname"><a href="../../../epetra/doc/html/classEpetra__SerialComm.html">Epetra_SerialComm</a></div></div>
<div class="ttc" id="aclassEpetra__SerialComm_html_a237a6407573dea22f0366936d158486d"><div class="ttname"><a href="../../../epetra/doc/html/classEpetra__SerialComm.html#a237a6407573dea22f0366936d158486d">Epetra_SerialComm::MyPID</a></div><div class="ttdeci">int MyPID() const</div></div>
<div class="ttc" id="aclassEpetra__Vector_html"><div class="ttname"><a href="../../../epetra/doc/html/classEpetra__Vector.html">Epetra_Vector</a></div></div>
<div class="ttc" id="aclassML__Epetra_1_1MultiLevelPreconditioner_html"><div class="ttname"><a href="classML__Epetra_1_1MultiLevelPreconditioner.html">ML_Epetra::MultiLevelPreconditioner</a></div><div class="ttdoc">MultiLevelPreconditioner: a class to define black-box multilevel preconditioners using aggregation me...</div><div class="ttdef"><b>Definition</b> ml_MultiLevelPreconditioner.h:247</div></div>
<div class="ttc" id="aclassML__Epetra_1_1MultiLevelPreconditioner_html_a16598f2eb932306426aebd561af4dc15"><div class="ttname"><a href="classML__Epetra_1_1MultiLevelPreconditioner.html#a16598f2eb932306426aebd561af4dc15">ML_Epetra::MultiLevelPreconditioner::PrintUnused</a></div><div class="ttdeci">void PrintUnused() const</div><div class="ttdoc">Prints unused parameters in the input ParameterList on standard output.</div><div class="ttdef"><b>Definition</b> ml_MultiLevelPreconditioner.h:412</div></div>
<div class="ttc" id="aclassML__Epetra_1_1MultiLevelPreconditioner_html_a9303867b4ffe267f3962ab66f36d21e1"><div class="ttname"><a href="classML__Epetra_1_1MultiLevelPreconditioner.html#a9303867b4ffe267f3962ab66f36d21e1">ML_Epetra::MultiLevelPreconditioner::Print</a></div><div class="ttdeci">void Print(int level=-2)</div><div class="ttdoc">Print the individual operators in the multigrid hierarchy.</div><div class="ttdef"><b>Definition</b> ml_MultiLevelPreconditioner.cpp:2809</div></div>
<div class="ttc" id="aml__MultiLevelPreconditioner_8h_html"><div class="ttname"><a href="ml__MultiLevelPreconditioner_8h.html">ml_MultiLevelPreconditioner.h</a></div></div>
<div class="ttc" id="aml__epetra__utils_8h_html"><div class="ttname"><a href="ml__epetra__utils_8h.html">ml_epetra_utils.h</a></div><div class="ttdoc">Interface to the Trilinos package Anasazi.</div></div>
<div class="ttc" id="aml__epetra__utils_8h_html_abd736026b1cdf8c4a875ef2285f0f438"><div class="ttname"><a href="ml__epetra__utils_8h.html#abd736026b1cdf8c4a875ef2285f0f438">Epetra_MatrixAdd</a></div><div class="ttdeci">Epetra_CrsMatrix * Epetra_MatrixAdd(Epetra_RowMatrix *B, Epetra_RowMatrix *Bt, double scalar)</div><div class="ttdoc">Adds two Epetra_RowMatrix's, returns the result as an Epetra_CrsMatrix.</div></div>
<div class="ttc" id="anamespaceML__Epetra_html_a56d4ce3baee9b349ed2333326e0ec2b6"><div class="ttname"><a href="namespaceML__Epetra.html#a56d4ce3baee9b349ed2333326e0ec2b6">ML_Epetra::SetDefaults</a></div><div class="ttdeci">int SetDefaults(std::string ProblemType, Teuchos::ParameterList &amp;List, int *options=0, double *params=0, const bool OverWrite=true)</div><div class="ttdoc">Sets default parameters for aggregation-based preconditioners.</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 9 2025 20:41:06 for ML by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
