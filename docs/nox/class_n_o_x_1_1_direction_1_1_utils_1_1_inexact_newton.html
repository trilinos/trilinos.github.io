<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NOX: NOX::Direction::Utils::InexactNewton Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">NOX<span id="projectnumber">&#160;Development</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_n_o_x.html">NOX</a></li><li class="navelem"><a class="el" href="namespace_n_o_x_1_1_direction.html">Direction</a></li><li class="navelem"><b>Utils</b></li><li class="navelem"><a class="el" href="class_n_o_x_1_1_direction_1_1_utils_1_1_inexact_newton.html">InexactNewton</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_n_o_x_1_1_direction_1_1_utils_1_1_inexact_newton-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">NOX::Direction::Utils::InexactNewton Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Inexact <a class="el" href="class_n_o_x_1_1_direction_1_1_newton.html" title="Newton direction computation">Newton</a> Utilities  
 <a href="class_n_o_x_1_1_direction_1_1_utils_1_1_inexact_newton.html#details">More...</a></p>

<p><code>#include &lt;NOX_Direction_Utils_InexactNewton.H&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad24db1b2bc91bcfb93b4eefea2564124" id="r_ad24db1b2bc91bcfb93b4eefea2564124"><td class="memItemLeft" align="right" valign="top"><a id="ad24db1b2bc91bcfb93b4eefea2564124" name="ad24db1b2bc91bcfb93b4eefea2564124"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>InexactNewton</b> ()</td></tr>
<tr class="memdesc:ad24db1b2bc91bcfb93b4eefea2564124"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor. <br /></td></tr>
<tr class="separator:ad24db1b2bc91bcfb93b4eefea2564124"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec0a89b8fd0a985c6309adb107ee55e0" id="r_aec0a89b8fd0a985c6309adb107ee55e0"><td class="memItemLeft" align="right" valign="top"><a id="aec0a89b8fd0a985c6309adb107ee55e0" name="aec0a89b8fd0a985c6309adb107ee55e0"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>InexactNewton</b> (const Teuchos::RCP&lt; <a class="el" href="class_n_o_x_1_1_global_data.html">NOX::GlobalData</a> &gt; &amp;gd, Teuchos::ParameterList &amp;directionSublist)</td></tr>
<tr class="memdesc:aec0a89b8fd0a985c6309adb107ee55e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor. <br /></td></tr>
<tr class="separator:aec0a89b8fd0a985c6309adb107ee55e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbfa83e8eceb19fa64e050e283c21ae4" id="r_acbfa83e8eceb19fa64e050e283c21ae4"><td class="memItemLeft" align="right" valign="top"><a id="acbfa83e8eceb19fa64e050e283c21ae4" name="acbfa83e8eceb19fa64e050e283c21ae4"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><b>~InexactNewton</b> ()</td></tr>
<tr class="memdesc:acbfa83e8eceb19fa64e050e283c21ae4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:acbfa83e8eceb19fa64e050e283c21ae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1b46d410736f67ab9b9c93dbd0663bc" id="r_aa1b46d410736f67ab9b9c93dbd0663bc"><td class="memItemLeft" align="right" valign="top"><a id="aa1b46d410736f67ab9b9c93dbd0663bc" name="aa1b46d410736f67ab9b9c93dbd0663bc"></a>
virtual bool&#160;</td><td class="memItemRight" valign="bottom"><b>reset</b> (const Teuchos::RCP&lt; <a class="el" href="class_n_o_x_1_1_global_data.html">NOX::GlobalData</a> &gt; &amp;gd, Teuchos::ParameterList &amp;directionSublist)</td></tr>
<tr class="memdesc:aa1b46d410736f67ab9b9c93dbd0663bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the utilities. <br /></td></tr>
<tr class="separator:aa1b46d410736f67ab9b9c93dbd0663bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a220c23ca41ecd5a32b342b8552c37324" id="r_a220c23ca41ecd5a32b342b8552c37324"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_o_x_1_1_direction_1_1_utils_1_1_inexact_newton.html#a220c23ca41ecd5a32b342b8552c37324">computeForcingTerm</a> (const <a class="el" href="class_n_o_x_1_1_abstract_1_1_group.html">NOX::Abstract::Group</a> &amp;soln, const <a class="el" href="class_n_o_x_1_1_abstract_1_1_group.html">NOX::Abstract::Group</a> &amp;oldSoln, int niter, const <a class="el" href="class_n_o_x_1_1_solver_1_1_generic.html">NOX::Solver::Generic</a> &amp;solver, double eta_last=-1.0)</td></tr>
<tr class="separator:a220c23ca41ecd5a32b342b8552c37324"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59ec624dc6c8bcd4b382a20e5acc9a2e" id="r_a59ec624dc6c8bcd4b382a20e5acc9a2e"><td class="memItemLeft" align="right" valign="top"><a id="a59ec624dc6c8bcd4b382a20e5acc9a2e" name="a59ec624dc6c8bcd4b382a20e5acc9a2e"></a>
virtual Teuchos::RCP&lt; Teuchos::ParameterList &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>getDefaultParameters</b> () const</td></tr>
<tr class="separator:a59ec624dc6c8bcd4b382a20e5acc9a2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Inexact <a class="el" href="class_n_o_x_1_1_direction_1_1_newton.html" title="Newton direction computation">Newton</a> Utilities </p>
<p>If we use an iterative linear solver for a Newton-based solve, then this is called an <b>inexact Newton method</b>. The tolerance used to terminate the linear solve is called the <b>forcing term</b>. The forcing term may be constant, or it may be <b>adjustable</b>. In either case, at iteration <picture><source srcset="form_75_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$k$" src="form_75.png" width="6" height="10"/></picture> we require,  </p><p class="formulaDsp">
<picture><source srcset="form_76_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  \frac{\|J_k d_k - (-F_k)\|}{\|F_k\|} \leq \eta_k.
  \]" src="form_76.png" width="121" height="31"/></picture>
</p>
<p> Here <picture><source srcset="form_77_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\eta_k$" src="form_77.png" width="13" height="9"/></picture> is the forcing term for iteration <picture><source srcset="form_75_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$k$" src="form_75.png" width="6" height="10"/></picture>.</p>
<dl class="section note"><dt>Note</dt><dd>This solution tolerance is to be enforced by the user's implementation of <a class="el" href="class_n_o_x_1_1_abstract_1_1_group.html#a0ea79dfbca4bb39b408bc472bcd8853e" title="Compute the Newton direction, using parameters for the linear solve.">NOX::Abstract::Group::computeNewton</a>; it is passed in as the "Tolerance" in the parameter list for that function.</dd></dl>
<p>Adjustable forcing terms were introduced by Eisenstat and Walker (1982); here they are implemented as described in Pernice and Walker (1998). We have two choices for adjustable forcing terms:</p>
<ul>
<li>
<p class="startli"><b>Type 1</b></p>
<p class="formulaDsp">
<picture><source srcset="form_78_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  \eta_k = \left\vert \frac{\| F_k \| - \|J_{k-1} d_{k-1} - (-F_{k-1}) \| }
  {\|F_{k-1}\|} \right\vert
  \]" src="form_78.png" width="205" height="31"/></picture>
</p>
<p class="interli">With the following safeguards imposed:  </p><p class="formulaDsp">
<picture><source srcset="form_79_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  \max\{\eta_{k-1}^{\frac{1 + \sqrt{5}}{2}}, \eta_{\min} \} \leq \eta_k \leq \eta_{\max}
  \]" src="form_79.png" width="166" height="23"/></picture>
</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Type 2</b></p>
<p class="formulaDsp">
<picture><source srcset="form_80_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  \eta_k = \gamma \left( \frac{\|F_k\|}{\|F_{k-1}\|} \right)^\alpha
  \]" src="form_80.png" width="106" height="33"/></picture>
</p>
<p class="endli">With the following safeguards imposed:  </p><p class="formulaDsp">
<picture><source srcset="form_81_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  \max\{\gamma \eta_{k-1}^{\alpha}, \eta_{\min} \} \leq \eta_k \leq \eta_{\max}
  \]" src="form_81.png" width="168" height="14"/></picture>
</p>
 </li>
</ul>
<p><b>Parameters</b></p>
<ul>
<li>
<p class="startli">"Forcing Term Method" - Method to compute the forcing term, i.e., the tolerance for the linear solver. Choices are: </p><ul>
<li>
"Constant" [default] </li>
<li>
"Type 1" </li>
<li>
"Type 2" </li>
</ul>
<p class="endli"></p>
</li>
<li>
<p class="startli">"Forcing Term Initial Tolerance" - <picture><source srcset="form_82_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\eta_0$" src="form_82.png" width="13" height="9"/></picture> (initial linear solver tolerance). Defaults to 0.1.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">"Forcing Term Minimum Tolerance" - <picture><source srcset="form_83_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\eta_{\min}$" src="form_83.png" width="24" height="9"/></picture>. Defaults to 1.0e-6.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">"Forcing Term Maximum Tolerance" - <picture><source srcset="form_84_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\eta_{\max}$" src="form_84.png" width="26" height="9"/></picture>. Defaults to 0.01.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">"Forcing Term Alpha" - <picture><source srcset="form_85_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\alpha$" src="form_85.png" width="8" height="6"/></picture> (used only by "Type 2"). Defaults to 1.5.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">"Forcing Term Gamma" - <picture><source srcset="form_86_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\gamma$" src="form_86.png" width="9" height="9"/></picture> (used only by "Type 2"). Defaults to 0.9.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">"Forcing Term User Defined Norm" (NOX::Parameter::UserNorm derived object) - If using a Type 1 or Type 2 adjustable forcing term, the norms used to calculate <picture><source srcset="form_106_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \eta_k $" src="form_106.png" width="13" height="9"/></picture> should be based on the same norm used in the convergence test of the linear solver. Essentially this means that the norm must account for LEFT scaling of any kind that is applied to the linear system during a solve. If set, the computation of <picture><source srcset="form_106_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \eta_k $" src="form_106.png" width="13" height="9"/></picture> will be done using a used defined function that is passed in through a NOX::Parameter::Arbitrary derived object. It will take the arbitrary object and cast it to a NOX::Parameter::UserNorm object and use it for norm computations. If this parameter is not set, this method uses the L-2 Norm for any norm computations of <picture><source srcset="form_107_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$
    \eta_k $" src="form_107.png" width="13" height="9"/></picture>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">"Set Tolerance in Parameter List" When calling <a class="el" href="class_n_o_x_1_1_direction_1_1_utils_1_1_inexact_newton.html#a220c23ca41ecd5a32b342b8552c37324">computeForcingTerm()</a> the value of the forcing term will be set in the parmaeter list pointed to by the <a class="el" href="class_n_o_x_1_1_direction_1_1_utils_1_1_inexact_newton.html" title="Inexact Newton Utilities">InexactNewton</a> object. It will be set under paramsPtr-&gt;sublist(&lt;directionMethod&gt;).sublist("Linear
Solver").set("Tolerance", eta_k). Defaults to true.</p>
<p class="endli"></p>
</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>When using a forcing term, it's critically important the the residual of the original system is used in the comparison. This can be an issue if scaling or left preconditioning is applied to the linear system.</dd></dl>
<p><b>References</b></p>
<ul>
<li>
<p class="startli">Michael Pernice and Homer F. Walker, <em>NITSOL: A Newton Iterative Solver for Nonlinear Systems</em>, SISC 19(Jan 1998):302-318.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">S. C. Eisenstat and H. F. Walker, <em>Globally convergent inexact Newton methods</em>, SINUM 19(1982):400-408</p>
<p class="endli"></p>
</li>
</ul>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a220c23ca41ecd5a32b342b8552c37324" name="a220c23ca41ecd5a32b342b8552c37324"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a220c23ca41ecd5a32b342b8552c37324">&#9670;&#160;</a></span>computeForcingTerm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double NOX::Direction::Utils::InexactNewton::computeForcingTerm </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_n_o_x_1_1_abstract_1_1_group.html">NOX::Abstract::Group</a> &amp;&#160;</td>
          <td class="paramname"><em>soln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_n_o_x_1_1_abstract_1_1_group.html">NOX::Abstract::Group</a> &amp;&#160;</td>
          <td class="paramname"><em>oldSoln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>niter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_n_o_x_1_1_solver_1_1_generic.html">NOX::Solver::Generic</a> &amp;&#160;</td>
          <td class="paramname"><em>solver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>eta_last</em> = <code>-1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Called each iteration to reset the forcing term (ie, the convergence tolerance for the linear solver).</p>
<p>if the user supplied eta_last then it will use this value for eta_km1 instead of looking for it in the "Linear Solver" sublist. </p>

<p class="reference">References <a class="el" href="class_n_o_x_1_1_abstract_1_1_group.html#a42998d8377e88b11b3c27fbd15aae422">NOX::Abstract::Group::applyJacobian()</a>, <a class="el" href="class_n_o_x_1_1_abstract_1_1_vector.html#a2067e5dd853e7ed9e380f886931f0288">NOX::Abstract::Vector::clone()</a>, <a class="el" href="class_n_o_x_1_1_utils.html#ab30f60438649426b2490e4646754c856aee8024a0699f0981c126dd5a2619959b">NOX::Utils::Details</a>, <a class="el" href="class_n_o_x_1_1_abstract_1_1_group.html#aa0674a7c4392da14f7b3fbd5ac7a0cce">NOX::Abstract::Group::getF()</a>, <a class="el" href="class_n_o_x_1_1_abstract_1_1_group.html#a83eecd9cdbff67a78bf71df3d0816081">NOX::Abstract::Group::getNormF()</a>, <a class="el" href="class_n_o_x_1_1_abstract_1_1_group.html#a1244ddbfb3fe8402ffb6a3c5a8d43c12">NOX::Abstract::Group::getX()</a>, <a class="el" href="class_n_o_x_1_1_abstract_1_1_group.html#a6ce6cf0e1662c0c7bf7c472739b7a8d1">NOX::Abstract::Group::isJacobian()</a>, and <a class="el" href="namespace_n_o_x.html#a053a1ab5b2b3bd9546883b949142c592a9e3ccd93557182819f2dbc8d7f5c7dee">NOX::ShapeCopy</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><b>NOX_Direction_Utils_InexactNewton.H</b></li>
<li><b>NOX_Direction_Utils_InexactNewton.C</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
