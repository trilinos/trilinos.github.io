<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NOX: LOCA Turning Point Continuation Tutorial</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">NOX<span id="projectnumber">&#160;Development</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">LOCA Turning Point Continuation Tutorial</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="loca_tp_continuation_tutorial_overview"></a>
Overview</h1>
<p>In the <a class="el" href="loca_continuation_tutorial.html">LOCA Continuation Tutorial</a>, two turning point bifurcations were discoved in the Chan problem as the parameter <picture><source srcset="form_85_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\alpha$" src="form_85.png" width="8" height="6"/></picture> was varied from <picture><source srcset="form_463_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$0$" src="form_463.png" width="8" height="9"/></picture> to <picture><source srcset="form_464_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$5$" src="form_464.png" width="6" height="9"/></picture>. Here we provide a brief tutorial on locating one of these turning points and tracking it in the second parameter <picture><source srcset="form_205_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\beta$" src="form_205.png" width="9" height="13"/></picture>. There are several methods in LOCA for computing turning points. The example here uses the minimally augmented formulation using the LAPACK direct solver for solving the augmented linear equations. See <a class="el" href="classLOCA_1_1TurningPoint_1_1MinimallyAugmented_1_1ExtendedGroup.html" title="A group representing the minimally augemented turning point equations.">LOCA::TurningPoint::MinimallyAugmented::ExtendedGroup</a> for a description of this algorithm. Also see <a class="el" href="classLOCA_1_1TurningPoint_1_1MooreSpence_1_1ExtendedGroup.html" title="A group representing the Moore-Spence turning point equations.">LOCA::TurningPoint::MooreSpence::ExtendedGroup</a> for the Moore-Spence turning point formulation. The code fragements discussed below can be found in ChanTPContinuation.C in the Chan subdirectory of the LOCA LAPACK examples directory.</p>
<h1><a class="anchor" id="loca_tp_continuation_tutorial_code"></a>
ChanTPContinuation.C</h1>
<p>Much of the setup for the turning point continuation problem is the same as for the equilibrium continuation discussed in <a class="el" href="loca_continuation_tutorial.html">LOCA Continuation Tutorial</a>. Therefore we will only discuss the differences between the two setups here.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;LOCA.H&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;LOCA_LAPACK.H&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;ChanProblemInterface.H&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line">    <span class="keywordtype">int</span> n = 100;</div>
<div class="line">    <span class="keywordtype">double</span> alpha = 4.0;</div>
<div class="line">    <span class="keywordtype">double</span> beta = 0.0;</div>
<div class="line">    <span class="keywordtype">double</span> scale = 1.0;</div>
<div class="line">    <span class="keywordtype">int</span> maxNewtonIters = 10;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create output file to save solutions</span></div>
<div class="line">    ofstream outFile(<span class="stringliteral">&quot;ChanTPContinuation.dat&quot;</span>);</div>
<div class="line">    outFile.setf(ios::scientific, ios::floatfield);</div>
<div class="line">    outFile.precision(14);</div>
</div><!-- fragment --><p>By examining the plot in <a class="el" href="loca_continuation_tutorial.html">LOCA Continuation Tutorial</a>, a turning point bifurcation occurs near <picture><source srcset="form_466_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\alpha=4$" src="form_466.png" width="31" height="9"/></picture> for <picture><source srcset="form_98_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\beta = 0$" src="form_98.png" width="31" height="13"/></picture>. We use these values as an initial set of parameter values near the bifurcation. We also set up an output file to store the continuation parameter, solution vector, bifurcation parameter, right null vector, measure of singularity of the Jacobian (sigma) and left null vector at each continuation step. The format is the same as in ChanContinuation.dat, consisting of a series of rows each containing <picture><source srcset="form_465_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$n+1$" src="form_465.png" width="30" height="10"/></picture> numbers. Three rows are written for each continuation step, the first containing the continuation parameter and the <picture><source srcset="form_363_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$n$" src="form_363.png" width="9" height="6"/></picture> components of the solution vector, the second containing the bifurcation parameter and the <picture><source srcset="form_363_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$n$" src="form_363.png" width="9" height="6"/></picture> components of the right null vector, and the third containing sigma and the <picture><source srcset="form_363_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$n$" src="form_363.png" width="9" height="6"/></picture> components of the left null vector.</p>
<div class="fragment"><div class="line"><span class="comment">// Create output file to save solutions</span></div>
<div class="line">ofstream outFile(<span class="stringliteral">&quot;ChanTPContinuation.dat&quot;</span>);</div>
<div class="line">outFile.setf(ios::scientific, ios::floatfield);</div>
<div class="line">outFile.precision(14);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Save size of discretizations</span></div>
<div class="line">outFile &lt;&lt; n &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create initial guess for the null vector of jacobian</span></div>
<div class="line">Teuchos::RCP&lt;NOX::Abstract::Vector&gt; nullVec =</div>
<div class="line">  Teuchos::rcp(<span class="keyword">new</span> <a class="code hl_class" href="classNOX_1_1LAPACK_1_1Vector.html">NOX::LAPACK::Vector</a>(n));</div>
<div class="line">nullVec-&gt;init(1.0);               <span class="comment">// initial value 1.0</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create initial values for a and b for minimally augmented method</span></div>
<div class="line">Teuchos::RCP&lt;NOX::Abstract::Vector&gt; a_vec =</div>
<div class="line">  Teuchos::rcp(<span class="keyword">new</span> <a class="code hl_class" href="classNOX_1_1LAPACK_1_1Vector.html">NOX::LAPACK::Vector</a>(n));</div>
<div class="line">a_vec-&gt;init(1.0);</div>
<div class="line"> </div>
<div class="line">Teuchos::RCP&lt;NOX::Abstract::Vector&gt; b_vec =</div>
<div class="line">  Teuchos::rcp(<span class="keyword">new</span> <a class="code hl_class" href="classNOX_1_1LAPACK_1_1Vector.html">NOX::LAPACK::Vector</a>(n));</div>
<div class="line">b_vec-&gt;init(1.0);</div>
<div class="ttc" id="aclassNOX_1_1LAPACK_1_1Vector_html"><div class="ttname"><a href="classNOX_1_1LAPACK_1_1Vector.html">NOX::LAPACK::Vector</a></div><div class="ttdoc">Implementation of NOX::Abstract::Vector for STL std::vector&lt;double&gt; (using LAPACK for some computatio...</div><div class="ttdef"><b>Definition</b> NOX_LAPACK_Vector.H:37</div></div>
</div><!-- fragment --><p>The only additional set up required for turning point tracking in this problem is to compute an initial guess for the null vector of the Jacobian (for the Moore-Spence formulation) or the initial values for the <picture><source srcset="form_455_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$a$" src="form_455.png" width="6" height="6"/></picture> and <picture><source srcset="form_456_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$b$" src="form_456.png" width="5" height="10"/></picture> vectors in the minimally augmented formulation. Here we use a vector of all one's in all three cases.</p>
<div class="fragment"><div class="line"><span class="comment">// Create parameter list</span></div>
<div class="line">Teuchos::RCP&lt;Teuchos::ParameterList&gt; paramList =</div>
<div class="line">  Teuchos::rcp(<span class="keyword">new</span> Teuchos::ParameterList);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create LOCA sublist</span></div>
<div class="line">Teuchos::ParameterList&amp; locaParamsList = paramList-&gt;sublist(<span class="stringliteral">&quot;LOCA&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create the stepper sublist and set the stepper parameters</span></div>
<div class="line">Teuchos::ParameterList&amp; stepperList = locaParamsList.sublist(<span class="stringliteral">&quot;Stepper&quot;</span>);</div>
<div class="line">stepperList.set(<span class="stringliteral">&quot;Continuation Method&quot;</span>, <span class="stringliteral">&quot;Arc Length&quot;</span>);  <span class="comment">// Default</span></div>
<div class="line">stepperList.set(<span class="stringliteral">&quot;Continuation Parameter&quot;</span>, <span class="stringliteral">&quot;beta&quot;</span>);     <span class="comment">// Must set</span></div>
<div class="line">stepperList.set(<span class="stringliteral">&quot;Initial Value&quot;</span>, beta);                <span class="comment">// Must set</span></div>
<div class="line">stepperList.set(<span class="stringliteral">&quot;Max Value&quot;</span>, 1.0);                     <span class="comment">// Must set</span></div>
<div class="line">stepperList.set(<span class="stringliteral">&quot;Min Value&quot;</span>, 0.0);                     <span class="comment">// Must set</span></div>
<div class="line">stepperList.set(<span class="stringliteral">&quot;Max Steps&quot;</span>, 20);                      <span class="comment">// Should set</span></div>
<div class="line">stepperList.set(<span class="stringliteral">&quot;Max Nonlinear Iterations&quot;</span>, maxNewtonIters); <span class="comment">// Should set</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create bifurcation sublist</span></div>
<div class="line">Teuchos::ParameterList&amp; bifurcationList =</div>
<div class="line">  locaParamsList.sublist(<span class="stringliteral">&quot;Bifurcation&quot;</span>);</div>
<div class="line">bifurcationList.set(<span class="stringliteral">&quot;Type&quot;</span>, <span class="stringliteral">&quot;Turning Point&quot;</span>);          <span class="comment">// For turning point</span></div>
<div class="line">bifurcationList.set(<span class="stringliteral">&quot;Bifurcation Parameter&quot;</span>, <span class="stringliteral">&quot;alpha&quot;</span>); <span class="comment">// Must set</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// For Moore-Spence formulation w/bordering</span></div>
<div class="line"><span class="comment">//bifurcationList.set(&quot;Formulation&quot;, &quot;Moore-Spence&quot;);          // Default</span></div>
<div class="line"><span class="comment">//bifurcationList.set(&quot;Solver Method&quot;, &quot;Salinger Bordering&quot;);  // Default</span></div>
<div class="line"><span class="comment">//bifurcationList.set(&quot;Solver Method&quot;, &quot;Phipps Bordering&quot;);</span></div>
<div class="line"><span class="comment">//bifurcationList.set(&quot;Bordered Solver Method&quot;,</span></div>
<div class="line"><span class="comment">//                    &quot;LAPACK Direct Solve&quot;);   // For Phipps Bordering</span></div>
<div class="line"><span class="comment">//bifurcationList.set(&quot;Length Normalization Vector&quot;, nullVec); // Must set</span></div>
<div class="line"><span class="comment">//bifurcationList.set(&quot;Initial Null Vector&quot;, nullVec);         // Must set</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// For minimally augmented formulation</span></div>
<div class="line">bifurcationList.set(<span class="stringliteral">&quot;Formulation&quot;</span>, <span class="stringliteral">&quot;Minimally Augmented&quot;</span>);</div>
<div class="line">bifurcationList.set(<span class="stringliteral">&quot;Initial A Vector&quot;</span>, a_vec);                <span class="comment">// Must set</span></div>
<div class="line">bifurcationList.set(<span class="stringliteral">&quot;Initial B Vector&quot;</span>, b_vec);                <span class="comment">// Must set</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// For minimally augmented method, should set these for good performance</span></div>
<div class="line"><span class="comment">// Direct solve of bordered equations</span></div>
<div class="line">bifurcationList.set(<span class="stringliteral">&quot;Bordered Solver Method&quot;</span>,  <span class="stringliteral">&quot;LAPACK Direct Solve&quot;</span>);</div>
<div class="line"><span class="comment">// Combine arc-length and turning point bordered rows &amp; columns</span></div>
<div class="line">stepperList.set(<span class="stringliteral">&quot;Bordered Solver Method&quot;</span>, <span class="stringliteral">&quot;Nested&quot;</span>);</div>
<div class="line">Teuchos::ParameterList&amp; nestedList =</div>
<div class="line">  stepperList.sublist(<span class="stringliteral">&quot;Nested Bordered Solver&quot;</span>);</div>
<div class="line"><span class="comment">// Direct solve of combined bordered system</span></div>
<div class="line">nestedList.set(<span class="stringliteral">&quot;Bordered Solver Method&quot;</span>, <span class="stringliteral">&quot;LAPACK Direct Solve&quot;</span>);</div>
</div><!-- fragment --><p>We now set <picture><source srcset="form_205_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\beta$" src="form_205.png" width="9" height="13"/></picture> to be the continuation parameter and <picture><source srcset="form_85_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\alpha$" src="form_85.png" width="8" height="6"/></picture> to be the bifurcation parameter. We will vary <picture><source srcset="form_205_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\beta$" src="form_205.png" width="9" height="13"/></picture> from <picture><source srcset="form_463_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$0$" src="form_463.png" width="8" height="9"/></picture> to <picture><source srcset="form_468_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$1$" src="form_468.png" width="5" height="9"/></picture>, computing a value of <picture><source srcset="form_85_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\alpha$" src="form_85.png" width="8" height="6"/></picture> for each corresponding value of <picture><source srcset="form_205_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\beta$" src="form_205.png" width="9" height="13"/></picture>. The initial value of <picture><source srcset="form_85_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\alpha$" src="form_85.png" width="8" height="6"/></picture> is set internally by accessing the component "alpha" in the parameter vector <em>p</em> set below. In the bifurcation sublist, we indicate that we would like to do turning point tracking using the minimally augmented formulation, and pass ref-count pointers to the initial guess for the a and b vectors. Note that these must be casted to <a class="el" href="classNOX_1_1Abstract_1_1Vector.html" title="NOX&#39;s pure abstract vector interface for vectors that are used by the nonlinear solver.">NOX::Abstract::Vector</a> ref-count pointers.</p>
<p>Both arc-length continuation and the minimally augmented turning point method add one additional equation to be solved resulting in two nested bordered systems, each adding an additional row and column to the Jacobian matrix. We tell LOCA to combine these rows and columns into one bordered system with two augmented rows and columns (by setting the "Bordered Solver Method" of the "Stepper" sublist to "Nested") and instruct LOCA to use the LAPACK-specific linear solver for solving this 2-bordered system. Note that we must set the "LAPACK Direct Solve" choice twice , once in the "Bifurcation" sublist and once in the "Nested Bordered Solver" sublist. The first specifies the solver for the first and last continuation steps which use natural continuation instead of arc-length continuation. The last specifies the solver for the rest of the continuation steps.</p>
<div class="fragment"><div class="line"> <span class="comment">// Create predictor sublist</span></div>
<div class="line">Teuchos::ParameterList&amp; predictorList =</div>
<div class="line">  locaParamsList.sublist(<span class="stringliteral">&quot;Predictor&quot;</span>);</div>
<div class="line">predictorList.set(<span class="stringliteral">&quot;Method&quot;</span>, <span class="stringliteral">&quot;Secant&quot;</span>);                         <span class="comment">// Default</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Should use for Moore-Spence w/Salinger Bordering &amp; Secant predictor</span></div>
<div class="line"><span class="comment">//Teuchos::ParameterList&amp; firstStepPredictor</span></div>
<div class="line"><span class="comment">//  = predictorList.sublist(&quot;First Step Predictor&quot;);</span></div>
<div class="line"><span class="comment">//firstStepPredictor.set(&quot;Method&quot;, &quot;Random&quot;);</span></div>
<div class="line"><span class="comment">//firstStepPredictor.set(&quot;Epsilon&quot;, 1.0e-3);</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Should use for Moore-Spence w/Salinger Bordering &amp; Secant predictor</span></div>
<div class="line"><span class="comment">//Teuchos::ParameterList&amp; lastStepPredictor</span></div>
<div class="line"><span class="comment">//  = predictorList.sublist(&quot;Last Step Predictor&quot;);</span></div>
<div class="line"><span class="comment">//lastStepPredictor.set(&quot;Method&quot;, &quot;Random&quot;);</span></div>
<div class="line"><span class="comment">//lastStepPredictor.set(&quot;Epsilon&quot;, 1.0e-3);</span></div>
</div><!-- fragment --><p>We again use a secant predictor to compute an initial guess at each continuation step. Because we are using the secant predictor, a different predictor must be used for the first step. The default is the "Constant" predictor which is fine for the minimally augmented formulation. However for the Moore-Spence formulation with Salinger bordering, we should use the "Random" predictor because the algorithm is singular. If the problem Jacobian does not depend on the continuation parameter, we can obtain highly ill-conditioned linear solves when not using the random predictor. A random predictor can be chosen for the last step for the same reason.</p>
<div class="fragment"><div class="line">    <span class="comment">// Create step size sublist</span></div>
<div class="line">    Teuchos::ParameterList&amp; stepSizeList = locaParamsList.sublist(<span class="stringliteral">&quot;Step Size&quot;</span>);</div>
<div class="line">    stepSizeList.set(<span class="stringliteral">&quot;Method&quot;</span>, <span class="stringliteral">&quot;Adaptive&quot;</span>);                      <span class="comment">// Default</span></div>
<div class="line">    stepSizeList.set(<span class="stringliteral">&quot;Initial Step Size&quot;</span>, 0.1);                  <span class="comment">// Should set</span></div>
<div class="line">    stepSizeList.set(<span class="stringliteral">&quot;Min Step Size&quot;</span>, 1.0e-3);                   <span class="comment">// Should set</span></div>
<div class="line">    stepSizeList.set(<span class="stringliteral">&quot;Max Step Size&quot;</span>, 1.0);                      <span class="comment">// Should set</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create the &quot;Solver&quot; parameters sublist to be used with NOX Solvers</span></div>
<div class="line">    Teuchos::ParameterList&amp; nlParams = paramList-&gt;sublist(<span class="stringliteral">&quot;NOX&quot;</span>);</div>
<div class="line">    Teuchos::ParameterList&amp; nlPrintParams = nlParams.sublist(<span class="stringliteral">&quot;Printing&quot;</span>);</div>
<div class="line">    nlPrintParams.set(<span class="stringliteral">&quot;Output Information&quot;</span>,</div>
<div class="line">              <a class="code hl_enumvalue" href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a25b135dc9f7c5b6fc0b9ce8171643e8b">NOX::Utils::OuterIteration</a> +</div>
<div class="line">              <a class="code hl_enumvalue" href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856adcc5226edb211cfed7b7e79de7c578a9">NOX::Utils::OuterIterationStatusTest</a> +</div>
<div class="line">              <a class="code hl_enumvalue" href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a119da0cce22656f16f1aac7400bd3b2a">NOX::Utils::InnerIteration</a> +</div>
<div class="line">              <a class="code hl_enumvalue" href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856aee8024a0699f0981c126dd5a2619959b">NOX::Utils::Details</a> +</div>
<div class="line">              <a class="code hl_enumvalue" href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a460d575464fc6e5c6fd43abd62bc7cf3">NOX::Utils::Warning</a> +</div>
<div class="line">              <a class="code hl_enumvalue" href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a57a33282b420afc58263ea967ed94c9b">NOX::Utils::StepperIteration</a> +</div>
<div class="line">              <a class="code hl_enumvalue" href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a46712ed982b14d26ceb21e71423e47d9">NOX::Utils::StepperDetails</a> +</div>
<div class="line">              <a class="code hl_enumvalue" href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856ad53caa32bfaa4cf4aa31b21dceac7ac2">NOX::Utils::StepperParameters</a>);            <span class="comment">// Should set</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create LAPACK Factory</span></div>
<div class="line">    Teuchos::RCP&lt;LOCA::LAPACK::Factory&gt; lapackFactory =</div>
<div class="line">      Teuchos::rcp(<span class="keyword">new</span> <a class="code hl_class" href="classLOCA_1_1LAPACK_1_1Factory.html">LOCA::LAPACK::Factory</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create global data object</span></div>
<div class="line">    Teuchos::RCP&lt;LOCA::GlobalData&gt; globalData =</div>
<div class="line">      LOCA::createGlobalData(paramList, lapackFactory);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set up the problem interface</span></div>
<div class="line">    ChanProblemInterface chan(globalData, n, alpha, beta, scale, outFile);</div>
<div class="line">    <a class="code hl_class" href="classLOCA_1_1ParameterVector.html">LOCA::ParameterVector</a> p;</div>
<div class="line">    p.<a class="code hl_function" href="classLOCA_1_1ParameterVector.html#aaaf4c959bc4140abe294151a8802b6f0">addParameter</a>(<span class="stringliteral">&quot;alpha&quot;</span>,alpha);</div>
<div class="line">    p.<a class="code hl_function" href="classLOCA_1_1ParameterVector.html#aaaf4c959bc4140abe294151a8802b6f0">addParameter</a>(<span class="stringliteral">&quot;beta&quot;</span>,beta);</div>
<div class="line">    p.<a class="code hl_function" href="classLOCA_1_1ParameterVector.html#aaaf4c959bc4140abe294151a8802b6f0">addParameter</a>(<span class="stringliteral">&quot;scale&quot;</span>,scale);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create a group which uses that problem interface. The group will</span></div>
<div class="line">    <span class="comment">// be initialized to contain the default initial guess for the</span></div>
<div class="line">    <span class="comment">// specified problem.</span></div>
<div class="line">    Teuchos::RCP&lt;LOCA::MultiContinuation::AbstractGroup&gt; grp =</div>
<div class="line">      Teuchos::rcp(<span class="keyword">new</span> <a class="code hl_class" href="classLOCA_1_1LAPACK_1_1Group.html">LOCA::LAPACK::Group</a>(globalData, chan));</div>
<div class="line"> </div>
<div class="line">    grp-&gt;setParams(p);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set up the status tests</span></div>
<div class="line">    Teuchos::RCP&lt;NOX::StatusTest::NormF&gt; statusTestA =</div>
<div class="line">      Teuchos::rcp(<span class="keyword">new</span> <a class="code hl_class" href="classNOX_1_1StatusTest_1_1NormF.html">NOX::StatusTest::NormF</a>(1.0e-10,</div>
<div class="line">                          <a class="code hl_enumvalue" href="classNOX_1_1StatusTest_1_1NormF.html#ac48931c140d11bcb58a95dbad3ad8cdca419d2bdfc6580ca3773535fc6fc19ea3">NOX::StatusTest::NormF::Scaled</a>));</div>
<div class="line">    Teuchos::RCP&lt;NOX::StatusTest::MaxIters&gt; statusTestB =</div>
<div class="line">      Teuchos::rcp(<span class="keyword">new</span> <a class="code hl_class" href="classNOX_1_1StatusTest_1_1MaxIters.html">NOX::StatusTest::MaxIters</a>(maxNewtonIters));</div>
<div class="line">    Teuchos::RCP&lt;NOX::StatusTest::Combo&gt; combo =</div>
<div class="line">      Teuchos::rcp(<span class="keyword">new</span> <a class="code hl_class" href="classNOX_1_1StatusTest_1_1Combo.html">NOX::StatusTest::Combo</a>(<a class="code hl_enumvalue" href="classNOX_1_1StatusTest_1_1Combo.html#a788f39025311c7e7fdb1d53660dafe19a6529707f844e7fe814d3fa94a761677f">NOX::StatusTest::Combo::OR</a>,</div>
<div class="line">                          statusTestA, statusTestB));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create the stepper</span></div>
<div class="line">    <a class="code hl_class" href="classLOCA_1_1Stepper.html">LOCA::Stepper</a> stepper(globalData, grp, combo, paramList);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Solve the nonlinear system</span></div>
<div class="line">    <a class="code hl_enumeration" href="classLOCA_1_1Abstract_1_1Iterator.html#acaf6fee3bc899dfc0e07096e17b7d3fb">LOCA::Abstract::Iterator::IteratorStatus</a> status = stepper.run();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (status != <a class="code hl_enumvalue" href="classLOCA_1_1Abstract_1_1Iterator.html#acaf6fee3bc899dfc0e07096e17b7d3fba9a436d7f61e22dbf66321d8febf78294">LOCA::Abstract::Iterator::Finished</a>) {</div>
<div class="line">      <span class="keywordflow">if</span> (globalData-&gt;locaUtils-&gt;isPrintType(<a class="code hl_enumvalue" href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a70f12508894f21ce2816873de343bb1d">NOX::Utils::Error</a>))</div>
<div class="line">    globalData-&gt;locaUtils-&gt;out()</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Stepper failed to converge!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Output the parameter list</span></div>
<div class="line">    <span class="keywordflow">if</span> (globalData-&gt;locaUtils-&gt;isPrintType(<a class="code hl_enumvalue" href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856ad53caa32bfaa4cf4aa31b21dceac7ac2">NOX::Utils::StepperParameters</a>)) {</div>
<div class="line">      globalData-&gt;locaUtils-&gt;out()</div>
<div class="line">    &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Final Parameters&quot;</span> &lt;&lt; std::endl</div>
<div class="line">    &lt;&lt; <span class="stringliteral">&quot;****************&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      stepper.getList()-&gt;print(globalData-&gt;locaUtils-&gt;out());</div>
<div class="line">      globalData-&gt;locaUtils-&gt;out() &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    outFile.close();</div>
<div class="line"> </div>
<div class="line">    LOCA::destroyGlobalData(globalData);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">catch</span> (std::exception&amp; e) {</div>
<div class="line">    cout &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">catch</span> (<span class="keyword">const</span> <span class="keywordtype">char</span> *s) {</div>
<div class="line">    cout &lt;&lt; s &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">catch</span> (...) {</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Caught unknown exception!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclassLOCA_1_1Abstract_1_1Iterator_html_acaf6fee3bc899dfc0e07096e17b7d3fb"><div class="ttname"><a href="classLOCA_1_1Abstract_1_1Iterator.html#acaf6fee3bc899dfc0e07096e17b7d3fb">LOCA::Abstract::Iterator::IteratorStatus</a></div><div class="ttdeci">IteratorStatus</div><div class="ttdoc">Enumerated type for status of the iterator.</div><div class="ttdef"><b>Definition</b> LOCA_Abstract_Iterator.H:60</div></div>
<div class="ttc" id="aclassLOCA_1_1Abstract_1_1Iterator_html_acaf6fee3bc899dfc0e07096e17b7d3fba9a436d7f61e22dbf66321d8febf78294"><div class="ttname"><a href="classLOCA_1_1Abstract_1_1Iterator.html#acaf6fee3bc899dfc0e07096e17b7d3fba9a436d7f61e22dbf66321d8febf78294">LOCA::Abstract::Iterator::Finished</a></div><div class="ttdeci">@ Finished</div><div class="ttdoc">The iterator is finished.</div><div class="ttdef"><b>Definition</b> LOCA_Abstract_Iterator.H:62</div></div>
<div class="ttc" id="aclassLOCA_1_1LAPACK_1_1Factory_html"><div class="ttname"><a href="classLOCA_1_1LAPACK_1_1Factory.html">LOCA::LAPACK::Factory</a></div><div class="ttdoc">Implementation of the LOCA::Abstract::Factory for LAPACK groups.</div><div class="ttdef"><b>Definition</b> LOCA_LAPACK_Factory.H:27</div></div>
<div class="ttc" id="aclassLOCA_1_1LAPACK_1_1Group_html"><div class="ttname"><a href="classLOCA_1_1LAPACK_1_1Group.html">LOCA::LAPACK::Group</a></div><div class="ttdoc">Extension of the NOX::LAPACK::Group to LOCA.</div><div class="ttdef"><b>Definition</b> LOCA_LAPACK_Group.H:65</div></div>
<div class="ttc" id="aclassLOCA_1_1ParameterVector_html"><div class="ttname"><a href="classLOCA_1_1ParameterVector.html">LOCA::ParameterVector</a></div><div class="ttdoc">LOCA's container for holding a set of parameters that are used by the LOCA continuation routines.</div><div class="ttdef"><b>Definition</b> LOCA_Parameter_Vector.H:32</div></div>
<div class="ttc" id="aclassLOCA_1_1ParameterVector_html_aaaf4c959bc4140abe294151a8802b6f0"><div class="ttname"><a href="classLOCA_1_1ParameterVector.html#aaaf4c959bc4140abe294151a8802b6f0">LOCA::ParameterVector::addParameter</a></div><div class="ttdeci">int addParameter(std::string label, double value=0.0)</div><div class="ttdoc">Adds a parameter to the list. Returns the index value assigned to the parameter.</div><div class="ttdef"><b>Definition</b> LOCA_Parameter_Vector.C:38</div></div>
<div class="ttc" id="aclassLOCA_1_1Stepper_html"><div class="ttname"><a href="classLOCA_1_1Stepper.html">LOCA::Stepper</a></div><div class="ttdoc">Implementation of LOCA::Abstract::Iterator for computing points along a continuation curve.</div><div class="ttdef"><b>Definition</b> LOCA_Stepper.H:69</div></div>
<div class="ttc" id="aclassNOX_1_1StatusTest_1_1Combo_html"><div class="ttname"><a href="classNOX_1_1StatusTest_1_1Combo.html">NOX::StatusTest::Combo</a></div><div class="ttdoc">Arbitrary combination of status tests.</div><div class="ttdef"><b>Definition</b> NOX_StatusTest_Combo.H:43</div></div>
<div class="ttc" id="aclassNOX_1_1StatusTest_1_1Combo_html_a788f39025311c7e7fdb1d53660dafe19a6529707f844e7fe814d3fa94a761677f"><div class="ttname"><a href="classNOX_1_1StatusTest_1_1Combo.html#a788f39025311c7e7fdb1d53660dafe19a6529707f844e7fe814d3fa94a761677f">NOX::StatusTest::Combo::OR</a></div><div class="ttdeci">@ OR</div><div class="ttdoc">Logically &quot;OR&quot; together the results of the tests in this combination.</div><div class="ttdef"><b>Definition</b> NOX_StatusTest_Combo.H:55</div></div>
<div class="ttc" id="aclassNOX_1_1StatusTest_1_1MaxIters_html"><div class="ttname"><a href="classNOX_1_1StatusTest_1_1MaxIters.html">NOX::StatusTest::MaxIters</a></div><div class="ttdoc">Failure test based on the maximum number of nonlinear solver iterations.</div><div class="ttdef"><b>Definition</b> NOX_StatusTest_MaxIters.H:35</div></div>
<div class="ttc" id="aclassNOX_1_1StatusTest_1_1NormF_html"><div class="ttname"><a href="classNOX_1_1StatusTest_1_1NormF.html">NOX::StatusTest::NormF</a></div><div class="ttdoc">Various convergence tests based on the norm of the residual.</div><div class="ttdef"><b>Definition</b> NOX_StatusTest_NormF.H:78</div></div>
<div class="ttc" id="aclassNOX_1_1StatusTest_1_1NormF_html_ac48931c140d11bcb58a95dbad3ad8cdca419d2bdfc6580ca3773535fc6fc19ea3"><div class="ttname"><a href="classNOX_1_1StatusTest_1_1NormF.html#ac48931c140d11bcb58a95dbad3ad8cdca419d2bdfc6580ca3773535fc6fc19ea3">NOX::StatusTest::NormF::Scaled</a></div><div class="ttdeci">@ Scaled</div><div class="ttdoc">Scale the norm by the length of the vector.</div><div class="ttdef"><b>Definition</b> NOX_StatusTest_NormF.H:87</div></div>
<div class="ttc" id="aclassNOX_1_1Utils_html_ab30f60438649426b2490e4646754c856a119da0cce22656f16f1aac7400bd3b2a"><div class="ttname"><a href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a119da0cce22656f16f1aac7400bd3b2a">NOX::Utils::InnerIteration</a></div><div class="ttdeci">@ InnerIteration</div><div class="ttdoc">2^2</div><div class="ttdef"><b>Definition</b> NOX_Utils.H:111</div></div>
<div class="ttc" id="aclassNOX_1_1Utils_html_ab30f60438649426b2490e4646754c856a25b135dc9f7c5b6fc0b9ce8171643e8b"><div class="ttname"><a href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a25b135dc9f7c5b6fc0b9ce8171643e8b">NOX::Utils::OuterIteration</a></div><div class="ttdeci">@ OuterIteration</div><div class="ttdoc">2^1</div><div class="ttdef"><b>Definition</b> NOX_Utils.H:109</div></div>
<div class="ttc" id="aclassNOX_1_1Utils_html_ab30f60438649426b2490e4646754c856a460d575464fc6e5c6fd43abd62bc7cf3"><div class="ttname"><a href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a460d575464fc6e5c6fd43abd62bc7cf3">NOX::Utils::Warning</a></div><div class="ttdeci">@ Warning</div><div class="ttdoc">2^0</div><div class="ttdef"><b>Definition</b> NOX_Utils.H:107</div></div>
<div class="ttc" id="aclassNOX_1_1Utils_html_ab30f60438649426b2490e4646754c856a46712ed982b14d26ceb21e71423e47d9"><div class="ttname"><a href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a46712ed982b14d26ceb21e71423e47d9">NOX::Utils::StepperDetails</a></div><div class="ttdeci">@ StepperDetails</div><div class="ttdoc">2^9 – For LOCA</div><div class="ttdef"><b>Definition</b> NOX_Utils.H:125</div></div>
<div class="ttc" id="aclassNOX_1_1Utils_html_ab30f60438649426b2490e4646754c856a57a33282b420afc58263ea967ed94c9b"><div class="ttname"><a href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a57a33282b420afc58263ea967ed94c9b">NOX::Utils::StepperIteration</a></div><div class="ttdeci">@ StepperIteration</div><div class="ttdoc">2^8 – For LOCA</div><div class="ttdef"><b>Definition</b> NOX_Utils.H:123</div></div>
<div class="ttc" id="aclassNOX_1_1Utils_html_ab30f60438649426b2490e4646754c856a70f12508894f21ce2816873de343bb1d"><div class="ttname"><a href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a70f12508894f21ce2816873de343bb1d">NOX::Utils::Error</a></div><div class="ttdeci">@ Error</div><div class="ttdoc">Errors are always printed.</div><div class="ttdef"><b>Definition</b> NOX_Utils.H:105</div></div>
<div class="ttc" id="aclassNOX_1_1Utils_html_ab30f60438649426b2490e4646754c856ad53caa32bfaa4cf4aa31b21dceac7ac2"><div class="ttname"><a href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856ad53caa32bfaa4cf4aa31b21dceac7ac2">NOX::Utils::StepperParameters</a></div><div class="ttdeci">@ StepperParameters</div><div class="ttdoc">2^10 – For LOCA</div><div class="ttdef"><b>Definition</b> NOX_Utils.H:127</div></div>
<div class="ttc" id="aclassNOX_1_1Utils_html_ab30f60438649426b2490e4646754c856adcc5226edb211cfed7b7e79de7c578a9"><div class="ttname"><a href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856adcc5226edb211cfed7b7e79de7c578a9">NOX::Utils::OuterIterationStatusTest</a></div><div class="ttdeci">@ OuterIterationStatusTest</div><div class="ttdoc">2^5</div><div class="ttdef"><b>Definition</b> NOX_Utils.H:117</div></div>
<div class="ttc" id="aclassNOX_1_1Utils_html_ab30f60438649426b2490e4646754c856aee8024a0699f0981c126dd5a2619959b"><div class="ttname"><a href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856aee8024a0699f0981c126dd5a2619959b">NOX::Utils::Details</a></div><div class="ttdeci">@ Details</div><div class="ttdoc">2^4</div><div class="ttdef"><b>Definition</b> NOX_Utils.H:115</div></div>
</div><!-- fragment --><p>The rest of the driver setup is very similar to ChanContinuation.C We slightly tighten the convergence tolerance to demonstrate the well conditioning of the minimally augmented method. In this case we must use the LAPACK factory since we are using the LAPACK-specific solver method "LAPACK Direct Solve".</p>
<p>After running the example and reading the data file ChanTPContinuation.dat, we can plot the continuation parameter <picture><source srcset="form_205_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\beta$" src="form_205.png" width="9" height="13"/></picture> versus the bifurcation parameter <picture><source srcset="form_85_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\alpha$" src="form_85.png" width="8" height="6"/></picture> to get a locus of turning point bifurcations in the <picture><source srcset="form_469_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$(\beta,\alpha)$" src="form_469.png" width="30" height="14"/></picture> parameter space:</p>
<div class="image">
<img src="chan_tp.png" alt=""/>
</div>
<p></p>
<p>There are two branches of the bifurcation curve which come together to form a cusp. Starting at <picture><source srcset="form_470_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\beta=0$" src="form_470.png" width="31" height="13"/></picture> on one branch, traversing the cusp, and moving to <picture><source srcset="form_470_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\beta=0$" src="form_470.png" width="31" height="13"/></picture> on the second branch connects the two turning points shown in the <a class="el" href="loca_continuation_tutorial.html">LOCA Continuation Tutorial</a>.</p>
<p>As in the continuation tutorial, the MATLAB code used to generate this plot is shown below.</p>
<div class="fragment"><div class="line">% open output file</div>
<div class="line">fid = fopen(<span class="stringliteral">&#39;ChanTPContinuation.dat&#39;</span>);</div>
<div class="line"> </div>
<div class="line">% read dimension of discretization</div>
<div class="line">n = fscanf(fid, <span class="stringliteral">&#39;%d&#39;</span>, 1);</div>
<div class="line"> </div>
<div class="line">beta = [];     % array of continuation parameter values at each step</div>
<div class="line">alpha = [];    % array of bifurcation parameter values at each step</div>
<div class="line">sigma = [];    % array of singular estimates at each step</div>
<div class="line">x = [];        % array of solution components at each step</div>
<div class="line">y = [];        % array of right null vector components at each step</div>
<div class="line">z = [];        % array of left null vector components at each step</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">while</span> ~feof(fid)</div>
<div class="line"> </div>
<div class="line">  % read beta</div>
<div class="line">  beta = [beta fscanf(fid, <span class="stringliteral">&#39;%g&#39;</span>, 1)];</div>
<div class="line"> </div>
<div class="line">  % read x</div>
<div class="line">  x = [x fscanf(fid, <span class="stringliteral">&#39;%g&#39;</span>, n)];</div>
<div class="line"> </div>
<div class="line">  % read alpha</div>
<div class="line">  alpha = [alpha fscanf(fid, <span class="stringliteral">&#39;%g&#39;</span>, 1)];</div>
<div class="line"> </div>
<div class="line">  % read y</div>
<div class="line">  y = [y fscanf(fid, <span class="stringliteral">&#39;%g&#39;</span>, n)];</div>
<div class="line"> </div>
<div class="line">  % read sigma</div>
<div class="line">  sigma = [sigma fscanf(fid, <span class="stringliteral">&#39;%g&#39;</span>, 1)];</div>
<div class="line"> </div>
<div class="line">  % read z</div>
<div class="line">  z = [z fscanf(fid, <span class="stringliteral">&#39;%g&#39;</span>, n)];</div>
<div class="line"> </div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">% close output file</div>
<div class="line">fclose(fid);</div>
<div class="line"> </div>
<div class="line">% compute maximum of each temperature profile</div>
<div class="line">maxT = max(x);</div>
<div class="line"> </div>
<div class="line">figure;</div>
<div class="line">plot(beta,alpha,<span class="stringliteral">&#39;bo-&#39;</span>);</div>
<div class="line">xlabel(<span class="stringliteral">&#39;\beta&#39;</span>);</div>
<div class="line">ylabel(<span class="stringliteral">&#39;\alpha    &#39;</span>,<span class="stringliteral">&#39;Rotation&#39;</span>,0);</div>
<div class="line">title(<span class="stringliteral">&#39;Locus of Turning Points&#39;</span>);</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 9 2025 20:46:01 for NOX by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
