<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NOX: LOCA Continuation Tutorial</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">NOX<span id="projectnumber">&#160;Development</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">LOCA Continuation Tutorial</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="loca_continuation_tutorial_overview"></a>
Overview</h1>
<p>Here we provide a brief tutorial for using LOCA to perform a simple continuation using the Chan problem (see ChanProblemInterface). The code fragements discussed below can be found in ChanContinuation.C in the Chan subdirectory of the LOCA LAPACK examples directory.</p>
<p>The ChanProblemInterface implements a 1-D finite-difference discretization of the Chan problem:  </p><p class="formulaDsp">
<picture><source srcset="form_460_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
      \frac{d^2 T}{d x^2} + \alpha s \left(1 + \frac{x + 0.5 x^2}{1 + 0.01 x^2}\right) = 0
  \]" src="form_460.png" width="178" height="33"/></picture>
</p>
<p> subject to the boundary conditions <picture><source srcset="form_461_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$T(0) = T(1) = \beta$" src="form_461.png" width="91" height="14"/></picture>. The parameters are <picture><source srcset="form_85_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\alpha$" src="form_85.png" width="8" height="6"/></picture>, <picture><source srcset="form_205_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\beta$" src="form_205.png" width="9" height="13"/></picture>, <picture><source srcset="form_59_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$s$" src="form_59.png" width="5" height="6"/></picture>, and <picture><source srcset="form_363_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$n$" src="form_363.png" width="9" height="6"/></picture>, the size of the discretization. The scaling factor <picture><source srcset="form_59_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$s$" src="form_59.png" width="5" height="6"/></picture> is used to test continuation at different scales of <picture><source srcset="form_85_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\alpha$" src="form_85.png" width="8" height="6"/></picture>. Below we will track the solution <picture><source srcset="form_462_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$T(x,\alpha,\beta)$" src="form_462.png" width="53" height="14"/></picture> as <picture><source srcset="form_85_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\alpha$" src="form_85.png" width="8" height="6"/></picture> is varied from <picture><source srcset="form_463_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$0$" src="form_463.png" width="8" height="9"/></picture> to <picture><source srcset="form_464_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$5$" src="form_464.png" width="6" height="9"/></picture>.</p>
<h1><a class="anchor" id="loca_continuation_tutorial_code"></a>
ChanContinuation.C Line by Line</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;LOCA.H&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;LOCA_LAPACK.H&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;ChanProblemInterface.H&quot;</span></div>
</div><!-- fragment --><p>To use LOCA in your code, you must always include the header LOCA.H. Since this is a LAPACK problem, we also include LOCA_LAPACK.H. Finally, we include the header for the Chan problem, ChanProblemInterface.H.</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span> n = 100;</div>
<div class="line">  <span class="keywordtype">double</span> alpha = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> beta = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> scale = 1.0;</div>
<div class="line">  <span class="keywordtype">int</span> maxNewtonIters = 20;</div>
<div class="line"> </div>
<div class="line">  alpha = alpha / scale;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span> {</div>
</div><!-- fragment --><p>Next we set up the basic problem parameters. <em>maxNewtonIters</em> is the maximum number of nonlinear solver iterations we wish to take at each continuation step. NOX and LOCA do throw exceptions (but only when serious errors occur), so all NOX and LOCA calculations should be placed in a try block.</p>
<div class="fragment"><div class="line"><span class="comment">// Create output file to save solutions</span></div>
<div class="line">ofstream outFile(<span class="stringliteral">&quot;ChanContinuation.dat&quot;</span>);</div>
<div class="line">outFile.setf(ios::scientific, ios::floatfield);</div>
<div class="line">outFile.precision(14);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Save size of discretizations</span></div>
<div class="line">outFile &lt;&lt; n &lt;&lt; std::endl;</div>
</div><!-- fragment --><p>Here we set up a file for saving the solutions computed at each continuation step. The printSolution method of the ChanProblemInterface is set up in such a way that if a file is provided, the current continuation parameter and solution vector are appended to the file, in addition to printing a portion of the solution vector to the screen. The format of this file is a series of rows, with each row containing <picture><source srcset="form_465_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$n+1$" src="form_465.png" width="30" height="10"/></picture> numbers, the first is the continuation parameter with the remaining <picture><source srcset="form_363_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$n$" src="form_363.png" width="9" height="6"/></picture> consisting of each component of the solution vector.</p>
<div class="fragment"><div class="line"><span class="comment">// Create parameter list</span></div>
<div class="line">Teuchos::RCP&lt;Teuchos::ParameterList&gt; paramList =</div>
<div class="line">  Teuchos::rcp(<span class="keyword">new</span> Teuchos::ParameterList);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create LOCA sublist</span></div>
<div class="line">Teuchos::ParameterList&amp; locaParamsList = paramList-&gt;sublist(<span class="stringliteral">&quot;LOCA&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create the stepper sublist and set the stepper parameters</span></div>
<div class="line">Teuchos::ParameterList&amp; stepperList = locaParamsList.sublist(<span class="stringliteral">&quot;Stepper&quot;</span>);</div>
<div class="line">stepperList.set(<span class="stringliteral">&quot;Continuation Method&quot;</span>, <span class="stringliteral">&quot;Arc Length&quot;</span>);<span class="comment">// Default</span></div>
<div class="line"><span class="comment">//stepperList.set(&quot;Continuation Method&quot;, &quot;Natural&quot;);</span></div>
<div class="line">stepperList.set(<span class="stringliteral">&quot;Continuation Parameter&quot;</span>, <span class="stringliteral">&quot;alpha&quot;</span>);  <span class="comment">// Must set</span></div>
<div class="line">stepperList.set(<span class="stringliteral">&quot;Initial Value&quot;</span>, alpha);             <span class="comment">// Must set</span></div>
<div class="line">stepperList.set(<span class="stringliteral">&quot;Max Value&quot;</span>, 5.0/scale);             <span class="comment">// Must set</span></div>
<div class="line">stepperList.set(<span class="stringliteral">&quot;Min Value&quot;</span>, 0.0/scale);             <span class="comment">// Must set</span></div>
<div class="line">stepperList.set(<span class="stringliteral">&quot;Max Steps&quot;</span>, 50);                    <span class="comment">// Should set</span></div>
<div class="line">stepperList.set(<span class="stringliteral">&quot;Max Nonlinear Iterations&quot;</span>, maxNewtonIters); <span class="comment">// Should set</span></div>
<div class="line">stepperList.set(<span class="stringliteral">&quot;Compute Eigenvalues&quot;</span>,<span class="keyword">false</span>);        <span class="comment">// Default</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create bifurcation sublist</span></div>
<div class="line">Teuchos::ParameterList&amp; bifurcationList =</div>
<div class="line">  locaParamsList.sublist(<span class="stringliteral">&quot;Bifurcation&quot;</span>);</div>
<div class="line">bifurcationList.set(<span class="stringliteral">&quot;Type&quot;</span>, <span class="stringliteral">&quot;None&quot;</span>);                 <span class="comment">// Default</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create predictor sublist</span></div>
<div class="line">Teuchos::ParameterList&amp; predictorList =</div>
<div class="line">  locaParamsList.sublist(<span class="stringliteral">&quot;Predictor&quot;</span>);</div>
<div class="line">predictorList.set(<span class="stringliteral">&quot;Method&quot;</span>, <span class="stringliteral">&quot;Secant&quot;</span>);               <span class="comment">// Default</span></div>
<div class="line"><span class="comment">//predictorList.set(&quot;Method&quot;, &quot;Constant&quot;);</span></div>
<div class="line"><span class="comment">//predictorList.set(&quot;Method&quot;, &quot;Tangent&quot;);</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create step size sublist</span></div>
<div class="line">Teuchos::ParameterList&amp; stepSizeList = locaParamsList.sublist(<span class="stringliteral">&quot;Step Size&quot;</span>);</div>
<div class="line">stepSizeList.set(<span class="stringliteral">&quot;Method&quot;</span>, <span class="stringliteral">&quot;Adaptive&quot;</span>);             <span class="comment">// Default</span></div>
<div class="line">stepSizeList.set(<span class="stringliteral">&quot;Initial Step Size&quot;</span>, 0.1/scale);   <span class="comment">// Should set</span></div>
<div class="line">stepSizeList.set(<span class="stringliteral">&quot;Min Step Size&quot;</span>, 1.0e-3/scale);    <span class="comment">// Should set</span></div>
<div class="line">stepSizeList.set(<span class="stringliteral">&quot;Max Step Size&quot;</span>, 10.0/scale);      <span class="comment">// Should set</span></div>
</div><!-- fragment --><p>Next we set up the LOCA parameters. We are setting up the problem to perform arc-length continuation in the parameter "alpha" from 0 to 5 with a maximum of 50 continuation steps and <em>maxNewtonIters</em> nonlinear iterations per step. Since we are doing an equilibrium continuation, we set the bifurcation method to "None". We use a secant predictor and adaptive step size control with an initial step size of 0.1, maximum of 10.0 and minimum of 0.001.</p>
<div class="fragment"><div class="line"><span class="comment">// Create the &quot;Solver&quot; parameters sublist to be used with NOX Solvers</span></div>
<div class="line">Teuchos::ParameterList&amp; nlParams = paramList-&gt;sublist(<span class="stringliteral">&quot;NOX&quot;</span>);</div>
<div class="line">Teuchos::ParameterList&amp; nlPrintParams = nlParams.sublist(<span class="stringliteral">&quot;Printing&quot;</span>);</div>
<div class="line">nlPrintParams.set(<span class="stringliteral">&quot;Output Information&quot;</span>,</div>
<div class="line">          <a class="code hl_enumvalue" href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856aee8024a0699f0981c126dd5a2619959b">NOX::Utils::Details</a> +</div>
<div class="line">          <a class="code hl_enumvalue" href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a25b135dc9f7c5b6fc0b9ce8171643e8b">NOX::Utils::OuterIteration</a> +</div>
<div class="line">          <a class="code hl_enumvalue" href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a119da0cce22656f16f1aac7400bd3b2a">NOX::Utils::InnerIteration</a> +</div>
<div class="line">          <a class="code hl_enumvalue" href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a460d575464fc6e5c6fd43abd62bc7cf3">NOX::Utils::Warning</a> +</div>
<div class="line">          <a class="code hl_enumvalue" href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a57a33282b420afc58263ea967ed94c9b">NOX::Utils::StepperIteration</a> +</div>
<div class="line">          <a class="code hl_enumvalue" href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a46712ed982b14d26ceb21e71423e47d9">NOX::Utils::StepperDetails</a> +</div>
<div class="line">          <a class="code hl_enumvalue" href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856ad53caa32bfaa4cf4aa31b21dceac7ac2">NOX::Utils::StepperParameters</a>);  <span class="comment">// Should set</span></div>
<div class="ttc" id="aclassNOX_1_1Utils_html_ab30f60438649426b2490e4646754c856a119da0cce22656f16f1aac7400bd3b2a"><div class="ttname"><a href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a119da0cce22656f16f1aac7400bd3b2a">NOX::Utils::InnerIteration</a></div><div class="ttdeci">@ InnerIteration</div><div class="ttdoc">2^2</div><div class="ttdef"><b>Definition</b> NOX_Utils.H:111</div></div>
<div class="ttc" id="aclassNOX_1_1Utils_html_ab30f60438649426b2490e4646754c856a25b135dc9f7c5b6fc0b9ce8171643e8b"><div class="ttname"><a href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a25b135dc9f7c5b6fc0b9ce8171643e8b">NOX::Utils::OuterIteration</a></div><div class="ttdeci">@ OuterIteration</div><div class="ttdoc">2^1</div><div class="ttdef"><b>Definition</b> NOX_Utils.H:109</div></div>
<div class="ttc" id="aclassNOX_1_1Utils_html_ab30f60438649426b2490e4646754c856a460d575464fc6e5c6fd43abd62bc7cf3"><div class="ttname"><a href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a460d575464fc6e5c6fd43abd62bc7cf3">NOX::Utils::Warning</a></div><div class="ttdeci">@ Warning</div><div class="ttdoc">2^0</div><div class="ttdef"><b>Definition</b> NOX_Utils.H:107</div></div>
<div class="ttc" id="aclassNOX_1_1Utils_html_ab30f60438649426b2490e4646754c856a46712ed982b14d26ceb21e71423e47d9"><div class="ttname"><a href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a46712ed982b14d26ceb21e71423e47d9">NOX::Utils::StepperDetails</a></div><div class="ttdeci">@ StepperDetails</div><div class="ttdoc">2^9 – For LOCA</div><div class="ttdef"><b>Definition</b> NOX_Utils.H:125</div></div>
<div class="ttc" id="aclassNOX_1_1Utils_html_ab30f60438649426b2490e4646754c856a57a33282b420afc58263ea967ed94c9b"><div class="ttname"><a href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a57a33282b420afc58263ea967ed94c9b">NOX::Utils::StepperIteration</a></div><div class="ttdeci">@ StepperIteration</div><div class="ttdoc">2^8 – For LOCA</div><div class="ttdef"><b>Definition</b> NOX_Utils.H:123</div></div>
<div class="ttc" id="aclassNOX_1_1Utils_html_ab30f60438649426b2490e4646754c856ad53caa32bfaa4cf4aa31b21dceac7ac2"><div class="ttname"><a href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856ad53caa32bfaa4cf4aa31b21dceac7ac2">NOX::Utils::StepperParameters</a></div><div class="ttdeci">@ StepperParameters</div><div class="ttdoc">2^10 – For LOCA</div><div class="ttdef"><b>Definition</b> NOX_Utils.H:127</div></div>
<div class="ttc" id="aclassNOX_1_1Utils_html_ab30f60438649426b2490e4646754c856aee8024a0699f0981c126dd5a2619959b"><div class="ttname"><a href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856aee8024a0699f0981c126dd5a2619959b">NOX::Utils::Details</a></div><div class="ttdeci">@ Details</div><div class="ttdoc">2^4</div><div class="ttdef"><b>Definition</b> NOX_Utils.H:115</div></div>
</div><!-- fragment --><p>Next we set up the NOX parameters. We use a simple full-step Newton method for the nonlinear solve at each continuation step (the default), and specify what output we want printed to the screen.</p>
<div class="fragment"><div class="line"><span class="comment">// Create LAPACK Factory</span></div>
<div class="line">Teuchos::RCP&lt;LOCA::LAPACK::Factory&gt; lapackFactory =</div>
<div class="line">  Teuchos::rcp(<span class="keyword">new</span> <a class="code hl_class" href="classLOCA_1_1LAPACK_1_1Factory.html">LOCA::LAPACK::Factory</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create global data object</span></div>
<div class="line">Teuchos::RCP&lt;LOCA::GlobalData&gt; globalData =</div>
<div class="line">  LOCA::createGlobalData(paramList, lapackFactory);</div>
<div class="ttc" id="aclassLOCA_1_1LAPACK_1_1Factory_html"><div class="ttname"><a href="classLOCA_1_1LAPACK_1_1Factory.html">LOCA::LAPACK::Factory</a></div><div class="ttdoc">Implementation of the LOCA::Abstract::Factory for LAPACK groups.</div><div class="ttdef"><b>Definition</b> LOCA_LAPACK_Factory.H:27</div></div>
</div><!-- fragment --><p>We now create the LAPACK factory and the global data object. The factory is optional, and allows the use of LAPACK-specific strategies (e.g., the LAPACK eigensolver DGGEV). However the global data object is manditory. If no factory is provided, the second argument to createGlobalData is empty.</p>
<div class="fragment"><div class="line"><span class="comment">// Set up the problem interface</span></div>
<div class="line">ChanProblemInterface chan(globalData, n, alpha, beta, scale, outFile);</div>
<div class="line"><a class="code hl_class" href="classLOCA_1_1ParameterVector.html">LOCA::ParameterVector</a> p;</div>
<div class="line">p.<a class="code hl_function" href="classLOCA_1_1ParameterVector.html#aaaf4c959bc4140abe294151a8802b6f0">addParameter</a>(<span class="stringliteral">&quot;alpha&quot;</span>,alpha);</div>
<div class="line">p.<a class="code hl_function" href="classLOCA_1_1ParameterVector.html#aaaf4c959bc4140abe294151a8802b6f0">addParameter</a>(<span class="stringliteral">&quot;beta&quot;</span>,beta);</div>
<div class="line">p.<a class="code hl_function" href="classLOCA_1_1ParameterVector.html#aaaf4c959bc4140abe294151a8802b6f0">addParameter</a>(<span class="stringliteral">&quot;scale&quot;</span>,scale);</div>
<div class="ttc" id="aclassLOCA_1_1ParameterVector_html"><div class="ttname"><a href="classLOCA_1_1ParameterVector.html">LOCA::ParameterVector</a></div><div class="ttdoc">LOCA's container for holding a set of parameters that are used by the LOCA continuation routines.</div><div class="ttdef"><b>Definition</b> LOCA_Parameter_Vector.H:32</div></div>
<div class="ttc" id="aclassLOCA_1_1ParameterVector_html_aaaf4c959bc4140abe294151a8802b6f0"><div class="ttname"><a href="classLOCA_1_1ParameterVector.html#aaaf4c959bc4140abe294151a8802b6f0">LOCA::ParameterVector::addParameter</a></div><div class="ttdeci">int addParameter(std::string label, double value=0.0)</div><div class="ttdoc">Adds a parameter to the list. Returns the index value assigned to the parameter.</div><div class="ttdef"><b>Definition</b> LOCA_Parameter_Vector.C:38</div></div>
</div><!-- fragment --><p>Next we instantiate the ChanProblemInterface and create a parameter vector to store the values of the problem parameters. Note that it is not necessary to put every problem parameter into the parameter vector, only those that serve as possible continuation or bifurcation parameters need to be supplied.</p>
<div class="fragment"><div class="line"><span class="comment">// Create a group which uses that problem interface. The group will</span></div>
<div class="line"><span class="comment">// be initialized to contain the default initial guess for the</span></div>
<div class="line"><span class="comment">// specified problem.</span></div>
<div class="line">Teuchos::RCP&lt;LOCA::MultiContinuation::AbstractGroup&gt; grp =</div>
<div class="line">  Teuchos::rcp(<span class="keyword">new</span> <a class="code hl_class" href="classLOCA_1_1LAPACK_1_1Group.html">LOCA::LAPACK::Group</a>(globalData, chan));</div>
<div class="line"> </div>
<div class="line">grp-&gt;setParams(p);</div>
<div class="ttc" id="aclassLOCA_1_1LAPACK_1_1Group_html"><div class="ttname"><a href="classLOCA_1_1LAPACK_1_1Group.html">LOCA::LAPACK::Group</a></div><div class="ttdoc">Extension of the NOX::LAPACK::Group to LOCA.</div><div class="ttdef"><b>Definition</b> LOCA_LAPACK_Group.H:65</div></div>
</div><!-- fragment --><p>Next we instantiate the LAPACK group with the Chan problem and then set the parameter vector in the group. From this point on, the <a class="el" href="classLOCA_1_1Stepper.html" title="Implementation of LOCA::Abstract::Iterator for computing points along a continuation curve.">LOCA::Stepper</a>, via the <a class="el" href="classLOCA_1_1LAPACK_1_1Group.html" title="Extension of the NOX::LAPACK::Group to LOCA.">LOCA::LAPACK::Group</a>, will take care of setting parameters in the problem interface.</p>
<div class="fragment"><div class="line"><span class="comment">// Set up the status tests</span></div>
<div class="line">Teuchos::RCP&lt;NOX::StatusTest::NormF&gt; normF =</div>
<div class="line">  Teuchos::rcp(<span class="keyword">new</span> <a class="code hl_class" href="classNOX_1_1StatusTest_1_1NormF.html">NOX::StatusTest::NormF</a>(1.0e-8));</div>
<div class="line">Teuchos::RCP&lt;NOX::StatusTest::MaxIters&gt; maxIters =</div>
<div class="line">  Teuchos::rcp(<span class="keyword">new</span> <a class="code hl_class" href="classNOX_1_1StatusTest_1_1MaxIters.html">NOX::StatusTest::MaxIters</a>(maxNewtonIters));</div>
<div class="line">Teuchos::RCP&lt;NOX::StatusTest::Generic&gt; comboOR =</div>
<div class="line">  Teuchos::rcp(<span class="keyword">new</span> <a class="code hl_class" href="classNOX_1_1StatusTest_1_1Combo.html">NOX::StatusTest::Combo</a>(<a class="code hl_enumvalue" href="classNOX_1_1StatusTest_1_1Combo.html#a788f39025311c7e7fdb1d53660dafe19a6529707f844e7fe814d3fa94a761677f">NOX::StatusTest::Combo::OR</a>,</div>
<div class="line">                      normF,</div>
<div class="line">                      maxIters));</div>
<div class="ttc" id="aclassNOX_1_1StatusTest_1_1Combo_html"><div class="ttname"><a href="classNOX_1_1StatusTest_1_1Combo.html">NOX::StatusTest::Combo</a></div><div class="ttdoc">Arbitrary combination of status tests.</div><div class="ttdef"><b>Definition</b> NOX_StatusTest_Combo.H:43</div></div>
<div class="ttc" id="aclassNOX_1_1StatusTest_1_1Combo_html_a788f39025311c7e7fdb1d53660dafe19a6529707f844e7fe814d3fa94a761677f"><div class="ttname"><a href="classNOX_1_1StatusTest_1_1Combo.html#a788f39025311c7e7fdb1d53660dafe19a6529707f844e7fe814d3fa94a761677f">NOX::StatusTest::Combo::OR</a></div><div class="ttdeci">@ OR</div><div class="ttdoc">Logically &quot;OR&quot; together the results of the tests in this combination.</div><div class="ttdef"><b>Definition</b> NOX_StatusTest_Combo.H:55</div></div>
<div class="ttc" id="aclassNOX_1_1StatusTest_1_1MaxIters_html"><div class="ttname"><a href="classNOX_1_1StatusTest_1_1MaxIters.html">NOX::StatusTest::MaxIters</a></div><div class="ttdoc">Failure test based on the maximum number of nonlinear solver iterations.</div><div class="ttdef"><b>Definition</b> NOX_StatusTest_MaxIters.H:35</div></div>
<div class="ttc" id="aclassNOX_1_1StatusTest_1_1NormF_html"><div class="ttname"><a href="classNOX_1_1StatusTest_1_1NormF.html">NOX::StatusTest::NormF</a></div><div class="ttdoc">Various convergence tests based on the norm of the residual.</div><div class="ttdef"><b>Definition</b> NOX_StatusTest_NormF.H:78</div></div>
</div><!-- fragment --><p>Next we create appropriate status tests for the problem. For convergence at each continuation step, we require the extended (solution and parameter components) residual norm be smaller than 1.0e-8 and the number of nonlinear iterations be smaller than <em>maxNewtonIters</em>.</p>
<div class="fragment"><div class="line"><span class="comment">// Create the stepper</span></div>
<div class="line"><a class="code hl_class" href="classLOCA_1_1Stepper.html">LOCA::Stepper</a> stepper(globalData, grp, comboOR, paramList);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Perform continuation run</span></div>
<div class="line"><a class="code hl_enumeration" href="classLOCA_1_1Abstract_1_1Iterator.html#acaf6fee3bc899dfc0e07096e17b7d3fb">LOCA::Abstract::Iterator::IteratorStatus</a> status = stepper.run();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Check for convergence</span></div>
<div class="line"><span class="keywordflow">if</span> (status != <a class="code hl_enumvalue" href="classLOCA_1_1Abstract_1_1Iterator.html#acaf6fee3bc899dfc0e07096e17b7d3fba9a436d7f61e22dbf66321d8febf78294">LOCA::Abstract::Iterator::Finished</a>) {</div>
<div class="line">  <span class="keywordflow">if</span> (globalData-&gt;locaUtils-&gt;isPrintType(<a class="code hl_enumvalue" href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a70f12508894f21ce2816873de343bb1d">NOX::Utils::Error</a>))</div>
<div class="line">globalData-&gt;locaUtils-&gt;out()</div>
<div class="line">  &lt;&lt; <span class="stringliteral">&quot;Stepper failed to converge!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="ttc" id="aclassLOCA_1_1Abstract_1_1Iterator_html_acaf6fee3bc899dfc0e07096e17b7d3fb"><div class="ttname"><a href="classLOCA_1_1Abstract_1_1Iterator.html#acaf6fee3bc899dfc0e07096e17b7d3fb">LOCA::Abstract::Iterator::IteratorStatus</a></div><div class="ttdeci">IteratorStatus</div><div class="ttdoc">Enumerated type for status of the iterator.</div><div class="ttdef"><b>Definition</b> LOCA_Abstract_Iterator.H:60</div></div>
<div class="ttc" id="aclassLOCA_1_1Abstract_1_1Iterator_html_acaf6fee3bc899dfc0e07096e17b7d3fba9a436d7f61e22dbf66321d8febf78294"><div class="ttname"><a href="classLOCA_1_1Abstract_1_1Iterator.html#acaf6fee3bc899dfc0e07096e17b7d3fba9a436d7f61e22dbf66321d8febf78294">LOCA::Abstract::Iterator::Finished</a></div><div class="ttdeci">@ Finished</div><div class="ttdoc">The iterator is finished.</div><div class="ttdef"><b>Definition</b> LOCA_Abstract_Iterator.H:62</div></div>
<div class="ttc" id="aclassLOCA_1_1Stepper_html"><div class="ttname"><a href="classLOCA_1_1Stepper.html">LOCA::Stepper</a></div><div class="ttdoc">Implementation of LOCA::Abstract::Iterator for computing points along a continuation curve.</div><div class="ttdef"><b>Definition</b> LOCA_Stepper.H:69</div></div>
<div class="ttc" id="aclassNOX_1_1Utils_html_ab30f60438649426b2490e4646754c856a70f12508894f21ce2816873de343bb1d"><div class="ttname"><a href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856a70f12508894f21ce2816873de343bb1d">NOX::Utils::Error</a></div><div class="ttdeci">@ Error</div><div class="ttdoc">Errors are always printed.</div><div class="ttdef"><b>Definition</b> NOX_Utils.H:105</div></div>
</div><!-- fragment --><p>Finally we instantiate the stepper, run the continuation, and check the returned status.</p>
<div class="fragment"><div class="line">    <span class="comment">// Get the final solution from the stepper</span></div>
<div class="line">    Teuchos::RCP&lt;const LOCA::LAPACK::Group&gt; finalGroup =</div>
<div class="line">      Teuchos::rcp_dynamic_cast&lt;const LOCA::LAPACK::Group&gt;(stepper.getSolutionGroup());</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classNOX_1_1LAPACK_1_1Vector.html">NOX::LAPACK::Vector</a>&amp; finalSolution =</div>
<div class="line">      <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code hl_class" href="classNOX_1_1LAPACK_1_1Vector.html">NOX::LAPACK::Vector</a>&amp;<span class="keyword">&gt;</span>(finalGroup-&gt;getX());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Print final solution</span></div>
<div class="line">    globalData-&gt;locaUtils-&gt;out()</div>
<div class="line">                &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Final solution is &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    finalGroup-&gt;printSolution(finalSolution,</div>
<div class="line">                      finalGroup-&gt;getParam(<span class="stringliteral">&quot;alpha&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Output the parameter list</span></div>
<div class="line">    <span class="keywordflow">if</span> (globalData-&gt;locaUtils-&gt;isPrintType(<a class="code hl_enumvalue" href="classNOX_1_1Utils.html#ab30f60438649426b2490e4646754c856ad53caa32bfaa4cf4aa31b21dceac7ac2">NOX::Utils::StepperParameters</a>)) {</div>
<div class="line">      globalData-&gt;locaUtils-&gt;out()</div>
<div class="line">    &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Final Parameters&quot;</span> &lt;&lt; std::endl</div>
<div class="line">    &lt;&lt; <span class="stringliteral">&quot;****************&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      stepper.getList()-&gt;<a class="code hl_function" href="classNOX_1_1LAPACK_1_1Vector.html#a43f04a7b3c9d2346ae89ba1ab1adf2fa">print</a>(globalData-&gt;locaUtils-&gt;out());</div>
<div class="line">      globalData-&gt;locaUtils-&gt;out() &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    outFile.close();</div>
<div class="line"> </div>
<div class="line">    LOCA::destroyGlobalData(globalData);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">catch</span> (std::exception&amp; e) {</div>
<div class="line">    cout &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">catch</span> (<span class="keyword">const</span> <span class="keywordtype">char</span> *s) {</div>
<div class="line">    cout &lt;&lt; s &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">catch</span> (...) {</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Caught unknown exception!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclassNOX_1_1LAPACK_1_1Vector_html"><div class="ttname"><a href="classNOX_1_1LAPACK_1_1Vector.html">NOX::LAPACK::Vector</a></div><div class="ttdoc">Implementation of NOX::Abstract::Vector for STL std::vector&lt;double&gt; (using LAPACK for some computatio...</div><div class="ttdef"><b>Definition</b> NOX_LAPACK_Vector.H:37</div></div>
<div class="ttc" id="aclassNOX_1_1LAPACK_1_1Vector_html_a43f04a7b3c9d2346ae89ba1ab1adf2fa"><div class="ttname"><a href="classNOX_1_1LAPACK_1_1Vector.html#a43f04a7b3c9d2346ae89ba1ab1adf2fa">NOX::LAPACK::Vector::print</a></div><div class="ttdeci">void print(std::ostream &amp;stream) const</div><div class="ttdoc">Print the vector. To be used for debugging only.</div><div class="ttdef"><b>Definition</b> NOX_LAPACK_Vector.C:286</div></div>
</div><!-- fragment --><p>Lastly we copy the final solution out of the stepper, print out the final parameter list, close the output file, destroy the global data object, and catch any thrown exceptions.</p>
<p>After running the example and plotting the maximum of the temperature versus the continuation parameter <picture><source srcset="form_85_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\alpha$" src="form_85.png" width="8" height="6"/></picture> at each step, we obtain the following continuation curve with two turning points:</p>
<div class="image">
<img src="chan.png" alt=""/>
</div>
<p></p>
<p>Turning point bifurcations occur near <picture><source srcset="form_466_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\alpha=4$" src="form_466.png" width="31" height="9"/></picture> and <picture><source srcset="form_467_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\alpha=3$" src="form_467.png" width="30" height="9"/></picture>. For a tutorial on locating these turning point bifurcations and tracking them in the second parameter <picture><source srcset="form_205_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\beta$" src="form_205.png" width="9" height="13"/></picture>, see the <a class="el" href="loca_tp_continuation_tutorial.html">LOCA Turning Point Continuation Tutorial</a>.</p>
<p>The above plot was generated via MATLAB using the output file ChanContinuation.dat specified above. For those interested, the MATLAB commands used to generate this plot are shown below. </p><div class="fragment"><div class="line">% open output file</div>
<div class="line">fid = fopen(<span class="stringliteral">&#39;ChanContinuation.dat&#39;</span>);</div>
<div class="line"> </div>
<div class="line">% read dimension of discretization</div>
<div class="line">n = fscanf(fid, <span class="stringliteral">&#39;%d&#39;</span>, 1);</div>
<div class="line"> </div>
<div class="line">alpha = []; % array of continuation parameter values at each step</div>
<div class="line">x = [];     % array of solution components at each step</div>
<div class="line"> </div>
<div class="line">% read values from output file</div>
<div class="line"><span class="keywordflow">while</span> ~feof(fid)</div>
<div class="line"> </div>
<div class="line">  % read alpha</div>
<div class="line">  alpha = [alpha fscanf(fid, <span class="stringliteral">&#39;%g&#39;</span>, 1)];</div>
<div class="line"> </div>
<div class="line">  % read x</div>
<div class="line">  x = [x fscanf(fid, <span class="stringliteral">&#39;%g&#39;</span>, n)];</div>
<div class="line"> </div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">% close output file</div>
<div class="line">fclose(fid);</div>
<div class="line"> </div>
<div class="line">% compute maximum of each temperature profile</div>
<div class="line">maxT = max(x);</div>
<div class="line"> </div>
<div class="line">plot(alpha,maxT,<span class="stringliteral">&#39;bo-&#39;</span>);</div>
<div class="line">xlabel(<span class="stringliteral">&#39;\alpha&#39;</span>);</div>
<div class="line">ylabel(<span class="stringliteral">&#39;T_{max}   &#39;</span>,<span class="stringliteral">&#39;Rotation&#39;</span>,0);</div>
<div class="line">title(<span class="stringliteral">&#39;Arc-length Continuation:  \beta = 0&#39;</span>);</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 9 2025 20:46:01 for NOX by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
